<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>environment</title>
    <url>/archives/project/briup_environment.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="0-å‰è¨€"><a href="#0-å‰è¨€" class="headerlink" title="0 å‰è¨€"></a>0 å‰è¨€</h1><ul>
<li>:file_folder: ç‰©è”ç½‘ç¯å¢ƒç›‘æµ‹ç³»ç»Ÿ </li>
<li>:timer_clock: 2021/9/24</li>
<li>:school:  jd2017(èè‹±ç­)</li>
<li>:man_teacher:  å´”ç•¥(ä¸»è®²)</li>
<li>ğŸ‘¨â€ğŸ’»  vanse-åˆ˜èª(è¾…å¯¼) </li>
</ul>
<h1 id="1-é¡¹ç›®å‡†å¤‡"><a href="#1-é¡¹ç›®å‡†å¤‡" class="headerlink" title="1 é¡¹ç›®å‡†å¤‡"></a>1 é¡¹ç›®å‡†å¤‡</h1><p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210924140713895.png"></p>
<h2 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h2><blockquote>
<p>:tipping_hand_man:  æ­¤å¤„ä»¥Oracleä¸ºä¾‹ pl/sqlè¯­æ³•å¾ªç¯å»º31å¼ è¡¨</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--ä½¿ç”¨PL/SQLå»ºè¡¨</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">FOR</span> i <span class="keyword">IN</span> <span class="number">1.</span><span class="number">.31</span> LOOP</span><br><span class="line"><span class="keyword">EXECUTE</span> IMMEDIATE</span><br><span class="line"><span class="string">&#x27;CREATE TABLE e_detail_&#x27;</span><span class="operator">||</span>TO_CHAR(i)<span class="operator">||</span></span><br><span class="line"><span class="string">&#x27;(</span></span><br><span class="line"><span class="string">    name varchar2(20),</span></span><br><span class="line"><span class="string">    srcId varchar2(5),</span></span><br><span class="line"><span class="string">    desId varchar2(5),</span></span><br><span class="line"><span class="string">    devId varchar2(5),</span></span><br><span class="line"><span class="string">    sersorAddress varchar2(7),</span></span><br><span class="line"><span class="string">    count number(2),</span></span><br><span class="line"><span class="string">    cmd  varchar2(5),</span></span><br><span class="line"><span class="string">    status number(2),</span></span><br><span class="line"><span class="string">    data number(9,4),</span></span><br><span class="line"><span class="string">    gather_date date</span></span><br><span class="line"><span class="string">)&#x27;</span>;</span><br><span class="line"><span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--åˆ é™¤31å¼ è¡¨</span></span><br><span class="line"><span class="comment">--ä½¿ç”¨PL/SQLåˆ é™¤è¡¨</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">FOR</span> i <span class="keyword">IN</span> <span class="number">1.</span><span class="number">.31</span> LOOP</span><br><span class="line"><span class="keyword">EXECUTE</span> IMMEDIATE</span><br><span class="line">	<span class="string">&#x27;DROP TABLE e_detail_&#x27;</span><span class="operator">||</span>TO_CHAR(i);</span><br><span class="line"><span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="2-å®¢æˆ·ç«¯"><a href="#2-å®¢æˆ·ç«¯" class="headerlink" title="2 å®¢æˆ·ç«¯"></a>2 å®¢æˆ·ç«¯</h1><h2 id="é‡‡é›†æ•°æ®"><a href="#é‡‡é›†æ•°æ®" class="headerlink" title="é‡‡é›†æ•°æ®"></a>é‡‡é›†æ•°æ®</h2><p><code>å·²çŸ¥æ•°æ®</code></p>
<h3 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a><strong>Environment</strong></h3><blockquote>
<p>å½“16çš„æ—¶å€™  å¯¹åº”è¦è§£æä¸¤ä¸ªEnvironment æ¹¿åº¦å¯¹è±¡ æ¸©åº¦å¯¹è±¡ å³nameå±æ€§</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.sql.Timestamp;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç¯å¢ƒå­˜å‚¨å®ä½“ç±»,åŒ…æ‹¬ç¯å¢ƒç§ç±»(æ¸©åº¦,æ¹¿åº¦,äºŒæ°§åŒ–ç¢³,å…‰ç…§å¼ºåº¦)</span></span><br><span class="line"><span class="comment"> 16 æ¸©/æ¹¿åº¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Environment</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//ç¯å¢ƒç§ç±»åç§°</span></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="comment">//å‘é€ç«¯id</span></span><br><span class="line">	<span class="keyword">private</span> String srcId;</span><br><span class="line">	<span class="comment">//æ ‘è“æ´¾ç³»ç»Ÿid</span></span><br><span class="line">	<span class="keyword">private</span> String desId;</span><br><span class="line">	<span class="comment">//å®éªŒç®±åŒºåŸŸæ¨¡å—id(1-8)</span></span><br><span class="line">	<span class="keyword">private</span> String devId;</span><br><span class="line">	<span class="comment">//æ¨¡å—ä¸Šä¼ æ„Ÿå™¨åœ°å€ 16 256 1280</span></span><br><span class="line">	<span class="keyword">private</span> String sersorAddress;</span><br><span class="line">	<span class="comment">//ä¼ æ„Ÿå™¨ä¸ªæ•°</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> count;</span><br><span class="line">	<span class="comment">//å‘é€æŒ‡ä»¤æ ‡å· 3è¡¨ç¤ºæ¥æ”¶æ•°æ® 16è¡¨ç¤ºå‘é€å‘½ä»¤</span></span><br><span class="line">	<span class="keyword">private</span> String cmd;</span><br><span class="line">	<span class="comment">//ç¯å¢ƒå€¼</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">float</span> data;</span><br><span class="line">    </span><br><span class="line">   <span class="comment">//çŠ¶æ€ é»˜è®¤1è¡¨ç¤ºæˆåŠŸ</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> status;</span><br><span class="line">	<span class="comment">//é‡‡é›†æ—¶é—´</span></span><br><span class="line">	<span class="keyword">private</span> Timestamp gather_date;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//GET/SET</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="data-file-simple"><a href="#data-file-simple" class="headerlink" title="data-file-simple"></a>data-file-simple</h3><blockquote>
<p>:tipping_hand_man: æ•°æ®åªæœ‰9åˆ— è€ŒEnvironmentå¯¹è±¡æœ‰10ä¸ªå±æ€§</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">100|101|2|16|1|3|57a491fc02|1|1516413763738</span><br><span class="line">100|101|2|16|1|3|57a891fc02|1|1516413764761</span><br><span class="line">100|101|2|16|1|3|57a491fc02|1|1516413765686</span><br><span class="line">100|101|2|256|1|3|001c03|1|1516413766708</span><br><span class="line">100|101|2|256|1|3|001c03|1|1516413767731</span><br><span class="line">100|101|2|16|1|3|57a492d002|1|1516413768756</span><br><span class="line">100|101|2|1280|1|3|02f801|1|1516413769787</span><br><span class="line">100|101|2|1280|1|3|02f801|1|1516413770702</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>ä¸€è¡Œæ•°æ®è¡¨ç¤ºä¸€ç»„æ•°æ®ï¼Œæ¯ä¸ªæ•°æ®ä¹‹é—´ä½¿ç”¨â€œ|â€åˆ†å‰²ï¼Œæ¯è¡Œæ•°æ®éƒ½è¡¨ç¤ºä¸€ç§ç¯å¢ƒæ•°æ®ï¼ŒåŒæ—¶ï¼Œæ¯è¡Œæ•°æ®åˆ†ä¸ºä»¥ä¸‹ä¹ä¸ªå°éƒ¨åˆ†ï¼š</p>
<ol>
<li><p>å‘é€ç«¯id</p>
</li>
<li><p>æ ‘è“æ´¾ç³»ç»Ÿid</p>
</li>
<li><p>å®éªŒç®±åŒºåŸŸæ¨¡å—id(1-8)</p>
</li>
<li><p>æ¨¡å—ä¸Šä¼ æ„Ÿå™¨åœ°å€</p>
<ul>
<li>16ï¼Œè¡¨ç¤ºæ¸©åº¦å’Œæ¹¿åº¦æ•°æ®</li>
<li>256ï¼Œè¡¨ç¤ºå…‰ç…§å¼ºåº¦æ•°æ®</li>
<li>1280ï¼Œè¡¨ç¤ºäºŒæ°§åŒ–ç¢³æ•°æ®</li>
</ul>
</li>
<li><p>ä¼ æ„Ÿå™¨ä¸ªæ•°</p>
</li>
<li><p>æŒ‡ä»¤æ ‡å·</p>
<p>å¦‚æœæ˜¯3è¡¨ç¤ºéœ€è¦æ¥å—æ•°æ®ï¼Œå¦‚æœæ˜¯16è¡¨ç¤ºéœ€è¦å‘é€æ•°æ®</p>
</li>
<li><p><strong>ç¯å¢ƒæ•°æ®</strong></p>
</li>
<li><p>çŠ¶æ€æ ‡è¯†</p>
<p>é»˜è®¤ä¸º1ï¼Œè¡¨ç¤ºæˆåŠŸ</p>
</li>
<li><p>é‡‡é›†æ—¶é—´</p>
</li>
</ol>
<p><strong>ç‰¹åˆ«æ³¨æ„ï¼Œå…³äºä¸€è¡Œä¸­çš„ç¬¬7ä¸ªæ•°æ®éƒ¨åˆ†ï¼š</strong></p>
<p>è¿™éƒ¨åˆ†æ˜¯çœŸæ­£çš„ç¯å¢ƒæ•°æ®ï¼Œä½†æ˜¯ä½¿ç”¨çš„åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œéœ€è¦è½¬æ¢ä¸ºåè¿›åˆ¶ï¼Œåˆ†ä¸‰ç§æƒ…å†µï¼š</p>
<ul>
<li><p>å¦‚æœå½“å‰æ˜¯æ¸©åº¦å’Œæ¹¿åº¦çš„æ•°æ®ï¼Œåˆ™å‰ä¸¤ä¸ªå­—èŠ‚æ˜¯æ¸©åº¦ï¼Œä¸­é—´ä¸¤ä¸ªå­—èŠ‚æ˜¯æ¹¿åº¦ï¼Œå‰©ä½™å­—èŠ‚ä¸ç”¨ç®¡</p>
</li>
<li><p>å¦‚æœå½“å‰æ˜¯å…‰ç…§å¼ºåº¦çš„æ•°æ®ï¼Œåˆ™å‰ä¸¤ä¸ªå­—èŠ‚å°±æ˜¯æ•°æ®å€¼ï¼Œå‰©ä½™å­—èŠ‚ä¸ç”¨ç®¡</p>
</li>
<li><p>å¦‚æœå½“å‰æ˜¯äºŒæ°§åŒ–ç¢³çš„æ•°æ®ï¼Œåˆ™å‰ä¸¤ä¸ªå­—èŠ‚å°±æ˜¯æ•°æ®å€¼ï¼Œå‰©ä½™å­—èŠ‚ä¸ç”¨ç®¡</p>
</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼Œä¸€ä¸ªå­—èŠ‚å¯ä»¥ç”±2ä¸ªåå…­è¿›åˆ¶è¡¨ç¤º</p>
</blockquote>
<p>æŠŠåå…­è¿›åˆ¶çš„ç¯å¢ƒæ•°æ®ï¼Œè½¬ä¸ºåè¿›åˆ¶çš„æ•°æ®ä¹‹åï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥å¤„ç†ï¼š</p>
<ul>
<li>å¦‚æœæ˜¯æ¸©åº¦æ•°æ®ï¼š(data*(0.00268127F))-46.85F</li>
<li>å¦‚æœæ˜¯æ¹¿åº¦æ•°æ®ï¼š(data*0.00190735F)-6</li>
<li>å¦‚æœæ˜¯äºŒæ°§åŒ–ç¢³å’Œå…‰ç…§å¼ºåº¦ï¼Œç›´æ¥è½¬æ¢å¾—åˆ°çš„åè¿›åˆ¶æ•°æ®å°±å¯ä»¥è¡¨ç¤º</li>
</ul>
<p><code>åˆ†æ</code></p>
<ul>
<li>è¯»å–simple-fileæ–‡ä»¶</li>
<li>è§£ææ¯ä¸€è¡Œ åˆ†åˆ«å°è£…åˆ° ä¸€ä¸ªEnvironmentå¯¹è±¡</li>
<li>ç¬¬4åˆ— å’Œ ç¬¬7åˆ—<ul>
<li>ç¬¬å››åˆ—<ul>
<li>16  </li>
<li>256</li>
<li>1280</li>
</ul>
</li>
<li>ç¬¬7åˆ— 16è¿›åˆ¶  57a491fc02  ==ä¸¤ä¸ªå­—èŠ‚  57a4==<ul>
<li>16 æ¸©/æ¹¿åº¦  æ¸©: å‰ä¸¤ä¸ªå­—èŠ‚ æ¹¿åº¦ : ä¸­é—´ä¸¤ä¸ªå­—èŠ‚</li>
<li>256 å…‰ç…§</li>
<li>1280 äºŒæ°§åŒ–ç¢³</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1ä¸ª  2ä¸ª16è¿›åˆ¶</span><br><span class="line">1ä¸ª  8ä¸ªäºŒè¿›åˆ¶ä½</span><br><span class="line">1ä¸ª16è¿›åˆ¶ 4ä¸ªäºŒè¿›åˆ¶è¡¨ç¤º  1/2ä¸ªå­—èŠ‚</span><br><span class="line">å› æ­¤  ä¸€ä¸ªå­—èŠ‚ä»£è¡¨2ä¸ª16è¿›åˆ¶</span><br></pre></td></tr></table></figure>





<p><code>è¿‡ç¨‹</code></p>
<p>###pom.xm</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- æ­¤å¤„ç‰ˆæœ¬å¯çœç•¥ --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.briup.smart<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>env-gather-interface<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="GatherImpl"><a href="#GatherImpl" class="headerlink" title="GatherImpl"></a>GatherImpl</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.sql.Timestamp;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.entity.Environment;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.util.CopyUtil;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * é‡‡é›†æ•°æ®</span></span><br><span class="line"><span class="comment"> * 	å°†100|101|2|16|1|3|5f6c6ba002|1|1516323990934 å°è£…æˆ Environmentå¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatherImpl</span> <span class="keyword">implements</span> <span class="title">Gather</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Collection&lt;Environment&gt; <span class="title">gather</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		InputStream in = GatherImpl.class.getClassLoader().getResourceAsStream(<span class="string">&quot;data-file-simple&quot;</span>);</span><br><span class="line">		BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in));</span><br><span class="line">		Collection&lt;Environment&gt; enColl = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">		<span class="comment">// 1.è¯»å–æ•°æ®</span></span><br><span class="line">		String line = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">while</span> ((line = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">			String[] lineData = line.split(<span class="string">&quot;[|]&quot;</span>);</span><br><span class="line">			Environment environment = <span class="keyword">new</span> Environment();</span><br><span class="line">			<span class="comment">// è®¾ç½®å‘é€ç«¯id</span></span><br><span class="line">			environment.setSrcId(lineData[<span class="number">0</span>]);</span><br><span class="line">			<span class="comment">// è®¾ç½®æ ‘è“æ´¾ç³»ç»Ÿid</span></span><br><span class="line">			environment.setDesId(lineData[<span class="number">1</span>]);</span><br><span class="line">			<span class="comment">// è®¾ç½®å®éªŒç®±åŒºåŸŸid</span></span><br><span class="line">			environment.setDevId(lineData[<span class="number">2</span>]);</span><br><span class="line">			<span class="comment">// è®¾ç½®æ¨¡å—ä¸Šä¼ åœ°å€</span></span><br><span class="line">			environment.setSersorAddress(lineData[<span class="number">3</span>]);</span><br><span class="line">			<span class="comment">// è®¾ç½®ä¼ æ„Ÿå™¨ä¸ªæ•°</span></span><br><span class="line">			environment.setCount(Integer.parseInt(lineData[<span class="number">4</span>]));</span><br><span class="line">			<span class="comment">// è®¾ç½®å‘é€æŒ‡ä»¤</span></span><br><span class="line">			environment.setCmd(lineData[<span class="number">5</span>]);</span><br><span class="line">			<span class="comment">// è®¾ç½®çŠ¶æ€</span></span><br><span class="line">			environment.setStatus(Integer.parseInt(lineData[<span class="number">7</span>]));</span><br><span class="line">			<span class="comment">// è®¾ç½®é‡‡é›†æ—¶é—´</span></span><br><span class="line">			environment.setGather_date(<span class="keyword">new</span> Timestamp(Long.parseLong(lineData[<span class="number">8</span>])));</span><br><span class="line">			<span class="comment">// è®¾ç½®ç¯å¢ƒç§ç±»</span></span><br><span class="line">			<span class="keyword">switch</span> (environment.getSersorAddress()) &#123;</span><br><span class="line">			<span class="comment">// 5d606f7802</span></span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;16&quot;</span>:</span><br><span class="line">				environment.setName(<span class="string">&quot;æ¸©åº¦&quot;</span>);<span class="comment">// ä¹Ÿæœ‰å¯èƒ½æ˜¯æ¹¿åº¦</span></span><br><span class="line">				<span class="keyword">int</span> wendu = Integer.parseInt(lineData[<span class="number">6</span>].substring(<span class="number">0</span>, <span class="number">4</span>), <span class="number">16</span>);<span class="comment">// æ¸©åº¦æ•°æ®</span></span><br><span class="line">				environment.setData((wendu * (<span class="number">0.00268127F</span>)) - <span class="number">46.85F</span>);</span><br><span class="line">				Environment copy = CopyUtil.copy(environment);</span><br><span class="line">				copy.setName(<span class="string">&quot;æ¹¿åº¦&quot;</span>);</span><br><span class="line">				<span class="keyword">int</span> shidu = Integer.parseInt(lineData[<span class="number">6</span>].substring(<span class="number">4</span>, <span class="number">8</span>), <span class="number">16</span>);<span class="comment">// æ¹¿åº¦æ•°æ®</span></span><br><span class="line">				enColl.add(copy);</span><br><span class="line">				<span class="comment">// å¤åˆ¶å¯¹è±¡</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;256&quot;</span>:</span><br><span class="line">				environment.setName(<span class="string">&quot;å…‰ç…§å¼ºåº¦&quot;</span>);</span><br><span class="line">				environment.setData(Integer.parseInt(lineData[<span class="number">6</span>].substring(<span class="number">0</span>, <span class="number">4</span>), <span class="number">16</span>));</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;1280&quot;</span>:</span><br><span class="line">				environment.setName(<span class="string">&quot;äºŒæ°§åŒ–ç¢³&quot;</span>);</span><br><span class="line">				environment.setData(Integer.parseInt(lineData[<span class="number">6</span>].substring(<span class="number">0</span>, <span class="number">4</span>), <span class="number">16</span>));</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			enColl.add(environment);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> enColl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		Collection&lt;Environment&gt; enColl = <span class="keyword">new</span> GatherImpl().gather();</span><br><span class="line">        <span class="comment">// 106866æ¡æ•°æ®</span></span><br><span class="line">		System.out.println(enColl.size());</span><br><span class="line"><span class="comment">//		enColl.forEach(en-&gt;&#123;</span></span><br><span class="line"><span class="comment">//			System.out.println(en);</span></span><br><span class="line"><span class="comment">//		&#125;);</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="CopyUtil"><a href="#CopyUtil" class="headerlink" title="CopyUtil"></a>CopyUtil</h3><p><code>è¯¥æ–¹æ³•ç”¨ä»¥å¤åˆ¶å¯¹è±¡å’Œå±æ€§</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Modifier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CopyUtil</span> </span>&#123;</span><br><span class="line">	<span class="comment">// å¤åˆ¶å¯¹è±¡</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">copy</span><span class="params">(T t)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// åˆ›å»ºæ–°å¯¹è±¡ä»¥åŠå±æ€§</span></span><br><span class="line">		<span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">		Class&lt;T&gt; c = (Class&lt;T&gt;) t.getClass();</span><br><span class="line">		T copy = c.newInstance();</span><br><span class="line">		<span class="comment">// å°†åŸå¯¹è±¡çš„å±æ€§å¤åˆ¶ç»™æ–°å±æ€§</span></span><br><span class="line">		<span class="comment">// æ‰€æœ‰çš„å±æ€§å</span></span><br><span class="line">		Field[] fields = c.getDeclaredFields();</span><br><span class="line">		<span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">			<span class="comment">// finalä¿®é¥°çš„å€¼è¿‡æ»¤</span></span><br><span class="line">			<span class="keyword">if</span> (Modifier.isFinal(field.getModifiers())) &#123;</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">			<span class="comment">// è·å–å€¼</span></span><br><span class="line">			field.set(copy, field.get(t));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> copy;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="å‘é€æ•°æ®"><a href="#å‘é€æ•°æ®" class="headerlink" title="å‘é€æ•°æ®"></a>å‘é€æ•°æ®</h2><p><code>åˆ†æ</code></p>
<ul>
<li>ç½‘ç»œå¥—æ¥å­—</li>
<li>å¯¹è±¡æµ</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.entity.Environment;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * ç½‘ç»œå¥—æ¥å­— - å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment"> * 	 å°†é‡‡é›†åˆ°çš„æ•°æ®å‘é€ç»™æœåŠ¡ç«¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientImpl</span> <span class="keyword">implements</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String address = <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> port = <span class="number">8888</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(Collection&lt;Environment&gt; c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		Socket socket = <span class="keyword">new</span> Socket(address, port);</span><br><span class="line">		OutputStream out = socket.getOutputStream();</span><br><span class="line">		ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(out);</span><br><span class="line">		oos.writeObject(c);</span><br><span class="line">		oos.flush();</span><br><span class="line">		System.out.println(<span class="string">&quot;å®¢æˆ·ç«¯å‘é€æ•°æ®å®Œæˆ&quot;</span>);</span><br><span class="line">		oos.close();</span><br><span class="line">		socket.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="3-æœåŠ¡ç«¯"><a href="#3-æœåŠ¡ç«¯" class="headerlink" title="3 æœåŠ¡ç«¯"></a>3 æœåŠ¡ç«¯</h1><h2 id="æ¥æ”¶æ•°æ®"><a href="#æ¥æ”¶æ•°æ®" class="headerlink" title="æ¥æ”¶æ•°æ®"></a>æ¥æ”¶æ•°æ®</h2><p><code>åˆ†æ</code></p>
<ul>
<li>ç½‘ç»œå¥—æ¥å­—</li>
<li>å¯¹è±¡æµ</li>
</ul>
<h3 id="ServerImpl"><a href="#ServerImpl" class="headerlink" title="ServerImpl"></a>ServerImpl</h3><blockquote>
<p>:tipping_hand_man: volatileå…³é”®å­—çš„å«ä¹‰</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.entity.Environment;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerImpl</span> <span class="keyword">implements</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">	<span class="comment">// æ¥æ”¶æœåŠ¡å™¨ç«¯å£</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> receivePort = <span class="number">8888</span>;</span><br><span class="line">	<span class="comment">// å…³é—­æœåŠ¡å™¨æ¥å£</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> shutdownPort = <span class="number">9999</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> flag;</span><br><span class="line"></span><br><span class="line">	ServerSocket serverSocket = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ¥æ”¶æœåŠ¡å™¨çš„æ¥æ”¶æ–¹æ³•</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reciver</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		serverSocket = <span class="keyword">new</span> ServerSocket(receivePort);</span><br><span class="line">		Socket socket = <span class="keyword">null</span>;</span><br><span class="line">		ObjectInputStream ois = <span class="keyword">null</span>;</span><br><span class="line">		startShutdown();</span><br><span class="line">		<span class="keyword">while</span> (!flag) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				socket = serverSocket.accept();</span><br><span class="line">				InputStream in = socket.getInputStream();</span><br><span class="line">				ois = <span class="keyword">new</span> ObjectInputStream(in);</span><br><span class="line">				Collection&lt;Environment&gt; enColl = (Collection&lt;Environment&gt;) ois.readObject();</span><br><span class="line">				System.out.println(<span class="string">&quot;æ¥æ”¶åˆ°äº†æ•°æ®: &quot;</span> + enColl.size());</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> (ois != <span class="keyword">null</span>) &#123;</span><br><span class="line">					ois.close();</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (socket != <span class="keyword">null</span>) &#123;</span><br><span class="line">					socket.close();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startShutdown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">			Socket socket = <span class="keyword">null</span>;</span><br><span class="line">			ServerSocket serverSocket = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				serverSocket = <span class="keyword">new</span> ServerSocket(shutdownPort);</span><br><span class="line">				Socket socker = serverSocket.accept();</span><br><span class="line">				<span class="comment">// å…³é—­æœåŠ¡å™¨</span></span><br><span class="line">				ServerImpl.<span class="keyword">this</span>.shutdown();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> (serverSocket != <span class="keyword">null</span>) &#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						serverSocket.close();</span><br><span class="line">					&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;).start();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç”¨äºå…³é—­æ¥æ”¶æœåŠ¡å™¨çš„ æ–¹æ³•</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.flag = <span class="keyword">true</span>;</span><br><span class="line">		<span class="comment">// æ³¨æ„éœ€è¦æ‰‹åŠ¨å…³é—­æ¥æ”¶æœåŠ¡å™¨</span></span><br><span class="line">		serverSocket.close();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>æµ‹è¯•</code></p>
<p><strong>å‘é€æœåŠ¡ç«¯å’Œå…³é—­æœåŠ¡ç«¯</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210926210623479.png" alt="image-20210926210623479"></p>
<p><strong>å‘é€å®¢æˆ·ç«¯</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210926210459984.png" alt="image-20210926210459984"></p>
<p><strong>å…³é—­å®¢æˆ·ç«¯</strong></p>
<p><img src="image/image-20210926210650194.png" alt="image-20210926210650194"></p>
<p><strong>ç»“æœ</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210926205351670.png" alt="image-20210926205351670"></p>
<p><code>ä»£ç è§£æ</code></p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210926210400284.png" alt="image-20210926210400284"></p>
<p><code>volatileå…³é”®å­—å¯ä»¥ä¿è¯çº¿ç¨‹çš„å¯è§æ€§</code></p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/2897315-c8bfc26b7dab8341.jpg"></p>
<h2 id="æ•°æ®å…¥åº“"><a href="#æ•°æ®å…¥åº“" class="headerlink" title="æ•°æ®å…¥åº“"></a>æ•°æ®å…¥åº“</h2><blockquote>
<p>æ¯ä¸ªEnvironmentå¯¹è±¡æœ‰æ—¥æœŸå±æ€§,ä»£è¡¨è¯¥æ•°æ®æ˜¯æŸä¸ªæ—¶é—´ç‚¹é‡‡é›†çš„,å°†æ¯ä¸ªå¯¹è±¡æŒ‰ç…§æ—¥æœŸ(ä¸»è¦æ˜¯å¤©)æ’å…¥åˆ°å¯¹åº”çš„è¡¨ä¸­(31å¼ è¡¨å¯¹åº”31å¤©)</p>
</blockquote>
<ul>
<li>éå†<code>List&lt;Environment&gt;</code>é›†åˆ</li>
<li>è·å–æ¯ä¸ªå¯¹è±¡çš„é‡‡é›†æ—¥æœŸ(æ—¶é—´æˆ³),æˆªå–å¤©æ•°</li>
<li>å°†æ¯ä¸ªå¯¹è±¡(æ¯æ¡æ•°æ®)æŒ‰ç…§æ—¥æœŸ æ’å…¥åˆ°å¯¹åº”çš„è¡¨ä¸­(table_(1-31))<ul>
<li>String sql = â€œinsert into table() values(?,?,?â€¦)â€;</li>
<li>conn.preparedStatement(sql);</li>
<li>psè®¾ç½®å‚æ•°</li>
<li>ps.executeUpdate();</li>
</ul>
</li>
<li>:tipping_hand_man: ä½¿ç”¨æ‰‹åŠ¨æäº¤+ps+æ‰¹å¤„ç†æå‡æ’å…¥æ•ˆç‡<ul>
<li>==æ³¨æ„: å¦‚æœæ’å…¥çš„ç¬¬äºŒæ¡æ•°æ®å’Œç¬¬ä¸€æ¡æ•°æ®æ˜¯åŒä¸€å¤©,æ­£å¸¸æ“ä½œ,å¦åˆ™,æ–°çš„å¤©æ•°,sqlå˜åŠ¨,åŒæ„è¯­å¥å¤±æ•ˆ.éœ€è¦é‡æ–°æ„å»º==</li>
</ul>
</li>
</ul>
<blockquote>
<p>:tipping_hand_man: å¦‚æœæœ¬åœ°ä»“åº“æ²¡æœ‰ojdbc8é©±åŠ¨,ä½¿ç”¨è¿œç¨‹ä»“åº“</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.oracle.ojdbc/ojdbc8 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.oracle.ojdbc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ojdbc8<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>19.3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å®‰è£…jaråŒ…åˆ°æœ¬åœ°ä»“åº“å‘½ä»¤</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mvn install:install-file -DgroupId=com.oracle -DartifactId=ojdbc8 -Dversion=8 -Dpackaging=jar -Dfile=ojdbc8.jar -DgeneratePom=true</span><br></pre></td></tr></table></figure>

<blockquote>
<p>:tipping_hand_man: å¦‚æœä¸æ˜¯åŒä¸€ä¸ªpså¯¹è±¡,æ‰¹å¤„ç†ä¼šå¤±æ•ˆ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.entity.Environment;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.util.JdbcUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBStoreImpl</span> <span class="keyword">implements</span> <span class="title">DBStore</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> lastDate = -<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> batchSize = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">private</span> Set&lt;Integer&gt; days = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">	<span class="keyword">private</span> Connection conn = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">private</span> PreparedStatement ps;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@SuppressWarnings(&quot;deprecation&quot;)</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveDB</span><span class="params">(Collection&lt;Environment&gt; c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;å¼€å§‹å…¥åº“&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			conn = JdbcUtil.getConnection();</span><br><span class="line">			conn.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">			<span class="keyword">for</span> (Environment env : c) &#123;</span><br><span class="line">				<span class="keyword">int</span> date = env.getGather_date().getDate();</span><br><span class="line">				days.add(date);</span><br><span class="line">				String sql = <span class="keyword">null</span>;</span><br><span class="line">				<span class="keyword">if</span>(lastDate == -<span class="number">1</span>) &#123;</span><br><span class="line">					sql = <span class="string">&quot;insert into e_detail_&quot;</span> + date</span><br><span class="line">							+ <span class="string">&quot;(name,srcId,desId,devId,sersorAddress,count,cmd,status,data,gather_date) values(?,?,?,?,?,?,?,?,?,?)&quot;</span>;</span><br><span class="line">					ps = conn.prepareStatement(sql);</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					<span class="comment">// ä¸æ˜¯åŒä¸€å¤©</span></span><br><span class="line">					<span class="keyword">if</span>(lastDate != date) &#123;</span><br><span class="line">						<span class="comment">// æ‰§è¡Œä¸Šä¸ªæ‰¹å¤„ç†çš„æ•°æ®</span></span><br><span class="line">						ps.executeBatch();</span><br><span class="line">						batchSize = <span class="number">0</span>;</span><br><span class="line">						ps.close(); <span class="comment">// å…³é—­ä¸Šä¸€æ¬¡çš„ps</span></span><br><span class="line">						sql = <span class="string">&quot;insert into e_detail_&quot;</span> + date</span><br><span class="line">								+ <span class="string">&quot;(name,srcId,desId,devId,sersorAddress,count,cmd,status,data,gather_date) values(?,?,?,?,?,?,?,?,?,?)&quot;</span>;</span><br><span class="line">						ps = conn.prepareStatement(sql);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line"></span><br><span class="line">				<span class="comment">// å¡«å……å‚æ•°</span></span><br><span class="line">				ps.setString(<span class="number">1</span>, env.getName());</span><br><span class="line">				ps.setString(<span class="number">2</span>, env.getSrcId());</span><br><span class="line">				ps.setString(<span class="number">3</span>, env.getDesId());</span><br><span class="line">				ps.setString(<span class="number">4</span>, env.getDevId());</span><br><span class="line">				ps.setString(<span class="number">5</span>, env.getSersorAddress());</span><br><span class="line">				ps.setInt(<span class="number">6</span>, env.getCount());</span><br><span class="line">				ps.setString(<span class="number">7</span>, env.getCmd());</span><br><span class="line">				ps.setInt(<span class="number">8</span>, env.getStatus());</span><br><span class="line">				ps.setFloat(<span class="number">9</span>, env.getData());</span><br><span class="line">				ps.setTimestamp(<span class="number">10</span>, env.getGather_date());</span><br><span class="line">				<span class="comment">// æ·»åŠ æ‰¹å¤„ç†</span></span><br><span class="line">				ps.addBatch();</span><br><span class="line">				batchSize++;</span><br><span class="line">				<span class="keyword">if</span> (batchSize == <span class="number">200</span>) &#123;</span><br><span class="line">					ps.executeBatch();</span><br><span class="line">					<span class="comment">// æ‰¹å¤„ç†å®Œå é‡æ–°è®¡æ•°</span></span><br><span class="line">					batchSize = <span class="number">0</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				lastDate = date;</span><br><span class="line">			&#125;</span><br><span class="line">			ps.executeBatch();</span><br><span class="line">			conn.commit();</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			conn.rollback();</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			JdbcUtil.close(ps, conn);</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">&quot;åˆ†å¸ƒ: &quot;</span> + days);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>









<h1 id="4-å¤‡ä»½"><a href="#4-å¤‡ä»½" class="headerlink" title="4 å¤‡ä»½"></a>4 å¤‡ä»½</h1><p><code>åœºæ™¯</code></p>
<ul>
<li>ç¬¬ä¸€æ¬¡é‡‡é›†å®Œæ•°æ®(simple.file)</li>
<li>æ­¤æ—¶å‡è®¾è¯¥æ–‡ä»¶æ–°æ·»äº†10è¡Œæ•°æ®(æ‰‹åŠ¨æ·»åŠ ,æ¨¡æ‹Ÿç¡¬ä»¶æ—¶åˆ»é‡‡é›†)</li>
<li>æ­¤æ—¶å†æ¬¡é‡‡é›†æ–°æ•°æ®,åº”è¯¥åªé‡‡é›†æ–°æ·»åŠ çš„æ•°æ®,ä¸ä¼šé‡æ–°ä»è¯¥æ–‡ä»¶çš„ç¬¬ä¸€è¡Œå¼€å§‹é‡æ–°è§£æ</li>
</ul>
<p><code>åˆ†æ</code></p>
<ul>
<li>å®ç°<code>backup/load</code>æ–¹æ³•<ul>
<li>é‡‡é›†æ–‡ä»¶æ—¶,å…ˆçœ‹æ˜¯å¦æœ‰å¤‡ä»½,æœ‰çš„è¯,è·³è¿‡å·²é‡‡é›†çš„å­—èŠ‚é•¿åº¦</li>
</ul>
</li>
<li>å®ç°<code>backup/store</code>æ–¹æ³•<ul>
<li>æ¯æ¬¡é‡‡é›†å®Œæ•°æ®,è®°å½•å½“æ—¶é‡‡é›†çš„å­—èŠ‚é•¿åº¦,ä¿å­˜åœ¨backup.fileä¸­</li>
</ul>
</li>
</ul>
<p><code>å¤‡ä»½å®ç°</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BackupImpl</span> <span class="keyword">implements</span> <span class="title">Backup</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String basePath = <span class="string">&quot;src/main/resources/bak&quot;</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">load</span><span class="params">(String fileName, <span class="keyword">boolean</span> del)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		</span><br><span class="line">		ObjectInputStream in = <span class="keyword">null</span>;</span><br><span class="line">		Object obj = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			String filePath = basePath + <span class="string">&quot;/&quot;</span> +fileName;</span><br><span class="line">			File file = <span class="keyword">new</span> File(filePath);</span><br><span class="line">			<span class="comment">// å¦‚æœå¤‡ä»½æ–‡ä»¶ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å›null</span></span><br><span class="line">			<span class="keyword">if</span>(!file.exists()) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			in = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(file));</span><br><span class="line">			</span><br><span class="line">			obj = in.readObject();</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(del) &#123;</span><br><span class="line">				file.deleteOnExit();</span><br><span class="line"><span class="comment">//				System.out.println(&quot;å¤‡ä»½æ–‡ä»¶å·²åˆ é™¤ï¼š&quot;+file.delete());</span></span><br><span class="line">			&#125;</span><br><span class="line">					</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(in!=<span class="keyword">null</span>) &#123;</span><br><span class="line">				in.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> obj;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">store</span><span class="params">(String fileName, Object obj, <span class="keyword">boolean</span> append)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		ObjectOutputStream out = <span class="keyword">null</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			String filePath = basePath+<span class="string">&quot;/&quot;</span>+fileName;</span><br><span class="line">			File file = <span class="keyword">new</span> File(filePath);</span><br><span class="line">			<span class="comment">// åˆ¤æ–­æ–‡ä»¶æ‰€åœ¨ç›®å½•æ˜¯å¦å­˜åœ¨,å¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»º</span></span><br><span class="line">			<span class="keyword">if</span>(!file.getParentFile().exists()) &#123;</span><br><span class="line">				file.getParentFile().mkdirs();</span><br><span class="line">			&#125;</span><br><span class="line">			out = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(file,append));</span><br><span class="line">			out.writeObject(obj);</span><br><span class="line">			out.flush();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(out!=<span class="keyword">null</span>) &#123;</span><br><span class="line">				out.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>æ”¹é€ é‡‡é›†æ¨¡å—</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.sql.Timestamp;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.entity.Environment;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.util.Backup;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.util.BackupImpl;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.util.CopyUtil;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * é‡‡é›†æ•°æ®</span></span><br><span class="line"><span class="comment"> * 	å°†100|101|2|16|1|3|5f6c6ba002|1|1516323990934 å°è£…æˆ Environmentå¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatherImpl</span> <span class="keyword">implements</span> <span class="title">Gather</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Backup backup = <span class="keyword">new</span> BackupImpl();</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Collection&lt;Environment&gt; <span class="title">gather</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		File file = <span class="keyword">new</span> File(<span class="string">&quot;data-file&quot;</span>);</span><br><span class="line">		<span class="comment">//InputStream in = GatherImpl.class.getClassLoader().getResourceAsStream(&quot;data-file&quot;);</span></span><br><span class="line">		BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(file));</span><br><span class="line">		</span><br><span class="line">		Long len = (Long)backup.load(<span class="string">&quot;gather-file-length&quot;</span>, Backup.LOAD_UNREMOVE);</span><br><span class="line">		<span class="keyword">if</span>(len!=<span class="keyword">null</span>) &#123;</span><br><span class="line">			br.skip(len);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">long</span> fileLength = file.length();</span><br><span class="line">		backup.store(<span class="string">&quot;gather-file-length&quot;</span>, fileLength, Backup.STORE_OVERRIDE);</span><br><span class="line">			</span><br><span class="line">		Collection&lt;Environment&gt; enColl = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">		<span class="comment">// 1.è¯»å–æ•°æ®</span></span><br><span class="line">		String line = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">while</span> ((line = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">			String[] lineData = line.split(<span class="string">&quot;[|]&quot;</span>);</span><br><span class="line">			<span class="keyword">if</span>(lineData.length != <span class="number">9</span>) &#123;</span><br><span class="line">				<span class="comment">// TODO è®°å½•å½“å‰æ ¼å¼æœ‰é—®é¢˜çš„æ•°æ®</span></span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			Environment environment = <span class="keyword">new</span> Environment();</span><br><span class="line">			<span class="comment">// è®¾ç½®å‘é€ç«¯id</span></span><br><span class="line">			environment.setSrcId(lineData[<span class="number">0</span>]);</span><br><span class="line">			<span class="comment">// è®¾ç½®æ ‘è“æ´¾ç³»ç»Ÿid</span></span><br><span class="line">			environment.setDesId(lineData[<span class="number">1</span>]);</span><br><span class="line">			<span class="comment">// è®¾ç½®å®éªŒç®±åŒºåŸŸid</span></span><br><span class="line">			environment.setDevId(lineData[<span class="number">2</span>]);</span><br><span class="line">			<span class="comment">// è®¾ç½®æ¨¡å—ä¸Šä¼ åœ°å€</span></span><br><span class="line">			environment.setSersorAddress(lineData[<span class="number">3</span>]);</span><br><span class="line">			<span class="comment">// è®¾ç½®ä¼ æ„Ÿå™¨ä¸ªæ•°</span></span><br><span class="line">			environment.setCount(Integer.parseInt(lineData[<span class="number">4</span>]));</span><br><span class="line">			<span class="comment">// è®¾ç½®å‘é€æŒ‡ä»¤</span></span><br><span class="line">			environment.setCmd(lineData[<span class="number">5</span>]);</span><br><span class="line">			<span class="comment">// è®¾ç½®çŠ¶æ€</span></span><br><span class="line">			environment.setStatus(Integer.parseInt(lineData[<span class="number">7</span>]));</span><br><span class="line">			<span class="comment">// è®¾ç½®é‡‡é›†æ—¶é—´</span></span><br><span class="line">			environment.setGather_date(<span class="keyword">new</span> Timestamp(Long.parseLong(lineData[<span class="number">8</span>])));</span><br><span class="line">			<span class="comment">// è®¾ç½®ç¯å¢ƒç§ç±»</span></span><br><span class="line">			<span class="keyword">switch</span> (environment.getSersorAddress()) &#123;</span><br><span class="line">			<span class="comment">// 5d606f7802</span></span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;16&quot;</span>:</span><br><span class="line">				environment.setName(<span class="string">&quot;æ¸©åº¦&quot;</span>);<span class="comment">// ä¹Ÿæœ‰å¯èƒ½æ˜¯æ¹¿åº¦</span></span><br><span class="line">				<span class="keyword">int</span> wendu = Integer.parseInt(lineData[<span class="number">6</span>].substring(<span class="number">0</span>, <span class="number">4</span>), <span class="number">16</span>);<span class="comment">// æ¸©åº¦æ•°æ®</span></span><br><span class="line">				environment.setData((wendu * (<span class="number">0.00268127F</span>)) - <span class="number">46.85F</span>);</span><br><span class="line">				Environment copy = CopyUtil.copy(environment);</span><br><span class="line">				copy.setName(<span class="string">&quot;æ¹¿åº¦&quot;</span>);</span><br><span class="line">				<span class="keyword">int</span> shidu = Integer.parseInt(lineData[<span class="number">6</span>].substring(<span class="number">4</span>, <span class="number">8</span>), <span class="number">16</span>);<span class="comment">// æ¹¿åº¦æ•°æ®</span></span><br><span class="line">				enColl.add(copy);</span><br><span class="line">				<span class="comment">// å¤åˆ¶å¯¹è±¡</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;256&quot;</span>:</span><br><span class="line">				environment.setName(<span class="string">&quot;å…‰ç…§å¼ºåº¦&quot;</span>);</span><br><span class="line">				environment.setData(Integer.parseInt(lineData[<span class="number">6</span>].substring(<span class="number">0</span>, <span class="number">4</span>), <span class="number">16</span>));</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;1280&quot;</span>:</span><br><span class="line">				environment.setName(<span class="string">&quot;äºŒæ°§åŒ–ç¢³&quot;</span>);</span><br><span class="line">				environment.setData(Integer.parseInt(lineData[<span class="number">6</span>].substring(<span class="number">0</span>, <span class="number">4</span>), <span class="number">16</span>));</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			enColl.add(environment);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> enColl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		Collection&lt;Environment&gt; enColl = <span class="keyword">new</span> GatherImpl().gather();</span><br><span class="line">		System.out.println(enColl.size());</span><br><span class="line"><span class="comment">//		enColl.forEach(en-&gt;&#123;</span></span><br><span class="line"><span class="comment">//			System.out.println(en);</span></span><br><span class="line"><span class="comment">//		&#125;);</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="5-æ—¥å¿—"><a href="#5-æ—¥å¿—" class="headerlink" title="5 æ—¥å¿—"></a>5 æ—¥å¿—</h1><p><code>åœºæ™¯</code></p>
<blockquote>
<p>æµ‹è¯•çš„æ—¶å€™ç»å¸¸ä½¿ç”¨System.out.println() æŸ¥çœ‹æƒ…å†µ</p>
</blockquote>
<p><strong>å¼Šç«¯</strong></p>
<ul>
<li>å°†æ¥é¡¹ç›®ä¸Šçº¿<code>System.out.println</code>ç­‰å†—ä½™ä»£ç éœ€è¦åˆ é™¤</li>
<li>æ­¤æ—¶è¯¥ä»£ç åˆ†å¸ƒåœ¨å„åœ°,ä¸æ˜“ç»Ÿä¸€åˆ é™¤ç®¡ç†</li>
<li>æ¯è¾“å‡ºä¸€æ¡è¯­å¥,éƒ½ä¼šå ç”¨æ€§èƒ½</li>
</ul>
<p><code>è§£å†³</code></p>
<p>ä½¿ç”¨æ—¥å¿—,æœ¬å¤„å¼•å…¥<code>Log4j</code>,è¯¦æƒ…æŸ¥çœ‹å·²å‘å¸ƒèµ„æ–™</p>
<ul>
<li>å¯¼å…¥Log4j.jar</li>
<li>ä½¿ç”¨é…ç½®æ–‡ä»¶ç»Ÿä¸€ç®¡ç†æ—¥å¿—  Log4j.properties</li>
<li>ä½¿ç”¨log.info()/log.debug()/log.warning()ç­‰æ–¹æ³•æ›¿æ¢<code>System.out.println</code></li>
</ul>
<p><code>log4j.properties</code></p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># OFF FATAL ERROR WARN INFO DEBUG TRACE ALL</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG,contrl,file</span></span><br><span class="line"></span><br><span class="line"><span class="meta">log4j.appender.contrl</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.contrl.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.contrl.layout.ConversionPattern</span>=<span class="string">%d %5p [%t] (%F:%L) - %m%n</span></span><br><span class="line"></span><br><span class="line"><span class="meta">log4j.appender.file</span>=<span class="string">org.apache.log4j.FileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.file.File</span>=<span class="string">D:/env/log/log.txt</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout.ConversionPattern</span>=<span class="string">%d %5p [%t] (%F:%L) - %m%n</span></span><br></pre></td></tr></table></figure>



<p><code>æ—¥å¿—åŒ…è£…</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogImpl</span> <span class="keyword">implements</span> <span class="title">Log</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Logger LOGGER = Logger.getRootLogger();</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">debug</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">		LOGGER.debug(message);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">info</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">		LOGGER.info(message);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">warn</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">		LOGGER.warn(message);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">error</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">		LOGGER.error(message);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fatal</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">		LOGGER.fatal(message);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><code>æ—¥å¿—ä½¿ç”¨ GatherImpl</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> Log log = <span class="keyword">new</span> LogImpl();</span><br><span class="line"></span><br><span class="line">socket = <span class="keyword">new</span> Socket(serverIp, serverPort);</span><br><span class="line">log.info(<span class="string">&quot;å®¢æˆ·ç«¯æ¨¡å— è¿æ¥æœåŠ¡å™¨æˆåŠŸï¼Œip=&quot;</span>+serverIp+<span class="string">&quot;ï¼Œport=&quot;</span>+serverPort);</span><br><span class="line"></span><br><span class="line">out = <span class="keyword">new</span> ObjectOutputStream(socket.getOutputStream());</span><br><span class="line"></span><br><span class="line">out.writeObject(c);</span><br><span class="line"></span><br><span class="line">out.flush();</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&quot;å®¢æˆ·ç«¯æ¨¡å— å‘é€æ•°æ®æˆåŠŸï¼Œå…±å‘é€&quot;</span>+c.size()+<span class="string">&quot;æ¡æ•°æ®&quot;</span>);</span><br></pre></td></tr></table></figure>





<h1 id="6-é…ç½®"><a href="#6-é…ç½®" class="headerlink" title="6 é…ç½®"></a>6 é…ç½®</h1><p>==éœ€è¦å®ç°çš„æ¥å£==</p>
<ul>
<li>Configuration.java é…ç½®æ¨¡å—</li>
<li>ConfigurationAware.java é…ç½®æ³¨å…¥</li>
<li>PropertiesAware.java å±æ€§æ³¨å…¥</li>
</ul>
<p><code>åœºæ™¯</code></p>
<p>ä¾‹å¦‚é‡‡é›†æ¨¡å—</p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210927140800703.png" alt="image-20210927140800703"></p>
<p>è¯¥æ¨¡å—å¼•å…¥äº†å¤‡ä»½æ¨¡å— backupå’Œå±æ€§filePath</p>
<p><code>å¼Šç«¯</code></p>
<p>å¦‚æœæŸç±»éœ€è¦ä¾èµ–å…¶ä»–å¯¹è±¡æˆ–è€…å±æ€§,ä¸å»ºè®®ç¡¬ç¼–ç newå¯¹è±¡æˆ–è€…å†™æ­»å±æ€§,å¸Œæœ›æœ‰ä¸ªé…ç½®ç±»å¯ä»¥ç»Ÿä¸€ç®¡ç†</p>
<p><code>è§£å†³</code></p>
<ol>
<li><p>å°†æ¥å°†å…¶ä»–å¯¹è±¡å’Œå±æ€§ä»ç¡¬ç¼–ç ä¸­è§£è€¦,å°†å…¶é…ç½®åˆ°xmlæ–‡ä»¶ä¸­,ä¾‹å¦‚conf.xml</p>
</li>
<li><p>å°†<code>conf.xml</code>åŠ è½½åˆ°Configurationé…ç½®ç±»ä¸­(ä½œä¸ºå®¹å™¨)</p>
<ul>
<li>è¯¥å®¹å™¨åŒ…å«äº†å…¶ä»–ç±»çš„å¯¹è±¡å’Œç›¸å…³å±æ€§</li>
</ul>
</li>
<li><p>å‡å¦‚GatherImpléœ€è¦ä¾èµ–å…¶ä»–å¯¹è±¡å®ç°ConfigurationAwareæ¥å£</p>
</li>
<li><p>å‡å¦‚GatherImpléœ€è¦è·¯å¾„å±æ€§,å®ç°PropertiesAware.javaæ¥å£</p>
</li>
</ol>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210928142527653.png" alt="image-20210928142527653"></p>
<p><code>conf.xml</code> è¯¥æ–‡ä»¶é…ç½®äº†ç±»çš„è·¯å¾„å’Œç›¸å…³å±æ€§</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">environment</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">gather</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.client.GatherImpl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">data-file-path</span>&gt;</span><span class="tag">&lt;/<span class="name">data-file-path</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">gather</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">logger</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.util.LogImpl&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">backup</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.util.BackupImpl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">file-path</span>&gt;</span><span class="tag">&lt;/<span class="name">file-path</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">backup</span>&gt;</span></span><br><span class="line">	 </span><br><span class="line">	<span class="tag">&lt;<span class="name">client</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.client.ClientImpl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">host</span>&gt;</span><span class="tag">&lt;/<span class="name">host</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">port</span>&gt;</span><span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">client</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">server</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.server.ServerThreadImpl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">server-port</span>&gt;</span><span class="tag">&lt;/<span class="name">server-port</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">dbStore</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.server.DBStoreImpl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">driver</span>&gt;</span><span class="tag">&lt;/<span class="name">driver</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url</span>&gt;</span><span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dbStore</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p><code>ConfigurationImpl å®¹å™¨å®ç°</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.dom4j.Document;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.Element;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.io.SAXReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.client.Client;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.client.Gather;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.server.DBStore;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.server.Server;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.support.ConfigurationAware;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.support.PropertiesAware;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.util.Backup;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.util.Log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigurationImpl</span> <span class="keyword">implements</span> <span class="title">Configuration</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Configuration CONFIG = <span class="keyword">new</span> ConfigurationImpl();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String XML_CONFIG_PATH = <span class="string">&quot;src/main/resources/conf.xml&quot;</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// è´Ÿè´£ç®¡ç†æ¨¡å—å¯¹è±¡</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">	<span class="comment">// è´Ÿè´£ç®¡ç†æ¨¡å—ä¸­çš„å‚æ•°</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Properties p = <span class="keyword">new</span> Properties();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		<span class="comment">// è§£æxmlé…ç½®æ–‡ä»¶ï¼Œå°†å€¼å­˜æ”¾åˆ°mapå’Œpä¹‹ä¸­</span></span><br><span class="line">		parseXML(XML_CONFIG_PATH);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// åˆå§‹åŒ–æ¨¡å—å¯¹è±¡é‡Œé¢çš„å±æ€§å€¼</span></span><br><span class="line">		initModule();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">ConfigurationImpl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(CONFIG!=<span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;è¯·ä½¿ç”¨getInstanceæ–¹æ³•è·å–å¯¹è±¡&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initModule</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">for</span> (Object <span class="keyword">module</span> : map.values()) &#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="keyword">module</span> <span class="keyword">instanceof</span> PropertiesAware) &#123;</span><br><span class="line">					((PropertiesAware)<span class="keyword">module</span>).init(p);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">for</span> (Object <span class="keyword">module</span> : map.values()) &#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="keyword">module</span> <span class="keyword">instanceof</span> ConfigurationAware) &#123;</span><br><span class="line">					((ConfigurationAware)<span class="keyword">module</span>).setConfiguration(CONFIG);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">parseXML</span><span class="params">(String xmlConfigPath)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">			Document document = reader.read(<span class="keyword">new</span> File(xmlConfigPath));</span><br><span class="line">			</span><br><span class="line">			Element rootElement = document.getRootElement();</span><br><span class="line">			</span><br><span class="line">			Iterator&lt;Element&gt; it = rootElement.elementIterator();</span><br><span class="line">			<span class="keyword">while</span>(it.hasNext()) &#123;</span><br><span class="line">				Element element = it.next();</span><br><span class="line">				String elementName = element.getName();</span><br><span class="line">				String classAttrValue = element.attribute(<span class="string">&quot;class&quot;</span>).getValue();</span><br><span class="line">				<span class="comment">// æ³¨æ„éœ€è¦ä¿è¯æ¯ä¸ªæ¨¡å—ä¸­éƒ½å¿…é¡»æœ‰ä¸€ä¸ªæ— å‚æ„é€ å™¨</span></span><br><span class="line">				Object obj = Class.forName(classAttrValue).newInstance();</span><br><span class="line">				</span><br><span class="line">				map.put(elementName.toUpperCase(), obj);</span><br><span class="line">				</span><br><span class="line">				Iterator&lt;Element&gt; childElementIt = element.elementIterator();</span><br><span class="line">				<span class="keyword">while</span>(childElementIt.hasNext()) &#123;</span><br><span class="line">					Element childElement = childElementIt.next();</span><br><span class="line">					String attrName = childElement.getName();</span><br><span class="line">					String attrValue = childElement.getText();</span><br><span class="line">					p.setProperty(attrName, attrValue);</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Configuration <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> CONFIG;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Log <span class="title">getLogger</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (Log)map.get(ModuleName.LOGGER.name());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Server <span class="title">getServer</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> (Server)map.get(ModuleName.SERVER.name());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Client <span class="title">getClient</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> (Client)map.get(ModuleName.CLIENT.name());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> DBStore <span class="title">getDbStore</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> (DBStore)map.get(ModuleName.DBSTORE.name());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Gather <span class="title">getGather</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> (Gather)map.get(ModuleName.GATHER.name());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Backup <span class="title">getBackup</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (Backup)map.get(ModuleName.BACKUP.name());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="class"><span class="keyword">enum</span> <span class="title">ModuleName</span></span>&#123;</span><br><span class="line">		GATHER,LOGGER,BACKUP,CLIENT,SERVER,DBSTORE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><code>ä½¿ç”¨å®¹å™¨ç±» GatherImpl</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatherImpl</span> <span class="keyword">implements</span> <span class="title">Gather</span>,<span class="title">PropertiesAware</span>,<span class="title">ConfigurationAware</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(Properties p)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.dataFilePath = p.getProperty(<span class="string">&quot;gather-data-file-path&quot;</span>);</span><br><span class="line">		<span class="keyword">this</span>.fileLengthBak = p.getProperty(<span class="string">&quot;gather-file-length-bak&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConfiguration</span><span class="params">(Configuration config)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.backup = config.getBackup();</span><br><span class="line">		<span class="keyword">this</span>.log = config.getLogger();</span><br><span class="line">	&#125;     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="7-ä¼˜åŒ–"><a href="#7-ä¼˜åŒ–" class="headerlink" title="7 ä¼˜åŒ–"></a>7 ä¼˜åŒ–</h1><h2 id="å…³é—­æœåŠ¡æ¨¡å—"><a href="#å…³é—­æœåŠ¡æ¨¡å—" class="headerlink" title="å…³é—­æœåŠ¡æ¨¡å—"></a>å…³é—­æœåŠ¡æ¨¡å—</h2><p><code>ReceiverServerShutdown</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.shutdown;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReceiverServerShutdown</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String host = <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> port = <span class="number">9091</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Socket socket = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			socket = <span class="keyword">new</span> Socket(host, port);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(socket != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					socket.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">new</span> ReceiverServerShutdown().shutdown();  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>ServerImpl</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.entity.Environment;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerImpl</span> <span class="keyword">implements</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">	<span class="comment">// æ¥æ”¶æœåŠ¡å™¨ç«¯å£</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> receivePort = <span class="number">9090</span>;</span><br><span class="line">	<span class="comment">// å…³é—­æœåŠ¡å™¨æ¥å£</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> shutdownPort = <span class="number">9091</span>;</span><br><span class="line">	<span class="comment">// æ˜¯å¦å…³é—­æœåŠ¡å™¨å¼€å…³ (ä¿è¯å¯è§æ€§)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">	<span class="keyword">private</span> DBStore dbStrore = <span class="keyword">new</span> DBStoreImpl();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> ServerSocket receiverServerSocket = <span class="keyword">null</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> ServerSocket shutdownServer = <span class="keyword">null</span>;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * å¯åŠ¨reiveræœåŠ¡å™¨(æ¥æ”¶æœåŠ¡å™¨) ä½œç”¨:è¯¥æœåŠ¡å™¨çš„ç«¯å£9090,è´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„æ•°æ®</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reciver</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		startShutdownServer();</span><br><span class="line">		startReceiverServer();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startReceiverServer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;æ¥æ”¶æœåŠ¡å™¨å¼€å¯&quot;</span>);	</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			receiverServerSocket = <span class="keyword">new</span> ServerSocket(receivePort);</span><br><span class="line">			ObjectInputStream object = <span class="keyword">null</span>;</span><br><span class="line">			Socket socket = <span class="keyword">null</span>;</span><br><span class="line">			<span class="comment">// è™šæ‹Ÿæœºä¼šä¼˜åŒ–,å°†å †åŒºçš„å€¼æ”¾åˆ°æ ˆä¸­</span></span><br><span class="line">			<span class="comment">// å¦‚æœæ­¤æ—¶flagä¸ºfalse,é‡Œé¢ä¼šé˜»å¡</span></span><br><span class="line">			<span class="keyword">while</span> (flag) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					socket = receiverServerSocket.accept();</span><br><span class="line">					object = <span class="keyword">new</span> ObjectInputStream(socket.getInputStream());</span><br><span class="line">					<span class="comment">// æ¥æ”¶æ•°æ®</span></span><br><span class="line">					List&lt;Environment&gt; enList = (List&lt;Environment&gt;) object.readObject();</span><br><span class="line">					System.out.println(<span class="string">&quot;æœåŠ¡å™¨æ”¶é›†åˆ°äº†æ•°æ®&quot;</span> + enList.size() + <span class="string">&quot;æ¡,éœ€è¦å…¥åº“&quot;</span>);</span><br><span class="line">					dbStrore.saveDB(enList);</span><br><span class="line">					socket.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">					<span class="keyword">if</span>(socket != <span class="keyword">null</span>) &#123;</span><br><span class="line">						socket.close();</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (receiverServerSocket != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					receiverServerSocket.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * å¯åŠ¨shutdownæœåŠ¡å™¨(å…³é—­æœåŠ¡å™¨) ä½œç”¨: è´Ÿè´£æ¥æ”¶ç”¨æˆ·å‘é€çš„æ¶ˆæ¯,å¯ä»¥å…³é—­æ‰€æœ‰æœåŠ¡å™¨(reciverå’Œhsutdown)</span></span><br><span class="line"><span class="comment">	 * æ­¤å¤„,å¦‚æœå…³é—­çº¿ç¨‹é˜»å¡,æ¥æ”¶æœåŠ¡å™¨ä¸ä¼šæ‰§è¡Œ,éœ€è¦å¤šçº¿ç¨‹</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startShutdownServer</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;å…³é—­æœåŠ¡å™¨å¼€å¯&quot;</span>);</span><br><span class="line">		<span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				shutdownServer = <span class="keyword">new</span> ServerSocket(shutdownPort);</span><br><span class="line">				shutdownServer.accept();</span><br><span class="line">				<span class="comment">// å…³é—­æœåŠ¡å™¨ æ­¤æ—¶thisæŒ‡å‘åŒ¿åå†…éƒ¨ç±»,éœ€è¦åŠ å¤–éƒ¨ç±»</span></span><br><span class="line">				ServerImpl.<span class="keyword">this</span>.shutdown();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>(shutdownServer != <span class="keyword">null</span>) &#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						shutdownServer.close();</span><br><span class="line">					&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">						<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;).start();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// å°†æ¥æ”¶æœåŠ¡å™¨çš„whileæ¡ä»¶æ”¹ä¸ºfalse</span></span><br><span class="line">			<span class="comment">// æ­¤å¤„ä¸¤ä¸ªçº¿ç¨‹æ“ä½œä¸€ä¸ªå˜é‡ </span></span><br><span class="line">		<span class="keyword">this</span>.flag = <span class="keyword">false</span>;</span><br><span class="line">		<span class="comment">// æ‰‹åŠ¨å…³é—­æ¥æ”¶çº¿ç¨‹æœåŠ¡å™¨</span></span><br><span class="line">		<span class="keyword">if</span>(receiverServerSocket != <span class="keyword">null</span>) &#123;</span><br><span class="line">			receiverServerSocket.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± " class="headerlink" title="çº¿ç¨‹æ± "></a>çº¿ç¨‹æ± </h2><h3 id="overview"><a href="#overview" class="headerlink" title="overview"></a>overview</h3><p>å¦‚æœå¹¶å‘çš„çº¿ç¨‹æ•°é‡å¾ˆå¤šï¼Œå¹¶ä¸”æ¯ä¸ªçº¿ç¨‹éƒ½æ˜¯æ‰§è¡Œä¸€ä¸ªæ—¶é—´å¾ˆçŸ­çš„ä»»åŠ¡å°±ç»“æŸäº†ï¼Œè¿™æ ·é¢‘ç¹åˆ›å»ºçº¿ç¨‹å°±ä¼šå¤§å¤§é™ä½ç³»ç»Ÿçš„æ•ˆç‡ï¼Œå› ä¸ºé¢‘ç¹åˆ›å»ºçº¿ç¨‹å’Œé”€æ¯çº¿ç¨‹éœ€è¦æ—¶é—´ã€‚</p>
<p>é‚£ä¹ˆå¦‚æœæœ‰ä¸€ç§åŠæ³•ä½¿å¾—çº¿ç¨‹å¯ä»¥å¤ç”¨ï¼Œå°±æ˜¯æ‰§è¡Œå®Œä¸€ä¸ªä»»åŠ¡åï¼Œå¹¶ä¸è¢«é”€æ¯ï¼Œè€Œæ˜¯å¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–çš„ä»»åŠ¡çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¤§å¤§æé«˜å…¶è¿è¡Œçš„æ•ˆç‡ã€‚</p>
<p>åœ¨Javaä¸­å¯ä»¥é€šè¿‡çº¿ç¨‹æ± æ¥è¾¾åˆ°è¿™æ ·çš„æ•ˆæœã€‚</p>
<h3 id="concurrent-å¹¶å‘"><a href="#concurrent-å¹¶å‘" class="headerlink" title="concurrent(å¹¶å‘)"></a>concurrent(å¹¶å‘)</h3><ul>
<li>ArrayList  synchoroinzed</li>
<li>LinkedList   Collections</li>
<li>concurrentä¸‹çš„ç±»</li>
</ul>
<blockquote>
<p>concurrentï¼Œå•è¯æœ¬èº«æ˜¯â€œå¹¶å‘â€çš„æ„æ€</p>
</blockquote>
<p><code>java.util.concurrent</code> ï¼Œæ˜¯JDKä¸­æä¾›çš„ä¸€ä¸ªä¸“é—¨å¤„ç†å¹¶å‘çš„åŒ…ï¼Œé‡Œé¢æœ‰ä¸€äº›ç›¸å…³çš„æ¥å£å’Œç±»ï¼Œå¯ä»¥åœ¨å¤„ç†çº¿ç¨‹å¹¶å‘è®¿é—®çš„æ—¶å€™ä½¿ç”¨ã€‚</p>
<p><code>java.util.concurrent.Executor</code> </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> java.util.concurrent;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * An object that executes submitted &#123;<span class="doctag">@link</span> Runnable&#125; tasks. This</span></span><br><span class="line"><span class="comment"> * interface provides a way of decoupling task submission from the</span></span><br><span class="line"><span class="comment"> * mechanics of how each task will be run, including details of thread</span></span><br><span class="line"><span class="comment"> * use, scheduling, etc.  An &#123;<span class="doctag">@code</span> Executor&#125; is normally used</span></span><br><span class="line"><span class="comment"> * instead of explicitly creating threads. For example, rather than</span></span><br><span class="line"><span class="comment"> * invoking &#123;<span class="doctag">@code</span> new Thread(new(RunnableTask())).start()&#125; for each</span></span><br><span class="line"><span class="comment"> * of a set of tasks, you might use:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;pre&gt;</span></span><br><span class="line"><span class="comment"> * Executor executor = &lt;em&gt;anExecutor&lt;/em&gt;;</span></span><br><span class="line"><span class="comment"> * executor.execute(new RunnableTask1());</span></span><br><span class="line"><span class="comment"> * executor.execute(new RunnableTask2());</span></span><br><span class="line"><span class="comment"> * ...</span></span><br><span class="line"><span class="comment"> * &lt;/pre&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * However, the &#123;<span class="doctag">@code</span> Executor&#125; interface does not strictly</span></span><br><span class="line"><span class="comment"> * require that execution be asynchronous. In the simplest case, an</span></span><br><span class="line"><span class="comment"> * executor can run the submitted task immediately in the caller&#x27;s</span></span><br><span class="line"><span class="comment"> * thread:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  &lt;pre&gt; &#123;<span class="doctag">@code</span></span></span><br><span class="line"><span class="comment"> * class DirectExecutor implements Executor &#123;</span></span><br><span class="line"><span class="comment"> *   public void execute(Runnable r) &#123;</span></span><br><span class="line"><span class="comment"> *     r.run();</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * &#125;&#125;&lt;/pre&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * More typically, tasks are executed in some thread other</span></span><br><span class="line"><span class="comment"> * than the caller&#x27;s thread.  The executor below spawns a new thread</span></span><br><span class="line"><span class="comment"> * for each task.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  &lt;pre&gt; &#123;<span class="doctag">@code</span></span></span><br><span class="line"><span class="comment"> * class ThreadPerTaskExecutor implements Executor &#123;</span></span><br><span class="line"><span class="comment"> *   public void execute(Runnable r) &#123;</span></span><br><span class="line"><span class="comment"> *     new Thread(r).start();</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * &#125;&#125;&lt;/pre&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Many &#123;<span class="doctag">@code</span> Executor&#125; implementations impose some sort of</span></span><br><span class="line"><span class="comment"> * limitation on how and when tasks are scheduled.  The executor below</span></span><br><span class="line"><span class="comment"> * serializes the submission of tasks to a second executor,</span></span><br><span class="line"><span class="comment"> * illustrating a composite executor.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  &lt;pre&gt; &#123;<span class="doctag">@code</span></span></span><br><span class="line"><span class="comment"> * class SerialExecutor implements Executor &#123;</span></span><br><span class="line"><span class="comment"> *   final Queue&lt;Runnable&gt; tasks = new ArrayDeque&lt;Runnable&gt;();</span></span><br><span class="line"><span class="comment"> *   final Executor executor;</span></span><br><span class="line"><span class="comment"> *   Runnable active;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *   SerialExecutor(Executor executor) &#123;</span></span><br><span class="line"><span class="comment"> *     this.executor = executor;</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *   public synchronized void execute(final Runnable r) &#123;</span></span><br><span class="line"><span class="comment"> *     tasks.offer(new Runnable() &#123;</span></span><br><span class="line"><span class="comment"> *       public void run() &#123;</span></span><br><span class="line"><span class="comment"> *         try &#123;</span></span><br><span class="line"><span class="comment"> *           r.run();</span></span><br><span class="line"><span class="comment"> *         &#125; finally &#123;</span></span><br><span class="line"><span class="comment"> *           scheduleNext();</span></span><br><span class="line"><span class="comment"> *         &#125;</span></span><br><span class="line"><span class="comment"> *       &#125;</span></span><br><span class="line"><span class="comment"> *     &#125;);</span></span><br><span class="line"><span class="comment"> *     if (active == null) &#123;</span></span><br><span class="line"><span class="comment"> *       scheduleNext();</span></span><br><span class="line"><span class="comment"> *     &#125;</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *   protected synchronized void scheduleNext() &#123;</span></span><br><span class="line"><span class="comment"> *     if ((active = tasks.poll()) != null) &#123;</span></span><br><span class="line"><span class="comment"> *       executor.execute(active);</span></span><br><span class="line"><span class="comment"> *     &#125;</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * &#125;&#125;&lt;/pre&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The &#123;<span class="doctag">@code</span> Executor&#125; implementations provided in this package</span></span><br><span class="line"><span class="comment"> * implement &#123;<span class="doctag">@link</span> ExecutorService&#125;, which is a more extensive</span></span><br><span class="line"><span class="comment"> * interface.  The &#123;<span class="doctag">@link</span> ThreadPoolExecutor&#125; class provides an</span></span><br><span class="line"><span class="comment"> * extensible thread pool implementation. The &#123;<span class="doctag">@link</span> Executors&#125; class</span></span><br><span class="line"><span class="comment"> * provides convenient factory methods for these Executors.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;Memory consistency effects: Actions in a thread prior to</span></span><br><span class="line"><span class="comment"> * submitting a &#123;<span class="doctag">@code</span> Runnable&#125; object to an &#123;<span class="doctag">@code</span> Executor&#125;</span></span><br><span class="line"><span class="comment"> * &lt;a href=&quot;package-summary.html#MemoryVisibility&quot;&gt;&lt;i&gt;happen-before&lt;/i&gt;&lt;/a&gt;</span></span><br><span class="line"><span class="comment"> * its execution begins, perhaps in another thread.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.5</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Doug Lea</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Executor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Executes the given command at some time in the future.  The command</span></span><br><span class="line"><span class="comment">     * may execute in a new thread, in a pooled thread, or in the calling</span></span><br><span class="line"><span class="comment">     * thread, at the discretion of the &#123;<span class="doctag">@code</span> Executor&#125; implementation.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> command the runnable task</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> RejectedExecutionException if this task cannot be</span></span><br><span class="line"><span class="comment">     * accepted for execution</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NullPointerException if command is null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable command)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªé¡¶å±‚æ¥å£ï¼Œåœ¨å®ƒé‡Œé¢åªå£°æ˜äº†ä¸€ä¸ª<code>execute</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°±æ˜¯ç”¨æ¥æ‰§è¡Œä¼ è¿›å»çš„ä»»åŠ¡çš„</p>
</blockquote>
<p><code>java.util.concurrent.ExecutorService</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> java.util.concurrent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * An &#123;<span class="doctag">@link</span> Executor&#125; that provides methods to manage termination and</span></span><br><span class="line"><span class="comment"> * methods that can produce a &#123;<span class="doctag">@link</span> Future&#125; for tracking progress of</span></span><br><span class="line"><span class="comment"> * one or more asynchronous tasks.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;An &#123;<span class="doctag">@code</span> ExecutorService&#125; can be shut down, which will cause</span></span><br><span class="line"><span class="comment"> * it to reject new tasks.  Two different methods are provided for</span></span><br><span class="line"><span class="comment"> * shutting down an &#123;<span class="doctag">@code</span> ExecutorService&#125;. The &#123;<span class="doctag">@link</span> #shutdown&#125;</span></span><br><span class="line"><span class="comment"> * method will allow previously submitted tasks to execute before</span></span><br><span class="line"><span class="comment"> * terminating, while the &#123;<span class="doctag">@link</span> #shutdownNow&#125; method prevents waiting</span></span><br><span class="line"><span class="comment"> * tasks from starting and attempts to stop currently executing tasks.</span></span><br><span class="line"><span class="comment"> * Upon termination, an executor has no tasks actively executing, no</span></span><br><span class="line"><span class="comment"> * tasks awaiting execution, and no new tasks can be submitted.  An</span></span><br><span class="line"><span class="comment"> * unused &#123;<span class="doctag">@code</span> ExecutorService&#125; should be shut down to allow</span></span><br><span class="line"><span class="comment"> * reclamation of its resources.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;Method &#123;<span class="doctag">@code</span> submit&#125; extends base method &#123;<span class="doctag">@link</span></span></span><br><span class="line"><span class="comment"> * Executor#execute(Runnable)&#125; by creating and returning a &#123;<span class="doctag">@link</span> Future&#125;</span></span><br><span class="line"><span class="comment"> * that can be used to cancel execution and/or wait for completion.</span></span><br><span class="line"><span class="comment"> * Methods &#123;<span class="doctag">@code</span> invokeAny&#125; and &#123;<span class="doctag">@code</span> invokeAll&#125; perform the most</span></span><br><span class="line"><span class="comment"> * commonly useful forms of bulk execution, executing a collection of</span></span><br><span class="line"><span class="comment"> * tasks and then waiting for at least one, or all, to</span></span><br><span class="line"><span class="comment"> * complete. (Class &#123;<span class="doctag">@link</span> ExecutorCompletionService&#125; can be used to</span></span><br><span class="line"><span class="comment"> * write customized variants of these methods.)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;The &#123;<span class="doctag">@link</span> Executors&#125; class provides factory methods for the</span></span><br><span class="line"><span class="comment"> * executor services provided in this package.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;h3&gt;Usage Examples&lt;/h3&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Here is a sketch of a network service in which threads in a thread</span></span><br><span class="line"><span class="comment"> * pool service incoming requests. It uses the preconfigured &#123;<span class="doctag">@link</span></span></span><br><span class="line"><span class="comment"> * Executors#newFixedThreadPool&#125; factory method:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  &lt;pre&gt; &#123;<span class="doctag">@code</span></span></span><br><span class="line"><span class="comment"> * class NetworkService implements Runnable &#123;</span></span><br><span class="line"><span class="comment"> *   private final ServerSocket serverSocket;</span></span><br><span class="line"><span class="comment"> *   private final ExecutorService pool;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *   public NetworkService(int port, int poolSize)</span></span><br><span class="line"><span class="comment"> *       throws IOException &#123;</span></span><br><span class="line"><span class="comment"> *     serverSocket = new ServerSocket(port);</span></span><br><span class="line"><span class="comment"> *     pool = Executors.newFixedThreadPool(poolSize);</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *   public void run() &#123; // run the service</span></span><br><span class="line"><span class="comment"> *     try &#123;</span></span><br><span class="line"><span class="comment"> *       for (;;) &#123;</span></span><br><span class="line"><span class="comment"> *         pool.execute(new Handler(serverSocket.accept()));</span></span><br><span class="line"><span class="comment"> *       &#125;</span></span><br><span class="line"><span class="comment"> *     &#125; catch (IOException ex) &#123;</span></span><br><span class="line"><span class="comment"> *       pool.shutdown();</span></span><br><span class="line"><span class="comment"> *     &#125;</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * class Handler implements Runnable &#123;</span></span><br><span class="line"><span class="comment"> *   private final Socket socket;</span></span><br><span class="line"><span class="comment"> *   Handler(Socket socket) &#123; this.socket = socket; &#125;</span></span><br><span class="line"><span class="comment"> *   public void run() &#123;</span></span><br><span class="line"><span class="comment"> *     // read and service request on socket</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * &#125;&#125;&lt;/pre&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The following method shuts down an &#123;<span class="doctag">@code</span> ExecutorService&#125; in two phases,</span></span><br><span class="line"><span class="comment"> * first by calling &#123;<span class="doctag">@code</span> shutdown&#125; to reject incoming tasks, and then</span></span><br><span class="line"><span class="comment"> * calling &#123;<span class="doctag">@code</span> shutdownNow&#125;, if necessary, to cancel any lingering tasks:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  &lt;pre&gt; &#123;<span class="doctag">@code</span></span></span><br><span class="line"><span class="comment"> * void shutdownAndAwaitTermination(ExecutorService pool) &#123;</span></span><br><span class="line"><span class="comment"> *   pool.shutdown(); // Disable new tasks from being submitted</span></span><br><span class="line"><span class="comment"> *   try &#123;</span></span><br><span class="line"><span class="comment"> *     // Wait a while for existing tasks to terminate</span></span><br><span class="line"><span class="comment"> *     if (!pool.awaitTermination(60, TimeUnit.SECONDS)) &#123;</span></span><br><span class="line"><span class="comment"> *       pool.shutdownNow(); // Cancel currently executing tasks</span></span><br><span class="line"><span class="comment"> *       // Wait a while for tasks to respond to being cancelled</span></span><br><span class="line"><span class="comment"> *       if (!pool.awaitTermination(60, TimeUnit.SECONDS))</span></span><br><span class="line"><span class="comment"> *           System.err.println(&quot;Pool did not terminate&quot;);</span></span><br><span class="line"><span class="comment"> *     &#125;</span></span><br><span class="line"><span class="comment"> *   &#125; catch (InterruptedException ie) &#123;</span></span><br><span class="line"><span class="comment"> *     // (Re-)Cancel if current thread also interrupted</span></span><br><span class="line"><span class="comment"> *     pool.shutdownNow();</span></span><br><span class="line"><span class="comment"> *     // Preserve interrupt status</span></span><br><span class="line"><span class="comment"> *     Thread.currentThread().interrupt();</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * &#125;&#125;&lt;/pre&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;Memory consistency effects: Actions in a thread prior to the</span></span><br><span class="line"><span class="comment"> * submission of a &#123;<span class="doctag">@code</span> Runnable&#125; or &#123;<span class="doctag">@code</span> Callable&#125; task to an</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> ExecutorService&#125;</span></span><br><span class="line"><span class="comment"> * &lt;a href=&quot;package-summary.html#MemoryVisibility&quot;&gt;&lt;i&gt;happen-before&lt;/i&gt;&lt;/a&gt;</span></span><br><span class="line"><span class="comment"> * any actions taken by that task, which in turn &lt;i&gt;happen-before&lt;/i&gt; the</span></span><br><span class="line"><span class="comment"> * result is retrieved via &#123;<span class="doctag">@code</span> Future.get()&#125;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.5</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Doug Lea</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ExecutorService</span> <span class="keyword">extends</span> <span class="title">Executor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function">List&lt;Runnable&gt; <span class="title">shutdownNow</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isShutdown</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isTerminated</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">awaitTermination</span><span class="params">(<span class="keyword">long</span> timeout, TimeUnit unit)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> InterruptedException</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    &lt;T&gt; <span class="function">Future&lt;T&gt; <span class="title">submit</span><span class="params">(Callable&lt;T&gt; task)</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    &lt;T&gt; <span class="function">Future&lt;T&gt; <span class="title">submit</span><span class="params">(Runnable task, T result)</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    Future&lt;?&gt; submit(Runnable task);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</span><br><span class="line">        <span class="keyword">throws</span> InterruptedException;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,</span><br><span class="line">                                  <span class="keyword">long</span> timeout, TimeUnit unit)</span><br><span class="line">        <span class="keyword">throws</span> InterruptedException;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    &lt;T&gt; <span class="function">T <span class="title">invokeAny</span><span class="params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> InterruptedException, ExecutionException</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    &lt;T&gt; <span class="function">T <span class="title">invokeAny</span><span class="params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="keyword">long</span> timeout, TimeUnit unit)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> InterruptedException, ExecutionException, TimeoutException</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ExecutorServiceæ¥å£ç»§æ‰¿äº†Executoræ¥å£ï¼Œå¹¶å£°æ˜äº†ä¸€äº›æ–¹æ³•ï¼šsubmitã€invokeAllã€invokeAnyä»¥åŠshutDownç­‰</p>
</blockquote>
<p><code>java.util.concurrent.AbstractExecutorService</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractExecutorService</span> <span class="keyword">implements</span> <span class="title">ExecutorService</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŠ½è±¡ç±»AbstractExecutorServiceå®ç°äº†ExecutorServiceæ¥å£</p>
</blockquote>
<p><code>java.util.concurrent.ThreadPoolExecutor</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPoolExecutor</span> <span class="keyword">extends</span> <span class="title">AbstractExecutorService</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ThreadPoolExecutorç»§æ‰¿äº†ç±»AbstractExecutorServiceï¼Œå¹¶è¿›è¡Œäº†æ‰©å±•</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼ŒThreadPoolExecutorå°±æ˜¯JKDä¸­æä¾›çš„ä¸€ä¸ªçº¿ç¨‹æ± ç±»</p>
</blockquote>
<h3 id="ThreadPoolExecutor"><a href="#ThreadPoolExecutor" class="headerlink" title="ThreadPoolExecutor"></a>ThreadPoolExecutor</h3><p><code>ThreadPoolExecutor</code>ç±»ä¸­æœ‰ä¸€ä¸ªäº”å‚æ„é€ å™¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPoolExecutor</span> <span class="keyword">extends</span> <span class="title">AbstractExecutorService</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,</span></span></span><br><span class="line"><span class="params"><span class="function">                              <span class="keyword">int</span> maximumPoolSize,</span></span></span><br><span class="line"><span class="params"><span class="function">                              <span class="keyword">long</span> keepAliveTime,</span></span></span><br><span class="line"><span class="params"><span class="function">                              TimeUnit unit,</span></span></span><br><span class="line"><span class="params"><span class="function">                              BlockingQueue&lt;Runnable&gt; workQueue)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//..</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°çš„å«ä¹‰:</p>
<ul>
<li><code>corePoolSize</code>ï¼Œçº¿ç¨‹æ± ç»´æŠ¤çº¿ç¨‹çš„æœ€å°‘æ•°é‡(æ ¸å¿ƒçº¿ç¨‹æ•°) </li>
<li><code>maximumPoolSize</code>ï¼Œçº¿ç¨‹æ± ç»´æŠ¤çº¿ç¨‹çš„æœ€å¤§æ•°é‡ </li>
<li><code>keepAliveTime</code>ï¼Œçº¿ç¨‹æ± ç»´æŠ¤çº¿ç¨‹æ‰€å…è®¸çš„ç©ºé—²æ—¶é—´</li>
<li><code>unit</code>ï¼Œçº¿ç¨‹æ± ç»´æŠ¤çº¿ç¨‹æ‰€å…è®¸çš„ç©ºé—²æ—¶é—´çš„å•ä½  </li>
<li><code>workQueue</code>ï¼Œçº¿ç¨‹æ± æ‰€ä½¿ç”¨çš„ç¼“å†²é˜Ÿåˆ— </li>
</ul>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/20180419002550514" alt="img"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/6024478-88ee7b20f8f45825.png" alt="img"></p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPoolExecutorTest</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		ThreadPoolExecutor executor = <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">5</span>, <span class="number">10</span>, <span class="number">2000</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">				<span class="keyword">new</span> ArrayBlockingQueue&lt;Runnable&gt;(<span class="number">5</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">15</span>;i++)&#123;</span><br><span class="line">			MyRun myTask = <span class="keyword">new</span> MyRun();</span><br><span class="line">			<span class="comment">//æŠŠè¦æ‰§è¡Œçš„ä»»åŠ¡äº¤ç»™çº¿ç¨‹æ± å³å¯</span></span><br><span class="line">			executor.execute(myTask);</span><br><span class="line">			System.out.println(<span class="string">&quot;çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°ç›®: &quot;</span>+executor.getPoolSize()+</span><br><span class="line">								<span class="string">&quot;,é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡æ•°ç›®: &quot;</span>+executor.getQueue().size()+</span><br><span class="line">								<span class="string">&quot;,å·²æ‰§è¡Œå®Œçš„ä»»åŠ¡æ•°ç›®: &quot;</span>+executor.getCompletedTaskCount());</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//å…³é—­çº¿ç¨‹æ± </span></span><br><span class="line">		executor.shutdown();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRun</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					Thread.sleep(<span class="number">1</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">	</span><br><span class="line">			System.out.println(<span class="string">&quot;ä»»åŠ¡ç»“æŸ&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">Executors</span><br></pre></td></tr></table></figure>

<ul>
<li>CachedThreadPool:å¯ç¼“å­˜çš„çº¿ç¨‹æ± ï¼Œè¯¥çº¿ç¨‹æ± ä¸­æ²¡æœ‰æ ¸å¿ƒçº¿ç¨‹ï¼Œéæ ¸å¿ƒçº¿ç¨‹çš„æ•°é‡ä¸ºInteger.max_valueï¼Œå°±æ˜¯æ— é™å¤§ï¼Œå½“æœ‰éœ€è¦æ—¶åˆ›å»ºçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œæ²¡æœ‰éœ€è¦æ—¶å›æ”¶çº¿ç¨‹ï¼Œé€‚ç”¨äºè€—æ—¶å°‘ï¼Œä»»åŠ¡é‡å¤§çš„æƒ…å†µã€‚</li>
<li>SecudleThreadPool:å‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ± ï¼ŒæŒ‰ç…§æŸç§ç‰¹å®šçš„è®¡åˆ’æ‰§è¡Œçº¿ç¨‹ä¸­çš„ä»»åŠ¡ï¼Œæœ‰æ ¸å¿ƒçº¿ç¨‹ï¼Œä½†ä¹Ÿæœ‰éæ ¸å¿ƒçº¿ç¨‹ï¼Œéæ ¸å¿ƒçº¿ç¨‹çš„å¤§å°ä¹Ÿä¸ºæ— é™å¤§ã€‚é€‚ç”¨äºæ‰§è¡Œå‘¨æœŸæ€§çš„ä»»åŠ¡ã€‚</li>
<li>SingleThreadPool:åªæœ‰ä¸€æ¡çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œé€‚ç”¨äºæœ‰é¡ºåºçš„ä»»åŠ¡çš„åº”ç”¨åœºæ™¯ã€‚</li>
<li>FixedThreadPool:å®šé•¿çš„çº¿ç¨‹æ± ï¼Œæœ‰æ ¸å¿ƒçº¿ç¨‹ï¼Œæ ¸å¿ƒçº¿ç¨‹çš„å³ä¸ºæœ€å¤§çš„çº¿ç¨‹æ•°é‡ï¼Œæ²¡æœ‰éæ ¸å¿ƒçº¿ç¨‹</li>
</ul>
<p><code>java.util.concurrent.Executors</code> ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªå·¥å‚ç±»ï¼Œå¯ä»¥ä¾¿æ·çš„å¸®æˆ‘ä»¬ç”Ÿäº§å‡ºçº¿ç¨‹æ± å¯¹è±¡ï¼ŒåŒæ—¶è¯¥ç±»ä¸­ä¹Ÿæä¾›äº†ä¸€äº›å®ç”¨çš„å·¥å‚æ–¹æ³•ï¼š</p>
<p>å·¥å‚æ–¹æ³•1ï¼Œåˆ›å»ºä¸€ä¸ªå®šé•¿çš„çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newFixedThreadPool</span><span class="params">(<span class="keyword">int</span> nThreads)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,</span><br><span class="line">                                  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    ExecutorService fixedThreadPool = Executors.newFixedThreadPool(<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> index = i;</span><br><span class="line">        fixedThreadPool.execute(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(index);</span><br><span class="line">                    Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fixedThreadPool.shutdown();</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œæœ€åè®°å¾—ç”¨å®Œå°±å…³é—­çº¿ç¨‹æ± </p>
</blockquote>
<p>==æ€è€ƒï¼Œå¦‚æœç”¨å®Œä¹‹åï¼Œæ²¡æœ‰å…³é—­çº¿ç¨‹æ± ï¼Œé‚£ä¹ˆä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ==</p>
<p>å·¥å‚æ–¹æ³•2ï¼Œåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çš„çº¿ç¨‹æ± ï¼Œå¦‚æœçº¿ç¨‹æ± é•¿åº¦è¶…è¿‡å¤„ç†éœ€è¦ï¼Œå¯çµæ´»å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œå¦åˆ™æ–°å»ºçº¿ç¨‹</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newCachedThreadPool</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">0</span>, Integer.MAX_VALUE,</span><br><span class="line">                                  <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> SynchronousQueue&lt;Runnable&gt;());</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    ExecutorService cachedThreadPool = Executors.newCachedThreadPool();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> index = i;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(index * <span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        cachedThreadPool.execute(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                System.out.println(index);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> poolSize = ((ThreadPoolExecutor)cachedThreadPool).getPoolSize();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;çº¿ç¨‹æ± ä¸­å½“å‰çº¿ç¨‹çš„æ•°é‡: &quot;</span>+poolSize);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cachedThreadPool.shutdown();</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å·¥å‚æ–¹æ³•3ï¼Œåˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåºæ‰§è¡Œ</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newSingleThreadExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> FinalizableDelegatedExecutorService(<span class="keyword">new</span> ThreadPoolExecutor(<span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">                                    <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                    <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    ExecutorService singleThreadExecutor = Executors.newSingleThreadExecutor();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> index = i;</span><br><span class="line">        singleThreadExecutor.execute(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(index);</span><br><span class="line">                    Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    singleThreadExecutor.shutdown();</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å·¥å‚æ–¹æ³•4ï¼Œåˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ,æ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œ</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ScheduledExecutorService <span class="title">newScheduledThreadPool</span><span class="params">(<span class="keyword">int</span> corePoolSize)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ScheduledThreadPoolExecutor(corePoolSize);  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    ScheduledExecutorService scheduledThreadPool = Executors.newScheduledThreadPool(<span class="number">5</span>);</span><br><span class="line">    scheduledThreadPool.scheduleAtFixedRate(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;å»¶è¿Ÿ10ç§’åæ‰§è¡Œ,ä¹‹åå†æŒ‰ç…§æ¯3ç§’æ‰§è¡Œä¸€æ¬¡&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">1</span>, <span class="number">3</span>, TimeUnit.SECONDS);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ”¹é€ æœåŠ¡ç«¯"><a href="#æ”¹é€ æœåŠ¡ç«¯" class="headerlink" title="æ”¹é€ æœåŠ¡ç«¯"></a>æ”¹é€ æœåŠ¡ç«¯</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.smart.env.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.Configuration;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.constant.EnvGatherConstants;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.entity.Environment;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.support.ConfigurationAware;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.support.PropertiesAware;</span><br><span class="line"><span class="keyword">import</span> com.briup.smart.env.util.Log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerImpl</span> <span class="keyword">implements</span> <span class="title">Server</span>,<span class="title">PropertiesAware</span>,<span class="title">ConfigurationAware</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> reciverServerPort;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> shutdownServerPort;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> ServerSocket reciverServer;</span><br><span class="line">	<span class="keyword">private</span> ServerSocket shutdownServer;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> ExecutorService threadPool = Executors.newFixedThreadPool(<span class="number">5</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Socket socket;</span><br><span class="line">	<span class="keyword">private</span> ObjectInputStream in;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> DBStore dbStore;</span><br><span class="line">	<span class="keyword">private</span> Log logger;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reciver</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		</span><br><span class="line">		logger.info(<span class="string">&quot;shutdownæœåŠ¡å™¨å·²ç»å¯åŠ¨ï¼š&quot;</span>+shutdownServerPort);</span><br><span class="line">		startShutdownServer();</span><br><span class="line">		</span><br><span class="line">		logger.info(<span class="string">&quot;reciveræœåŠ¡å™¨å·²ç»å¯åŠ¨ï¼š&quot;</span>+reciverServerPort);</span><br><span class="line">		startReciverServer();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * å¯åŠ¨reciveræœåŠ¡å™¨ï¼ˆæ¥æ”¶æœåŠ¡å™¨ï¼‰</span></span><br><span class="line"><span class="comment">	 * ä½œç”¨ï¼šè¯¥æœåŠ¡å™¨çš„ç«¯å£9999ï¼Œè´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„æ•°æ®</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startReciverServer</span><span class="params">()</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			</span><br><span class="line">			reciverServer = <span class="keyword">new</span> ServerSocket(reciverServerPort);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">while</span>(flag) &#123;</span><br><span class="line">				logger.debug(<span class="string">&quot;reciverServeræœåŠ¡å™¨æ­£åœ¨ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥&quot;</span>);</span><br><span class="line">				socket = reciverServer.accept();</span><br><span class="line">				</span><br><span class="line">				</span><br><span class="line">				logger.debug(<span class="string">&quot;reciverServeræœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯è¿æ¥&quot;</span>);</span><br><span class="line">				logger.debug(<span class="string">&quot;reciverServeræœåŠ¡å™¨ä½¿ç”¨çº¿ç¨‹æ± å¤„ç†è¿™ä¸ªå®¢æˆ·ç«¯&quot;</span>);</span><br><span class="line">				threadPool.execute(()-&gt;&#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						</span><br><span class="line">						in = <span class="keyword">new</span> ObjectInputStream(socket.getInputStream());</span><br><span class="line">						</span><br><span class="line">						<span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">						List&lt;Environment&gt; list = (List&lt;Environment&gt;)in.readObject();</span><br><span class="line">						</span><br><span class="line">						dbStore.saveDB(list);</span><br><span class="line">						</span><br><span class="line">						socket.close();</span><br><span class="line">						</span><br><span class="line">					&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">						<span class="keyword">if</span>(socket!=<span class="keyword">null</span>) &#123;</span><br><span class="line">							<span class="keyword">try</span> &#123;</span><br><span class="line">								socket.close();</span><br><span class="line">							&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">								e.printStackTrace();</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					</span><br><span class="line">					</span><br><span class="line">				&#125;);</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(socket!=<span class="keyword">null</span>) &#123;</span><br><span class="line">				socket.close();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(reciverServer!=<span class="keyword">null</span>) &#123;</span><br><span class="line">				reciverServer.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * å¯åŠ¨shutdownæœåŠ¡å™¨ï¼ˆå…³é—­æœåŠ¡å™¨ï¼‰</span></span><br><span class="line"><span class="comment">	 * ä½œç”¨ï¼šè¯¥æœåŠ¡å™¨çš„ç«¯å£8888ï¼Œè´Ÿè´£æ¥æ”¶ç”¨æˆ·å‘é€çš„æ¶ˆæ¯ï¼Œå¯ä»¥å…³é—­æ‰€æœ‰æœåŠ¡å™¨ï¼ˆreciverå’Œshutdownï¼‰</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startShutdownServer</span><span class="params">()</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		Runnable run = ()-&gt;&#123;&#125;;</span></span><br><span class="line">		Runnable run = ()-&gt;&#123;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				shutdownServer = <span class="keyword">new</span> ServerSocket(shutdownServerPort);</span><br><span class="line">				</span><br><span class="line">				shutdownServer.accept();</span><br><span class="line">				</span><br><span class="line">				ServerImpl.<span class="keyword">this</span>.shutdown();</span><br><span class="line">				</span><br><span class="line">			&#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>(shutdownServer!=<span class="keyword">null</span>) &#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						shutdownServer.close();</span><br><span class="line">					&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">new</span> Thread(run).start();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.flag = <span class="keyword">false</span>;</span><br><span class="line">		reciverServer.close();</span><br><span class="line">		threadPool.shutdown();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(Properties properties)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		reciverServerPort = Integer.parseInt(properties.getProperty(EnvGatherConstants.MODULE_SERVER_RECIVER_SERVER_PORT));</span><br><span class="line">		shutdownServerPort = Integer.parseInt(properties.getProperty(EnvGatherConstants.MODULE_SERVER_SHUTDOWN_SERVER_PORT));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConfiguration</span><span class="params">(Configuration configuration)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		dbStore = configuration.getDbStore();</span><br><span class="line">		logger = configuration.getLogger();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h1 id="8-æ‰“åŒ…"><a href="#8-æ‰“åŒ…" class="headerlink" title="8 æ‰“åŒ…"></a>8 æ‰“åŒ…</h1><h2 id="é…ç½®æ’ä»¶"><a href="#é…ç½®æ’ä»¶" class="headerlink" title="é…ç½®æ’ä»¶"></a>é…ç½®æ’ä»¶</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">finalName</span>&gt;</span>env-gather-client<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">&lt;!-- å¯æ‰§è¡Œjaræ’ä»¶ --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-shade-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">					<span class="comment">&lt;!-- è®¾ç½®æ‰“åŒ…æ—¶å€™ç”Ÿæˆdependency-reduced-pom.xmlæ–‡ä»¶ä¸ºfalse --&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">createDependencyReducedPom</span>&gt;</span>false<span class="tag">&lt;/<span class="name">createDependencyReducedPom</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">						<span class="comment">&lt;!-- ç»‘å®šshadeæ’ä»¶åˆ°Mavençš„ç”Ÿå‘½å‘¨æœŸ (package) --&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">						<span class="comment">&lt;!--åœ¨ç”Ÿå‘½å‘¨æœŸåæ‰§è¡Œç»‘å®šçš„shadeæ’ä»¶çš„goals --&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">goal</span>&gt;</span>shade<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">transformers</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">transformer</span></span></span><br><span class="line"><span class="tag">									<span class="attr">implementation</span>=<span class="string">&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;</span>&gt;</span></span><br><span class="line">									<span class="comment">&lt;!--æŒ‡å®šç¨‹åºå…¥å£ç±» --&gt;</span></span><br><span class="line">									<span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>com.briup.smart.env.main.ClientMain<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;/<span class="name">transformer</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;/<span class="name">transformers</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="ä¿®æ”¹srcç›¸å…³è·¯å¾„"><a href="#ä¿®æ”¹srcç›¸å…³è·¯å¾„" class="headerlink" title="ä¿®æ”¹srcç›¸å…³è·¯å¾„"></a>ä¿®æ”¹srcç›¸å…³è·¯å¾„</h2><p><code>conf-deploy.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">environment</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">gather</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.client.GatherImpl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">gather-data-file-path</span>&gt;</span>data-file-simple<span class="tag">&lt;/<span class="name">gather-data-file-path</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">gather-file-length-bak</span>&gt;</span>gather-file-length<span class="tag">&lt;/<span class="name">gather-file-length-bak</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">gather</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">logger</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.util.LogImpl&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">backup</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.util.BackupImpl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">backup-base-path</span>&gt;</span>D:/env/bak<span class="tag">&lt;/<span class="name">backup-base-path</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">backup</span>&gt;</span></span><br><span class="line">	 </span><br><span class="line">	<span class="tag">&lt;<span class="name">client</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.client.ClientImpl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">client-server-ip</span>&gt;</span>127.0.0.1<span class="tag">&lt;/<span class="name">client-server-ip</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">client-port</span>&gt;</span>8888<span class="tag">&lt;/<span class="name">client-port</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">client</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">server</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.server.ServerImpl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">server-port</span>&gt;</span>8888<span class="tag">&lt;/<span class="name">server-port</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">server-stop-port</span>&gt;</span>9999<span class="tag">&lt;/<span class="name">server-stop-port</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">dbStore</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.smart.env.server.DBStoreImpl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dbStore-batch-size</span>&gt;</span>100<span class="tag">&lt;/<span class="name">dbStore-batch-size</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dbStore</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨ç±»åŠ è½½å™¨åŠ è½½èµ„æº"><a href="#ä½¿ç”¨ç±»åŠ è½½å™¨åŠ è½½èµ„æº" class="headerlink" title="ä½¿ç”¨ç±»åŠ è½½å™¨åŠ è½½èµ„æº"></a>ä½¿ç”¨ç±»åŠ è½½å™¨åŠ è½½èµ„æº</h2><p><code>ConfigurationImpl</code></p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210929202202813.png" alt="image-20210929202202813"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210929202226219.png" alt="image-20210929202226219"></p>
<p><code>BackupImpl</code></p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210929202321655.png" alt="image-20210929202321655"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210929202330401.png" alt="image-20210929202330401"></p>
<p><code>GatherImpl</code></p>
<p><img src="https://gitee.com/vanse/images/raw/master/environment/image-20210929202301756.png" alt="image-20210929202301756"></p>
<p>==æ­¤å¤„è¦æ³¨æ„æ‰“åŒ…å,new File(path)æ˜¯æ–‡ä»¶ä¸å­˜åœ¨çš„,æ­¤æ—¶fileLength=0==</p>
]]></content>
      <categories>
        <category>project</category>
      </categories>
      <tags>
        <tag>briup</tag>
        <tag>corejava</tag>
        <tag>vanse_public</tag>
      </tags>
  </entry>
  <entry>
    <title>cms</title>
    <url>/archives/project/briup-cms.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>å‰è¨€</p>
<ul>
<li>æ•™ç¨‹: cms</li>
<li>æ—¶é—´: 2121/11/10</li>
<li>æ•´ç†äºº: vanse(åˆ˜èª)</li>
<li>ç­çº§ï¼šèè‹±ç­</li>
</ul>
<h1 id="é¡¹ç›®å‡†å¤‡"><a href="#é¡¹ç›®å‡†å¤‡" class="headerlink" title="é¡¹ç›®å‡†å¤‡"></a>é¡¹ç›®å‡†å¤‡</h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><pre><code>åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œå†…å®¹ç®¡ç†ç³»ç»Ÿå åˆ°æ‰€æœ‰ç³»ç»Ÿçš„80%ä»¥ä¸Šï¼Œæ¯”å¦‚ä¸ªäººåšå®¢ï¼Œè…¾è®¯æ–°é—»ï¼Œä»Šæ—¥å¤´æ¡ï¼Œæœç‹æ–° é—»ç­‰ã€‚ è¿™äº›éƒ½æ˜¯æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ç»å¸¸ä½¿ç”¨åˆ°çš„ç³»ç»Ÿï¼Œå®ƒçš„æ ¸å¿ƒå°±æ˜¯å¯ä»¥æ¦‚æ‹¬ä¸ºå†…å®¹ï¼ˆèµ„è®¯ï¼‰ï¼Œä¸€ç¯‡æ–‡ç« å°±æ˜¯ä¸€ä¸ªèµ„è®¯ï¼Œå¤§å®¶è¶Šæ¥è¶Šå–œæ¬¢å°†ç”Ÿæ´»ä¸­çš„æ‰€è§æ‰€é—»ç®€è¿°å‡ºæ¥ã€‚
</code></pre>
<p>å¦‚å›¾ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210317215643452.png" alt="image-20210317215643452"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210317215652686.png" alt="image-20210317215652686"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œç›®å‰æ¥è®²å¯¹äºèµ„è®¯ç³»ç»Ÿçš„éœ€æ±‚é‡æ˜¯éå¸¸å¤§çš„</p>
</blockquote>
<pre><code>é€šç”¨çš„çœ‹ç‚¹èµ„è®¯ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨å‰åå°åˆ†ç¦»å¼€å‘çš„æŠ€æœ¯ï¼Œå°†ç³»ç»Ÿåˆ†ä¸ºå‰å°é¡µé¢å±•ç¤ºä»¥åŠåå°èµ„è®¯ç®¡ç†ç³»ç»Ÿã€‚å¯¹äºåå°ç³»ç»Ÿæ˜¯åŸºæœ¬ä¸Šæ˜¯é€šç”¨çš„ï¼Œè€Œå‰å°å¯æ ¹æ®ä¸åŒå®¢æˆ·çš„éœ€æ±‚å»ä¿®æ”¹å®šåˆ¶ã€‚
</code></pre>
<p>  (ä¸æ¶‰åŠé¡µé¢  ä½¿ç”¨æŸäº›å‰ç«¯æ¨¡æ¿)</p>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>çœ‹ç‚¹èµ„è®¯ç³»ç»Ÿæœ€æ ¸å¿ƒçš„æ•°æ®æ˜¯å†…å®¹ï¼Œä¾‹å¦‚æ–‡ç« ã€æ–°é—»ç­‰ï¼Œæ‰€ä»¥åå°ä¸»è¦åŠŸèƒ½æ˜¯å®ç°è¿™äº›å†…å®¹çš„ç®¡ç†ï¼Œä¾‹å¦‚æ ç›®ç®¡ç†ã€è¯„è®ºç®¡ç†ã€ç”¨æˆ·ç®¡ç†ä»¥åŠè§’è‰²ç®¡ç†ç­‰ï¼Œå¯¹äºå‰å°å¯ä»¥çµæ´»å¾—å±•ç¤ºåå°çš„æ•°æ®ã€‚<br>ä¾‹å¦‚ï¼Œ</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210317215829625.png" alt="image-20210317215829625"></p>
<h2 id="æŠ€æœ¯"><a href="#æŠ€æœ¯" class="headerlink" title="æŠ€æœ¯"></a>æŠ€æœ¯</h2><p>åå°é‡‡ç”¨çš„æŠ€æœ¯ï¼š</p>
<ul>
<li>springboot(è„šæ‰‹æ¶)</li>
<li>spring(å®¹å™¨)</li>
<li>springmvc(servletå°è£… ä¼ è¾“æ•°æ®)</li>
<li>springdata-jpa(jdbc å¤„ç†æ•°æ®)</li>
</ul>
<p>æ•°æ®åº“ï¼š</p>
<ul>
<li>mysql    </li>
</ul>
<p>æ–‡æ¡£ç®¡ç†ï¼š</p>
<ul>
<li>swagger</li>
</ul>
<p>æ¶æ„é€‰å–ï¼š</p>
<ul>
<li>ä¸‰å±‚æ¶æ„<ul>
<li>controller</li>
<li>service</li>
<li>dao</li>
</ul>
</li>
</ul>
<h2 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h2><h3 id="ç”¨æˆ·æ¨¡å—"><a href="#ç”¨æˆ·æ¨¡å—" class="headerlink" title="ç”¨æˆ·æ¨¡å—"></a>ç”¨æˆ·æ¨¡å—</h3><blockquote>
<p>å¯¹åº”çš„å®ä½“ç±»ä¸ºUser</p>
</blockquote>
<p>1ã€æ–°å¢ç”¨æˆ·</p>
<ul>
<li>å‚æ•°1ï¼šUser</li>
</ul>
<p>2ã€ç¼–è¾‘ç”¨æˆ·</p>
<ul>
<li>å‚æ•°1ï¼šUser</li>
</ul>
<p>3ã€æŸ¥è¯¢ç”¨æˆ·ï¼ˆåˆ†é¡µï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<p>4ã€åˆ é™¤ç”¨æˆ·ï¼ˆæ‰¹é‡ï¼Œæ³¨é”€ç”¨æˆ·ï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šList<Long> ids</li>
</ul>
<p>5ã€ç¦ç”¨æˆ–è§£å°ç”¨æˆ·ä¿¡æ¯ï¼ˆæ›´æ–°ç”¨æˆ·çŠ¶æ€ï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šLong id</li>
<li>å‚æ•°2ï¼šString status</li>
</ul>
<p>6ã€æ ¹æ®ç”¨æˆ·åè·å–ç”¨æˆ·ä¿¡æ¯</p>
<ul>
<li>å‚æ•°1ï¼šString username</li>
</ul>
<p>7ã€ç™»å½•</p>
<ul>
<li>å‚æ•°1ï¼šString username</li>
<li>å‚æ•°2ï¼šString password</li>
</ul>
<h3 id="è§’è‰²æ¨¡å—"><a href="#è§’è‰²æ¨¡å—" class="headerlink" title="è§’è‰²æ¨¡å—"></a>è§’è‰²æ¨¡å—</h3><blockquote>
<p>å¯¹åº”çš„å®ä½“ç±»ä¸ºRole</p>
</blockquote>
<p>1ã€æ–°å¢è§’è‰²</p>
<ul>
<li>å‚æ•°1ï¼šRole r</li>
</ul>
<p>2ã€ç¼–è¾‘è§’è‰²</p>
<ul>
<li>å‚æ•°1ï¼šRole r</li>
</ul>
<p>3ã€æŸ¥è¯¢è§’è‰²ï¼ˆåˆ†é¡µï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<p>4ã€æ‰¹é‡åˆ é™¤è§’è‰²</p>
<ul>
<li>å‚æ•°1ï¼šList<Long> ids</li>
</ul>
<h3 id="èµ„è®¯æ¨¡å—"><a href="#èµ„è®¯æ¨¡å—" class="headerlink" title="èµ„è®¯æ¨¡å—"></a>èµ„è®¯æ¨¡å—</h3><blockquote>
<p>èµ„è®¯åœ¨è¿™é‡Œä¸»è¦æŒ‡çš„çš„æ˜¯æ–‡ç« ï¼Œå¯¹åº”çš„å®ä½“ç±»ä¸ºArticle</p>
</blockquote>
<p>1ã€æ–°å¢èµ„è®¯</p>
<ul>
<li>å‚æ•°1ï¼šArticle article</li>
</ul>
<p>2ã€ç¼–è¾‘èµ„è®¯</p>
<ul>
<li>å‚æ•°1ï¼šArticle article</li>
</ul>
<p>3ã€æŸ¥è¯¢èµ„è®¯ï¼ˆåˆ†é¡µï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<p>4ã€æ‰¹é‡åˆ é™¤èµ„è®¯</p>
<ul>
<li>å‚æ•°1ï¼šList<Long> ids</li>
</ul>
<p>5ã€å®¡æ ¸èµ„è®¯</p>
<ul>
<li>å‚æ•°1ï¼šLong id</li>
<li>å‚æ•°2ï¼šString status</li>
</ul>
<p>6ã€æ ¹æ®ç±»åˆ«IDæŸ¥è¯¢ï¼Œåˆ†é¡µè·å–èµ„è®¯ä¿¡æ¯ï¼Œå¹¶ä¸”æŒ‰ç…§é˜…è¯»é‡é™åºæ’</p>
<ul>
<li>å‚æ•°1ï¼šLong categoryId</li>
<li>å‚æ•°2ï¼šInteger pageNum</li>
<li>å‚æ•°3ï¼šInteger pageSize</li>
</ul>
<p>7ã€æ ¹æ®ç”¨æˆ·åˆ†é¡µè·å–èµ„è®¯ä¿¡æ¯</p>
<ul>
<li>å‚æ•°1ï¼šLong userId</li>
<li>å‚æ•°2ï¼šInteger pageNum</li>
<li>å‚æ•°3ï¼šInteger pageSize</li>
</ul>
<h3 id="ç±»åˆ«æ¨¡å—"><a href="#ç±»åˆ«æ¨¡å—" class="headerlink" title="ç±»åˆ«æ¨¡å—"></a>ç±»åˆ«æ¨¡å—</h3><blockquote>
<p>ç±»åˆ«ä¹Ÿå°±æ˜¯æ ç›®ï¼š Category</p>
</blockquote>
<p>1ã€æ–°å¢ç±»åˆ«</p>
<ul>
<li>å‚æ•°1ï¼šCategory category</li>
</ul>
<p>2ã€ç¼–è¾‘ç±»åˆ«</p>
<ul>
<li>å‚æ•°1ï¼šCategory category</li>
</ul>
<p>3ã€æŸ¥è¯¢ç±»åˆ«ï¼ˆåˆ†é¡µï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<p>4ã€æ‰¹é‡åˆ é™¤ç±»åˆ«</p>
<ul>
<li>å‚æ•°1ï¼šList<Long> ids</li>
</ul>
<p>5ã€æ›´æ–°ç±»åˆ«åºå·</p>
<ul>
<li>å‚æ•°1ï¼šLong id</li>
<li>å‚æ•°2ï¼šLong no</li>
</ul>
<p>6ã€æŒ‰ç…§åºå·å‡åºåˆ†é¡µè·å–ç±»åˆ«ä¿¡æ¯</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<h3 id="è¯„è®ºæ¨¡å—"><a href="#è¯„è®ºæ¨¡å—" class="headerlink" title="è¯„è®ºæ¨¡å—"></a>è¯„è®ºæ¨¡å—</h3><blockquote>
<p>å¯¹åº”çš„å®ä½“ç±»ä¸ºComment</p>
</blockquote>
<p>1ã€æ–°å¢è¯„è®º</p>
<ul>
<li>å‚æ•°1ï¼šComment comment</li>
</ul>
<p>2ã€ç¼–è¾‘è¯„è®º</p>
<ul>
<li>å‚æ•°1ï¼šComment comment</li>
</ul>
<p>3ã€æ‰¹é‡åˆ é™¤è¯„è®º</p>
<ul>
<li>å‚æ•°1ï¼šList<Long> ids</li>
</ul>
<p>4ã€æŸ¥è¯¢è¯„è®ºï¼ˆåˆ†é¡µï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<p>5ã€åˆ†é¡µè·å–æŒ‡å®šæ–‡ç« ä¸‹æ‰€æœ‰çš„è¯„è®º</p>
<ul>
<li>å‚æ•°1ï¼šLong articleId</li>
<li>å‚æ•°2ï¼šInteger num</li>
<li>å‚æ•°3ï¼šInteger size</li>
</ul>
<h2 id="å­—å…¸"><a href="#å­—å…¸" class="headerlink" title="å­—å…¸"></a>å­—å…¸</h2><p>1ã€ç”¨æˆ·è¡¨ï¼Œcms_user</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210317221131577.png" alt="image-20210317221131577"></p>
<p>2ã€è§’è‰²è¡¨ï¼Œcms_role</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210317221149140.png" alt="image-20210317221149140"></p>
<p>3ã€æ–‡ç« ç±»åˆ«è¡¨ï¼Œcms_category</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210317221204520.png" alt="image-20210317221204520"></p>
<p>4ã€æ–‡ç« è¡¨ï¼Œcms_article</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210317221220121.png" alt="image-20210317221220121"></p>
<p>5ã€è¯„è®ºè¡¨ï¼Œcms_comment</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210317221235341.png" alt="image-20210317221235341"></p>
<blockquote>
<p>æ³¨æ„ï¼Œå› ä¸ºé¡¹ç›®ä¸­ä½¿ç”¨äº†JPAï¼Œå¯ä»¥åœ¨å®ä½“ç±»ä¸­é…ç½®å®Œå…³ç³»æ˜ å°„åï¼Œè®©JPAæ ¹æ®é…ç½®è‡ªåŠ¨åˆ›å»ºè¡¨</p>
</blockquote>
<h2 id="åŸå‹å›¾"><a href="#åŸå‹å›¾" class="headerlink" title="åŸå‹å›¾"></a>åŸå‹å›¾</h2><p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210317230950797.png" alt="image-20210317230950797"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210317231012612.png" alt="image-20210317231012612"></p>
<h1 id="é¡¹ç›®æ­å»º"><a href="#é¡¹ç›®æ­å»º" class="headerlink" title="é¡¹ç›®æ­å»º"></a>é¡¹ç›®æ­å»º</h1><blockquote>
<p>åˆ›å»ºcmsé¡¹ç›®</p>
</blockquote>
<h2 id="pom"><a href="#pom" class="headerlink" title="pom"></a>pom</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">relativePath</span> /&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.briup<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cms<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-co.nnector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="properties"><a href="#properties" class="headerlink" title="properties"></a>properties</h2><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">9999</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/cms?characterEncoding=utf8&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=GMT%2B8</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">root</span></span><br><span class="line"><span class="comment">#cj  8.0</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¦‚æœéœ€è¦,å¯ä»¥è¿›è¡Œè‡ªåŠ¨å»ºè¡¨</span></span><br><span class="line"><span class="meta">spring.jpa.hibernate.ddl-auto</span>=<span class="string">update</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¦‚æœéœ€è¦,å¯ä»¥æ‰§è¡ŒæŒ‡å®šçš„sqlæ–‡ä»¶è¿›è¡Œå»ºè¡¨ </span></span><br><span class="line"><span class="comment">#spring.datasource.schema=sql/test.sql</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¦‚æœéœ€è¦,å¯ä»¥æ˜¾ç¤ºæ‰§è¡Œçš„sqlè¯­å¥</span></span><br><span class="line"><span class="meta">spring.jpa.show-sql</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># å¦‚æœéœ€è¦,å¯ä»¥æ ¼å¼åŒ–sqlè¯­å¥</span></span><br><span class="line"><span class="meta">spring.jpa.properties.hibernate.format_sql</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>

<h2 id="entity"><a href="#entity" class="headerlink" title="entity"></a>entity</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;cms_user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="meta">@Column(nullable = false)</span></span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="meta">@Column(nullable = false)</span></span><br><span class="line">	<span class="keyword">private</span> String password;</span><br><span class="line">	<span class="keyword">private</span> String phone;</span><br><span class="line">	<span class="meta">@Column(name = &quot;real_name&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String realName;</span><br><span class="line">	<span class="keyword">private</span> String gender;</span><br><span class="line">	<span class="keyword">private</span> Date birthday;</span><br><span class="line">	<span class="meta">@Column(name = &quot;register_time&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Date registerTime;</span><br><span class="line">	<span class="meta">@Column(nullable = false,columnDefinition = &quot;varchar(5) COMMENT &#x27;çŠ¶æ€ æ­£å¸¸0 ç¦ç”¨1&#x27;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String status;</span><br><span class="line">	<span class="keyword">private</span> String image;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="dao"><a href="#dao" class="headerlink" title="dao"></a>dao</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">User</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="main"><a href="#main" class="headerlink" title="main"></a>main</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CmsApplication</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(CmsApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="test"><a href="#test" class="headerlink" title="test"></a>test</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestJPA</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserDao userDao;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		User user = <span class="keyword">new</span> User();</span><br><span class="line">		user.setUsername(<span class="string">&quot;vanse&quot;</span>);</span><br><span class="line">		user.setPassword(<span class="string">&quot;000&quot;</span>);</span><br><span class="line">		user.setStatus(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">		userDao.save(user);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		List&lt;User&gt; userList = userDao.findAll();</span><br><span class="line">		System.out.println(userList);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="service"><a href="#service" class="headerlink" title="service"></a>service</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">------------------------</span><br><span class="line"> <span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserDao userDao;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		List&lt;User&gt; userList = userDao.findAll();</span><br><span class="line">		<span class="keyword">return</span> userList;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserService userService;</span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/findAll&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userService.findAll();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¯åŠ¨é¡¹ç›®"><a href="#å¯åŠ¨é¡¹ç›®" class="headerlink" title="å¯åŠ¨é¡¹ç›®"></a>å¯åŠ¨é¡¹ç›®</h2><p><a href="http://localhost:9999/user/findAll">è®¿é—®è·¯å¾„</a></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;vanse&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;phone&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;realName&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;gender&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;birthday&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;registerTime&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;image&quot;</span>: <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>



<h2 id="çƒ­éƒ¨ç½²"><a href="#çƒ­éƒ¨ç½²" class="headerlink" title="çƒ­éƒ¨ç½²"></a>çƒ­éƒ¨ç½²</h2><p>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- çƒ­éƒ¨ç½² --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- optional=true, ä¾èµ–ä¸ä¼šä¼ é€’, è¯¥é¡¹ç›®ä¾èµ–devtools; ä¹‹åä¾èµ–booté¡¹ç›®çš„é¡¹ç›®å¦‚æœæƒ³è¦ä½¿ç”¨devtools, </span></span><br><span class="line"><span class="comment">				éœ€è¦é‡æ–°å¼•å…¥ --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># çƒ­éƒ¨ç½²</span></span><br><span class="line"><span class="meta">spring.devtools.restart.enabled</span>=<span class="string">true   </span></span><br><span class="line"><span class="meta">spring.devtools.restart.additional-paths</span>=<span class="string">src/main/java </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#è¿”å›jsonçš„å…¨å±€æ—¶é—´æ ¼å¼ å¦‚æœè®¾ç½®å…¨å±€ ç”Ÿæ—¥ä¹Ÿå¾—æ˜¯è¿™ä¸ªæ ¼å¼</span></span><br><span class="line"><span class="comment">#spring.jackson.date-format=yyyy-MM-dd HH:mm:ss</span></span><br><span class="line"><span class="comment">#spring.jackson.time-zone=GMT+8</span></span><br></pre></td></tr></table></figure>







<p><code>é—®é¢˜</code></p>
<p>å‰åç«¯åˆ†ç¦»çš„æƒ…å†µä¸‹ï¼Œæ•°æ®å¯¹æ¥ã€‚</p>
<hr>
<h1 id="swagger"><a href="#swagger" class="headerlink" title="swagger"></a>swagger</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><blockquote>
<p>é¡¹ç›®é‡‡ç”¨å‰åå°åˆ†ç¦»çš„æ¶æ„è¿›è¡Œå¼€å‘ï¼Œåå°å¯ä»¥ä½¿ç”¨Swaggerï¼Œç”Ÿæˆåœ¨çº¿APIæ–‡æ¡£ï¼Œæ–¹ä¾¿å‰ç«¯äººå‘˜å¯¹æ¥ä½¿ç”¨</p>
</blockquote>
<p><code>Swagger </code>æ˜¯ä¸€ä¸ªè§„èŒƒå’Œå®Œæ•´çš„æ¡†æ¶ï¼Œç”¨äºç”Ÿæˆã€æè¿°ã€è°ƒç”¨å’Œå¯è§†åŒ– RESTful é£æ ¼çš„ Web æœåŠ¡ã€‚</p>
<p><a href="https://swagger.io/">Swaggerå®˜ç½‘</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20211110235217141.png" alt="image-20211110235217141"></p>
<p><a href="https://petstore.swagger.io/?_ga=2.236238660.419502645.1636559508-49422942.1636559508">é…ç½®ç”Ÿæˆçš„åœ¨çº¿APIæ–‡æ¡£æ ·ä¾‹ï¼š</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20211110235430680.png" alt="image-20211110235430680"></p>
<p><code>springfox </code>ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„API Docçš„æ¡†æ¶ï¼Œ å®ƒçš„å‰èº«æ˜¯swagger-springmvcï¼Œå¯ä»¥å°†æˆ‘ä»¬çš„Controllerä¸­<br>çš„æ–¹æ³•ä»¥æ–‡æ¡£çš„å½¢å¼å±•ç°ã€‚</p>
<p><a href="http://springfox.github.io/springfox/">springfoxå®˜ç½‘</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20211110235736768.png" alt="image-20211110235736768"></p>
<p><code>springfox-swagger2 </code>ï¼Œå®ƒæ˜¯æ•´åˆspringmvcå’Œswagger2çš„ä¸€ä¸ªé¡¹ç›®ï¼Œé¡¹ç›®ä¸­ä½¿ç”¨swaggeræ—¶ï¼Œè¦å¼•å…¥å®ƒ<br>çš„<a href="https://mvnrepository.com/artifact/io.springfox/springfox-swagger2">ä¾èµ–</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20211110235947547.png" alt="image-20211110235947547"></p>
<h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>swagger-demo</p>
<h2 id="æ•´åˆ"><a href="#æ•´åˆ" class="headerlink" title="æ•´åˆ"></a>æ•´åˆ</h2><h3 id="pom-1"><a href="#pom-1" class="headerlink" title="pom"></a>pom</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- swagger-uiä¾èµ–--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--swaggerä¾èµ– --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.swagger<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-models<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.swagger<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-models<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.PathSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Contact;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Swagger2Config</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ApiSelectorBuilder select() apié€‰æ‹©å™¨</span></span><br><span class="line">	<span class="comment">// æŒ‡å®šå¤„ç†å™¨ ä»»ä½•è·¯å¾„</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Docket <span class="title">createDocket</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">				.apiInfo(apiInfo())</span><br><span class="line">				.select()</span><br><span class="line">				.apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.briup.cms.controller&quot;</span>))</span><br><span class="line">				.paths(PathSelectors.any())</span><br><span class="line">				.build();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// swaggeré¡µé¢ä¸­æ˜¾ç¤ºçš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">	<span class="comment">//@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">				.title(<span class="string">&quot;cms&quot;</span>)</span><br><span class="line">				.description(<span class="string">&quot;æ–°é—»å‘å¸ƒç³»ç»Ÿ&quot;</span>)</span><br><span class="line">				.version(<span class="string">&quot;1.0&quot;</span>)</span><br><span class="line">				.contact(<span class="keyword">new</span> Contact(<span class="string">&quot;vanse&quot;</span>, <span class="string">&quot;http://wangsidandan.github.io&quot;</span>, <span class="string">&quot;wangsidandan@gmail.com&quot;</span>))</span><br><span class="line">				.build();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œswaggerä¸­åŸºæœ¬éƒ½æ˜¯å›ºå®šçš„é…ç½®ï¼ŒæŒ‰ç…§è‡ªå·±çš„é¡¹ç›®æƒ…å†µï¼Œè¿›è¡Œä¿®æ”¹å­—ç¬¦ä¸²å˜é‡å³å¯</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20211111101837824.png" alt="image-20211111101837824"></p>
<p><code>é—®é¢˜</code></p>
<p>å‰ç«¯åŒäº‹å¯çœ‹æ¥å£ï¼Œä½†æ˜¯ä¸æ˜å…¶æ„ã€‚</p>
<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p><strong>UserController.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="comment">// æ¨¡å—æ³¨é‡Š</span></span><br><span class="line"><span class="meta">@Api(tags  = &quot;ç”¨æˆ·æ¨¡å—&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserService userService;</span><br><span class="line">	</span><br><span class="line">       <span class="comment">// æ–¹æ³•æ³¨é‡Š</span></span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·&quot;,notes = &quot;ä¸éœ€è¦å‚æ•°&quot;)</span></span><br><span class="line">	<span class="meta">@GetMapping</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userService.findAll();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;æ ¹æ®idæŸ¥æ‰¾ç”¨æˆ·&quot;,notes = &quot;éœ€è¦å‚æ•°id&quot;)</span></span><br><span class="line">        <span class="comment">// resté£æ ¼</span></span><br><span class="line">	<span class="meta">@GetMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">findById</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;id&quot;,value = &quot;ç”¨æˆ·id&quot;,required = true)</span> </span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@PathVariable(&quot;id&quot;)</span> </span></span></span><br><span class="line"><span class="params"><span class="function">			Integer id)</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">		<span class="keyword">return</span> userService.findById(id);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>UserService</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">User <span class="title">findById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>UserServiceImpl</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserDao userDao;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		List&lt;User&gt; userList = userDao.findAll();</span><br><span class="line">		<span class="keyword">return</span> userList;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * getOne: æ‡’åŠ è½½</span></span><br><span class="line"><span class="comment">	 * 		å¦‚æœæ˜¯æ‡’åŠ è½½ï¼Œæ­¤æ—¶è¿”å›jsonæ•°æ®ä¼šæŠ¥é”™</span></span><br><span class="line"><span class="comment">	 * 		éœ€è¦åœ¨å®ä½“ç±»ä¸Šåšå¤„ç† @JsonIgnoreProperties(&#123;&quot;hibernateLazyInitializer&quot;,&quot;handler&quot;&#125;)</span></span><br><span class="line"><span class="comment">	 * findByIdï¼šåŠæ—¶ åŠ è½½</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">findById</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// æ‡’åŠ è½½</span></span><br><span class="line">		<span class="comment">//User user = userDao.getOne(id);</span></span><br><span class="line">		<span class="comment">// åŠæ—¶åŠ è½½   </span></span><br><span class="line">		User user = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			user = userDao.findById(id).get(); <span class="comment">// å¦‚æœidä¸å­˜åœ¨ ä¼šæŠ¥é”™</span></span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_NONE);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> user;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20211111124209738.png" alt="image-20211111124209738"></p>
<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><ul>
<li>å‰åç«¯éœ€è¦ç»Ÿä¸€è¿”å›æ ¼å¼</li>
<li>æŠ›å‡ºå¼‚å¸¸æ•°æ®éœ€è¦å¤„ç†</li>
</ul>
<h1 id="å“åº”æ•°æ®"><a href="#å“åº”æ•°æ®" class="headerlink" title="å“åº”æ•°æ®"></a>å“åº”æ•°æ®</h1><p>å¯¼å…¥å·¥å…·ç±»  <strong>Resultå’ŒResultCode</strong></p>
<p>Result</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»Ÿä¸€Controllerä¸­RESTFulé£æ ¼æ¥å£è¿”å›çš„ç»“æœ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Result</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Integer code;</span><br><span class="line">	<span class="keyword">private</span> String msg;</span><br><span class="line">	<span class="keyword">private</span> Object data;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">Result</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">Result</span><span class="params">(Integer code, String msg)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.code = code;</span><br><span class="line">		<span class="keyword">this</span>.msg = msg;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setResultCode</span><span class="params">(ResultCode code)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.code = code.code();</span><br><span class="line">		<span class="keyword">this</span>.msg = code.message();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æ“ä½œå¤±è´¥ï¼Œè‡ªå®šä¹‰codeå’Œmsg</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">failure</span><span class="params">(Integer code, String msg)</span> </span>&#123;</span><br><span class="line">		Result result = <span class="keyword">new</span> Result(code,msg);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æ“ä½œæˆåŠŸï¼Œæ²¡æœ‰è¿”å›çš„æ•°æ®</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">success</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Result result = <span class="keyword">new</span> Result();</span><br><span class="line">		result.setResultCode(ResultCode.SUCCESS);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æ“ä½œæˆåŠŸï¼Œæœ‰è¿”å›çš„æ•°æ®</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">success</span><span class="params">(Object data)</span> </span>&#123;</span><br><span class="line">		Result result = <span class="keyword">new</span> Result();</span><br><span class="line">		result.setResultCode(ResultCode.SUCCESS);</span><br><span class="line">		result.setData(data);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æ“ä½œå¤±è´¥ï¼Œæ²¡æœ‰è¿”å›çš„æ•°æ®</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">failure</span><span class="params">(ResultCode resultCode)</span> </span>&#123;</span><br><span class="line">		Result result = <span class="keyword">new</span> Result();</span><br><span class="line">		result.setResultCode(resultCode);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æ“ä½œå¤±è´¥ï¼Œæœ‰è¿”å›çš„æ•°æ®</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">failure</span><span class="params">(ResultCode resultCode, Object data)</span> </span>&#123;</span><br><span class="line">		Result result = <span class="keyword">new</span> Result();</span><br><span class="line">		result.setResultCode(resultCode);</span><br><span class="line">		result.setData(data);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> code;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(Integer code)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.code = code;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> msg;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMsg</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.msg = msg;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">getData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> data;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(Object data)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.data = data;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ResultCode</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»Ÿä¸€å¹¶è‡ªå®šä¹‰è¿”å›çŠ¶æ€ç ï¼Œå¦‚æœ‰éœ€æ±‚å¯ä»¥å¦å¤–å¢åŠ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">ResultCode</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* æˆåŠŸçŠ¶æ€ç  */</span></span><br><span class="line">	SUCCESS(<span class="number">1</span>, <span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* å‚æ•°é”™è¯¯ï¼š10001-19999 */</span></span><br><span class="line">	PARAM_IS_INVALID(<span class="number">10001</span>, <span class="string">&quot;å‚æ•°æ— æ•ˆ&quot;</span>),</span><br><span class="line">	PARAM_IS_BLANK(<span class="number">10002</span>, <span class="string">&quot;å‚æ•°ä¸ºç©º&quot;</span>),</span><br><span class="line">	PARAM_TYPE_BIND_ERROR(<span class="number">10003</span>, <span class="string">&quot;å‚æ•°ç±»å‹é”™è¯¯&quot;</span>),</span><br><span class="line">	PARAM_NOT_COMPLETE(<span class="number">10004</span>, <span class="string">&quot;å‚æ•°ç¼ºå¤±&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* ç”¨æˆ·é”™è¯¯ï¼š20001-29999*/</span></span><br><span class="line">	USER_NOT_LOGIN(<span class="number">20001</span>, <span class="string">&quot;ç”¨æˆ·æœªç™»å½•&quot;</span>),</span><br><span class="line">	USER_LOGIN_ERROR(<span class="number">20002</span>, <span class="string">&quot;è´¦å·ä¸å­˜åœ¨æˆ–å¯†ç é”™è¯¯&quot;</span>),</span><br><span class="line">	USER_ACCOUNT_FORBIDDEN(<span class="number">20003</span>, <span class="string">&quot;è´¦å·å·²è¢«ç¦ç”¨&quot;</span>),</span><br><span class="line">	USER_NOT_EXIST(<span class="number">20004</span>, <span class="string">&quot;ç”¨æˆ·ä¸å­˜åœ¨&quot;</span>),</span><br><span class="line">	USER_HAS_EXISTED(<span class="number">20005</span>, <span class="string">&quot;ç”¨æˆ·å·²å­˜åœ¨&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* ä¸šåŠ¡é”™è¯¯ï¼š30001-39999 */</span></span><br><span class="line">	SPECIFIED_QUESTIONED_USER_NOT_EXIST(<span class="number">30001</span>, <span class="string">&quot;ä¸šåŠ¡é€»è¾‘å‡ºç°é—®é¢˜&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* ç³»ç»Ÿé”™è¯¯ï¼š40001-49999 */</span></span><br><span class="line">	SYSTEM_INNER_ERROR(<span class="number">40001</span>, <span class="string">&quot;ç³»ç»Ÿå†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* æ•°æ®é”™è¯¯ï¼š50001-599999 */</span></span><br><span class="line">	DATA_NONE(<span class="number">50001</span>, <span class="string">&quot;æ•°æ®æœªæ‰¾åˆ°&quot;</span>),</span><br><span class="line">	DATA_WRONG(<span class="number">50002</span>, <span class="string">&quot;æ•°æ®é”™è¯¯&quot;</span>),</span><br><span class="line">	DATA_EXISTED(<span class="number">50003</span>, <span class="string">&quot;æ•°æ®å·²å­˜åœ¨&quot;</span>),</span><br><span class="line">	DATA_USEING(<span class="number">50004</span>,<span class="string">&quot;è¯¥æ•°æ®æ­£åœ¨è¢«å¼•ç”¨&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* æ¥å£é”™è¯¯ï¼š60001-69999 */</span></span><br><span class="line">	INTERFACE_INNER_INVOKE_ERROR(<span class="number">60001</span>, <span class="string">&quot;å†…éƒ¨ç³»ç»Ÿæ¥å£è°ƒç”¨å¼‚å¸¸&quot;</span>),</span><br><span class="line">	INTERFACE_OUTTER_INVOKE_ERROR(<span class="number">60002</span>, <span class="string">&quot;å¤–éƒ¨ç³»ç»Ÿæ¥å£è°ƒç”¨å¼‚å¸¸&quot;</span>),</span><br><span class="line">	INTERFACE_FORBID_VISIT(<span class="number">60003</span>, <span class="string">&quot;è¯¥æ¥å£ç¦æ­¢è®¿é—®&quot;</span>),</span><br><span class="line">	INTERFACE_ADDRESS_INVALID(<span class="number">60004</span>, <span class="string">&quot;æ¥å£åœ°å€æ— æ•ˆ&quot;</span>),</span><br><span class="line">	INTERFACE_REQUEST_TIMEOUT(<span class="number">60005</span>, <span class="string">&quot;æ¥å£è¯·æ±‚è¶…æ—¶&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* æƒé™é”™è¯¯ï¼š70001-79999 */</span></span><br><span class="line">	PERMISSION_NO_ACCESS(<span class="number">70001</span>, <span class="string">&quot;æ— è®¿é—®æƒé™&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Integer code;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">	ResultCode(Integer code, String message) &#123;</span><br><span class="line">		<span class="keyword">this</span>.code = code;</span><br><span class="line">		<span class="keyword">this</span>.message = message;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">code</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.code;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">message</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.message;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;code&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;msg&quot;</span>: <span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;data&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;vanse&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;phone&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;realName&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;gender&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;birthday&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;registerTime&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;image&quot;</span>: <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>é—®é¢˜</code></p>
<p>å¦‚æœå¼‚å¸¸ï¼Œç»Ÿä¸€å“åº”æ ¼å¼å¤±æ•ˆ</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;timestamp&quot;</span>: <span class="string">&quot;2021-11-11T06:00:16.631+0000&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;status&quot;</span>: <span class="number">500</span>,</span><br><span class="line">  <span class="attr">&quot;error&quot;</span>: <span class="string">&quot;Internal Server Error&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;message&quot;</span>: <span class="string">&quot;/ by zero&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;path&quot;</span>: <span class="string">&quot;/user/1&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="å…¨å±€å¼‚å¸¸"><a href="#å…¨å±€å¼‚å¸¸" class="headerlink" title="å…¨å±€å¼‚å¸¸"></a>å…¨å±€å¼‚å¸¸</h1><h2 id="é»˜è®¤å¼‚å¸¸"><a href="#é»˜è®¤å¼‚å¸¸" class="headerlink" title="é»˜è®¤å¼‚å¸¸"></a>é»˜è®¤å¼‚å¸¸</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobleExceptionHandler</span> </span>&#123;</span><br><span class="line">	<span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">handler</span><span class="params">(Exception e)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> Result.failure(<span class="number">500</span>, <span class="string">&quot;æœåŠ¡å™¨å¼‚å¸¸: &quot;</span> + e.getMessage());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="è‡ªå®šä¹‰å¼‚å¸¸"><a href="#è‡ªå®šä¹‰å¼‚å¸¸" class="headerlink" title="è‡ªå®šä¹‰å¼‚å¸¸"></a>è‡ªå®šä¹‰å¼‚å¸¸</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// throw new CustomerException(&quot;&quot;);</span></span><br><span class="line"><span class="comment">// throw new CustomerException(ResultCode.failure)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	<span class="keyword">private</span> ResultCode resultCode;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CustomerException</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(message);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CustomerException</span><span class="params">(ResultCode resultCode)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//this(resultCode.message());</span></span><br><span class="line">		<span class="keyword">this</span>.resultCode = resultCode;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> ResultCode <span class="title">getResultCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> resultCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setResultCode</span><span class="params">(ResultCode resultCode)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.resultCode = resultCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//new CustomerException(&quot;&quot;);</span></span><br><span class="line">		<span class="keyword">new</span> CustomerException(ResultCode.DATA_EXISTED);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ”¹é€  GlobleExceptionHandler</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobleExceptionHandler</span> </span>&#123;</span><br><span class="line">	<span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">handler</span><span class="params">(Exception e)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(e <span class="keyword">instanceof</span> CustomerException) &#123;</span><br><span class="line">			<span class="comment">// new CustomerException(ResultCode.DATA_EXISTED) å¯¹æ–¹æŠ›å‡ºResultCode</span></span><br><span class="line">			<span class="comment">// å…¨å±€æ•è·åˆ°ResultCode</span></span><br><span class="line">			<span class="keyword">return</span> Result.failure( ((CustomerException)e).getResultCode() );</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> Result.failure(<span class="number">500</span>, <span class="string">&quot;æœåŠ¡å™¨å¼‚å¸¸: &quot;</span> + e.getMessage());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ ¹æ®idæŸ¥æ‰¾ç”¨æˆ·&quot;,notes = &quot;éœ€è¦å‚æ•°id&quot;)</span></span><br><span class="line">	<span class="meta">@GetMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">findById</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;id&quot;,value = &quot;ç”¨æˆ·id&quot;,required = true)</span> </span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@PathVariable(&quot;id&quot;)</span> </span></span></span><br><span class="line"><span class="params"><span class="function">			Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(id &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_NONE);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> Result.success(userService.findById(id));</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;code&quot;</span>: <span class="number">50001</span>,</span><br><span class="line">  <span class="attr">&quot;msg&quot;</span>: <span class="string">&quot;æ•°æ®æœªæ‰¾åˆ°&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;data&quot;</span>: <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="ç”¨æˆ·æ¨¡å—-1"><a href="#ç”¨æˆ·æ¨¡å—-1" class="headerlink" title="ç”¨æˆ·æ¨¡å—"></a>ç”¨æˆ·æ¨¡å—</h1><h2 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.service;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserService</span> </span>&#123;</span><br><span class="line">		<span class="comment">//åˆ†é¡µè·å–æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">		<span class="function">Page&lt;User&gt; <span class="title">getAll</span><span class="params">(Integer pageNum,Integer pageSize)</span></span>;</span><br><span class="line">		<span class="comment">//æ–°å¢ç”¨æˆ·ä¿¡æ¯æˆ–è€…æ›´æ–°å­¦ç”Ÿä¿¡æ¯</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">saveOrUpdateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">		<span class="comment">//æ‰¹é‡åˆ é™¤ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">deleteUserInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span></span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//ä¿®æ”¹ç”¨æˆ·çš„çŠ¶æ€</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">updateUserStatus</span><span class="params">(Integer id,String status)</span></span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//ç™»å½•</span></span><br><span class="line">		<span class="function">User <span class="title">login</span><span class="params">(String username,String password)</span></span>;</span><br><span class="line">		<span class="comment">//æ ¹æ®ç”¨æˆ·åè·å–ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">		<span class="function">User <span class="title">findUserByUsername</span><span class="params">(String username)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="æ–°å¢-æ›´æ–°"><a href="#æ–°å¢-æ›´æ–°" class="headerlink" title="æ–°å¢/æ›´æ–°"></a>æ–°å¢/æ›´æ–°</h2><h3 id="UserServiceImpl"><a href="#UserServiceImpl" class="headerlink" title="UserServiceImpl"></a>UserServiceImpl</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveOrUpdateUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// useréƒ¨åˆ†æ•°æ®åå°å¤„ç†</span></span><br><span class="line">		user.setRegisterTime(<span class="keyword">new</span> Date());</span><br><span class="line">		user.setStatus(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">		userDao.save(user);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="UserController"><a href="#UserController" class="headerlink" title="UserController"></a>UserController</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ’å…¥æˆ–æ›´æ–°&quot;,notes = &quot;æœ‰id:æ›´æ–° æ— id:æ’å…¥&quot;)</span></span><br><span class="line">	<span class="meta">@PostMapping</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">saveOrUpdateUser</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> </span>&#123;</span><br><span class="line">		userService.saveOrUpdateUser(user);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Useréœ€è¦æ›´æ”¹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç”Ÿæ—¥åªæœ‰å¹´æœˆæ—¥ è½¬æ¢æ—¥æœŸæ ¼å¼ï¼Œåªè¦æ—¥æœŸå³å¯</span></span><br><span class="line"><span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;,timezone=&quot;GMT+8&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Date birthday;</span><br></pre></td></tr></table></figure>



<h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"># æ·»åŠ </span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;birthday&quot;</span>: <span class="string">&quot;2000-11-04&quot;</span>,  # åå°æ—¶é—´æ¨¡å¼ä¸º yyyy-MM-dd  æ³¨æ„è¡¥å…¨</span><br><span class="line">  <span class="attr">&quot;gender&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;phone&quot;</span>: <span class="string">&quot;110&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;realName&quot;</span>: <span class="string">&quot;tom&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;è¿½é£å°‘å¹´&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>é—®é¢˜</code></p>
<p>å‰ç«¯åŒäº‹ä¸çŸ¥é“å­—æ®µå«ä¹‰ ä¸çŸ¥é“å“ªäº›å¿…é¡»ä¼ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;cms_user&quot;)</span></span><br><span class="line"><span class="meta">@ApiModel(&quot;ç”¨æˆ·æ¨¡å‹&quot;)</span></span><br><span class="line"><span class="comment">// è§£å†³æ‡’åŠ è½½è¿”å›nullæŠ¥é”™çš„é—®é¢˜</span></span><br><span class="line"><span class="meta">@JsonIgnoreProperties(&#123;&quot;hibernateLazyInitializer&quot;,&quot;handler&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;id&quot;,value = &quot;ç”¨æˆ·id,ä¸åŠ ä¸ºæ–°å¢,æ·»åŠ ä¸ºä¿®æ”¹&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;username&quot;,value = &quot;ç”¨æˆ·å&quot;,required = true,example = &quot;vanse&quot;)</span></span><br><span class="line">	<span class="meta">@Column(nullable = false)</span></span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;password&quot;,value = &quot;å¯†ç &quot;,required = true,example = &quot;000&quot;)</span></span><br><span class="line">	<span class="meta">@Column(nullable = false)</span></span><br><span class="line">	<span class="keyword">private</span> String password;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;phone&quot;,value = &quot;æ‰‹æœºå·&quot;,required = true,example = &quot;175********&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String phone;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;realName&quot;,value = &quot;çœŸå®å§“å&quot;,required = true,example = &quot;è€åˆ˜&quot;)</span></span><br><span class="line">	<span class="meta">@Column(name = &quot;real_name&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String realName;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;gender&quot;,value = &quot;æ€§åˆ«&quot;,required = true,example = &quot;0&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String gender;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// ç”Ÿæ—¥åªæœ‰å¹´æœˆæ—¥</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;birthday&quot;,value = &quot;ç”Ÿæ—¥&quot;,required = true,example = &quot;1900-01-12&quot;)</span></span><br><span class="line">	<span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;,timezone=&quot;GMT+8&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Date birthday;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(hidden = true)</span></span><br><span class="line">	<span class="meta">@Column(name = &quot;register_time&quot;)</span></span><br><span class="line">    <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;,timezone=&quot;GMT+8&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Date registerTime;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(nullable = false,columnDefinition = &quot;varchar(5) COMMENT &#x27;çŠ¶æ€ æ­£å¸¸0 ç¦ç”¨1&#x27;&quot;)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;çŠ¶æ€&quot;,value = &quot;é»˜è®¤ä¸º0,æ·»åŠ ä¸éœ€è¦&quot;,example = &quot;1&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String status;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;image&quot;,value = &quot;å›¾ç‰‡è·¯å¾„&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String image;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="https://gitee.com/vanse/images/raw/master/cms/image-20211111153006270.png" alt="image-20211111153006270" style="zoom:50%;" />

<h3 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveOrUpdateUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(user.getId() == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="comment">// useréƒ¨åˆ†æ•°æ®åå°å¤„ç†</span></span><br><span class="line">			user.setRegisterTime(<span class="keyword">new</span> Date());</span><br><span class="line">			user.setStatus(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">			userDao.save(user);</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">// é€‰æ‹©æ€§æ›´æ–° å¯èƒ½ä¸¢å¤±æ³¨å†Œæ—¶é—´</span></span><br><span class="line">			User target = findById(user.getId());</span><br><span class="line">			NotNullNameUtil.getNotNullNames(user, target);</span><br><span class="line">			userDao.save(target);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">---------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NotNullNameUtil</span> </span>&#123;</span><br><span class="line">	<span class="comment">// è·å–å¯¹è±¡çš„å€¼ä¸ºç©ºçš„ å±æ€§æ•°ç»„</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getNotNullNames</span><span class="params">(Object source,Object target)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">final</span> BeanWrapper src = <span class="keyword">new</span> BeanWrapperImpl(source);</span><br><span class="line">		java.beans.PropertyDescriptor[] pds = src.getPropertyDescriptors();</span><br><span class="line"></span><br><span class="line">		Set&lt;String&gt; emptyNames = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">		<span class="keyword">for</span> (java.beans.PropertyDescriptor pd : pds) &#123;</span><br><span class="line">			Object srcValue = src.getPropertyValue(pd.getName());</span><br><span class="line">			<span class="keyword">if</span> (srcValue == <span class="keyword">null</span>)</span><br><span class="line">				emptyNames.add(pd.getName());</span><br><span class="line">		&#125;</span><br><span class="line">        	<span class="comment">// è¿”å›ç©ºå±æ€§æ•°ç»„</span></span><br><span class="line">		String[] names = emptyNames.toArray(<span class="keyword">new</span> String[emptyNames.size()]);</span><br><span class="line">        	<span class="comment">// å¤åˆ¶å¯¹è±¡æ—¶å¿½è§†å±æ€§</span></span><br><span class="line">		BeanUtils.copyProperties(source, target,names);</span><br><span class="line">		<span class="keyword">return</span> target;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="comment">//  &quot;birthday&quot;: &quot;1900-01-12&quot;,</span></span><br><span class="line">  <span class="string">&quot;gender&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: <span class="number">3</span>,</span><br><span class="line">   <span class="comment">// &quot;image&quot;: &quot;string&quot;,</span></span><br><span class="line">  <span class="string">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">  <span class="string">&quot;phone&quot;</span>: <span class="string">&quot;175********&quot;</span>,</span><br><span class="line">  <span class="string">&quot;realName&quot;</span>: <span class="string">&quot;è€åˆ˜&quot;</span>,</span><br><span class="line">  <span class="string">&quot;status&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">  <span class="string">&quot;username&quot;</span>: <span class="string">&quot;wangsidandan&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="ä¿®æ”¹æ–°å¢"><a href="#ä¿®æ”¹æ–°å¢" class="headerlink" title="ä¿®æ”¹æ–°å¢"></a>ä¿®æ”¹æ–°å¢</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveOrUpdateUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(user.getId() == <span class="keyword">null</span>) &#123;</span><br><span class="line">			String username = user.getUsername();</span><br><span class="line">			<span class="comment">// å‚æ•°ä¸èƒ½ä¸ºç©º</span></span><br><span class="line">			<span class="keyword">if</span> (username == <span class="keyword">null</span> || <span class="string">&quot;&quot;</span>.equals(username.trim())) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.PARAM_IS_BLANK);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// å§“åä¸èƒ½é‡å¤</span></span><br><span class="line">			User userFromDB = findUserByUsername(username);</span><br><span class="line">			<span class="keyword">if</span> (userFromDB != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_EXISTED);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// useréƒ¨åˆ†æ•°æ®åå°å¤„ç†</span></span><br><span class="line">			user.setRegisterTime(<span class="keyword">new</span> Date());</span><br><span class="line">			user.setStatus(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">			userDao.save(user);</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">// é€‰æ‹©æ€§æ›´æ–° å¯èƒ½ä¸¢å¤±æ³¨å†Œæ—¶é—´</span></span><br><span class="line">			User target = findById(user.getId());</span><br><span class="line">			BeanUtils.copyProperties(user, target,ObjectNullNames.getNullPropertyNames(user));</span><br><span class="line">			userDao.save(target);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">-------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">User</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	<span class="function">User <span class="title">findByUsername</span><span class="params">(String username)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><code>æ€»ç»“</code></h3><ul>
<li><p>æ–°å¢</p>
<ul>
<li>æ ¡éªŒ è‡ªå®šä¹‰å¼‚å¸¸</li>
<li>éƒ¨åˆ†æ•°æ®åå°å¤„ç†</li>
</ul>
</li>
<li><p>æ›´æ–°</p>
<ul>
<li>é€‰æ‹©æ€§æ›´æ–°</li>
</ul>
</li>
</ul>
<h2 id="åˆ†é¡µ"><a href="#åˆ†é¡µ" class="headerlink" title="åˆ†é¡µ"></a>åˆ†é¡µ</h2><h3 id="UserServiceImpl-1"><a href="#UserServiceImpl-1" class="headerlink" title="UserServiceImpl"></a>UserServiceImpl</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Page&lt;User&gt; <span class="title">getAll</span><span class="params">(Integer pageNum, Integer pageSize)</span> </span>&#123;</span><br><span class="line">		Pageable pageable = PageRequest.of(pageNum, pageSize);</span><br><span class="line">		<span class="keyword">return</span> userDao.findAll(pageable);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UserController-1"><a href="#UserController-1" class="headerlink" title="UserController"></a>UserController</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;åˆ†é¡µæŸ¥æ‰¾ç”¨æˆ·&quot;,notes = &quot;éœ€è¦å½“å‰ä¹Ÿå’Œæ¯é¡µæ¡æ•°&quot;)</span></span><br><span class="line">	<span class="meta">@GetMapping(&quot;&#123;pageNum&#125;/&#123;pageSize&#125;&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">findByPage</span><span class="params">(	</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;pageNum&quot;,value = &quot;å½“å‰é¡µ&quot;,required = true,defaultValue = &quot;0&quot;)</span>	 <span class="meta">@PathVariable(&quot;pageNum&quot;)</span> Integer pageNum,</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;pageSize&quot;,value = &quot;æ¯é¡µæ¡æ•°&quot;,required = true,defaultValue = &quot;5&quot;)</span>  <span class="meta">@PathVariable(&quot;pageSize&quot;)</span> Integer pageSize)</span> </span>&#123;</span><br><span class="line">		Page&lt;User&gt; page = userService.getAll(pageNum, pageSize);</span><br><span class="line">		<span class="keyword">long</span> total = page.getTotalElements(); <span class="comment">// è·å–æ€»æ¡æ•°</span></span><br><span class="line">		List&lt;User&gt; content = page.getContent();</span><br><span class="line">		Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">		map.put(<span class="string">&quot;total&quot;</span>, total);</span><br><span class="line">		map.put(<span class="string">&quot;content&quot;</span>, content);</span><br><span class="line">		<span class="keyword">return</span> Result.success(map);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;code&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;msg&quot;</span>: <span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;data&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;content&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;vanse&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;phone&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;realName&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;gender&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;birthday&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;registerTime&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;image&quot;</span>: <span class="literal">null</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="æ›´æ–°çŠ¶æ€"><a href="#æ›´æ–°çŠ¶æ€" class="headerlink" title="æ›´æ–°çŠ¶æ€"></a>æ›´æ–°çŠ¶æ€</h2><h3 id="UserServiceImpl-2"><a href="#UserServiceImpl-2" class="headerlink" title="UserServiceImpl"></a>UserServiceImpl</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°çŠ¶æ€</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUserStatus</span><span class="params">(Integer id, String status)</span> </span>&#123;</span><br><span class="line">        	<span class="comment">// æ­¤å¤„æ— é¡»é¢å¤–å¤„ç†  è¯¥æ–¹æ³•å·²ç»æœ‰å¼‚å¸¸å¤„ç†</span></span><br><span class="line">		User user = findById(id);</span><br><span class="line">		user.setStatus(status);</span><br><span class="line">		userDao.save(user);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UserController-2"><a href="#UserController-2" class="headerlink" title="UserController"></a>UserController</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ”¹å˜ç”¨æˆ·çŠ¶æ€&quot;,notes = &quot;éœ€è¦ç”¨æˆ·idå’Œç”¨æˆ·çŠ¶æ€å‚æ•°&quot;)</span></span><br><span class="line">	<span class="meta">@PutMapping(&quot;&#123;id&#125;/&#123;status&#125;&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">saveOrUpdateUser</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;id&quot;,value = &quot;ç”¨æˆ·id&quot;,required = true)</span>	<span class="meta">@PathVariable(&quot;id&quot;)</span>Integer id,</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;status&quot;,value = &quot;ç”¨æˆ·çŠ¶æ€&quot;,required = true)</span> <span class="meta">@PathVariable(&quot;status&quot;)</span>String status)</span> </span>&#123;</span><br><span class="line">		userService.updateUserStatus(id, status);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ‰¹é‡åˆ é™¤"><a href="#æ‰¹é‡åˆ é™¤" class="headerlink" title="æ‰¹é‡åˆ é™¤"></a>æ‰¹é‡åˆ é™¤</h2><h3 id="UserServiceImpl-3"><a href="#UserServiceImpl-3" class="headerlink" title="UserServiceImpl"></a>UserServiceImpl</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ‰¹é‡åˆ é™¤</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUserInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">		List&lt;User&gt; userList =  userDao.findAllById(ids);</span><br><span class="line">		<span class="keyword">if</span>(userList == <span class="keyword">null</span> || userList.size() == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_NONE);</span><br><span class="line">		&#125;</span><br><span class="line">		userDao.deleteInBatch(userList);	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="UserController-3"><a href="#UserController-3" class="headerlink" title="UserController"></a>UserController</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ‰¹é‡åˆ é™¤</span></span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;æ‰¹é‡åˆ é™¤&quot;,notes = &quot;éœ€è¦ä¼ é€’å¤šä¸ªid&quot;)</span></span><br><span class="line">	<span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">		@ApiImplicitParam(name = &quot;ids&quot;,value = &quot;å¤šä¸ªid&quot;,paramType = &quot;query&quot;,dataType = &quot;Integer&quot;,allowMultiple = true)</span></span><br><span class="line"><span class="meta">		&#125;)</span></span><br><span class="line">	<span class="meta">@DeleteMapping(&quot;/deleteBatch&quot;)</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 	@RequestParam(&quot;ids&quot;)</span></span><br><span class="line"><span class="comment">		@ApiParam(name = &quot;ids&quot;,value = &quot;æ‰¹é‡id&quot;,required = true)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">deleteBatch</span><span class="params">(<span class="meta">@RequestParam(&quot;ids&quot;)</span> List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// @ApiParam é»˜è®¤æ˜¯jsonæ ¼å¼</span></span><br><span class="line">		userService.deleteUserInBatch(ids);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h2><h3 id="UserServiceImpl-4"><a href="#UserServiceImpl-4" class="headerlink" title="UserServiceImpl"></a>UserServiceImpl</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">		User user = findUserByUsername(username);</span><br><span class="line">		<span class="keyword">if</span>(user == <span class="keyword">null</span> || !password.equals(user.getPassword())) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.USER_LOGIN_ERROR);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> user;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UserController-4"><a href="#UserController-4" class="headerlink" title="UserController"></a>UserController</h3><p>æ­¤å¤„å°†å‚æ•°æ‹¼æ¥åœ¨åœ°å€æ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç™»å½•</span></span><br><span class="line"><span class="meta">@ApiOperation(value = &quot;ç™»å½•&quot;,notes = &quot;ç”¨æˆ·åå’Œå¯†ç &quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">loign</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@RequestParam(&quot;username&quot;)</span></span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;username&quot;,value = &quot;ç”¨æˆ·å&quot;,required = true)</span>String username,</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@RequestParam(&quot;password&quot;)</span></span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;password&quot;,value = &quot;å¯†ç &quot;,required = true)</span>String password)</span> </span>&#123;</span><br><span class="line">	User user = userService.login(username, password);</span><br><span class="line">	<span class="keyword">return</span> Result.success(<span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç™»å½•</span></span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;ç™»å½•&quot;,notes = &quot;ç”¨æˆ·åå’Œå¯†ç &quot;)</span></span><br><span class="line">	<span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">			@ApiImplicitParam(name = &quot;username&quot;,value = &quot;ç”¨æˆ·å&quot;,paramType = &quot;form&quot;,dataType = &quot;string&quot;,defaultValue = &quot;wangsidandan&quot; ),</span></span><br><span class="line"><span class="meta">			@ApiImplicitParam(name = &quot;password&quot;,value = &quot;å¯†ç &quot;,paramType = &quot;form&quot;,dataType = &quot;string&quot;,defaultValue = &quot;000&quot; )&#125;)</span></span><br><span class="line">	<span class="meta">@PostMapping(value = &quot;/login&quot;,consumes = &quot;application/x-www-form-urlencoded&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">loign</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			String username,String password)</span> </span>&#123;</span><br><span class="line">		User user = userService.login(username, password);</span><br><span class="line">		<span class="keyword">return</span> Result.success(<span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span>);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼š<br><code>@Api</code> ï¼Œç”¨æ¥æŒ‡å®šå½“å‰APIæ¨¡å—çš„åç§°<br><code>@ApiOperation </code>ï¼Œç”¨æ¥è®¾ç½®APIæ–¹æ³•çš„ç®€ä»‹è¯´æ˜<br><code>@ApiImplicitParams</code> ï¼Œç”¨æ¥è®¾ç½®APIæ–¹æ³•çš„å‚æ•°ï¼Œå¯ä»¥æœ‰å¤šä¸ªå‚æ•°<br><code>@ApiImplicitParam </code>ï¼Œç”¨æ¥è®¾ç½®ä¸€ä¸ªå‚æ•°çš„è¯¦ç»†ä¿¡æ¯</p>
<ul>
<li>nameï¼Œå‚æ•°çš„åç§°</li>
<li>valueï¼Œå‚æ•°çš„ä»‹ç»</li>
<li>dataTypeï¼Œå‚æ•°çš„æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚String</li>
<li>requiredï¼Œæ˜¯å¦ä¸ºå¿…é¡»å‚æ•°</li>
<li>defaultValueï¼Œé»˜è®¤å¡«å…¥è¾“å…¥æ¡†çš„å€¼</li>
<li>paramTypeï¼Œå‚æ•°çš„ç±»å‹ï¼š<ul>
<li>path    /user/{id} </li>
<li>query /user?id=</li>
<li>body æ­£æ–‡</li>
<li>header è¯·æ±‚å¤´</li>
<li>form è¯·æ±‚è¡¨å•</li>
</ul>
</li>
</ul>
<h1 id="jwt"><a href="#jwt" class="headerlink" title="jwt"></a>jwt</h1><h2 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ä¼ ç»Ÿçš„Webåº”ç”¨ä¸­ï¼Œä½¿ç”¨sessionæ¥å­˜åœ¨ç”¨æˆ·çš„ä¿¡æ¯ï¼Œæ¯æ¬¡ç”¨æˆ·è®¤è¯é€šè¿‡ä»¥åï¼ŒæœåŠ¡å™¨éœ€è¦åˆ›å»ºä¸€æ¡è®°å½•<br>ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œé€šå¸¸æ˜¯åœ¨å†…å­˜ä¸­ã€‚</p>
<ul>
<li>éšç€è®¤è¯é€šè¿‡çš„ç”¨æˆ·è¶Šæ¥è¶Šå¤šï¼ŒæœåŠ¡å™¨çš„åœ¨è¿™é‡Œçš„å¼€é”€å°±ä¼šè¶Šæ¥è¶Šå¤§,</li>
<li>ç”±äºSessionæ˜¯åœ¨å†…å­˜ä¸­çš„ï¼Œè¿™å°±å¸¦æ¥ä¸€äº›æ‰©å±•æ€§çš„é—®é¢˜<ul>
<li>servletä¾èµ–äºwebå®¹å™¨    </li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210318005044861.png" alt="image-20210318005044861"></p>
<blockquote>
<p>JSON Web Token (JWT,tokençš„ä¸€ç§)ï¼Œæ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†(RFC 7519)ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘çš„ã€è‡ªåŒ…å«çš„æ–¹å¼ï¼Œç”¨äºä½œä¸ºJSONå¯¹è±¡åœ¨å„æ–¹ä¹‹é—´å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯å¯ä»¥è¢«éªŒè¯å’Œä¿¡ä»»ï¼Œå› ä¸ºå®ƒæ˜¯æ•°å­—ç­¾åçš„ã€‚</p>
</blockquote>
<ul>
<li>JWTå­˜æ”¾åœ¨å®¢æˆ·ç«¯ï¼ˆå‰ç«¯ï¼‰ï¼Œæ¯æ¬¡è¯·æ±‚çš„è¯·æ±‚å¤´ä¸­ï¼Œæºå¸¦æ­¤JWTå‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ç«¯è´Ÿè´£æ¥æ”¶<br>å’ŒéªŒè¯</li>
<li>æœåŠ¡å™¨ç«¯å¯ä»¥ä¸ç”¨å­˜å‚¨JWTï¼Œè¿™æ ·å¯ä»¥é™ä½æœåŠ¡å™¨çš„å†…å­˜çš„å¼€é”€</li>
<li>JWTå’Œè¯­è¨€æ— å…³ï¼Œæ‰©å±•èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œæ— è®ºæ˜¯PCç«¯è¿˜æ˜¯ç§»åŠ¨ç«¯ï¼Œéƒ½å¯ä»¥å¾ˆå®¹æ˜“çš„ä½¿ç”¨</li>
<li>ä¸å—cookieçš„é™åˆ¶</li>
</ul>
<p>å¦‚å›¾ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210318005232445.png" alt="image-20210318005232445"></p>
<blockquote>
<p>æ³¨æ„ï¼Œsessionå’ŒJWTçš„ä¸»è¦åŒºåˆ«å°±æ˜¯ä¿å­˜çš„ä½ç½®ï¼Œsessionæ˜¯ä¿å­˜åœ¨æœåŠ¡ç«¯çš„ï¼Œè€ŒJWTæ˜¯ä¿å­˜åœ¨å®¢æˆ·<br>ç«¯çš„</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼ŒJWTå°±æ˜¯ä¸€ä¸ªå›ºå®šæ ¼å¼çš„å­—ç¬¦ä¸²</p>
</blockquote>
<p><a href="https://jwt.io/">JWTå®˜ç½‘</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210318005358285.png" alt="image-20210318005358285"></p>
<h2 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h2><p>JWTå›ºå®šå„ç§çš„å­—ç¬¦ä¸²ï¼Œç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li>Headerï¼Œå¤´éƒ¨</li>
<li>Payloadï¼Œè½½è·</li>
<li>Signatureï¼Œç­¾å</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼ŒæŠŠè¿™ä¸‰éƒ¨åˆ†ä½¿ç”¨ç‚¹ï¼ˆ.ï¼‰è¿æ¥èµ·æ¥ï¼Œå°±æ˜¯ä¸€ä¸ªJWTå­—ç¬¦ä¸²</p>
</blockquote>
<p>å¦‚å›¾ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210319084618060.png" alt="image-20210319084618060"></p>
<h3 id="å¤´éƒ¨"><a href="#å¤´éƒ¨" class="headerlink" title="å¤´éƒ¨"></a>å¤´éƒ¨</h3><blockquote>
<p>headerä¸€èˆ¬çš„ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼štokençš„ç±»å‹ï¼ˆâ€œJWTâ€ï¼‰å’Œç®—æ³•åç§°ï¼ˆæ¯”å¦‚ï¼šHMAC SHA256æˆ–è€…RSAç­‰ç­‰ï¼‰ã€‚</p>
</blockquote>
<p>JWTé‡ŒéªŒè¯å’Œç­¾åä½¿ç”¨çš„ç®—æ³•åˆ—è¡¨å¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210319084933149.png" alt="image-20210319084933149"></p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;alg&quot;</span>: <span class="string">&quot;HS256&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;typ&quot;</span>: <span class="string">&quot;JWT&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è½½è·"><a href="#è½½è·" class="headerlink" title="è½½è·"></a>è½½è·</h3><blockquote>
<p>payloadä¸»è¦ç”¨æ¥åŒ…å«å£°æ˜ï¼ˆclaims ï¼‰ï¼Œè¿™ä¸ªå£°æ˜ä¸€èˆ¬æ˜¯å…³äºå®ä½“(é€šå¸¸æ˜¯ç”¨æˆ·)å’Œå…¶ä»–æ•°æ®çš„å£°æ˜ã€‚</p>
</blockquote>
<p>å£°æ˜æœ‰ä¸‰ç§ç±»å‹:</p>
<ul>
<li>registered</li>
<li>public</li>
<li>private</li>
</ul>
<p>å…·ä½“å¦‚ä¸‹ï¼š</p>
<p>Registered claims : è¿™é‡Œæœ‰ä¸€ç»„é¢„å®šä¹‰çš„å£°æ˜ï¼Œå®ƒä»¬ä¸æ˜¯å¼ºåˆ¶çš„ï¼Œä½†æ˜¯æ¨èã€‚</p>
<ul>
<li>iss: jwtç­¾å‘è€…</li>
<li>sub: jwtæ‰€é¢å‘çš„ç”¨æˆ·</li>
<li>aud: æ¥æ”¶jwtçš„ä¸€æ–¹</li>
<li>exp: jwtçš„è¿‡æœŸæ—¶é—´ï¼Œè¿™ä¸ªè¿‡æœŸæ—¶é—´å¿…é¡»è¦å¤§äºç­¾å‘æ—¶é—´ </li>
<li>nbf: å®šä¹‰åœ¨ä»€ä¹ˆæ—¶é—´ä¹‹å‰ï¼Œè¯¥jwtéƒ½æ˜¯ä¸å¯ç”¨çš„</li>
<li>iat: jwtçš„ç­¾å‘æ—¶é—´</li>
<li>jti: jwtçš„å”¯ä¸€èº«ä»½æ ‡è¯†ï¼Œä¸»è¦ç”¨æ¥ä½œä¸ºä¸€æ¬¡æ€§tokenï¼Œä»è€Œå›é¿é‡æ”¾æ”»å‡»</li>
</ul>
<p>Public claims : å¯ä»¥éšæ„å®šä¹‰</p>
<ul>
<li>è‡ªå®šä¹‰æ•°æ®:å­˜æ”¾åœ¨tokenä¸­å­˜æ”¾çš„key-valueå€¼</li>
</ul>
<p>Private claims : ç”¨äºåœ¨åŒæ„ä½¿ç”¨å®ƒä»¬çš„å„æ–¹ä¹‹é—´å…±äº«ä¿¡æ¯ï¼Œå¹¶ä¸”ä¸æ˜¯æ³¨å†Œçš„æˆ–å…¬å¼€çš„å£°æ˜</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;iss&quot;</span>: <span class="string">&quot;briup&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;iat&quot;</span>: <span class="number">1446593502</span>,</span><br><span class="line">    <span class="attr">&quot;exp&quot;</span>: <span class="number">1446594722</span>,</span><br><span class="line">    <span class="attr">&quot;aud&quot;</span>: <span class="string">&quot;www.briup.com&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;sub&quot;</span>: <span class="string">&quot;briup@briup.com&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;tom&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œä¸è¦åœ¨JWTçš„payloadæˆ–headerä¸­æ”¾ç½®æ•æ„Ÿä¿¡æ¯ï¼Œé™¤éå®ƒä»¬æ˜¯åŠ å¯†çš„</p>
</blockquote>
<p>æŠŠå¤´éƒ¨å’Œè½½è·åˆ†åˆ«è¿›è¡ŒBase64ç¼–ç ä¹‹åå¾—åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åå†å°†è¿™ä¸¤ä¸ªç¼–ç åçš„å­—ç¬¦ä¸²ç”¨è‹±æ–‡å¥å·.<br>è¿æ¥åœ¨ä¸€èµ·ï¼ˆå¤´éƒ¨åœ¨å‰ï¼‰ï¼Œå½¢æˆæ–°çš„å­—ç¬¦ä¸²ï¼š</p>
<p><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI2MmI2OWNlZC02YWNlLTRmYzAtOTk5MS00YWUwMjIxODQ0OTciLCJleHAiOjE2MDYwNTQzNjl9</code></p>
<p>###ç­¾å</p>
<p>æœ€åï¼Œå°†ä¸Šé¢æ‹¼æ¥å®Œçš„å­—ç¬¦ä¸²ç”¨HS256ç®—æ³•è¿›è¡ŒåŠ å¯†ï¼Œåœ¨åŠ å¯†çš„æ—¶å€™ï¼Œè¿˜éœ€è¦æä¾›ä¸€ä¸ªå¯†é’¥ï¼ˆsecretï¼‰ã€‚åŠ å¯†åçš„å†…å®¹ä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°±æ˜¯ç­¾åã€‚</p>
<p>æŠŠè¿™ä¸ªç­¾åæ‹¼æ¥åœ¨åˆšæ‰çš„å­—ç¬¦ä¸²åé¢å°±èƒ½å¾—åˆ°å®Œæ•´çš„JWTå­—ç¬¦ä¸²ã€‚<br>headeréƒ¨åˆ†å’Œpayloadéƒ¨åˆ†å¦‚æœè¢«ç¯¡æ”¹ï¼Œç”±äºç¯¡æ”¹è€…ä¸çŸ¥é“å¯†é’¥æ˜¯ä»€ä¹ˆï¼Œä¹Ÿæ— æ³•ç”Ÿæˆæ–°çš„signatureéƒ¨åˆ†ï¼Œ<br>æœåŠ¡ç«¯ä¹Ÿå°±æ— æ³•é€šè¿‡ã€‚</p>
<blockquote>
<p>åœ¨JWTä¸­ï¼Œæ¶ˆæ¯ä½“æ˜¯é€æ˜çš„ï¼Œä½¿ç”¨ç­¾åå¯ä»¥ä¿è¯æ¶ˆæ¯ä¸è¢«ç¯¡æ”¹ã€‚</p>
</blockquote>
<blockquote>
<p>ç¡®ä¿å¯†é’¥ä¸ä¼šæ³„éœ²,å¦åˆ™ä¼šè¢«ç¯¡æ”¹</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œä½¿ç”¨HMACSHA256åŠ å¯†ç®—æ³•ï¼Œé…åˆç§˜é’¥ï¼Œå°†å‰ä¿©éƒ¨è¿›è¡ŒåŠ å¯†ï¼Œç”Ÿæˆç­¾å</p>
<p><code>HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload), secret)</code></p>
<p>ä¾‹å¦‚ï¼Œå°†Headerã€Payloadã€Signatureä¸‰éƒ¨åˆ†ä½¿ç”¨ç‚¹ï¼ˆ.ï¼‰è¿æ¥èµ·æ¥</p>
<p><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI2MmI2OWNlZC02YWNlLTRmYzAtOTk5MS00Y WUwMjIxODQ0OTciLCJleHAiOjE2MDYwNTQzNjl9.DNVhr36j66JpQBfcYoo64IRp84dKiQeaq7axHTBcP9 E</code></p>
<p>ä¾‹å¦‚ï¼Œä½¿ç”¨å®˜ç½‘æä¾›çš„å·¥å…·ï¼Œå¯ä»¥å¯¹è¯¥JWTè¿›è¡ŒéªŒè¯å’Œè§£æ</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210319085334765.png" alt="image-20210319085334765"></p>
<blockquote>
<p>æ³¨æ„ï¼Œåœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨JWTå°è£…çš„å·¥å…·ç±»ï¼Œä¹Ÿå¯ä»¥å®Œæˆæ­¤æ“ä½œ</p>
</blockquote>
<h2 id="æ•´åˆ-1"><a href="#æ•´åˆ-1" class="headerlink" title="æ•´åˆ"></a>æ•´åˆ</h2><h3 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.auth0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>java-jwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.11.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="å·¥å…·ç±»"><a href="#å·¥å…·ç±»" class="headerlink" title="å·¥å…·ç±»"></a>å·¥å…·ç±»</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtUtil</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿‡æœŸæ—¶é—´5åˆ†é’Ÿ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> EXPIRE_TIME = <span class="number">5</span> * <span class="number">60</span> * <span class="number">1000</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * jwt å¯†é’¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String SECRET = <span class="string">&quot;jwt_secret&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆç­¾åï¼Œäº”åˆ†é’Ÿåè¿‡æœŸ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> infoï¼ŒMapçš„valueåªèƒ½å­˜æ”¾çš„å€¼çš„ç±»å‹ä¸ºï¼šMap, List, Boolean, Integer, Long, Double, String and Date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">sign</span><span class="params">(String userId,Map&lt;String,Object&gt; info)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Date date = <span class="keyword">new</span> Date(System.currentTimeMillis() + EXPIRE_TIME);</span><br><span class="line">            Algorithm algorithm = Algorithm.HMAC256(SECRET);</span><br><span class="line">            <span class="keyword">return</span> JWT.create()</span><br><span class="line">                    <span class="comment">// å°† user id ä¿å­˜åˆ° token é‡Œé¢</span></span><br><span class="line">                    .withAudience(userId)</span><br><span class="line">                    <span class="comment">// å­˜æ”¾è‡ªå®šä¹‰æ•°æ®</span></span><br><span class="line">                    .withClaim(<span class="string">&quot;info&quot;</span>, info)</span><br><span class="line">                    <span class="comment">// äº”åˆ†é’Ÿåtokenè¿‡æœŸ</span></span><br><span class="line">                    .withExpiresAt(date)</span><br><span class="line">                    <span class="comment">// token çš„å¯†é’¥</span></span><br><span class="line">                    .sign(algorithm);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        	e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®tokenè·å–userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getUserId</span><span class="params">(String token)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String userId = JWT.decode(token).getAudience().get(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> userId;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JWTDecodeException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®tokenè·å–è‡ªå®šä¹‰æ•°æ®info</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,Object&gt; <span class="title">getInfo</span><span class="params">(String token)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> JWT.decode(token).getClaim(<span class="string">&quot;info&quot;</span>).asMap();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JWTDecodeException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¡éªŒtoken</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkSign</span><span class="params">(String token)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Algorithm algorithm = Algorithm.HMAC256(SECRET);</span><br><span class="line">            JWTVerifier verifier = JWT.require(algorithm)</span><br><span class="line">                    <span class="comment">// .withClaim(&quot;username&quot;, username)</span></span><br><span class="line">                    .build();</span><br><span class="line">            verifier.verify(token);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JWTVerificationException exception) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;token æ— æ•ˆï¼Œè¯·é‡æ–°è·å–&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ‹¦æˆªè®¤è¯èµ„æº</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtInteceptors</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// åˆ¤æ–­æ˜¯ä¸æ˜¯è®¤è¯èµ„æº(æ ¹æ®æ‹¦æˆªå™¨é…ç½® auth/**) ä¸æ˜¯çš„è¯ç›´æ¥æ”¾è¡Œ</span></span><br><span class="line">		<span class="comment">//System.out.println(handler); //class org.springframework.web.method.HandlerMethod</span></span><br><span class="line">		<span class="keyword">if</span>(!(handler <span class="keyword">instanceof</span> HandlerMethod))&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// ä»è¯·æ±‚å¤´ä¸­è·å–token</span></span><br><span class="line">		String token = request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">		<span class="comment">// åˆ¤æ–­tokenæ˜¯å¦ä¸ºç©º ç©ºç›´æ¥æŠ›å¼‚å¸¸ </span></span><br><span class="line">		<span class="keyword">if</span>(token == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;æ— token,è¯·ç™»å½•&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// æ ¡éªŒtoken</span></span><br><span class="line">		JwtUtil.checkSign(token);</span><br><span class="line">		<span class="comment">// å–å‡ºtokenä¸­çš„ä¿¡æ¯</span></span><br><span class="line">		String userId = JwtUtil.getUserId(token);</span><br><span class="line">		System.out.println(userId);</span><br><span class="line">		Map&lt;String, Object&gt; info = JwtUtil.getInfo(token);</span><br><span class="line">		info.forEach((k,v)-&gt;&#123;</span><br><span class="line">			System.out.println(k+<span class="string">&quot;=&quot;</span>+v);</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="comment">// æ”¾è¡Œ</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="mvcé…ç½®"><a href="#mvcé…ç½®" class="headerlink" title="mvcé…ç½®"></a>mvcé…ç½®</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">		registry.addInterceptor(<span class="keyword">new</span> JwtInteceptors())</span><br><span class="line">		.addPathPatterns(<span class="string">&quot;/auth/**&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="èµ„æº"><a href="#èµ„æº" class="headerlink" title="èµ„æº"></a>èµ„æº</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/auth&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;æµ‹è¯•æ¨¡å—&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æµ‹è¯•-2"><a href="#æµ‹è¯•-2" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p><strong>ç›´æ¥è®¿é—®</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20211112093343903.png" alt="image-20211112093343903"></p>
<p><strong>è·å–token</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20211112093718429.png" alt="image-20211112093718429"></p>
<p><strong>æºå¸¦è¯·æ±‚å¤´</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20211112093811250.png" alt="image-20211112093811250"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">3</span><br><span class="line">gender=0</span><br><span class="line">username=wangsidandan</span><br></pre></td></tr></table></figure>



<p><strong>ä¿®æ”¹tokenï¼Œæ•…æ„å†™é”™åï¼Œå†è®¿é—®æµ‹è¯•</strong></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;code&quot;</span>:<span class="number">500</span>,<span class="attr">&quot;msg&quot;</span>:<span class="string">&quot;æœåŠ¡å™¨å¼‚å¸¸: token æ— æ•ˆï¼Œè¯·é‡æ–°è·å–&quot;</span>,<span class="attr">&quot;data&quot;</span>:<span class="literal">null</span>&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è·å–æ–°çš„tokenæµ‹è¯•é€šè¿‡åï¼Œç­‰å¾…5åˆ†é’Ÿåï¼Œå†æ¬¡è®¿é—®</strong></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;code&quot;</span>:<span class="number">500</span>,<span class="attr">&quot;msg&quot;</span>:<span class="string">&quot;æœåŠ¡å™¨å¼‚å¸¸: token æ— æ•ˆï¼Œè¯·é‡æ–°è·å–&quot;</span>,<span class="attr">&quot;data&quot;</span>:<span class="literal">null</span>&#125;</span><br></pre></td></tr></table></figure>



<h3 id="swagger-1"><a href="#swagger-1" class="headerlink" title="swagger"></a>swagger</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/auth&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;æµ‹è¯•æ¨¡å—&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;æµ‹è¯•&quot;,notes = &quot;tokenæ”¾è¯·æ±‚å¤´&quot;)</span></span><br><span class="line">	<span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">		@ApiImplicitParam(name = &quot;token&quot;,value = &quot;tokenå€¼&quot;,dataType = &quot;string&quot;,paramType = &quot;header&quot;,required = true)</span></span><br><span class="line"><span class="meta">	&#125;)</span></span><br><span class="line">	<span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>é—®é¢˜</code></p>
<p>æ¯ä¸ªéœ€è¦æ‹¦æˆªçš„èµ„æºéƒ½è¦æ‰‹åŠ¨é…ç½®token</p>
<h2 id="å…¨å±€é…ç½®"><a href="#å…¨å±€é…ç½®" class="headerlink" title="å…¨å±€é…ç½®"></a>å…¨å±€é…ç½®</h2><h3 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h3><blockquote>
<p>å¾ˆå¤šè¯·æ±‚ä¸­ï¼Œä¼šæºå¸¦tokenåˆ°æœåŠ¡å™¨ç«¯è¿›è¡Œè®¤è¯ï¼Œtokenæœ‰æ•ˆæ—¶æ‰å¯ä»¥è¿›è¡Œæœ¬æ¬¡è®¿é—®ï¼Œè°ƒç”¨ç›¸åº”çš„æ¥å£</p>
</blockquote>
<p>ä½¿ç”¨swaggerè¿›è¡Œæ¥å£æµ‹è¯•åï¼Œå¯ä»¥ç»™swaggerä¸­æµ‹è¯•çš„æ¥å£ï¼Œæ·»åŠ å…¨å±€çš„å‚æ•°ï¼Œè®©æ¯ä¸€ä¸ªæ¥å£éƒ½å«ä¹‰æŒ‡å®šçš„å‚æ•°ï¼Œè¿™æ ·å°±ä¸éœ€è¦æ¯ä¸€ä¸ªæ¥ä¸Šæ·»åŠ swaggerçš„æ³¨è§£äº†ã€‚</p>
<h3 id="2-ä½¿ç”¨"><a href="#2-ä½¿ç”¨" class="headerlink" title="2.ä½¿ç”¨"></a>2.ä½¿ç”¨</h3><h4 id="æ–¹å¼1"><a href="#æ–¹å¼1" class="headerlink" title="æ–¹å¼1"></a><strong>æ–¹å¼1</strong></h4><p>ç¬¬ä¸€ç§è®¾ç½®å…¨å±€å˜é‡çš„æ–¹å¼ï¼š</p>
<blockquote>
<p>æ³¨æ„ï¼Œå¤åˆ¶ä¹‹å‰springboot-swaggeré¡¹ç›®ï¼Œå†æ·»åŠ å°‘é‡ä¿®æ”¹å³å¯</p>
</blockquote>
<p>ä¿®æ”¹é…ç½®ç±»SwaggerConfig2.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ParameterBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.PathSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.schema.ModelRef;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Contact;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Parameter;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Swagger2Config</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ApiSelectorBuilder select() apié€‰æ‹©å™¨</span></span><br><span class="line">	<span class="comment">// æŒ‡å®šå¤„ç†å™¨ ä»»ä½•è·¯å¾„</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Docket <span class="title">createDocket</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//é…ç½®å…¨å±€å‚æ•°</span></span><br><span class="line">				ParameterBuilder tokenPar = <span class="keyword">new</span> ParameterBuilder();  </span><br><span class="line">				Parameter param = tokenPar.name(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">							        	  .description(<span class="string">&quot;JWTä»¤ç‰Œ&quot;</span>)</span><br><span class="line">							        	  .modelRef(<span class="keyword">new</span> ModelRef(<span class="string">&quot;string&quot;</span>))</span><br><span class="line">							        	  .parameterType(<span class="string">&quot;header&quot;</span>)</span><br><span class="line">							        	  .required(<span class="keyword">false</span>)</span><br><span class="line">							        	  .build();  </span><br><span class="line">		        </span><br><span class="line">		        List&lt;Parameter&gt; pars = <span class="keyword">new</span> ArrayList&lt;Parameter&gt;();  </span><br><span class="line">		        pars.add(param);  </span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">				.apiInfo(apiInfo())</span><br><span class="line">				.select()</span><br><span class="line">				.apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.briup.cms.controller&quot;</span>))</span><br><span class="line">				.paths(PathSelectors.any())</span><br><span class="line">				.build()</span><br><span class="line">				.globalOperationParameters(pars)</span><br><span class="line">				.ignoredParameterTypes(HttpServletRequest.class,HttpServletResponse.class);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// swaggeré¡µé¢ä¸­æ˜¾ç¤ºçš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">	<span class="comment">//@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">				.title(<span class="string">&quot;cms&quot;</span>)</span><br><span class="line">				.description(<span class="string">&quot;æ–°é—»å‘å¸ƒç³»ç»Ÿ&quot;</span>)</span><br><span class="line">				.version(<span class="string">&quot;1.0&quot;</span>)</span><br><span class="line">				.contact(<span class="keyword">new</span> Contact(<span class="string">&quot;vanse&quot;</span>, <span class="string">&quot;http://wangsidandan.github.io&quot;</span>, <span class="string">&quot;wangsidandan@gmail.com&quot;</span>))</span><br><span class="line">				.build();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321163623737.png" alt="image-20210321163623737"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321163643126.png" alt="image-20210321163643126"></p>
<blockquote>
<p>æ³¨æ„ï¼Œæ­¤æ—¶åœ¨swaggerä¸­æ˜¾ç¤ºçš„æ¥å£ï¼Œéƒ½è‡ªåŠ¨æ·»åŠ äº†è¿™ä¸ªå…¨å±€å‚æ•°tokenï¼Œå¹¶ä¸”è¯·æ±‚æ—¶ä¹Ÿæºå¸¦äº†æŒ‡å®šçš„tokenå€¼</p>
</blockquote>
<p><code>é—®é¢˜</code></p>
<p>ä¸éœ€è¦è®¤è¯çš„æ¥å£ä¹Ÿæ·»åŠ äº†token</p>
<p>####æ–¹å¼2</p>
<p>ç¬¬äºŒç§è®¾ç½®å…¨å±€å˜é‡çš„æ–¹å¼ï¼š</p>
<blockquote>
<p>æ³¨æ„ï¼Œå¤åˆ¶ä¹‹å‰springboot-swaggeré¡¹ç›®ï¼Œå†æ·»åŠ å°‘é‡ä¿®æ”¹å³å¯</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.common.base.Predicate;</span><br><span class="line"><span class="keyword">import</span> com.google.common.base.Predicates;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.PathSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiKey;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.AuthorizationScope;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Contact;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.SecurityReference;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.service.contexts.SecurityContext;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Swagger2Config</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ApiSelectorBuilder select() apié€‰æ‹©å™¨</span></span><br><span class="line">	<span class="comment">// æŒ‡å®šå¤„ç†å™¨ ä»»ä½•è·¯å¾„</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Docket <span class="title">createDocket</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2).apiInfo(apiInfo()).select()</span><br><span class="line">				.apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.briup.cms.controller&quot;</span>)).paths(PathSelectors.any())</span><br><span class="line">				.build().securitySchemes(security()).securityContexts(securityContexts())</span><br><span class="line">				.ignoredParameterTypes(HttpServletRequest.class, HttpServletResponse.class);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// swaggeré¡µé¢ä¸­æ˜¾ç¤ºçš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">	<span class="comment">// @Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder().title(<span class="string">&quot;cms&quot;</span>).description(<span class="string">&quot;æ–°é—»å‘å¸ƒç³»ç»Ÿ&quot;</span>).version(<span class="string">&quot;1.0&quot;</span>)</span><br><span class="line">				.contact(<span class="keyword">new</span> Contact(<span class="string">&quot;vanse&quot;</span>, <span class="string">&quot;http://wangsidandan.github.io&quot;</span>, <span class="string">&quot;wangsidandan@gmail.com&quot;</span>)).build();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * è®¾ç½®è®¤è¯ä¸­æ˜¾ç¤ºçš„æ˜¾ç¤ºçš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> List&lt;ApiKey&gt; <span class="title">security</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> Collections.singletonList(<span class="keyword">new</span> ApiKey(<span class="string">&quot;Authorization&quot;</span>, <span class="string">&quot;token&quot;</span>, <span class="string">&quot;header&quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * è®¾ç½®è®¤è¯è§„åˆ™</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> List&lt;SecurityContext&gt; <span class="title">securityContexts</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		List&lt;String&gt; antPaths = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		antPaths.add(<span class="string">&quot;/auth/**&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Collections.singletonList(SecurityContext.builder().securityReferences(defaultAuth())</span><br><span class="line">				.forPaths(antPathsCondition(antPaths)).build());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * è¿”å›è®¤è¯è·¯å¾„çš„æ¡ä»¶</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> Predicate&lt;String&gt; <span class="title">antPathsCondition</span><span class="params">(List&lt;String&gt; antPaths)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		List&lt;Predicate&lt;String&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">		antPaths.forEach(path -&gt; list.add(PathSelectors.ant(path)));</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Predicates.or(list);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * è®¾ç½®è®¤è¯çš„èŒƒå›´ï¼Œä»¥åŠè®¤è¯çš„ç±»å‹</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> List&lt;SecurityReference&gt; <span class="title">defaultAuth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		AuthorizationScope authorizationScope = <span class="keyword">new</span> AuthorizationScope(<span class="string">&quot;global&quot;</span>, <span class="string">&quot;accessEverything&quot;</span>);</span><br><span class="line">		AuthorizationScope[] authorizationScopes = <span class="keyword">new</span> AuthorizationScope[<span class="number">1</span>];</span><br><span class="line">		authorizationScopes[<span class="number">0</span>] = authorizationScope;</span><br><span class="line">		<span class="keyword">return</span> Collections.singletonList(<span class="keyword">new</span> SecurityReference(<span class="string">&quot;Authorization&quot;</span>, authorizationScopes));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ¯”ä¹‹å‰æ–°å¢çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321171405316.png" alt="image-20210321171405316"></p>
<blockquote>
<p>æ³¨æ„ï¼Œæ–°å¢ä»£ç å¦‚å›¾æ‰€ç¤ºï¼Œä»¥åŠä¸‹é¢æ–°å¢çš„å‡ ä¸ªæ–¹æ³•</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321171428922.png" alt="image-20210321171428922"></p>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºä¸€ä¸ªâ€œé”â€çš„å›¾æ ‡ï¼Œè¡¨ç¤ºè¿™é‡Œæœ‰äº›æ¥å£æ˜¯éœ€è¦è®¤è¯çš„</p>
</blockquote>
<p>å±•å¼€æ¨¡å—åï¼Œè®¿é—®è·¯å¾„ç¬¦åˆè¦æ±‚æ¥å£ï¼Œä¹Ÿä¼šæ˜¾ç¤ºâ€œé”â€çš„å›¾æ ‡</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321171450952.png" alt="image-20210321171450952"></p>
<p>ç‚¹å‡»é”çš„å›¾æ ‡ï¼Œæ·»åŠ è¯·æ±‚å¤´ä¸­çš„ç»Ÿä¸€è®¤è¯ä¿¡æ¯ï¼ˆtokenï¼‰ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321171509563.png" alt="image-20210321171509563"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321171519876.png" alt="image-20210321171519876"></p>
<p>ç‚¹å‡»è®¤è¯æŒ‰é’®åï¼Œè¿›è¡Œè®¿é—®æµ‹è¯•ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321171537958.png" alt="image-20210321171537958"></p>
<p>æ³¨æ„ï¼Œè¿™æ—¶å€™ï¼Œæœ‰â€œé”â€å›¾æ ‡çš„æ¥å£ï¼Œåœ¨è®¿é—®çš„æ—¶å€™ï¼Œéƒ½ä¼šæºå¸¦åˆšåˆšè®¾ç½®çš„è¯·æ±‚å¤´ä¸­çš„è®¤è¯ä¿¡æ¯tokenå€¼</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321171609118.png" alt="image-20210321171609118"></p>
<p>æ³¨æ„ï¼Œè¿™æ—¶å€™ï¼Œæ— â€œé”â€å›¾æ ‡çš„æ¥å£ï¼Œåœ¨è®¿é—®çš„æ—¶å€™ï¼Œé»˜è®¤æ˜¯ä¸ä¼šæºå¸¦è®¾ç½®çš„è¯·æ±‚å¤´ä¿¡æ¯çš„</p>
<h1 id="cors"><a href="#cors" class="headerlink" title="cors"></a>cors</h1><h2 id="1-æ¦‚è¿°-1"><a href="#1-æ¦‚è¿°-1" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h2><p>è·¨åŸŸè®¿é—®ï¼Œæ˜¯æŒ‡ä»ä¸€ä¸ªåŸŸåçš„ç½‘é¡µå»è¯·æ±‚å¦ä¸€ä¸ªåŸŸåçš„èµ„æºã€‚æ¯”å¦‚ä»<a href="http://www.baidu.com/">www.baidu.com</a> é¡µé¢å»è¯·æ±‚ <a href="http://www.google.com/">www.google.com</a> çš„èµ„æºã€‚ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ä¸èƒ½è¿™ä¹ˆåšè·¨åŸŸè®¿é—®ï¼Œå› ä¸ºæœ‰æµè§ˆå™¨çš„â€œ<strong>åŒæºç­–ç•¥</strong>â€å­˜åœ¨ï¼Œè¿™æ˜¯æµè§ˆå™¨å¯¹JavaScriptæ–½åŠ çš„å®‰å…¨é™åˆ¶ã€‚</p>
<blockquote>
<p>è·¨åŸŸï¼ŒæŒ‡çš„æ˜¯æµè§ˆå™¨ä¸èƒ½æ‰§è¡Œå…¶ä»–ç½‘ç«™çš„è„šæœ¬ã€‚å®ƒæ˜¯ç”±æµè§ˆå™¨çš„åŒæºç­–ç•¥é€ æˆçš„ï¼Œæ˜¯æµè§ˆå™¨å¯¹JavaScriptæ–½åŠ çš„å®‰å…¨é™åˆ¶ã€‚</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321224558036.png" alt="image-20210321224558036"></p>
<p><strong>â€œåŒæºç­–ç•¥â€</strong>ç®€å•çš„è¯´ï¼Œå°±æ˜¯Aç½‘ç«™é¡µé¢è®¿é—®Bç½‘ç«™çš„èµ„æºå—é™ï¼ˆè·¨åŸŸè®¿é—®ï¼‰ï¼Œé™¤éAå’ŒBæ˜¯â€œåŒæºâ€ã€‚<br><strong>â€œåŒæºâ€</strong>æ˜¯æŒ‡ä¸‰ä¸ªç›¸åŒï¼Œåè®®ç›¸åŒã€åŸŸåç›¸åŒã€ç«¯å£ç›¸åŒï¼Œåªæœ‰æœ‰ä»»ä½•ä¸€ä¸ªåœ°æ–¹ä¸åŒï¼Œå°±è®¤ä¸ºæ˜¯è·¨åŸŸã€‚</p>
<p>ä¾‹å¦‚ï¼Œ<br>ç½‘é¡µAçš„åœ°å€ä¸ºï¼Œ <a href="http://www.example.com/dir/page.html">http://www.example.com/dir/page.html</a><br>å‡è®¾ï¼Œç½‘é¡µAè¦è®¿é—®çš„ç½‘é¡µBåœ°å€ä¸ºï¼š</p>
<ul>
<li><a href="http://www.example.com/dir2/other.html">http://www.example.com/dir2/other.html</a> ï¼š åŒæºï¼ˆæ­£å¸¸è®¿é—®ï¼‰</li>
<li><a href="https://www.example.com/dir/other.html">https://www.example.com/dir/other.html</a> ï¼šä¸åŒæºï¼ˆåè®®ä¸åŒï¼Œè·¨åŸŸï¼‰</li>
<li><a href="http://vip.www.example.com/dir/other.html">http://vip.www.example.com/dir/other.html</a> ï¼šä¸åŒæºï¼ˆåŸŸåä¸åŒï¼Œè·¨åŸŸï¼‰</li>
<li><a href="http://www.example.com:81/dir/other.html">http://www.example.com:81/dir/other.html</a> ï¼šä¸åŒæºï¼ˆç«¯å£ä¸åŒï¼Œè·¨åŸŸï¼‰</li>
</ul>
<p>éšç€äº’è”ç½‘çš„å‘å±•ï¼Œâ€œåŒæºæ”¿ç­–â€è¶Šæ¥è¶Šä¸¥æ ¼ï¼Œç›®å‰ï¼Œå¦‚æœéåŒæºï¼ˆè·¨åŸŸï¼‰ï¼Œå…±æœ‰ä¸‰ç§è¡Œä¸ºå—åˆ°é™åˆ¶ï¼š</p>
<ul>
<li>Cookie ã€LocalStorageã€IndexDB æ— æ³•è®¿é—®</li>
<li>DOM æ— æ³•è·å–</li>
<li>AJAXè¯·æ±‚ä¸èƒ½å‘é€</li>
</ul>
<p>æµè§ˆå™¨çš„ç”¨â€œåŒæºç­–ç•¥â€æ¥é™åˆ¶è·¨åŸŸè®¿é—®çš„ç›®çš„æ˜¯ä¸ºäº†å®‰å…¨ï¼Œä¾‹å¦‚ï¼Œå‡è®¾æ²¡æœ‰è·¨åŸŸè®¿é—®çš„é™åˆ¶</p>
<ul>
<li><p>ç”¨æˆ·è®¿é—®<a href="http://www.mybank.com/">www.mybank.com</a> ï¼Œç™»é™†å¹¶è¿›è¡Œç½‘é“¶æ“ä½œï¼Œè¿™æ—¶cookieã€tokenç­‰æ•°æ®ä¿¡æ¯å­˜æ”¾åœ¨æµè§ˆå™¨ä¸­</p>
</li>
<li><p>ç”¨æˆ·è®¿é—®<a href="http://www.abc.com/">www.abc.com</a></p>
</li>
<li><p>è¿™æ—¶<a href="http://www.abc.com/">www.abc.com</a> ç½‘ç«™å°±å¯ä»¥åœ¨æ‹¿åˆ°é“¶è¡Œçš„cookieæˆ–tokenç­‰ï¼Œç„¶åå‘èµ·å¯¹<a href="http://www.mybank.com/">www.mybank.com</a> çš„æ“ä½œ</p>
</li>
</ul>
<p>æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­ï¼Œéœ€è¦è®¾ç½®å¯¹è·¨åŸŸè®¿é—®çš„æ”¯æŒï¼Œæ˜¯å› ä¸ºé¡¹ç›®çš„æ¶æ„éœ€è¦ï¼Œä¾‹å¦‚</p>
<ul>
<li>å…¬å¸å†…éƒ¨æœ‰å¤šä¸ªä¸åŒçš„å­ç³»ç»Ÿï¼Œä¾‹å¦‚Aå’ŒBï¼Œåˆ†åˆ«éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œå…¶åŸŸåä¹Ÿä¸ç›¸åŒ</li>
<li>ç”±äºå…¬å¸å†…éƒ¨çš„æ•°æ®éœ€è¦ï¼Œç°åœ¨Aç³»ç»Ÿä¸­ï¼Œè·¨åŸŸè®¿é—®Bç³»ç»Ÿï¼Œä»è€Œè·å–å†…éƒ¨çš„ä¸€äº›ä¿¡æ¯èµ„æº</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼Œåœ¨å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ä¸­ï¼Œå‰ç«¯é¡µé¢éƒ¨ç½²åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œåç«¯é¡¹ç›®éƒ¨ç½²åœ¨å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œä»å‰ç«¯é¡µé¢ä¸Šå‘é€ajaxè¯·æ±‚åˆ°åç«¯ç³»ç»Ÿä¸­ï¼Œè¿™ç§æƒ…å†µï¼Œå°±å±äºè·¨åŸŸè®¿é—®</p>
</blockquote>
<h2 id="2-æ¡ˆä¾‹"><a href="#2-æ¡ˆä¾‹" class="headerlink" title="2.æ¡ˆä¾‹"></a>2.æ¡ˆä¾‹</h2><p>1ã€æ–°å»ºé¡¹ç›®ï¼Œspringboot-html</p>
<img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321230538847.png" alt="image-20210321230538847" style="zoom:50%;" />



<p>2ã€é¡µé¢ä»£ç ï¼šajax.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;script src=&quot;https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js&quot;&gt;&lt;/script&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ä¸éœ€è¦å†™static--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;.btn1&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">console</span>.log(msg);</span></span><br><span class="line"><span class="javascript">                    &#125;,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        alert(<span class="string">&#x27;error&#x27;</span>);</span></span><br><span class="line"><span class="javascript">                    &#125;</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        &#125;);</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn1&quot;</span>&gt;</span>test1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€pomæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>4ã€é…ç½®æ–‡ä»¶application.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">9999</span></span><br></pre></td></tr></table></figure>

<p>5ã€Controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.web.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@GetMapping(&quot;/ajax&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ajax&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>6ã€è¿è¡Œè®¿é—®</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321231102544.png" alt="image-20210321231102544"></p>
<p><strong>å†æ„å»ºæä¾›æ¥å£è®¿é—®çš„åç«¯é¡¹ç›®</strong></p>
<p>1ã€æ–°å»ºé¡¹ç›®ï¼Œspringboot-cors</p>
<img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321231146093.png" alt="image-20210321231146093" style="zoom:67%;" />

<p>2ã€pomæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>3ã€é…ç½®æ–‡ä»¶ï¼Œapplication.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8989</span></span><br></pre></td></tr></table></figure>

<p>4ã€Controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.web.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@GetMapping(&quot;/hi&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5ã€å¯åŠ¨ï¼Œè®¿é—®</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321231321782.png" alt="image-20210321231321782"></p>
<p>æœ€åï¼Œè®¿é—®springboot-htmlé¡¹ç›®ä¸­çš„ajax.htmlé¡µé¢ï¼Œç‚¹å‡»é¡µé¢ä¸­çš„æŒ‰é’®ï¼Œå‘é€ajaxè¯·æ±‚ï¼Œè®¿é—®springbootcors<br>é¡¹ç›®ä¸­çš„æ¥å£ï¼š</p>
<p>å½“å‰é¡µé¢çš„è®¿é—®åœ°å€ï¼š <a href="http://localhost:9999/ajax">http://localhost:9999/ajax</a><br>ç‚¹å‡»æŒ‰é’®åè¯·æ±‚åœ°å€ï¼š <a href="http://localhost:8989/hi">http://localhost:8989/hi</a><br>å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶è¿™ä¿©ä¸ªåœ°å€ï¼Œå±äºâ€œéåŒæºâ€ï¼Œæœ¬æ¬¡è®¿é—®å±äºè·¨åŸŸè®¿é—®ã€‚</p>
<p>ç‚¹å‡»åï¼Œæ§åˆ¶å°ä¸Šè¾“å‡ºçš„é”™è¯¯ä¿¡æ¯ï¼š<br>å·²æ‹¦æˆªè·¨æºè¯·æ±‚ï¼šåŒæºç­–ç•¥ç¦æ­¢è¯»å–ä½äº <a href="http://localhost:8989/hi">http://localhost:8989/hi</a> çš„è¿œç¨‹èµ„æºã€‚<br>ï¼ˆåŸå› ï¼šCORS å¤´ç¼ºå°‘ â€˜Access-Control-Allow-Originâ€™ï¼‰ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321232022681.png" alt="image-20210321232022681"></p>
<p>ç‚¹å¼€ç½‘ç»œæ¨¡å—ï¼ŒæŸ¥çœ‹å…·ä½“çš„è¯·æ±‚ä¿¡æ¯ï¼š<br>è¯·æ±‚å¤´ä¸­ï¼Œè‡ªåŠ¨æ·»åŠ äº†ä¿¡æ¯ Origin: <a href="http://localhost:9999/">http://localhost:9999</a> ï¼Œé€šçŸ¥æœåŠ¡å™¨æœ¬æ¬¡æ˜¯è·¨åŸŸè®¿é—®</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321232136576.png" alt="image-20210321232136576"></p>
<p>ä»æœ¬æ¬¡å“åº”çš„å†…å®¹ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå…¶å®å“åº”çš„å†…å®¹å·²ç»æˆåŠŸè¿”å›äº†ï¼Œä½†æ˜¯ç”±äºæµè§ˆå™¨çš„åŒæºæ”¿ç­–ï¼ŒæŠŠè¿™äº›ç»“æœéƒ½ç»™èˆå¼ƒäº†ã€‚å¹¶ä¸”æ‰§è¡Œäº†Ajaxä¸­çš„å›è°ƒå‡½æ•°error</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210321232221184.png" alt="image-20210321232221184"></p>
<h2 id="3-è§£å†³"><a href="#3-è§£å†³" class="headerlink" title="3.è§£å†³"></a>3.è§£å†³</h2><p>é¿å¼€åŒæºæ”¿ç­–ç»™è·¨åŸŸè®¿é—®å¸¦æ¥çš„é™åˆ¶ï¼Œæ–¹å¼æœ‰å¾ˆå¤šï¼š</p>
<ol>
<li>nginx</li>
<li>CORS</li>
<li>JSONP</li>
<li>WebSocket</li>
<li>Node.js</li>
<li>document.domain+iframe</li>
<li>other</li>
</ol>
<p>è¿™é‡Œä¸»è¦è¯´ä¸‹nginxåå‘ä»£ç†å’ŒCORSè·¨åŸŸèµ„æºå…±äº«ï¼Œè¿™ä¿©ç§è·¨åŸŸè§£å†³æ–¹æ¡ˆ</p>
<h3 id="3-1-nginx"><a href="#3-1-nginx" class="headerlink" title="3.1 nginx"></a>3.1 nginx</h3><p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322064446018.png" alt="image-20210322064446018"></p>
<p>Nginxæ˜¯ä¸€æ¬¾å¼€æºçš„ã€é«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†æœåŠ¡å™¨</p>
<ul>
<li>ä¹Ÿæ˜¯ä¸€ä¸ªIMAP/POP3/SMTPä»£ç†æœåŠ¡å™¨</li>
<li>ç”±Cè¯­è¨€ç¼–å†™ï¼Œå…¶ç³»ç»Ÿå¼€é”€ã€CPUä½¿ç”¨æ•ˆç‡éƒ½å¾ˆä¼˜ç§€</li>
<li>æ€§èƒ½ç¨³å®šã€åŠŸèƒ½ä¸°å¯Œã€é…ç½®ç®€æ´</li>
<li>æœåŠ¡å™¨ä¸­æ²¡æœ‰webå®¹å™¨</li>
</ul>
<p>æ­£å‘ä»£ç†ï¼Œä¸€èˆ¬éœ€è¦è‡ªå·±æ‰‹åŠ¨è¿›è¡Œé…ç½®ï¼š(<strong>å·²çŸ¥ä»£ç†æœåŠ¡å™¨</strong>)<br>ä»£ç†æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯åœ¨åŒä¸€ä¸ªç½‘ç»œä¸­ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬è®¿é—®ä¸äº†æŸä¸ªç½‘ç«™Bï¼Œä½†æ˜¯èƒ½è®¿é—®æŸä¸ªä»£ç†æœåŠ¡å™¨Pï¼Œè¿™ä¸ªä»£ç†æœåŠ¡å™¨På´å¯ä»¥è®¿é—®åˆ°ç½‘ç»œBï¼Œ<br>é‚£ä¹ˆæˆ‘å°±å…ˆè‡ªå·±æ‰‹åŠ¨é…ç½®è¿ä¸Šä»£ç†æœåŠ¡å™¨Pï¼Œç„¶åè®©ä»£ç†æœåŠ¡å™¨På¸®æˆ‘è®¿é—®ç½‘ç«™Bï¼Œå¹¶æŠŠç»“æœè¿”å›ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20211005101017166.png" alt="image-20211005101017166"></p>
<p>åå‘ä»£ç†ï¼Œä¸€èˆ¬æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥æ”¶ç½‘ç»œä¸Šçš„è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚å†è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„å…¶ä»–æœåŠ¡<br>å™¨ï¼š<br>ä»£ç†æœåŠ¡å™¨å’ŒWebæœåŠ¡å™¨åœ¨åŒä¸€ä¸ªç½‘ç»œä¸­ã€‚ä¸€èˆ¬ä¸éœ€è¦ç”¨æˆ·è‡ªå·±è®¾ç½®æœåŠ¡å™¨ï¼Œç”¨æˆ·ç”šè‡³æ„Ÿå—ä¸åˆ°è‡ªå·±è®¿é—®çš„æ˜¯åå‘ä»£ç†æœåŠ¡å™¨ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322064703065.png" alt="image-20210322064703065"></p>
<p>ä¾‹å¦‚ï¼ŒNginxçš„åå‘ä»£ç†åŠŸèƒ½ï¼Œè§£å†³è®¿é—®è·¨åŸŸé—®é¢˜ï¼Œæˆ–è€…å®ç°å¤šä¸ªæœåŠ¡å™¨è´Ÿè½½å‡è¡¡çš„æ•ˆæœã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322064734300.png" alt="image-20210322064734300"></p>
<p>1ã€ä¿®æ”¹nginxçš„é…ç½®æ–‡ä»¶nginx.conf</p>
<p>ä¿®æ”¹å‰çš„é…ç½®æ–‡ä»¶ä¸ºï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322064805891.png" alt="image-20210322064805891"></p>
<p>ä¿®æ”¹åçš„é…ç½®æ–‡ä»¶ä¸ºï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322064827250.png" alt="image-20210322064827250"></p>
<blockquote>
<p>ç‰¹åˆ«æ³¨æ„ï¼Œnginxå¯åŠ¨çš„æ—¶å€™ï¼Œä¸€å®šä¸è¦å­˜æ”¾åœ¨æœ‰ä¸­æ–‡çš„è·¯å¾„ä¸­ï¼Œå¦‚æœå¯åŠ¨å¤±è´¥ï¼ŒæŸ¥çœ‹é”™è¯¯çš„æ—¥å¿—è®°å½•</p>
</blockquote>
<p>conf.config</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#user  nobody;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">#error_log  logs/error.log;</span><br><span class="line">#error_log  logs/error.log  notice;</span><br><span class="line">#error_log  logs/error.log  info;</span><br><span class="line"></span><br><span class="line">#pid        logs/nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    #log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">    #                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">    #                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page /50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    proxy_pass   http://127.0.0.1;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    root           html;</span><br><span class="line">        #    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">        #    fastcgi_index  index.php;</span><br><span class="line">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">        #    include        fastcgi_params;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class="line">        # concurs with nginx&#x27;s one</span><br><span class="line">        #</span><br><span class="line">        #location ~ /\.ht &#123;</span><br><span class="line">        #    deny  all;</span><br><span class="line">        #&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       8000;</span><br><span class="line">    #    listen       somename:8080;</span><br><span class="line">    #    server_name  somename  alias  another.alias;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # HTTPS server</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       443 ssl;</span><br><span class="line">    #    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #    ssl_certificate      cert.pem;</span><br><span class="line">    #    ssl_certificate_key  cert.key;</span><br><span class="line"></span><br><span class="line">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    #    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    #    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">location /html &#123;</span><br><span class="line">    rewrite ^/html/(.*)$ /$1 break;</span><br><span class="line">    proxy_pass http://localhost:9999/;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å½“è®¿é—®æŒ‡å®šåœ°å€ <a href="http://localhost/html">http://localhost/html</a> çš„æ—¶å€™ï¼Œä¼šå…ˆé‡å†™URIåœ°å€</li>
<li>URIç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼^/api/(.*)$ çš„åœ°å€ä¼šè¢«é‡å†™ä¸º /$1</li>
<li>$1è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼ä¸­ç¬¬ä¸€ä¸ª()ä¸­çš„å­—ç¬¦ä¸²</li>
<li>æœ€åæŠŠé‡å†™åçš„æ–°åœ°å€ï¼Œè½¬å‘ç»™<a href="http://localhost:9999/">http://localhost:9999/</a></li>
</ul>
<p>ä¾‹å¦‚ï¼Œ<br>æµè§ˆå™¨ä¸­è®¿é—®<a href="http://localhost/html/ajax">http://localhost/html/ajax</a><br>nginxä»£ç†åï¼Œå…ˆé‡å†™åœ°å€ï¼Œå°†/html/ajaxï¼Œé‡å†™ä¸º/ajax<br>ç„¶åè½¬å‘ç»™<a href="http://localhost:9999/">http://localhost:9999/</a> ï¼Œæœ€ç»ˆè®¿é—®çš„æ˜¯<a href="http://localhost:9999/ajax">http://localhost:9999/ajax</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">location /api &#123;</span><br><span class="line">    rewrite ^/api/(.*)$ /$1 break;</span><br><span class="line">    proxy_pass http://localhost:8989/;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œå’Œä¸Šé¢çš„æè¿°çš„å«ä¹‰ç›¸åŒ</p>
</blockquote>
<p>2ã€ajaxé¡µé¢ä¸­ï¼Œæ–°å¢æŒ‰é’®å’Œajaxè¯·æ±‚</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">  $(&quot;.btn2&quot;).on(&quot;click&quot;,function()&#123;</span><br><span class="line">                $.ajax(&#123;</span><br><span class="line">                    type: &quot;GET&quot;,</span><br><span class="line">                    url : &quot;/api/hi&quot;,</span><br><span class="line">                    success: function(msg)&#123;</span><br><span class="line">                        console.log(msg);</span><br><span class="line">                    &#125;,</span><br><span class="line">                    error: function()&#123;</span><br><span class="line">                        alert(&#x27;error&#x27;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn2&quot;</span>&gt;</span>test2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>3ã€å¯åŠ¨nginxæœåŠ¡å™¨ï¼Œè®¿é—®åœ°å€</p>
<p><a href="http://localhost/html/ajax">http://localhost/html/ajax</a></p>
<blockquote>
<p>æ³¨æ„ï¼Œæ­¤æ—¶è®¿é—®springboot-htmlé¡¹ç›®ä¸­çš„é¡µé¢åœ°å€ï¼Œå’Œä¹‹å‰æ˜¯ä¸ä¸€æ ·çš„</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322074942961.png" alt="image-20210322074942961"></p>
<p>æ²¡æœ‰ä½¿ç”¨nginxä¹‹å‰ï¼Œè®¿é—®springboot-htmlä¸­é¡µé¢çš„åœ°å€ï¼š <a href="http://localhost:9999/ajax">http://localhost:9999/ajax</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322070308045.png" alt="image-20210322070308045"></p>
<p>ä½¿ç”¨nginxä¹‹åï¼Œè®¿é—®springboot-htmlä¸­é¡µé¢çš„åœ°å€ï¼š <a href="http://localhost/html/ajax">http://localhost/html/ajax</a></p>
<p>4ã€ç‚¹å‡»æŒ‰é’®2ï¼Œå‘é€ajaxè¯·æ±‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322075035934.png" alt="image-20210322075035934"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶ajaxè¯·æ±‚å·²ç»æˆåŠŸäº†</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322075121167.png" alt="image-20210322075121167"></p>
<blockquote>
<p>æ³¨æ„ï¼Œæ­¤æ—¶ajaxè¯·æ±‚çš„åœ°å€ä¸ºï¼š <a href="http://localhost/api/hi">http://localhost/api/hi</a></p>
</blockquote>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œå·²å®Œæˆè·¨åŸŸè®¿é—®ï¼Œä½†å…¶å®æ˜¯ä½¿ç”¨nginxä»£ç†æœåŠ¡å™¨æ¥â€œæ¬ºéª—â€æµè§ˆå™¨ï¼Œè®©æµè§ˆå™¨è®¤ä¸ºæ˜¯ â€œåŒæºè®¿é—®â€</p>
</blockquote>
<p>å¦‚å›¾ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322070521188.png" alt="image-20210322070521188"></p>
<blockquote>
<p>æµè§ˆå™¨ä¸­ï¼Œä»å§‹è‡³ç»ˆéƒ½æ˜¯è®¿é—®<a href="http://localhost/">http://localhost/</a> ä¸‹é¢çš„èµ„æºï¼Œæ‰€ä»¥æµè§ˆå™¨è®¤ä¸ºä¸€ç›´æ˜¯â€œåŒæºè®¿é—®â€</p>
</blockquote>
<blockquote>
<p>æµè§ˆå™¨ä¸çŸ¥é“çš„æ˜¯ï¼Œå®ƒè®¿é—®çš„æœåŠ¡å™¨æ˜¯ä¸€ä¸ªnginxä»£ç†æœåŠ¡å™¨ï¼Œå®ƒä¼šæ¥æ”¶æµè§ˆå™¨è¯·æ±‚ï¼Œé‡å†™URIåœ°å€<br>åï¼Œè½¬å‘ç»™çœŸæ­£çš„æœåŠ¡å™¨ã€‚</p>
</blockquote>
<h3 id="3-2-cors"><a href="#3-2-cors" class="headerlink" title="3.2 cors"></a>3.2 cors</h3><h4 id="1ã€æ¦‚å¿µ"><a href="#1ã€æ¦‚å¿µ" class="headerlink" title="1ã€æ¦‚å¿µ"></a>1ã€æ¦‚å¿µ</h4><p>CORS(Cross-origin resource sharing)ï¼Œæ˜¯ä¸€ä¸ªW3Cæ ‡å‡†ï¼Œå…¨ç§°æ˜¯â€è·¨åŸŸèµ„æºå…±äº«â€ã€‚</p>
<ul>
<li>æ•´ä¸ªCORSé€šä¿¡è¿‡ç¨‹ï¼Œéƒ½æ˜¯æµè§ˆå™¨è‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·å‚ä¸ã€‚</li>
<li>å¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒCORSé€šä¿¡ä¸åŒæºçš„AJAXé€šä¿¡æ²¡æœ‰å·®åˆ«ï¼Œä»£ç å®Œå…¨ä¸€æ ·ã€‚</li>
<li>æµè§ˆå™¨ä¸€æ—¦å‘ç°AJAXè¯·æ±‚è·¨æºï¼Œå°±ä¼šè‡ªåŠ¨æ·»åŠ ä¸€äº›é™„åŠ çš„å¤´ä¿¡æ¯ã€‚ï¼ˆOriginï¼‰</li>
<li>æœ‰æ—¶è¿˜ä¼šå¤šå‡ºä¸€æ¬¡é™„åŠ çš„è¯·æ±‚ï¼Œä½†ç”¨æˆ·ä¸ä¼šæœ‰æ„Ÿè§‰ã€‚ï¼ˆoptionsæ–¹å¼çš„è¯·æ±‚ï¼‰</li>
</ul>
<h4 id="2ã€åˆ†ç±»"><a href="#2ã€åˆ†ç±»" class="headerlink" title="2ã€åˆ†ç±»"></a>2ã€åˆ†ç±»</h4><p>æµè§ˆå™¨å°†CORSè¯·æ±‚åˆ†æˆä¸¤ç±»ï¼š</p>
<ul>
<li>ç®€å•è¯·æ±‚ï¼ˆsimple requestï¼‰</li>
<li>éç®€å•è¯·æ±‚ï¼ˆnot-so-simple requestï¼‰</li>
</ul>
<p>åªè¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤å¤§æ¡ä»¶ï¼Œå°±å±äºç®€å•è¯·æ±‚ï¼š</p>
<p>è¯·æ±‚æ–¹æ³•æ˜¯ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ä¹‹ä¸€<br>    GET<br>    POST<br>    HEAD<br>HTTPçš„å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µ<br>    Accept<br>    Accept-Language</p>
<p>â€‹    Content-Language<br>â€‹    Last-Event-ID<br>â€‹    Content-Typeï¼Œè¯¥å­—æ®µçš„å€¼åªèƒ½æ˜¯ä»¥ä¸‹ä¸‰ç§</p>
<p>â€‹        application/x-www-form-urlencoded</p>
<p>â€‹        multipart/form-data<br>â€‹        text/plain</p>
<blockquote>
<p>æ³¨æ„ï¼Œåªè¦ä¸èƒ½åŒæ—¶æ»¡è¶³ä¸Šé¢ä¸¤ä¸ªæ¡ä»¶ï¼Œå°±å±äºéç®€å•è¯·æ±‚ã€‚</p>
</blockquote>
<h4 id="3ã€ç®€å•è¯·æ±‚"><a href="#3ã€ç®€å•è¯·æ±‚" class="headerlink" title="3ã€ç®€å•è¯·æ±‚"></a>3ã€ç®€å•è¯·æ±‚</h4><p>å¯¹äºç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ç›´æ¥å‘å‡ºCORSè¯·æ±‚ï¼ŒåŒæ—¶åœ¨è¯·æ±‚å¤´ä¸­å¢åŠ ä¸€ä¸ªOriginå­—æ®µã€‚<br>è¯¥å­—æ®µè¡¨ç¤ºï¼Œæœ¬æ¬¡è¯·æ±‚æ¥è‡ªå“ªä¸ªæºï¼ˆåè®® + åŸŸå + ç«¯å£ï¼‰ï¼ŒæœåŠ¡å™¨æ ¹æ®è¿™ä¸ªå€¼ï¼Œå†³å®šæ˜¯å¦åŒæ„è¿™æ¬¡è¯·<br>æ±‚ã€‚</p>
<p>OriginæŒ‡å®šçš„æºï¼Œå³ä½¿ä¸åœ¨æœåŠ¡å™¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨è¿˜æ˜¯ä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„HTTPå“åº”ï¼Œä½†æ˜¯å“åº”å¤´ä¸­<br>ä¸å«æŒ‡å®šAccess-Control-Allow-Originå­—æ®µï¼Œæµè§ˆå™¨è¿™æ—¶å€™å°±çŸ¥é“æœ¬æ¬¡è·¨åŸŸè®¿é—®å¤±è´¥ã€‚<br>ä½†æ˜¯è¿™ä¸ªæ—¶å€™ï¼Œå“åº”çŠ¶æ€å¯èƒ½æ˜¯200ï¼ŒåŒæ—¶åœ¨ä¸€äº›å·¥å…·ä¸­è¿˜èƒ½çœ‹åˆ°æ­£ç¡®çš„è¿”å›å€¼ã€‚<br>ä¾‹å¦‚ï¼Œ</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322070848847.png" alt="image-20210322070848847"></p>
<p>å…¶ä¸­ï¼Œ</p>
<ol>
<li>æµè§ˆå™¨åœ¨è¯·æ±‚å¤´ä¸­è‡ªåŠ¨æ·»åŠ äº†Origin å­—æ®µ</li>
<li>æœåŠ¡å™¨åœ¨å“åº”ä¸­æ²¡æœ‰æ·»åŠ Access-Control-Allow-Origin å­—æ®µï¼ˆè¯´æ˜æœåŠ¡å™¨ä¸æ”¯æŒæ­¤è¯·æ±‚è·¨åŸŸè®¿<br>é—®ï¼‰</li>
<li>å“åº”çš„çŠ¶æ€ç æ˜¯200ï¼Œå¹¶ä¸”ä»å“åº”å†…å®¹ä¸­å¯ä»¥çœ‹åˆ°æ­£ç¡®çš„è¿”å›å†…å®¹</li>
<li>åŒæ—¶ï¼Œæµè§ˆå™¨ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¢«ajaxçš„æ ¸å¿ƒå¯¹è±¡XMLHttpRequestçš„onerror å›è°ƒå‡½æ•°æ•è·</li>
</ol>
<p>å¦‚æœOriginæŒ‡å®šçš„åŸŸååœ¨æœåŠ¡å™¨çš„è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨è¿”å›çš„å“åº”ï¼Œä¼šå¤šå‡ºå‡ ä¸ªå¤´ä¿¡æ¯å­—æ®µï¼š</p>
<ol>
<li><p>Access-Control-Allow-Origin<br>è¯¥å­—æ®µæ˜¯å¿…é¡»çš„ã€‚<br>å®ƒçš„å€¼è¦ä¹ˆæ˜¯è¯·æ±‚æ—¶Originå­—æ®µçš„å€¼ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ª*ï¼Œè¡¨ç¤ºæ¥å—ä»»æ„åŸŸåçš„è·¨åŸŸè¯·æ±‚ã€‚</p>
</li>
<li><p>Access-Control-Allow-Credentials</p>
<p>è¯¥å­—æ®µå¯é€‰<br>è¡¨ç¤ºæ˜¯å¦å…è®¸å‘é€Cookieã€‚<br>è®¾ä¸ºtrueï¼Œå³è¡¨ç¤ºæœåŠ¡å™¨å·²ç»å…è®¸äº†ï¼Œè·¨åŸŸè¯·æ±‚ä¸­å¯ä»¥æºå¸¦Cookieã€‚<br>ä½†æ˜¯è¿™éœ€è¦AJAXä¸­è®¾ç½®withCredentials=trueè¿›è¡Œé…åˆã€‚<br>å¦‚æœæœåŠ¡å™¨ä¸è¦æµè§ˆå™¨å‘é€Cookieï¼Œåˆ é™¤è¯¥å­—æ®µå³å¯ã€‚</p>
</li>
</ol>
<p><code>3. Access-Control-Expose-Headers</code></p>
<p>â€‹    è¯¥å­—æ®µå¯é€‰<br>â€‹    åˆ—å‡ºäº†å“ªäº›é¦–éƒ¨å¯ä»¥ä½œä¸ºå“åº”çš„ä¸€éƒ¨åˆ†æš´éœ²ç»™å¤–éƒ¨ã€‚<br>â€‹    é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸ƒç§å¯ä»¥æš´éœ²ç»™å¤–éƒ¨<br>â€‹    Cache-Control<br>â€‹    Content-Language<br>â€‹    Content-Length<br>â€‹    Content-Type<br>â€‹    Expires<br>â€‹    Last-Modified<br>â€‹    Pragma</p>
<p>â€‹    å¦‚æœæƒ³è¦è®©å®¢æˆ·ç«¯å¯ä»¥è®¿é—®åˆ°å…¶ä»–çš„é¦–éƒ¨ä¿¡æ¯ï¼Œå¯ä»¥å°†å®ƒä»¬åœ¨Access-Control-Expose-Headersé‡Œé¢æŒ‡å®š</p>
<h4 id="4ã€éç®€å•è¯·æ±‚"><a href="#4ã€éç®€å•è¯·æ±‚" class="headerlink" title="4ã€éç®€å•è¯·æ±‚"></a>4ã€éç®€å•è¯·æ±‚</h4><p>éç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯PUTæˆ–DELETEï¼Œæˆ–è€…Content-Typeå­—æ®µ<br>çš„ç±»å‹æ˜¯application/jsonã€‚<br>éç®€å•è¯·æ±‚çš„CORSè¯·æ±‚ï¼Œä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œå¢åŠ ä¸€æ¬¡HTTPæŸ¥è¯¢è¯·æ±‚ï¼Œç§°ä¸ºâ€é¢„æ£€â€è¯·æ±‚ï¼ˆpreflightï¼‰ã€‚<br>æµè§ˆå™¨å…ˆè¯¢é—®æœåŠ¡å™¨ï¼Œå½“å‰ç½‘é¡µæ‰€åœ¨çš„åŸŸåæ˜¯å¦åœ¨æœåŠ¡å™¨çš„è®¸å¯åå•ä¹‹ä¸­ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº›HTTPåŠ¨è¯<br>å’Œå¤´ä¿¡æ¯å­—æ®µã€‚åªæœ‰å¾—åˆ°è‚¯å®šç­”å¤ï¼Œæµè§ˆå™¨æ‰ä¼šå‘å‡ºæ­£å¼çš„XMLHttpRequestè¯·æ±‚ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="string">&quot;.btn1&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">        <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span><br><span class="line">        <span class="attr">contentType</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">        <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(msg);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œåœ¨è¯·æ±‚å¤´ä¸­ï¼ŒæŒ‡å®šcontentTypeä¸ºapplication/json</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322071208502.png" alt="image-20210322071208502"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œè¯·æ±‚å¤´ä¸­æœ‰Content-Type:application/json å­—æ®µï¼Œå±äºéç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šæå‰å‘é€ä¸€ä¸ªoptionæ–¹å¼çš„â€œé¢„æ£€è¯·æ±‚â€(é¢„æ£€è¯·æ±‚ä¼šç¼“å­˜)</p>
</blockquote>
<p>åœ¨è¿™ä¸ªâ€œé¢„æ£€è¯·æ±‚â€çš„å“åº”ä¸­ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€äº›æ•°æ®æ¥é€šçŸ¥æµè§ˆå™¨ï¼ŒæœåŠ¡å™¨å¯¹è·¨åŸŸè¯·æ±‚çš„è¦æ±‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20210322071259213.png" alt="image-20210322071259213"></p>
<p>å¦‚æœæµè§ˆå™¨å¦å®šäº†â€œé¢„æ£€â€è¯·æ±‚ï¼Œä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„HTTPå›åº”ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•CORSç›¸å…³çš„å¤´ä¿¡æ¯å­—æ®µã€‚<br>è¿™æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šè®¤å®šï¼ŒæœåŠ¡å™¨ä¸åŒæ„é¢„æ£€è¯·æ±‚ï¼Œå› æ­¤è§¦å‘ä¸€ä¸ªé”™è¯¯ï¼Œè¢«XMLHttpRequestå¯¹è±¡çš„onerror<br>å›è°ƒå‡½æ•°æ•è·ã€‚</p>
<blockquote>
<p>æµ‹è¯•ç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚</p>
</blockquote>
<p>==â€œé¢„æ£€â€æˆåŠŸçš„å¸¸è§å“åº”å¤´éƒ¨å­—æ®µæœ‰ï¼š==</p>
<ul>
<li>Access-Control-Allow-Origin</li>
<li>Access-Control-Allow-Methods</li>
<li>Access-Control-Allow-Headers</li>
<li>Access-Control-Allow-Credentials<br>æ ‡ç­¾å…è®¸å®¢æˆ·ç«¯æºå¸¦éªŒè¯ä¿¡æ¯ï¼Œä¾‹å¦‚ cookie<pre><code>Access-Control-Max-Age
è¡¨ç¤ºé¢„æ£€è¯·æ±‚çš„è¿”å›ç»“æœï¼ˆå³Access-Control-Allow-Methods å’ŒAccess-Control-Allow-Headersæä¾›çš„ä¿¡æ¯ï¼‰ å¯ä»¥è¢«ç¼“å­˜å¤šä¹…ã€‚
</code></pre>
</li>
</ul>
<p>æ³¨æ„ï¼Œajaxè·¨åŸŸè®¿é—®çš„æ—¶å€™ï¼Œå¦‚æœéœ€è¦åœ¨è¯·æ±‚ä¸­æºå¸¦cookieï¼Œéœ€è¦æœ‰ä»¥ä¸‹è®¾ç½®</p>
<ol>
<li><p>å‰ç«¯ajaxè¯·æ±‚ä¸­ï¼ŒæŒ‡å®šwithCredentialså±æ€§ä¸ºture</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">    <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span><br><span class="line">    <span class="attr">xhrFields</span>:&#123;</span><br><span class="line">   		 <span class="attr">withCredentials</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(msg);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>åç«¯å“åº”å¤´ä¸­ï¼Œè®¾ç½®Access-Control-Allow-Credentialså±æ€§ä¸ºtrue</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å…è®¸è·¨åŸŸæºå¸¦cookie</span></span><br><span class="line">response.setHeader(<span class="string">&quot;Access-Control-Allow-Credentials&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ol>
<ol start="3">
<li>åç«¯å“åº”å¤´ä¸­ï¼Œè®¾ç½®Access-Control-Allow-Originå±æ€§ä¸ºå…·ä½“çš„å€¼ï¼Œè€Œä¸æ˜¯èƒ½é€šé…ç¬¦*</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);</span></span><br><span class="line">response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;http://127.0.0.1:9999&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">	<span class="comment">// å…è®¸cookieçš„æƒ…å†µä¸‹ å‰ç«¯é…ç½® åå°é…ç½®</span></span><br><span class="line">	<span class="meta">@GetMapping(&quot;/hi&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">		response.setHeader(<span class="string">&quot;Access-Control-Allow-Credentials&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">		response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;http://localhost:9999&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">   <span class="comment">// ä¸å…è®¸cookieçš„æƒ…å†µä¸‹</span></span><br><span class="line">   <span class="meta">@GetMapping(&quot;/hi&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">		response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å‰ç«¯è®¿é—® <a href="http://localhost:9999/ajax">http://localhost:9999/ajax</a> åå°å°±é… localhost</p>
<p>æ­¤æ—¶æ— æ³•å¤„ç†é¢„æ£€æŸ¥è¯·æ±‚</p>
</blockquote>
<p>å¯æ·»åŠ æ‹¦æˆªå™¨ï¼ˆäº†è§£ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.web.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CosInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		response.setHeader(<span class="string">&quot;Access-Control-Allow-Credentials&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">		response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;http://localhost:9999&quot;</span>);</span><br><span class="line">		response.setHeader(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>,<span class="string">&quot;POST, GET, OPTIONS, DELETE&quot;</span>);</span><br><span class="line">		response.setHeader(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;Content-Type, x-requested-with, X-Custom-Header, Authorization&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;è·¨åŸŸ&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.CorsRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.cms.web.interceptor.CosInterceptor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addInterceptor(cosInterceptor())</span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CosInterceptor <span class="title">cosInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CosInterceptor();</span><br><span class="line">    &#125;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œåç«¯ä»£ç ä½¿ç”¨çš„ä½¿ç”¨responseè®¾ç½®çš„ï¼Œåœ¨springmvcä¸­ï¼Œä¹Ÿå¯ä»¥ä¸“é—¨çš„è®¾ç½®æ–¹æ³•æ¥ä»£æ›¿è¿™ç§æ–¹å¼</p>
</blockquote>
<h4 id="5ã€ä½¿ç”¨"><a href="#5ã€ä½¿ç”¨" class="headerlink" title="5ã€ä½¿ç”¨"></a>5ã€ä½¿ç”¨</h4><p>springboot-htmlé¡¹ç›®ä¸­çš„ajax.htmlé¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;script src=&quot;https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js&quot;&gt;&lt;/script&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;.btn1&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">console</span>.log(msg);</span></span><br><span class="line"><span class="javascript">                    &#125;,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        alert(<span class="string">&#x27;error&#x27;</span>);</span></span><br><span class="line"><span class="javascript">                    &#125;</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;.btn2&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">url</span> : <span class="string">&quot;/api/hi&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">console</span>.log(msg);</span></span><br><span class="line"><span class="javascript">                    &#125;,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        alert(<span class="string">&#x27;error&#x27;</span>);</span></span><br><span class="line"><span class="javascript">                    &#125;</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript">            </span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;.btn3&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">console</span>.log(msg);</span></span><br><span class="line"><span class="javascript">                    &#125;,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        alert(<span class="string">&#x27;error&#x27;</span>);</span></span><br><span class="line"><span class="javascript">                    &#125;</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        &#125;);</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn1&quot;</span>&gt;</span>test1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn2&quot;</span>&gt;</span>test2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn3&quot;</span>&gt;</span>test3<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¸»è¦æµ‹è¯•çš„æ˜¯test3æŒ‰é’®</p>
</blockquote>
<p>springboot-corsé¡¹ç›®ä¸­çš„Controllerï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.web.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@GetMapping(&quot;/hi&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>springboot-corsé¡¹ç›®ä¸­çš„é…ç½®ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.CorsRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)<span class="comment">//æ˜ å°„æ‰€æœ‰è·¯å¾„</span></span><br><span class="line">        .allowedOrigins(<span class="string">&quot;*&quot;</span>)<span class="comment">//è¿è¡Œæ‰€æœ‰å®¢æˆ·ç«¯è®¿é—®</span></span><br><span class="line">        .allowCredentials(<span class="keyword">false</span>)<span class="comment">//ä¸å…è®¸æºå¸¦cookie</span></span><br><span class="line">        .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)<span class="comment">//</span></span><br><span class="line">        æ”¯æŒçš„æ–¹æ³•</span><br><span class="line">        .allowedHeaders(<span class="string">&quot;*&quot;</span>)<span class="comment">//è¿è¡Œæ‰€æœ‰è¯·æ±‚å¤´å­—æ®µ</span></span><br><span class="line">        .maxAge(<span class="number">3600</span>);<span class="comment">//å…è®¸å®¢æˆ·ç«¯ç¼“å­˜â€œé¢„æ£€è¯·æ±‚â€ä¸­è·å–çš„ä¿¡æ¯ï¼Œ3600ç§’</span></span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¸»è¦é…ç½®äº†è·¨åŸŸè®¿é—®çš„å±æ€§</p>
</blockquote>
<p>å¯åŠ¨ä¿©ä¸ªé¡¹ç›®ï¼Œè®¿é—®é¡µé¢ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œæµ‹è¯•ajaxè·¨åŸŸè®¿é—®ï¼š</p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶ajaxè¯·æ±‚è¿›è¡Œè·¨åŸŸè®¿é—®ï¼Œå·²ç»æˆåŠŸ</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œæ­¤æ—¶å¯ä»¥å°è¯•åœ¨ajaxè¯·æ±‚ä¸­ï¼Œè®¾ç½®contentType: application/json ,è§‚å¯Ÿæ˜¯å¦ä¼šå‘å‡ºâ€œé¢„æ£€â€è¯·æ±‚</p>
</blockquote>
<p>åŒæ—¶ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹ajaxè¯·æ±‚ï¼Œè®©å…¶å†™çš„cookieå’ŒæŒ‡å®šå­—æ®µçš„å¤´éƒ¨ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="string">&quot;.btn3&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">        <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span><br><span class="line">        <span class="attr">xhrFields</span>:&#123;</span><br><span class="line">        <span class="attr">withCredentials</span>: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">headers</span>:&#123;</span><br><span class="line">        <span class="attr">token</span>:<span class="string">&quot;aaa.bbb.ccc&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">contentType</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">        <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(msg);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">        alert(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œå¯¹åº”çš„åç«¯è·¨åŸŸè®¾ç½®ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">        .allowedOrigins(<span class="string">&quot;http://localhost:9999&quot;</span>)</span><br><span class="line">        .allowCredentials(<span class="keyword">true</span>)</span><br><span class="line">        .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)</span><br><span class="line">        .allowedHeaders(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">        .maxAge(<span class="number">3600</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="6ã€å…¶ä»–"><a href="#6ã€å…¶ä»–" class="headerlink" title="6ã€å…¶ä»–"></a>6ã€å…¶ä»–</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">    registry.addMapping(<span class="string">&quot;/**&quot;</span>)<span class="comment">//æ˜ å°„æ‰€æœ‰è·¯å¾„</span></span><br><span class="line">    .allowedOrigins(<span class="string">&quot;*&quot;</span>)<span class="comment">//è¿è¡Œæ‰€æœ‰å®¢æˆ·ç«¯è®¿é—®</span></span><br><span class="line">    .allowCredentials(<span class="keyword">false</span>)<span class="comment">//ä¸å…è®¸æºå¸¦cookie</span></span><br><span class="line">    .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)<span class="comment">//æ”¯æŒçš„æ–¹æ³•</span></span><br><span class="line">    .allowedHeaders(<span class="string">&quot;*&quot;</span>)<span class="comment">//è¿è¡Œæ‰€æœ‰è¯·æ±‚å¤´å­—æ®µ</span></span><br><span class="line">    .maxAge(<span class="number">3600</span>);<span class="comment">//å…è®¸å®¢æˆ·ç«¯ç¼“å­˜â€œé¢„æ£€è¯·æ±‚â€ä¸­è·å–çš„ä¿¡æ¯ï¼Œ3600ç§’</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨æ­¤é…ç½®ä¸­ï¼Œå¦‚æœè®¾ç½®allowCredentials(true) ï¼Œé‚£ä¹ˆallowedOrigins(â€œ*â€) è¿™é‡Œå°±ä¸èƒ½ä½¿ç”¨é€š<br>é…ç¬¦äº†ï¼Œå¿…é¡»è¦å†™ä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼ˆå¯å˜å‚æ•°ï¼‰å®¢æˆ·ç«¯çš„åœ°å€<br>ä¾‹å¦‚ï¼Œ allowedOrigins(â€œ<a href="http://127.0.0.1:9999&quot;">http://127.0.0.1:9999&quot;</a>)</p>
<p>å¦å¤–ï¼Œå¦‚æœåªæ˜¯æƒ³è®©Controllerä¸­çš„æŸä¸€ä¸ªæ–¹æ³•æˆ–è€…å‡ ä¸ªæ–¹æ³•è¢«è·¨åŸŸè®¿é—®ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨æ–¹æ³•ä¸Šä½¿ç”¨<br>@CrossOrigin æ³¨è§£ï¼Œä¾‹å¦‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@CrossOrigin(origins = &#123;&quot;http://127.0.0.1:9999&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hi&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œæ­¤æ—¶å°±ä¸éœ€è¦åœ¨é…ç½®ç±»ä¸­åšå…¶ä»–é…ç½®äº†ï¼Œç›´æ¥ä¸€ä¸ªæ³¨è§£å°±å¯ä»¥è®©è¯¥æ–¹æ³•è¢«è·¨åŸŸè®¿é—®äº†</p>
</blockquote>
<h1 id="è§’è‰²æ¨¡å—-1"><a href="#è§’è‰²æ¨¡å—-1" class="headerlink" title="è§’è‰²æ¨¡å—"></a>è§’è‰²æ¨¡å—</h1><ul>
<li>ä¸€ä¸ªè§’è‰²æœ‰å¤šä¸ªç”¨æˆ· å¤–é”®åœ¨ç”¨æˆ·æ–¹</li>
<li>jpaå®ä½“æ˜ å°„å¯ä»¥åªé…ç½®ä¸€æ–¹</li>
</ul>
<h2 id="å®ä½“"><a href="#å®ä½“" class="headerlink" title="å®ä½“"></a>å®ä½“</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;cms_role&quot;)</span></span><br><span class="line"><span class="meta">@ApiModel(&quot;è§’è‰²æ¨¡å‹&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Role</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;id&quot;,value = &quot;è§’è‰²id&quot;,example = &quot;1&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;name&quot;,value = &quot;è§’è‰²åç§°&quot;,example = &quot;admin&quot;)</span></span><br><span class="line">	<span class="meta">@Column(nullable = false)</span></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;name&quot;,value = &quot;è§’è‰²æè¿°&quot;,example = &quot;manager&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String description;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//private Set&lt;User&gt; userList;</span></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> description;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDescription</span><span class="params">(String description)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.description = description;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="æ¥å£-1"><a href="#æ¥å£-1" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RoleService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//åˆ†é¡µè·å–æ‰€æœ‰è§’è‰²ä¿¡æ¯</span></span><br><span class="line">	<span class="function">Page&lt;Role&gt; <span class="title">findAll</span><span class="params">(Integer pageNum,Integer pageSize)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//æ–°å¢è§’è‰²ä¿¡æ¯æˆ–è€…æ›´æ–°è§’è‰²ä¿¡æ¯</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">saveOrUpdateRole</span><span class="params">(Role role)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//æ‰¹é‡åˆ é™¤è§’è‰²ä¿¡æ¯</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">deleteRoleInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ’å…¥è§’è‰²"><a href="#æ’å…¥è§’è‰²" class="headerlink" title="æ’å…¥è§’è‰²"></a>æ’å…¥è§’è‰²</h2><h3 id="service-1"><a href="#service-1" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveOrUpdateRole</span><span class="params">(Role role)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(role.getId() == <span class="keyword">null</span>) &#123;</span><br><span class="line">			roleDao.save(role);</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			Role target = roleDao.findById(role.getId()).get();</span><br><span class="line">			NotNullNameUtil.getNotNullNames(role, target);</span><br><span class="line">			roleDao.save(target);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-1"><a href="#controller-1" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;æ·»åŠ æˆ–ä¿®æ”¹è§’è‰²&quot;,notes = &quot;æ— id: æ·»åŠ  æœ‰idï¼šä¿®æ”¹&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">saveOrUpdate</span><span class="params">(<span class="meta">@RequestBody</span> Role role)</span> </span>&#123;</span><br><span class="line">		roleService.saveOrUpdateRole(role);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ†é¡µæŸ¥è¯¢"><a href="#åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h2><h3 id="service-2"><a href="#service-2" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Page&lt;Role&gt; <span class="title">findAll</span><span class="params">(Integer pageNum, Integer pageSize)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		Pageable page = PageRequest.of(pageNum, pageSize);</span><br><span class="line">		<span class="keyword">return</span> roleDao.findAll(page);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-2"><a href="#controller-2" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;&#123;pageNum&#125;/&#123;pageSize&#125;&quot;)</span></span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;åˆ†é¡µæŸ¥è¯¢&quot;,notes = &quot;å½“å‰é¡µé¢é¡µç å’Œæ¯é¡µæ¡æ•°&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">findByPage</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;pageNum&quot;,value = &quot;å½“å‰é¡µ&quot;,required = true)</span> </span></span></span><br><span class="line"><span class="params"><span class="function">				<span class="meta">@PathVariable(&quot;pageNum&quot;)</span> </span></span></span><br><span class="line"><span class="params"><span class="function">					Integer pageNum,</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;pageSize&quot;,value = &quot;æ¯é¡µæ˜¾ç¤ºæ¡æ•°&quot;,required = true)</span> </span></span></span><br><span class="line"><span class="params"><span class="function">				<span class="meta">@PathVariable(&quot;pageSize&quot;)</span></span></span></span><br><span class="line"><span class="params"><span class="function">					Integer pageSize)</span> </span>&#123;</span><br><span class="line">		Page&lt;Role&gt; page = roleService.findAll(pageNum, pageSize);</span><br><span class="line">		List&lt;Role&gt; context = page.getContent();</span><br><span class="line">		<span class="keyword">long</span> total = page.getTotalElements();</span><br><span class="line">		Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">		map.put(<span class="string">&quot;context&quot;</span>, context);</span><br><span class="line">		map.put(<span class="string">&quot;total&quot;</span>, total);</span><br><span class="line">		<span class="keyword">return</span> Result.success(map);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><h3 id="service-3"><a href="#service-3" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteRoleInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		List&lt;Role&gt; roleList  = roleDao.findAllById(ids);</span><br><span class="line">		<span class="keyword">if</span>(roleList == <span class="keyword">null</span> || roleList.size() == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_NONE);</span><br><span class="line">		&#125;</span><br><span class="line">		roleDao.deleteInBatch(roleList);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-3"><a href="#controller-3" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping</span></span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;åˆ é™¤è§’è‰²&quot;,notes = &quot;ä¼ å¤šä¸ªIdå€¼&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">deleteBatch</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@RequestParam(name=&quot;ids&quot;)</span></span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;ids&quot;,value = &quot;è§’è‰²id&quot;,required = true)</span> List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">		roleService.deleteRoleInBatch(ids);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p><code>é—®é¢˜</code></p>
<p>å¤–é”®è¢«å¼•ç”¨æ— æ³•åˆ é™¤ã€‚</p>
<ul>
<li>åˆ é™¤è§’è‰²çº§è”åˆ é™¤ç”¨æˆ·ï¼Ÿ</li>
<li>åˆ¤æ–­å¦‚æœè§’è‰²åœ¨ä½¿ç”¨ä¸è®©åˆ é™¤ï¼Ÿ</li>
<li>åˆ é™¤è§’è‰² å°†ç”¨æˆ·å¤–é”®ç½®ç©º</li>
</ul>
<h2 id="å¤–é”®ç½®ç©º"><a href="#å¤–é”®ç½®ç©º" class="headerlink" title="å¤–é”®ç½®ç©º"></a>å¤–é”®ç½®ç©º</h2><h3 id="æ•°æ®åº“è®¾ç½®"><a href="#æ•°æ®åº“è®¾ç½®" class="headerlink" title="æ•°æ®åº“è®¾ç½®"></a>æ•°æ®åº“è®¾ç½®</h3><p><img src="https://gitee.com/vanse/images/raw/master/cms/image-20211112193132222.png" alt="image-20211112193132222"></p>
<h3 id="jpaè®¾ç½®"><a href="#jpaè®¾ç½®" class="headerlink" title="jpaè®¾ç½®"></a>jpaè®¾ç½®</h3><blockquote>
<p>JPAé»˜è®¤åˆ é™¤å¤–é”®ç­–ç•¥æ˜¯å¤–é”®ç½®ç©º ä½†æ˜¯éœ€è¦ä¸¤æ–¹éƒ½è®¾ç½®å…³ç³» ä¸å»ºè®®ï¼Œå¦åˆ™ä¸¤è¾¹éƒ½ç»´æŠ¤å¤–é”®å…³ç³»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ManyToOne(targetEntity = Role.class)</span></span><br><span class="line"><span class="meta">@JoinColumn(name=&quot;role_id&quot;,referencedColumnName = &quot;id&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Role role;</span><br><span class="line"></span><br><span class="line"><span class="meta">@OneToMany(targetEntity = User.class)</span></span><br><span class="line"><span class="meta">@JoinColumn(name = &quot;role_id&quot;, referencedColumnName = &quot;id&quot;)</span></span><br><span class="line"><span class="keyword">private</span> List&lt;User&gt; userList;</span><br></pre></td></tr></table></figure>



<h2 id="ç”¨æˆ·"><a href="#ç”¨æˆ·" class="headerlink" title="ç”¨æˆ·"></a>ç”¨æˆ·</h2><blockquote>
<p>ç”±äºè®¾ç½®äº†è§’è‰²å’Œç”¨æˆ·çš„å…³ç³»ï¼Œæ­¤æ—¶ç”¨æˆ·æ¨¡å—çš„æ¥å£å‘ç”Ÿäº†å˜åŒ–</p>
</blockquote>
<h3 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h3><blockquote>
<p>jpaè‡ªå¸¦å¯¼èˆªæŸ¥è¯¢ï¼ŒæŸ¥æ‰¾ç”¨æˆ·æ—¶åŒæ—¶æŸ¥æ‰¾è§’è‰²</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;code&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;msg&quot;</span>: <span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;data&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;xvxcv&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;sdfs&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;phone&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;realName&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;gender&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;birthday&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;registerTime&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;image&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;role&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;sdf&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;sdf&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ–°å¢"><a href="#æ–°å¢" class="headerlink" title="æ–°å¢"></a>æ–°å¢</h3><blockquote>
<p>  æ’å…¥ç”¨æˆ·æ—¶ ä¼šé»˜è®¤æä¾›è§’è‰²ç±»</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;birthday&quot;</span>: <span class="string">&quot;1900-01-13&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;gender&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;phone&quot;</span>: <span class="string">&quot;175********&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;realName&quot;</span>: <span class="string">&quot;è€åˆ˜&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;role&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;id&quot;</span>: <span class="number">2</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;jack2&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="ç›®å½•æ¨¡å—"><a href="#ç›®å½•æ¨¡å—" class="headerlink" title="ç›®å½•æ¨¡å—"></a>ç›®å½•æ¨¡å—</h1><ul>
<li><p>ä¸€ä¸ªç›®å½•æœ‰å¤šä¸ªå­ç›®å½•</p>
</li>
<li><p>ä¸€ä¸ªç›®å½•æœ‰å¤šä¸ªæ–‡ç« </p>
</li>
<li><p>ä¸€ä¸ªç”¨æˆ·æœ‰å¤šä¸ªæ–‡ç« </p>
</li>
<li><p>ä¸€ä¸ªç”¨æˆ·æœ‰å¤šä¸ªè¯„è®º</p>
</li>
<li><p>ä¸€ä¸ªæ–‡ç« æœ‰å¤šä¸ªè¯„è®º</p>
</li>
<li><p>ä¸€ä¸ªè¯„è®ºæœ‰å¤šä¸ªå­è¯„è®º</p>
</li>
</ul>
<h2 id="å®ä½“-1"><a href="#å®ä½“-1" class="headerlink" title="å®ä½“"></a>å®ä½“</h2><p>ç›®å½•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;cms_category&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;id&quot;,value = &quot;åˆ†ç±»id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(nullable = false)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;name&quot;,value = &quot;åˆ†ç±»åç§°&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;description&quot;,value = &quot;åˆ†ç±»æè¿°&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String description;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(columnDefinition = &quot;int(10) COMMENT &#x27;åºå·&#x27;&quot;)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;no&quot;,value = &quot;æ’åºç¼–å·&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> no;</span><br><span class="line">	<span class="comment">//lprivate int parent_id;</span></span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;parent_id&quot;,referencedColumnName = &quot;id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Category category; <span class="comment">// çˆ¶ç›®å½•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–‡ç« </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;cms_article&quot;)</span></span><br><span class="line"><span class="meta">@ApiModel(&quot;æ–‡ç« æ¨¡å‹&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Article</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;id&quot;,value = &quot;æ–‡ç« id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(nullable = false)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;title&quot;,value = &quot;æ–‡ç« æ ‡é¢˜&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String title;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(nullable = false,length = 1024)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;content&quot;,value = &quot;æ–‡ç« å†…å®¹&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String content;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(name = &quot;publish_time&quot;)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;publishTime&quot;,value = &quot;æ–‡ç« å‘å¸ƒæ—¶é—´&quot;,hidden = true)</span></span><br><span class="line">	<span class="keyword">private</span> Date publishTime;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;status&quot;,value = &quot;å®¡æ ¸çŠ¶æ€&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> status;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;readTimes&quot;,value = &quot;é˜…è¯»æ¬¡æ•°&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> readTimes;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(name = &quot;thumb_up&quot;)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;thumbUp&quot;,value = &quot;ç‚¹èµæ•°&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> thumbUp;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(name = &quot;thumb_down&quot;)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;thumbDown&quot;,value = &quot;ç‚¹è¸©æ•°&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> thumbDown;</span><br><span class="line">	<span class="comment">//private int userId;</span></span><br><span class="line">	<span class="comment">//private categoryId;</span></span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;category_id&quot;,referencedColumnName = &quot;id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Category category;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;user_id&quot;,referencedColumnName = &quot;id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> User user;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@OneToMany(mappedBy = &quot;article&quot;,cascade = CascadeType.ALL,targetEntity = Comment.class)</span></span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">	<span class="keyword">private</span> Set&lt;Comment&gt; comments = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¯„è®º</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;cms_comment&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Comment</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;id&quot;,value = &quot;è¯„è®ºid&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;content&quot;,value = &quot;è¯„è®ºå†…å®¹&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String content;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ApiModelProperty(name = &quot;time&quot;,value = &quot;è¯„è®ºæ—¶é—´&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Date time; <span class="comment">// è¯„è®ºæ—¶é—´</span></span><br><span class="line"><span class="comment">//	private int userId;</span></span><br><span class="line"><span class="comment">//	private int articleId;</span></span><br><span class="line"><span class="comment">//	private int parentId;</span></span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;user_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> User user;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;article_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Article article;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;comment_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Comment comment;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ¥å£-2"><a href="#æ¥å£-2" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//åˆ†é¡µè·å–æ‰€æœ‰åˆ†ç±»</span></span><br><span class="line">	<span class="function">Page&lt;Category&gt; <span class="title">findAll</span><span class="params">(Integer pageNum,Integer pageSize)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//æ–°å¢åˆ†ç±»æˆ–è€…æ›´æ–°åˆ†ç±»</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">saveOrUpdateCategory</span><span class="params">(Category category)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//æ‰¹é‡åˆ é™¤åˆ†ç±»</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">deleteCategoryInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//æŒ‰åºå·å‡åºæŸ¥è¯¢åˆ†ç±»ä¿¡æ¯ï¼Œå¹¶è¿›è¡Œåˆ†é¡µ</span></span><br><span class="line">	<span class="function">Page&lt;Category&gt; <span class="title">findAllSortbyno</span><span class="params">(Integer pageNum,Integer pageSize)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//æ›´æ–°åˆ†ç±»åºå·</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">updateCategoryNo</span><span class="params">(Integer id,<span class="keyword">int</span> no)</span><span class="keyword">throws</span> ServiceException</span>;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="æ–°å¢-æ›´æ–°-1"><a href="#æ–°å¢-æ›´æ–°-1" class="headerlink" title="æ–°å¢/æ›´æ–°"></a>æ–°å¢/æ›´æ–°</h2><h3 id="service-4"><a href="#service-4" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ æˆ–è€…æ›´æ–°ç›®å½• </span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveOrUpdateCategory</span><span class="params">(Category category)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		Integer id = category.getId();</span><br><span class="line">		String name = category.getName();</span><br><span class="line">		<span class="keyword">if</span>(id == <span class="keyword">null</span>) &#123;</span><br><span class="line">			categoryDao.save(category);</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			Category target = categoryDao.findById(id).get();</span><br><span class="line">			NotNullNameUtil.getNotNullNames(category, target);</span><br><span class="line">			categoryDao.save(target);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-4"><a href="#controller-4" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ–°å¢/æ›´æ–°ç›®å½•&quot;,notes = &quot;æ–°å¢/æ›´æ–°ç›®å½•ï¼Œéœ€è¦jsonæ ¼å¼çš„å­—ç¬¦ä¸²&quot;)</span></span><br><span class="line">	<span class="meta">@PostMapping(&quot;/category&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">saveOrUpdateCategory</span><span class="params">(<span class="meta">@RequestBody</span> Category category)</span> </span>&#123;</span><br><span class="line">	    categoryService.saveOrUpdateCategory(category);</span><br><span class="line">	    <span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ‰¹é‡åˆ é™¤-1"><a href="#æ‰¹é‡åˆ é™¤-1" class="headerlink" title="æ‰¹é‡åˆ é™¤"></a>æ‰¹é‡åˆ é™¤</h2><h3 id="service-5"><a href="#service-5" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteCategoryInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		<span class="comment">// ç›®å½•å…³è”äº†æ–‡ç«  ä¸èƒ½åˆ é™¤ </span></span><br><span class="line">		<span class="keyword">for</span> (Integer id : ids) &#123;</span><br><span class="line">			<span class="comment">// å¦‚æœç›®å½•ä¸‹æœ‰å­ç›®å½• ä¸è®©åˆ é™¤  è¯¥idæ˜¯ä¸æ˜¯çˆ¶ç±»</span></span><br><span class="line">			List&lt;Category&gt; categoryList = categoryDao.findByCategoryId(id);</span><br><span class="line">			<span class="keyword">if</span> (categoryList != <span class="keyword">null</span> &amp;&amp; categoryList.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				System.out.println(<span class="string">&quot;ç›®å½•ä¸‹æœ‰å­ç›®å½•&quot;</span>);</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_USEING);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// å¦‚æœç›®å½•ä¸‹æœ‰æ–‡ç«  ä¸è®©åˆ é™¤</span></span><br><span class="line">			List&lt;Article&gt; articleList = articleService.findByCategoryId(id);</span><br><span class="line">			<span class="keyword">if</span>(articleList != <span class="keyword">null</span> &amp;&amp; articleList.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				System.out.println(<span class="string">&quot;ç›®å½•ä¸‹æœ‰æ–‡ç« &quot;</span>);</span><br><span class="line">				 <span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_USEING);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// åˆ é™¤ç›®å½•</span></span><br><span class="line">			categoryDao.deleteById(id);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-5"><a href="#controller-5" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;åˆ é™¤ç›®å½•&quot;,notes = &quot;æä¾›å¤šä¸ªid,æ‰¹é‡åˆ é™¤&quot;)</span></span><br><span class="line">	<span class="meta">@DeleteMapping(&quot;/deleteCategoryInBatch&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">deleteCategoryInBatch</span><span class="params">(<span class="meta">@RequestParam(&quot;ids&quot; )</span><span class="meta">@ApiParam(name = &quot;ids&quot;,value = &quot;idåˆ—è¡¨&quot;)</span> List&lt;Integer&gt;ids)</span> </span>&#123;</span><br><span class="line">		categoryService.deleteCategoryInBatch(ids);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="CategoryDao"><a href="#CategoryDao" class="headerlink" title="CategoryDao"></a>CategoryDao</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryDao</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Category</span>, <span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function">List&lt;Category&gt; <span class="title">findByCategoryId</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ArticleServiceImpl"><a href="#ArticleServiceImpl" class="headerlink" title="ArticleServiceImpl"></a>ArticleServiceImpl</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Article&gt; <span class="title">findByCategoryId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		List&lt;Article&gt; articleList = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			articleList = articleDao.findByCategoryId(id);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> articleList;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ†é¡µå‡åº"><a href="#åˆ†é¡µå‡åº" class="headerlink" title="åˆ†é¡µå‡åº"></a>åˆ†é¡µå‡åº</h2><h3 id="service-6"><a href="#service-6" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Page&lt;Category&gt; <span class="title">findAllSortbyno</span><span class="params">(Integer pageNum, Integer pageSize)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		<span class="comment">// æ’åº åˆ†é¡µ</span></span><br><span class="line">		Pageable page = PageRequest.of(pageNum, pageSize, Direction.ASC, <span class="string">&quot;no&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> categoryDao.findAll(page);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-6"><a href="#controller-6" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æŸ¥è¯¢ç›®å½•&quot;,notes = &quot;åˆ†é¡µå¹¶ä¸”é¡ºåºæŸ¥è¯¢&quot; )</span></span><br><span class="line">	<span class="meta">@GetMapping(&quot;/find/&#123;pageNum&#125;/&#123;pageSize&#125;&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">findAllSortbyno</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;pageNum&quot;,value = &quot;å½“å‰é¡µ&quot;,required = true)</span> <span class="meta">@PathVariable(&quot;pageNum&quot;)</span><span class="keyword">int</span> pageNum,</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;pageSize&quot;,value = &quot;æ¯é¡µæ•°é‡&quot;,required = true)</span> <span class="meta">@PathVariable(&quot;pageSize&quot;)</span> <span class="keyword">int</span> pageSize)</span> </span>&#123;</span><br><span class="line">		Page&lt;Category&gt; page = categoryService.findAllSortbyno(pageNum, pageSize);</span><br><span class="line">		List&lt;Category&gt; content = page.getContent();</span><br><span class="line">		<span class="keyword">long</span> total = page.getTotalElements();</span><br><span class="line">		Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">		map.put(<span class="string">&quot;total&quot;</span>, total);</span><br><span class="line">		map.put(<span class="string">&quot;content&quot;</span>, content);</span><br><span class="line">		<span class="keyword">return</span> Result.success(map);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ›´æ–°åˆ†ç±»åºå·"><a href="#æ›´æ–°åˆ†ç±»åºå·" class="headerlink" title="æ›´æ–°åˆ†ç±»åºå·"></a>æ›´æ–°åˆ†ç±»åºå·</h2><h3 id="service-7"><a href="#service-7" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateCategoryNo</span><span class="params">(Integer id, <span class="keyword">int</span> no)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		Category category = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			category = categoryDao.findById(id).get();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			 <span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_NONE);</span><br><span class="line">		&#125;</span><br><span class="line">		category.setNo(no);</span><br><span class="line">		categoryDao.save(category);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-7"><a href="#controller-7" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ›´æ–°åˆ†ç±»æ’åº&quot;,notes = &quot;æ”¹å˜æ’åºå­—æ®µ&quot;)</span></span><br><span class="line">	<span class="meta">@PutMapping(&quot;/update/&#123;id&#125;/&#123;no&#125;&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">updateCategoryNo</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;id&quot;,value = &quot;åˆ†ç±»id&quot;,required = true)</span> <span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id,</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;no&quot;,value = &quot;æ’åºå­—æ®µ&quot;,required = true)</span>  <span class="meta">@PathVariable(&quot;no&quot;)</span> <span class="keyword">int</span> no)</span> </span>&#123;</span><br><span class="line">		categoryService.updateCategoryNo(id, no);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>





<h1 id="æ–‡ç« æ¨¡å—"><a href="#æ–‡ç« æ¨¡å—" class="headerlink" title="æ–‡ç« æ¨¡å—"></a>æ–‡ç« æ¨¡å—</h1><h2 id="æ¥å£-3"><a href="#æ¥å£-3" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//å‘å¸ƒèµ„è®¯æˆ–è€…ç¼–è¾‘èµ„è®¯</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">saveOrUpdateArticle</span><span class="params">(Article article)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//åˆ†é¡µè·å–æ‰€æœ‰èµ„è®¯</span></span><br><span class="line">	<span class="comment">//pageNum:é¡µç ï¼ŒpageSizeï¼šä¸€é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®</span></span><br><span class="line">	<span class="function">Page&lt;Article&gt; <span class="title">findAll</span><span class="params">(Integer pageNum,Integer pageSize)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//æ‰¹é‡åˆ é™¤èµ„è®¯</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">deleteArticleInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//ç®¡ç†å‘˜å®¡æ ¸èµ„è®¯</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">updateArticleStatus</span><span class="params">(Integer id,String status)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// æŸ¥è¯¢åˆ†ç±»ä¸‹çš„æ–‡ç« </span></span><br><span class="line">	<span class="function">List&lt;Article&gt; <span class="title">findByCategoryId</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ·»åŠ -æ›´æ–°"><a href="#æ·»åŠ -æ›´æ–°" class="headerlink" title="æ·»åŠ /æ›´æ–°"></a>æ·»åŠ /æ›´æ–°</h2><h3 id="service-8"><a href="#service-8" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveOrUpdateArticle</span><span class="params">(Article article)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		Integer id = article.getId();</span><br><span class="line">		String title = article.getTitle();</span><br><span class="line">		<span class="keyword">if</span> (id == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (title == <span class="keyword">null</span> || <span class="string">&quot;&quot;</span>.equals(title.trim())) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.PARAM_IS_BLANK);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// è¿˜éœ€è¦åˆ¤æ–­æ ‡é¢˜æ˜¯å¦å·²ç»å­˜åœ¨</span></span><br><span class="line">			article.setPublishTime(<span class="keyword">new</span> Date());</span><br><span class="line">			article.setReadTimes(<span class="number">0</span>); <span class="comment">// é˜…è¯»æ¬¡æ•° æŸ¥çœ‹æ–‡ç« è¯¦æƒ…æ—¶ é˜…è¯»æ¬¡æ•°+1</span></span><br><span class="line">			article.setStatus(<span class="number">0</span>); <span class="comment">// æœªå®¡æ ¸</span></span><br><span class="line">			article.setThumbDown(<span class="number">0</span>); <span class="comment">// ç‚¹è¸©æ•°</span></span><br><span class="line">			article.setThumbUp(<span class="number">0</span>); <span class="comment">// ç‚¹èµæ•°</span></span><br><span class="line">			articleDao.save(article);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			Article target = articleDao.findById(id).get();</span><br><span class="line">			NotNullNameUtil.getNotNullNames(article, target);</span><br><span class="line">			articleDao.save(target);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-8"><a href="#controller-8" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ–°å¢æ–‡ç« &quot;, notes = &quot;æ–°å¢æ–‡ç« ï¼Œéœ€è¦jsonæ ¼å¼çš„å­—ç¬¦ä¸²&quot;)</span></span><br><span class="line">	<span class="meta">@PostMapping</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">saveOrUpdateArticle</span><span class="params">(<span class="meta">@RequestBody</span> Article article)</span> </span>&#123;</span><br><span class="line">		articleService.saveOrUpdateArticle(article);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;category&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;id&quot;</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;666&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;readTimes&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;è®ºcorejavaçš„å­¦ä¹ &quot;</span>,</span><br><span class="line">  <span class="attr">&quot;user&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;id&quot;</span>: <span class="number">3</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ†é¡µ-1"><a href="#åˆ†é¡µ-1" class="headerlink" title="åˆ†é¡µ"></a>åˆ†é¡µ</h2><h3 id="service-9"><a href="#service-9" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Page&lt;Article&gt; <span class="title">findAll</span><span class="params">(Integer pageNum, Integer pageSize)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> articleDao.findAll(PageRequest.of(pageNum, pageSize));</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>###controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;åˆ†é¡µæŸ¥è¯¢æ–‡ç« &quot;, notes = &quot;æä¾›å½“å‰é¡µç å’Œæ¯é¡µæ˜¾ç¤ºæ¡æ•°&quot;)</span></span><br><span class="line">	<span class="meta">@GetMapping(&quot;&#123;pageNum&#125;/&#123;pageSize&#125;&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">findAll</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;pageNum&quot;,value = &quot;å½“å‰é¡µ&quot;,required = true,defaultValue = &quot;0&quot;)</span>	<span class="meta">@PathVariable(&quot;pageNum&quot;)</span> <span class="keyword">int</span> pageNum, </span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;pageSize&quot;,value = &quot;æ¯é¡µæ¡æ•°&quot;,required = true,defaultValue = &quot;5&quot;)</span>	<span class="meta">@PathVariable(&quot;pageSize&quot;)</span> <span class="keyword">int</span> pageSize)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//è¿”å›å®Œæ•´åˆ†é¡µä¿¡æ¯ï¼ˆåŒ…æ‹¬æ€»æ¡æ•°ï¼Œä¸Šä¸€é¡µä¸‹ä¸€é¡µç­‰ã€‚ï¼‰</span></span><br><span class="line">		Page&lt;Article&gt; page = articleService.findAll(pageNum, pageSize);</span><br><span class="line">		<span class="comment">//æ­¤å¤„ä¸ºäº†é¡µé¢æ•ˆæœæš‚æ—¶åªè¿”å›æ•°æ®  ï¼Œå¯è‡ªè¡Œè°ƒæ•´</span></span><br><span class="line">		List&lt;Article&gt; content = page.getContent();</span><br><span class="line">		<span class="keyword">long</span> total = page.getTotalElements();</span><br><span class="line">		Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">		map.put(<span class="string">&quot;content&quot;</span>, content);</span><br><span class="line">		map.put(<span class="string">&quot;total&quot;</span>, total);</span><br><span class="line">		<span class="keyword">return</span> Result.success(map);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å®¡æ ¸"><a href="#å®¡æ ¸" class="headerlink" title="å®¡æ ¸"></a>å®¡æ ¸</h2><h3 id="service-10"><a href="#service-10" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateArticleStatus</span><span class="params">(Integer id, Integer status)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		Article article = articleDao.findById(id).get();</span><br><span class="line">		article.setStatus(status);</span><br><span class="line">		articleDao.save(article);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="controller-9"><a href="#controller-9" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;ä¿®æ”¹æ–‡ç« çŠ¶æ€&quot;, notes = &quot;æä¾›idå’Œstatus&quot;)</span></span><br><span class="line">	<span class="meta">@PutMapping(&quot;&#123;id&#125;/&#123;status&#125;&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">updateArticleStatus</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;id&quot;,value = &quot;æ–‡ç« id&quot;,required = true)</span>	<span class="meta">@PathVariable(&quot;id&quot;)</span>Integer id,</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;status&quot;,value = &quot;å®¡æ ¸çŠ¶æ€&quot;,required = true)</span> <span class="meta">@PathVariable(&quot;status&quot;)</span> Integer status)</span> </span>&#123;</span><br><span class="line">		articleService.updateArticleStatus(id, status);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ‰¹é‡åˆ é™¤-2"><a href="#æ‰¹é‡åˆ é™¤-2" class="headerlink" title="æ‰¹é‡åˆ é™¤"></a>æ‰¹é‡åˆ é™¤</h2><h3 id="service-11"><a href="#service-11" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ‰¹é‡åˆ é™¤æ–‡ç«  ä»¥åŠè¯„è®º</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteArticleInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		List&lt;Article&gt; articleList = articleDao.findAllById(ids);</span><br><span class="line">		<span class="keyword">if</span> (articleList == <span class="keyword">null</span> || articleList.size() == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_NONE);</span><br><span class="line">		&#125;</span><br><span class="line">		articleDao.deleteInBatch(articleList);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-10"><a href="#controller-10" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ‰¹é‡åˆ é™¤æ–‡ç« &quot;, notes = &quot;æä¾›idé›†åˆ&quot;)</span></span><br><span class="line">	<span class="meta">@DeleteMapping</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">deleteBatch</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@RequestParam(&quot;ids&quot;)</span></span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;ids&quot;,value = &quot;æ–‡ç« id&quot;,required = true)</span> List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">		articleService.deleteArticleInBatch(ids);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ­¤å¤„æµ‹è¯•cascadeå¯ç”¨ï¼Œä½†æ˜¯webä¸å¯ç”¨ï¼Œåˆ äº†è¡¨é‡å»ºå¯è§£å†³</p>
</blockquote>
<h2 id="å…³è”"><a href="#å…³è”" class="headerlink" title="å…³è”"></a>å…³è”</h2><p>æ­¤å¤„æœ‰ç”¨æˆ·å¤–é”®ï¼Œéœ€è¦å¤„ç†ç”¨æˆ·åˆ é™¤æ—¶ï¼Œæ–‡ç« çš„å¤„ç†ï¼Œç½®ä¸ºç©º</p>
<h1 id="è¯„è®ºæ¨¡å—-1"><a href="#è¯„è®ºæ¨¡å—-1" class="headerlink" title="è¯„è®ºæ¨¡å—"></a>è¯„è®ºæ¨¡å—</h1><h2 id="æ¥å£-4"><a href="#æ¥å£-4" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CommentService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//åˆ†é¡µè·å–æ‰€æœ‰è¯„è®º</span></span><br><span class="line">	<span class="function">Page&lt;Comment&gt; <span class="title">findAll</span><span class="params">(Integer pageNum, Integer pageSize)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//æ–°å¢è¯„è®ºæˆ–è€…æ›´æ–°è¯„è®º</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">saveOrUpdateComment</span><span class="params">(Comment comment)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//æ‰¹é‡åˆ é™¤è¯„è®º</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">deleteCommentInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//æ ¹æ®èµ„è®¯idåˆ†é¡µè·å–æ‰€æœ‰è¯„è®º</span></span><br><span class="line">	<span class="function">Page&lt;Comment&gt; <span class="title">findAllByArticleId</span><span class="params">(Integer articleId,Integer pageNum, Integer pageSize)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ–°å¢-1"><a href="#æ–°å¢-1" class="headerlink" title="æ–°å¢"></a>æ–°å¢</h2><h3 id="service-12"><a href="#service-12" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveOrUpdateComment</span><span class="params">(Comment comment)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		String content = comment.getContent();</span><br><span class="line">		<span class="keyword">if</span>(content == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.PARAM_IS_BLANK);</span><br><span class="line">		&#125;</span><br><span class="line">		comment.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">		<span class="comment">// è¯„è®ºä¸éœ€è¦ä¿®æ”¹</span></span><br><span class="line">		commentDao.save(comment);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-11"><a href="#controller-11" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ·»åŠ è¯„è®º&quot;,notes = &quot;å‚æ•°ä¸ºjsonæ ¼å¼&quot;)</span></span><br><span class="line">	<span class="meta">@PostMapping</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">saveOrUpdateComment</span><span class="params">(<span class="meta">@RequestBody</span> Comment comment)</span> </span>&#123;</span><br><span class="line">		commentService.saveOrUpdateComment(comment);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;article&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;id&quot;</span>: <span class="number">4</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;comment&quot;</span>:&#123;</span><br><span class="line">    <span class="attr">&quot;id&quot;</span>: <span class="number">7</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;ä½ ä¹Ÿä¸€æ ·&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;user&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;id&quot;</span>: <span class="number">3</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ†é¡µæŸ¥è¯¢-1"><a href="#åˆ†é¡µæŸ¥è¯¢-1" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h2><h3 id="service-13"><a href="#service-13" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Page&lt;Comment&gt; <span class="title">findAll</span><span class="params">(Integer pageNum, Integer pageSize)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> commentDao.findAll(PageRequest.of(pageNum, pageSize));</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-12"><a href="#controller-12" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;åˆ†é¡µæŸ¥è¯¢è¯„è®º&quot;, notes = &quot;æä¾›å½“å‰é¡µç å’Œæ¯é¡µæ˜¾ç¤ºæ¡æ•°&quot;)</span></span><br><span class="line">	<span class="meta">@GetMapping(&quot;&#123;pageNum&#125;/&#123;pageSize&#125;&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">findAll</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;pageNum&quot;,value = &quot;å½“å‰é¡µ&quot;,required = true,defaultValue = &quot;0&quot;)</span>	<span class="meta">@PathVariable(&quot;pageNum&quot;)</span> <span class="keyword">int</span> pageNum, </span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;pageSize&quot;,value = &quot;æ¯é¡µæ¡æ•°&quot;,required = true,defaultValue = &quot;5&quot;)</span>	<span class="meta">@PathVariable(&quot;pageSize&quot;)</span> <span class="keyword">int</span> pageSize)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//è¿”å›å®Œæ•´åˆ†é¡µä¿¡æ¯ï¼ˆåŒ…æ‹¬æ€»æ¡æ•°ï¼Œä¸Šä¸€é¡µä¸‹ä¸€é¡µç­‰ã€‚ï¼‰</span></span><br><span class="line">		Page&lt;Comment&gt; page = commentService.findAll(pageNum, pageSize);</span><br><span class="line">		<span class="comment">//æ­¤å¤„ä¸ºäº†é¡µé¢æ•ˆæœæš‚æ—¶åªè¿”å›æ•°æ®  ï¼Œå¯è‡ªè¡Œè°ƒæ•´</span></span><br><span class="line">		List&lt;Comment&gt; content = page.getContent();</span><br><span class="line">		<span class="keyword">long</span> total = page.getTotalElements();</span><br><span class="line">		Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">		map.put(<span class="string">&quot;content&quot;</span>, content);</span><br><span class="line">		map.put(<span class="string">&quot;total&quot;</span>, total);</span><br><span class="line">		<span class="keyword">return</span> Result.success(map);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<p><strong>jpaåµŒå¥—æŸ¥è¯¢ æ ˆæº¢å‡º</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Article.java</span><br><span class="line"><span class="meta">@JsonIgnore</span></span><br><span class="line"><span class="keyword">private</span> Set&lt;Comment&gt; comments = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br></pre></td></tr></table></figure>



<h2 id="æ‰¹é‡åˆ é™¤-3"><a href="#æ‰¹é‡åˆ é™¤-3" class="headerlink" title="æ‰¹é‡åˆ é™¤"></a>æ‰¹é‡åˆ é™¤</h2><h3 id="service-14"><a href="#service-14" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteCommentInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span> <span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		<span class="comment">// çˆ¶å­è¯„è®º çº§è”åˆ é™¤å³å¯</span></span><br><span class="line">		List&lt;Comment&gt; commentList = commentDao.findAllById(ids);</span><br><span class="line">		commentDao.deleteAll(commentList);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-13"><a href="#controller-13" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ‰¹é‡åˆ é™¤è¯„è®º&quot;, notes = &quot;æä¾›idé›†åˆ&quot;)</span></span><br><span class="line">	<span class="meta">@DeleteMapping</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">deleteBatch</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@RequestParam(&quot;ids&quot;)</span></span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;ids&quot;,value = &quot;è¯„è®ºid&quot;,required = true)</span> List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">		commentService.deleteCommentInBatch(ids);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ†é¡µæŸæ–‡ç« è¯„è®º"><a href="#åˆ†é¡µæŸæ–‡ç« è¯„è®º" class="headerlink" title="åˆ†é¡µæŸæ–‡ç« è¯„è®º"></a>åˆ†é¡µæŸæ–‡ç« è¯„è®º</h2><h3 id="service-15"><a href="#service-15" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Page&lt;Comment&gt; <span class="title">findAllByArticleId</span><span class="params">(Integer articleId, Integer pageNum, Integer pageSize)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> ServiceException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> commentDao.findAllByArticleId(articleId,PageRequest.of(pageNum, pageSize));</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-14"><a href="#controller-14" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;åˆ†é¡µæŸ¥è¯¢æŸæ–‡ç« è¯„è®º&quot;, notes = &quot;æä¾›å½“å‰é¡µç å’Œæ¯é¡µæ˜¾ç¤ºæ¡æ•°,æ–‡ç« id&quot;)</span></span><br><span class="line">		<span class="meta">@GetMapping(&quot;&#123;articleId&#125;/&#123;pageNum&#125;/&#123;pageSize&#125;&quot;)</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> Result <span class="title">findAllByArticleId</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;articleId&quot;,value = &quot;æ–‡ç« id&quot;,required = true,defaultValue = &quot;0&quot;)</span>	<span class="meta">@PathVariable(&quot;articleId&quot;)</span> <span class="keyword">int</span> articleId,</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;pageNum&quot;,value = &quot;å½“å‰é¡µ&quot;,required = true,defaultValue = &quot;0&quot;)</span>	<span class="meta">@PathVariable(&quot;pageNum&quot;)</span> <span class="keyword">int</span> pageNum, </span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;pageSize&quot;,value = &quot;æ¯é¡µæ¡æ•°&quot;,required = true,defaultValue = &quot;5&quot;)</span>	<span class="meta">@PathVariable(&quot;pageSize&quot;)</span> <span class="keyword">int</span> pageSize)</span> </span>&#123;</span><br><span class="line">			<span class="comment">//è¿”å›å®Œæ•´åˆ†é¡µä¿¡æ¯ï¼ˆåŒ…æ‹¬æ€»æ¡æ•°ï¼Œä¸Šä¸€é¡µä¸‹ä¸€é¡µç­‰ã€‚ï¼‰</span></span><br><span class="line">			Page&lt;Comment&gt; page = commentService.findAllByArticleId(articleId,pageNum, pageSize);</span><br><span class="line">			<span class="comment">//æ­¤å¤„ä¸ºäº†é¡µé¢æ•ˆæœæš‚æ—¶åªè¿”å›æ•°æ®  ï¼Œå¯è‡ªè¡Œè°ƒæ•´</span></span><br><span class="line">			List&lt;Comment&gt; content = page.getContent();</span><br><span class="line">			<span class="keyword">long</span> total = page.getTotalElements();</span><br><span class="line">			Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">			map.put(<span class="string">&quot;content&quot;</span>, content);</span><br><span class="line">			map.put(<span class="string">&quot;total&quot;</span>, total);</span><br><span class="line">			<span class="keyword">return</span> Result.success(map);</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<h3 id="CommentDao"><a href="#CommentDao" class="headerlink" title="CommentDao"></a>CommentDao</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CommentDao</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Comment</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	<span class="function">Page&lt;Comment&gt; <span class="title">findAllByArticleId</span><span class="params">(Integer articleId, Pageable page)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h1 id="security"><a href="#security" class="headerlink" title="security"></a>security</h1>]]></content>
      <categories>
        <category>project</category>
      </categories>
      <tags>
        <tag>briup</tag>
        <tag>vanse_public</tag>
        <tag>springboot</tag>
      </tags>
  </entry>
  <entry>
    <title>out_before</title>
    <url>/archives/project/out-before.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><ul>
<li>é¡¹ç›®å‰ç½®çŸ¥è¯† springboot+ssm+mysql</li>
<li>æ•´ç†äºº: vanse(åˆ˜èª)</li>
<li>æ—¶é—´: 2021/12/26</li>
<li>å¯¹è±¡: ç”˜è‚ƒå†œå¤§2018çº§(é’‰é’‰æˆè¯¾)</li>
</ul>
<h1 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a><a href="http://c.biancheng.net/mysql/10/">mysql</a></h1><p>MySQL æ˜¯æœ€æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œåœ¨ WEB åº”ç”¨æ–¹é¢ MySQL æ˜¯æœ€å¥½çš„ RDBMS(Relational Database Management Systemï¼šå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ)åº”ç”¨è½¯ä»¶ä¹‹ä¸€ã€‚</p>
<ul>
<li>æœ¬é¡¹ç›®ä¸­åªä½¿ç”¨åˆ°åŸºæœ¬çš„å•è¡¨æ“ä½œå’Œå¤šè¡¨æŸ¥è¯¢</li>
</ul>
<h2 id="è¡¨è®¾è®¡"><a href="#è¡¨è®¾è®¡" class="headerlink" title="è¡¨è®¾è®¡"></a>è¡¨è®¾è®¡</h2><h3 id="åˆ›å»ºè¡¨"><a href="#åˆ›å»ºè¡¨" class="headerlink" title="åˆ›å»ºè¡¨"></a>åˆ›å»ºè¡¨</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `demo_user` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ç¼–å·&#x27;</span>,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">  `gender` <span class="type">int</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ€§åˆ« 0ç”· 1å¥³&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20220102181535876.png" alt="image-20220102181535876"></p>
<h3 id="åˆ é™¤è¡¨"><a href="#åˆ é™¤è¡¨" class="headerlink" title="åˆ é™¤è¡¨"></a>åˆ é™¤è¡¨</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> demo_user</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20220102181647318.png" alt="image-20220102181647318"></p>
<h2 id="å•è¡¨æ“ä½œ"><a href="#å•è¡¨æ“ä½œ" class="headerlink" title="å•è¡¨æ“ä½œ"></a>å•è¡¨æ“ä½œ</h2><blockquote>
<p>mysql é»˜è®¤è‡ªåŠ¨æäº¤</p>
</blockquote>
<h3 id="æ·»åŠ "><a href="#æ·»åŠ " class="headerlink" title="æ·»åŠ "></a>æ·»åŠ </h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">into</span> demo_user(id,username,password,gender)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="keyword">NULL</span>,<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;000&#x27;</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>æ‰¹é‡æ·»åŠ </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">into</span> demo_user(id,username,password,gender)</span><br><span class="line"><span class="keyword">VALUES</span> </span><br><span class="line">	(<span class="keyword">NULL</span>,<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;000&#x27;</span>,<span class="number">0</span>),</span><br><span class="line">	(<span class="keyword">NULL</span>,<span class="string">&#x27;lucy&#x27;</span>,<span class="string">&#x27;000&#x27;</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h3 id="ä¿®æ”¹"><a href="#ä¿®æ”¹" class="headerlink" title="ä¿®æ”¹"></a>ä¿®æ”¹</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">UPDATE demo_user <span class="keyword">SET</span> gender <span class="operator">=</span> <span class="number">1</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">from</span> demo_user <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>æ‰¹é‡åˆ é™¤</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> demo_user <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="number">2</span>,<span class="number">3</span>)</span><br></pre></td></tr></table></figure>



<h3 id="æŸ¥æ‰¾"><a href="#æŸ¥æ‰¾" class="headerlink" title="æŸ¥æ‰¾"></a>æŸ¥æ‰¾</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> demo_user</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> demo_user <span class="keyword">where</span> id <span class="keyword">in</span>(<span class="number">2</span>,<span class="number">3</span>)</span><br></pre></td></tr></table></figure>



<h2 id="å¤šè¡¨æ“ä½œ"><a href="#å¤šè¡¨æ“ä½œ" class="headerlink" title="å¤šè¡¨æ“ä½œ"></a>å¤šè¡¨æ“ä½œ</h2><p>è¡¨å’Œè¡¨çš„å…³ç³»</p>
<ul>
<li>ä¸€å¯¹ä¸€</li>
<li>ä¸€å¯¹å¤š</li>
<li>å¤šå¯¹å¤š</li>
</ul>
<h3 id="ä¸€å¯¹å¤š"><a href="#ä¸€å¯¹å¤š" class="headerlink" title="ä¸€å¯¹å¤š"></a>ä¸€å¯¹å¤š</h3><blockquote>
<p>æ–°å¢è¡¨ demo_qq  ä¸€ä¸ªç”¨æˆ·æœ‰å¤šä¸ªqqå·  å¤–é”®ä¸€èˆ¬è®¾ç½®åœ¨å¤šçš„ä¸€æ–¹</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `demo_qq` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `account` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;qqå·&#x27;</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">  `user_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ‰€å±ç”¨æˆ·&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY `user_id` (`user_id`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `demo_qq_ibfk_1` <span class="keyword">FOREIGN</span> KEY (`user_id`) <span class="keyword">REFERENCES</span> `demo_user` (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br></pre></td></tr></table></figure>



<h4 id="å¢"><a href="#å¢" class="headerlink" title="å¢"></a>å¢</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_qq(id,account,password,user_id)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;40255895&#x27;</span>,<span class="string">&#x27;000&#x27;</span>,<span class="number">4</span>)</span><br></pre></td></tr></table></figure>

<p><code>æ³¨æ„</code></p>
<p>ä»è¡¨demo_qqæ’å…¥å¤–é”®æ—¶æœ‰çº¦æŸ,å¤–é”®å€¼æ˜¯å¿…é¡»demo_userä¸­å·²æœ‰çš„å€¼,å¦åˆ™ä¼šæŠ¥é”™</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_qq(id,account,password,user_id)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;40255895&#x27;</span>,<span class="string">&#x27;000&#x27;</span>,<span class="number">1</span>)</span><br><span class="line"><span class="operator">&gt;</span> <span class="number">1452</span> <span class="operator">-</span> Cannot <span class="keyword">add</span> <span class="keyword">or</span> update a child <span class="type">row</span>: a <span class="keyword">foreign</span> key <span class="keyword">constraint</span> fails (`st`.`demo_qq`, <span class="keyword">CONSTRAINT</span> `demo_qq_ibfk_1` <span class="keyword">FOREIGN</span> KEY (`user_id`) <span class="keyword">REFERENCES</span> `demo_user` (`id`))</span><br><span class="line"><span class="operator">&gt;</span> æ—¶é—´: <span class="number">0.002</span>s</span><br></pre></td></tr></table></figure>



<h4 id="åˆ "><a href="#åˆ " class="headerlink" title="åˆ "></a>åˆ </h4><p>ä»è¡¨demo_qqä¸­çš„æ•°æ®å¯ä»¥ç›´æ¥åˆ é™¤</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> demo_qq <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>ä¸»è¡¨demo_userä¸­</p>
<ul>
<li><p>å¦‚æœæ•°æ®æ²¡æœ‰è¢«ä»è¡¨å¼•ç”¨,å¯ä»¥ç›´æ¥åˆ é™¤</p>
</li>
<li><p>å¦‚æœæ•°æ®è¢«ä»è¡¨å¼•ç”¨ æ— æ³•åˆ é™¤</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">from</span> demo_user <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="number">1451</span> <span class="operator">-</span> Cannot <span class="keyword">delete</span> <span class="keyword">or</span> update a parent <span class="type">row</span>: a <span class="keyword">foreign</span> key <span class="keyword">constraint</span> fails (`st`.`demo_qq`, <span class="keyword">CONSTRAINT</span> `demo_qq_ibfk_1` <span class="keyword">FOREIGN</span> KEY (`user_id`) <span class="keyword">REFERENCES</span> `demo_user` (`id`))</span><br><span class="line"><span class="operator">&gt;</span> æ—¶é—´: <span class="number">0.004</span>s</span><br></pre></td></tr></table></figure>

<p><strong>è§£å†³</strong></p>
<ul>
<li>å…ˆåˆ é™¤ä»è¡¨ä¸­å¼•ç”¨çš„ä»è¡¨æ•°æ®,å†åˆ é™¤ä¸»è¡¨æ•°æ®</li>
<li>å¤–é”®è®¾ç½®<ul>
<li>CASCADE åˆ é™¤ä¸»è¡¨æ•°æ®,ä»è¡¨ä¸­å¼•ç”¨çš„æ•°æ®ä¹Ÿçº§è”åˆ é™¤</li>
<li>SET NULL åˆ é™¤ä¸»è¡¨æ•°æ®,ä»è¡¨ä¸­å¼•ç”¨çš„å¤–é”®ç½®ç©º</li>
</ul>
</li>
<li>é€»è¾‘å¤–é”®</li>
</ul>
</li>
</ul>
<h4 id="æ”¹"><a href="#æ”¹" class="headerlink" title="æ”¹"></a>æ”¹</h4><p>ä¸»è¡¨å’Œä»è¡¨æ­£å¸¸ä¿®æ”¹</p>
<h4 id="æŸ¥"><a href="#æŸ¥" class="headerlink" title="æŸ¥"></a>æŸ¥</h4><p>å•è¡¨: ä¸»è¡¨å’Œä»è¡¨éƒ½å¯æ­£å¸¸æŸ¥æ‰¾</p>
<p>å¤šè¡¨: </p>
<ul>
<li><p>å­æŸ¥è¯¢</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> user_id <span class="keyword">from</span> demo_qq  #<span class="number">4</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> demo_user <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">4</span></span><br></pre></td></tr></table></figure></li>
<li><p>å¤šè¡¨è”æŸ¥</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">u.id <span class="keyword">as</span> uid,u.username,u.password,u.gender,</span><br><span class="line">q.id <span class="keyword">as</span> qid,q.account,q.password <span class="keyword">as</span> qpassword</span><br><span class="line"><span class="keyword">FROM</span> demo_user u,demo_qq q</span><br><span class="line"><span class="keyword">WHERE</span> u.id <span class="operator">=</span> q.user_id</span><br></pre></td></tr></table></figure>

<p><code>å°†æ¥è®¾ç½®å¤–é”®,æœ€å¥½å¯ä»¥åŒºåˆ«å±æ€§åç§°</code></p>
</li>
</ul>
<h3 id="å¤šå¯¹å¤š"><a href="#å¤šå¯¹å¤š" class="headerlink" title="å¤šå¯¹å¤š"></a>å¤šå¯¹å¤š</h3><blockquote>
<p>æ–°å¢è§’è‰²è¡¨ ç”¨æˆ·å’Œè§’è‰²æ˜¯å¤šå¯¹å¤šçš„å…³ç³»</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `demo_role` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è§’è‰²åç§°&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¤šå¯¹å¤šéœ€è¦åˆ›å»ºæ¡¥è¡¨ç¡®å®šå…³ç³»</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `demo_user_role` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `role_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY `user_id` (`user_id`),</span><br><span class="line">  KEY `role_id` (`role_id`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `demo_user_role_ibfk_2` <span class="keyword">FOREIGN</span> KEY (`role_id`) <span class="keyword">REFERENCES</span> `demo_role` (`id`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `demo_user_role_ibfk_1` <span class="keyword">FOREIGN</span> KEY (`user_id`) <span class="keyword">REFERENCES</span> `demo_user` (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br></pre></td></tr></table></figure>



<h4 id="å¢-1"><a href="#å¢-1" class="headerlink" title="å¢"></a>å¢</h4><p>æ­£å¸¸å¾€ä¸­é—´è¡¨æ·»åŠ å€¼å³å¯(æœ‰å¤–é”®çº¦æŸ)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_user_role(id,user_id,role_id)</span><br><span class="line"> <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="number">4</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4 id="åˆ -1"><a href="#åˆ -1" class="headerlink" title="åˆ "></a>åˆ </h4><p>æ­£å¸¸åˆ é™¤ä¸­é—´è¡¨å³å¯</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">from</span> demo_user_role <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>

<h4 id="æ”¹-1"><a href="#æ”¹-1" class="headerlink" title="æ”¹"></a>æ”¹</h4><p>æ­£å¸¸ä¿®æ”¹å³å¯ä¾‹å¦‚æ›´æ”¹ç”¨æˆ·çš„è§’è‰²</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">UPDATE demo_user_role</span><br><span class="line"><span class="keyword">SET</span> role_id <span class="operator">=</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>





<h4 id="æŸ¥-1"><a href="#æŸ¥-1" class="headerlink" title="æŸ¥"></a>æŸ¥</h4><p>æŸ¥å‡ºç”¨æˆ·çš„è§’è‰²,éœ€è¦å¤šè¡¨æŸ¥è¯¢</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">u.username,r.name</span><br><span class="line"><span class="keyword">from</span> demo_user u,demo_role r,demo_user_role ur</span><br><span class="line"><span class="keyword">where</span> u.id <span class="operator">=</span> ur.user_id <span class="keyword">and</span> r.id <span class="operator">=</span> ur.role_id</span><br></pre></td></tr></table></figure>





<h1 id="maven"><a href="#maven" class="headerlink" title="maven"></a><a href="https://www.runoob.com/maven/maven-tutorial.html">maven</a></h1><h2 id="1-1-æ¦‚è¿°"><a href="#1-1-æ¦‚è¿°" class="headerlink" title="1.1 æ¦‚è¿°"></a>1.1 æ¦‚è¿°</h2><p>Mavenæ˜¯Apacheä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå®ƒæ˜¯ä¸€ä¸ªåˆ›æ–°çš„é¡¹ç›®ç®¡ç†å·¥å…·ï¼Œå®ƒç”¨äºå¯¹Javaé¡¹ç›®è¿›è¡Œé¡¹ç›®æ„å»ºã€ä¾èµ–ç®¡ç†åŠé¡¹ç›®ä¿¡æ¯ç®¡ç†ã€‚ï¼ˆå¼€æºã€å…è´¹ã€Javaè¯­è¨€å®ç°ï¼‰</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914155455940.png" alt="image-20200914155455940"></p>
<p>MavenåŸºäºé¡¹ç›®å¯¹è±¡æ¨¡å‹(POMï¼ŒProject Object Model)ï¼Œå¯¹é¡¹ç›®è¿›è¡ŒæŠ½è±¡ï¼ŒæŠŠä¸€ä¸ªé¡¹ç›®ä»åˆ›å»ºåˆ°éƒ¨ç½²ï¼Œä¸­é—´æ‰€ç»å†çš„å„ä¸ªé˜¶æ®µï¼Œéƒ½è¿›è¡Œå•ç‹¬å®šä¹‰ï¼Œè¿™æ ·å°±å¯ä»¥å¯¹ä¸€ä¸ªé¡¹ç›®è¿›è¡Œå„ä¸ªç¯èŠ‚çš„ç¨‹åºåŒ–ç®¡ç†ï¼Œå¹¶ä¸”å…è®¸ç”¨æˆ·è¿›è¡Œæ‰©å±•ï¼Œæ»¡è¶³ç”¨æˆ·å®šåˆ¶åŒ–çš„éœ€æ±‚ã€‚</p>
<blockquote>
<p>æ€»ç»“ï¼šMavenå°±æ˜¯ä¸€ä¸ªè½¯ä»¶å·¥å…·ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨å°±æ˜¯å¯¹é¡¹ç›®è¿›è¡Œç®¡ç†</p>
</blockquote>
<p>==æ€è€ƒï¼ŒMavenå’ŒSVNéƒ½æ˜¯è½¯ä»¶å·¥å…·ï¼Œå®ƒä»¬åœ¨é¡¹ç›®ä¸­çš„ä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ==</p>
<h2 id="1-2-ä½œç”¨"><a href="#1-2-ä½œç”¨" class="headerlink" title="1.2 ä½œç”¨"></a>1.2 ä½œç”¨</h2><p>Mavenåœ¨é¡¹ç›®ä¸­çš„ä½œç”¨å¾ˆå¤šï¼Œè¿™äº›ä½œç”¨ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹ä¿©ä¸ªæ–¹é¢ï¼š</p>
<ol>
<li>é¡¹ç›®æ„å»º</li>
<li>ä¾èµ–ç®¡ç†</li>
</ol>
<p><strong>é¡¹ç›®æ„å»º</strong>ï¼Œæ˜¯æŒ‡ä¸€ä¸ªé¡¹ç›®æ¸…ç†ã€ç¼–è¯‘ã€æµ‹è¯•ã€æŠ¥å‘Šã€æ‰“åŒ…ã€å®‰è£…ã€éƒ¨ç½²ç­‰è¿‡ç¨‹ï¼ŒMavenä¸­æŠŠè¿™äº›è¿‡ç¨‹è¿›è¡Œäº†<strong>æ ‡å‡†åŒ–</strong>ç®¡ç†ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªå‘½ä»¤ï¼Œè‡ªåŠ¨æŒ‰ç…§é¡ºåºï¼Œä¾æ¬¡æ‰§è¡Œè¿™é‡Œé¢çš„æ¯ä¸€ä¸ªæ­¥éª¤ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914210444981.png" alt="image-20200914210444981"></p>
<p>å…¶ä¸­ï¼Œ</p>
<ol>
<li>æ¸…ç†cleanï¼šå°†ä¹‹å‰ç¼–è¯‘å¾—åˆ°çš„æ—§æ–‡ä»¶classå­—èŠ‚ç æ–‡ä»¶åˆ é™¤</li>
<li>ç¼–è¯‘compileï¼šå°†javaæºç¨‹åºç¼–è¯‘æˆclasså­—èŠ‚ç æ–‡ä»¶</li>
<li>æµ‹è¯•testï¼šè‡ªåŠ¨æµ‹è¯•ï¼Œè‡ªåŠ¨è°ƒç”¨junitç¨‹åº</li>
<li>æŠ¥å‘Šreportï¼šæµ‹è¯•ç¨‹åºæ‰§è¡Œçš„ç»“æœ</li>
<li>æ‰“åŒ…packageï¼šåŠ¨æ€Webå·¥ç¨‹æ‰“WaråŒ…ï¼Œjavaå·¥ç¨‹æ‰“jaråŒ…</li>
<li>å®‰è£…installï¼šMavenç‰¹å®šçš„æ¦‚å¿µï¼Œå°†æ‰“åŒ…å¾—åˆ°çš„æ–‡ä»¶å¤åˆ¶åˆ°mavenä»“åº“ä¸­çš„æŒ‡å®šä½ç½®</li>
<li>éƒ¨ç½²deployï¼šå°†å·¥ç¨‹ç”Ÿæˆçš„ç»“æœæ”¾åˆ°æœåŠ¡å™¨ä¸­æˆ–è€…å®¹å™¨ä¸­ï¼Œä½¿å…¶å¯ä»¥è¿è¡Œ</li>
</ol>
<blockquote>
<p>æ³¨æ„ï¼ŒMavenå…è®¸åœ¨æ¯ä¸ªæ­¥éª¤ä¸­ï¼Œé™¤äº†é»˜è®¤çš„æ“ä½œå¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡æ’ä»¶æ¥å®šä¹‰ç”¨æˆ·æŒ‡å®šçš„æ“ä½œ</p>
</blockquote>
<p>==æ€è€ƒï¼Œåœ¨Eclipseä¸­ï¼Œå¯¹ä¸€ä¸ªæ™®é€šé¡¹ç›®ï¼Œæ˜¯å¦‚æœè¿›è¡Œé¡¹ç›®æ„å»ºçš„ï¼Ÿ==</p>
<p><strong>ä¾èµ–ç®¡ç†</strong>ï¼Œæ˜¯æŒ‡Mavenå°†é¡¹ç›®ä¸­æ‰€ä¾èµ–çš„å¤–éƒ¨jaråŒ…ï¼Œè¿›è¡Œç»Ÿä¸€çš„ç®¡ç†ã€‚</p>
<p>ä¹‹å‰è‡ªå·±æ‰‹åŠ¨ç®¡ç†è¿™äº›jaræ—¶ï¼Œæ‰€é‡åˆ°çš„é—®é¢˜ï¼š</p>
<ul>
<li>éœ€è¦åˆ°ä¸åŒçš„å®˜ç½‘ä¸‹è½½ä¸åŒçš„jar</li>
<li>éœ€è¦è‡ªå·±æµ‹è¯•å¤šä¸ªjarä¹‹é—´æ˜¯å¦ç‰ˆæœ¬å…¼å®¹</li>
<li>éœ€è¦è‡ªå·±åˆ†æä¾èµ–å…³ç³»ï¼Œä¾‹å¦‚a.jarä¾èµ–b.jarï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨a.jarçš„æ—¶å€™ä¹Ÿè¦æŠŠb.jarä¸‹è½½ä¸‹æ¥</li>
<li>éœ€è¦è‡ªå·±ç®¡ç†jarå’Œå…¶å¯¹åº”çš„æºç å’Œjavadoc</li>
<li>â€¦..</li>
</ul>
<blockquote>
<p>ä½¿ç”¨Mavenåï¼Œè¿™äº›é—®é¢˜éƒ½ç»Ÿç»Ÿå¸®æˆ‘ä»¬è§£å†³äº†ï¼Œå®ƒä¼šå¯¹é¡¹ç›®ä¸­ä¾èµ–çš„jarè¿›è¡Œè‡ªåŠ¨ç®¡ç†</p>
</blockquote>
<p>==æ€è€ƒï¼Œåœ¨Eclipseä¸­ï¼Œå¯¹ä¸€ä¸ªæ™®é€šé¡¹ç›®ï¼Œæ˜¯å¦‚æœè¿›è¡Œä¾èµ–ç®¡ç†çš„ï¼Ÿ==</p>
<h2 id="1-3-ä¸‹è½½"><a href="#1-3-ä¸‹è½½" class="headerlink" title="1.3 ä¸‹è½½"></a>1.3 ä¸‹è½½</h2><p><a href="https://maven.apache.org/">Mavenå®˜ç½‘</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914165659531.png" alt="image-20200914165659531"></p>
<p><a href="https://maven.apache.org/download.cgi">Mavenä¸‹è½½</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914165824685.png" alt="image-20200914165824685"></p>
<h2 id="1-4-å®‰è£…"><a href="#1-4-å®‰è£…" class="headerlink" title="1.4 å®‰è£…"></a>1.4 å®‰è£…</h2><p>1ã€å®‰è£…JDKï¼Œå¹¶ä¸”é…ç½®ç¯å¢ƒå˜é‡JAVA_HOME</p>
<ul>
<li>JDKå¿…é¡»æ˜¯1.7ä»¥ä¸Š</li>
<li>==JAVA_HOMEä¸­é…ç½®çš„è·¯å¾„ä¸€å®šæ˜¯JDKçš„è·¯å¾„ï¼Œè€Œä¸æ˜¯JREçš„è·¯å¾„==</li>
</ul>
<p>2ã€ä¸‹è½½å¥½çš„Mavenï¼Œåœ¨æŒ‡å®šç›®å½•è§£å‹å³å¯</p>
<ul>
<li>Mavenæ‰€åœ¨è·¯å¾„ä¸­æœ€å¥½ä¸è¦å‡ºç°ä¸­æ–‡ã€ç©ºæ ¼<br><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914170734336.png" alt="image-20200914170734336"></li>
</ul>
<p>3ã€é…ç½®Mavençš„ç¯å¢ƒå˜é‡</p>
<ul>
<li>M2_HOME=D:\briup\apache-maven-3.6.3</li>
</ul>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914170946623.png" alt="image-20200914170946623"></p>
<p>4ã€é…ç½®Pathå˜é‡</p>
<ul>
<li><p>Path=%M2_HOME%\bin;%Path%</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914171139809.png" alt="image-20200914171139809"></p>
</li>
</ul>
<p>5ã€æµ‹è¯•å®‰è£…æ˜¯å¦æˆåŠŸ</p>
<ul>
<li><p><strong>é‡æ–°</strong>æ‰“å¼€ä¸€ä¸ªæ–°ç»ˆç«¯çª—å£</p>
</li>
<li><p>è¾“å…¥å‘½ä»¤ï¼š<code>mvn -v</code></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914171335774.png" alt="image-20200914171335774"></p>
</li>
</ul>
<h2 id="1-5-ä»“åº“"><a href="#1-5-ä»“åº“" class="headerlink" title="1.5 ä»“åº“"></a>1.5 ä»“åº“</h2><p>Mavenä¸­çš„ä»“åº“ï¼Œæ˜¯ç”¨æ¥å­˜æ”¾é¡¹ç›®æ‰€ä¾èµ–çš„jarçš„ï¼Œä»“åº“ä¸»è¦åˆ†ä¸ºä¸‰ç§ï¼š</p>
<ul>
<li>æœ¬åœ°ä»“åº“</li>
<li>ä¸­å¤®ä»“åº“</li>
<li>ç§æœ‰ä»“åº“</li>
</ul>
<p><strong>æœ¬åœ°ä»“åº“ï¼š</strong></p>
<p>é¡¹ç›®ä¸­æ‰€ä¾èµ–çš„ç¬¬ä¸‰æ–¹jarï¼Œæœ€ç»ˆéƒ½ä¼šä¸‹è½½å­˜æ”¾åˆ°è‡ªå·±ç”µè„‘ä¸­çš„æœ¬åœ°ä»“åº“ä¸­ï¼Œæœ¬åœ°ä»“åº“çš„ä½ç½®å¯ä»¥è‡ªå·±æŒ‡å®šï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤è·¯å¾„ï¼š<code>$&#123;user.home&#125;/.m2/repository</code></p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914172300522.png" alt="image-20200914172300522"></p>
<p><strong>ä¸­å¤®ä»“åº“ï¼š</strong></p>
<p>è¿™æ˜¯Mavenå®˜æ–¹æä¾›çš„è¿œç¨‹ä»“åº“ï¼Œä»“åº“ä¸­å­˜æ”¾äº†ï¼Œæ—¥å¸¸é¡¹ç›®ä¸­æ‰€ä¼šä½¿ç”¨åˆ°çš„å‡ ä¹æ‰€æœ‰jaråŒ…ï¼Œå½“æˆ‘ä»¬è‡ªå·±ç”µè„‘ä¸­çš„æœ¬åœ°ä»“åº“ä¸­ï¼Œæ²¡æœ‰è¦ä¾èµ–çš„jarçš„æ—¶å€™ï¼ŒMavené»˜è®¤ä¼šä»ä¸­å¤®ä»“åº“ä¸­æŸ¥æ‰¾å¹¶ä¸‹è½½éœ€è¦çš„jaråŒ…</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914183356292.png" alt="image-20200914183356292"></p>
<blockquote>
<p>æ³¨æ„ï¼Œmavenå§‹ç»ˆä¼šå…ˆå»æœ¬åœ°ä»“åº“ä¸­æŸ¥çœ‹éœ€è¦çš„jaråŒ…ï¼Œå¦‚æœæ²¡æœ‰å†åˆ°ä¸­å¤®ä»“åº“ä¸­æŸ¥æ‰¾</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œä»ä¸­å¤®ä»“åº“ä¸­ä¸‹è½½çš„jaråŒ…ï¼Œä¼šè‡ªåŠ¨å­˜æ”¾åˆ°æœ¬åœ°ä»“åº“ä¸­</p>
</blockquote>
<p>Mavençš„ä¸­å¤®ä»“åº“ï¼Œè¿˜æœ‰æä¾›äº†WEBå½¢å¼çš„æŸ¥æ‰¾å’Œä¸‹è½½çš„çš„åœ°æ–¹ï¼š</p>
<p><a href="https://mvnrepository.com/">Mavenä¸­å¤®ä»“åº“</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914193939237.png" alt="image-20200914193939237"></p>
<p><strong>ç§æœ‰ä»“åº“ï¼š</strong></p>
<p>ç§æœ‰ä»“åº“ï¼Œä¹Ÿç§°ä¸ºç§æœï¼Œä¸€èˆ¬æ˜¯ç”±å…¬å¸è‡ªå·±è®¾ç«‹çš„ï¼Œåªä¸ºæœ¬å…¬å¸å†…éƒ¨å…±äº«ä½¿ç”¨ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914190844493.png" alt="image-20200914190844493"></p>
<p>é¡¹ç›®ä¸­ä¾èµ–çš„jarï¼Œmavené¦–å…ˆè¿˜æ˜¯ä¼šå…ˆåˆ°æœ¬åœ°ä»“åº“ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰ä¼šå»ç§æœä¸­æŸ¥æ‰¾ï¼Œå¦‚æœç§æœä¸­æ²¡æœ‰ï¼Œé‚£ä¹ˆç§æœä¼šè‡ªåŠ¨å»è¿œç¨‹ä»“åº“ä¸­å»ä¸‹è½½ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼Œæœ€ç»ˆä¸‹è½½åˆ°jaråï¼Œè¿™ä¸ªjarè¿˜æ˜¯ä¼šå…ˆå­˜æ”¾åˆ°æœ¬åœ°ä»“åº“ï¼Œç„¶åé¡¹ç›®ä¸­å»å¼•ç”¨è¿™ä¸ªæœ¬åœ°ä»“åº“çš„jarï¼Œå°±æ˜¯æŠŠè¿™ä¸ªjarçš„è·¯å¾„è‡ªåŠ¨é…ç½®åˆ°é¡¹ç›®çš„classpathä¸­ã€‚</p>
</blockquote>
<hr>
<p>å¯ä»¥ä½¿ç”¨<code>Nexus</code>è½¯ä»¶å·¥å…·ï¼Œæ¥æ­å»ºå±€åŸŸç½‘ä¸­çš„ç§æœ‰çš„è¿œç¨‹ä»“åº“ï¼Œä¹Ÿå°±æ˜¯ç§æœã€‚ï¼ˆäº†è§£å³å¯ï¼‰</p>
<p><a href="https://www.sonatype.com/download-nexus-repo-oss">Nexuså®˜ç½‘ä¸‹è½½</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914192141808.png" alt="image-20200914192141808"></p>
<h2 id="1-6-é…ç½®"><a href="#1-6-é…ç½®" class="headerlink" title="1.6 é…ç½®"></a>1.6 é…ç½®</h2><p>mavenä¼šå…ˆæ‰¾ <code>$&#123;user.home&#125;/.m2/settings.xml</code> ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œä¼šå†æ‰¾å®‰è£…ç›®å½•çš„ <code>\conf\settings.xml</code></p>
<p>1ã€<strong>ä»“åº“é…ç½®ï¼š</strong></p>
<p>å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œæœ¬åœ°ä»“åº“çš„ä½ç½®æ˜¯ï¼š<code>$&#123;user.home&#125;/.m2/repository</code> ï¼Œå¦‚æœæƒ³ä¿®æ”¹è¿™ä¸ªåœ°å€ï¼Œå¯ä»¥åœ¨mavençš„é…ç½®æ–‡ä»¶ä¸­ï¼Œè¿›è¡Œé…ç½®ï¼š <code>D:\briup\apache-maven-3.6.3\conf\settings.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>D:/briup/repository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914192605993.png" alt="image-20200914192605993"></p>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œå†™ä¸Šä½ å¸Œæœ›çš„æœ¬åœ°ä»“åº“è·¯å¾„å³å¯ï¼Œå¦‚æœä¸å†™ï¼Œé‚£ä¹ˆå°±æ˜¯é»˜è®¤å€¼</p>
</blockquote>
<p>2ã€<strong>é•œåƒé…ç½®ï¼š</strong></p>
<p>Mavençš„å®‰è£…ç›®å½•ä¸­ï¼Œæœ‰ä¸€ä¸ªjaråŒ…ï¼š<code>D:\briup\apache-maven-3.6.3\lib\maven-model-builder -3.6.3.jar</code></p>
<p>è¿™ä¸ªjarä¸­ï¼Œæœ‰ä¸€ä¸ªsuperpomï¼ˆè¶…çº§pomï¼‰ï¼Œæˆ‘ä»¬çš„mavené¡¹ç›®ä¼šè‡ªåŠ¨ç»§æ‰¿è¿™ä¸ªsuperpomæ–‡ä»¶ï¼Œè€Œåœ¨superpomä¸­ï¼Œé…ç½®äº†ä¸­å¤®ä»“åº“çš„åœ°å€ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914194354853.png" alt="image-20200914194354853"></p>
<p><code>pom-4.0.0.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">Licensed to the Apache Software Foundation (ASF) under one</span></span><br><span class="line"><span class="comment">or more contributor license agreements.  See the NOTICE file</span></span><br><span class="line"><span class="comment">distributed with this work for additional information</span></span><br><span class="line"><span class="comment">regarding copyright ownership.  The ASF licenses this file</span></span><br><span class="line"><span class="comment">to you under the Apache License, Version 2.0 (the</span></span><br><span class="line"><span class="comment">&quot;License&quot;); you may not use this file except in compliance</span></span><br><span class="line"><span class="comment">with the License.  You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Unless required by applicable law or agreed to in writing,</span></span><br><span class="line"><span class="comment">software distributed under the License is distributed on an</span></span><br><span class="line"><span class="comment">&quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</span></span><br><span class="line"><span class="comment">KIND, either express or implied.  See the License for the</span></span><br><span class="line"><span class="comment">specific language governing permissions and limitations</span></span><br><span class="line"><span class="comment">under the License.</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- START SNIPPET: superpom --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>central<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>Central Repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.maven.apache.org/maven2<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">pluginRepositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>central<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>Central Repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.maven.apache.org/maven2<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">releases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">updatePolicy</span>&gt;</span>never<span class="tag">&lt;/<span class="name">updatePolicy</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">pluginRepositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;project.basedir&#125;/target<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>$&#123;project.build.directory&#125;/classes<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">testOutputDirectory</span>&gt;</span>$&#123;project.build.directory&#125;/test-classes<span class="tag">&lt;/<span class="name">testOutputDirectory</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sourceDirectory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/java<span class="tag">&lt;/<span class="name">sourceDirectory</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scriptSourceDirectory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/scripts<span class="tag">&lt;/<span class="name">scriptSourceDirectory</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">testSourceDirectory</span>&gt;</span>$&#123;project.basedir&#125;/src/test/java<span class="tag">&lt;/<span class="name">testSourceDirectory</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">testResources</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">testResource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;project.basedir&#125;/src/test/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">testResource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">testResources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginManagement</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- <span class="doctag">NOTE:</span> These plugins will be removed from future versions of the super POM --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- They are kept for the moment as they are very unlikely to conflict with lifecycle mappings (MNG-4453) --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-antrun-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-assembly-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2-beta-5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-dependency-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-release-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">pluginManagement</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">reporting</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>$&#123;project.build.directory&#125;/site<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">reporting</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- <span class="doctag">NOTE:</span> The release profile will be removed from future versions of the super POM --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>release-profile<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">name</span>&gt;</span>performRelease<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">inherited</span>&gt;</span>true<span class="tag">&lt;/<span class="name">inherited</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-source-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">id</span>&gt;</span>attach-sources<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">goal</span>&gt;</span>jar-no-fork<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">inherited</span>&gt;</span>true<span class="tag">&lt;/<span class="name">inherited</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-javadoc-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">id</span>&gt;</span>attach-javadocs<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">goal</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">inherited</span>&gt;</span>true<span class="tag">&lt;/<span class="name">inherited</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-deploy-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">updateReleaseInfo</span>&gt;</span>true<span class="tag">&lt;/<span class="name">updateReleaseInfo</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- END SNIPPET: superpom --&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>å…¶ä¸­ï¼Œæœ€å‰é¢çš„ä¿©ä¸ªé…ç½®ï¼Œå°±æ˜¯é…ç½®äº†ä¸­å¤®ä»“åº“çš„åœ°å€ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>central<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Central Repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.maven.apache.org/maven2<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">pluginRepositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>central<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Central Repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.maven.apache.org/maven2<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">releases</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">updatePolicy</span>&gt;</span>never<span class="tag">&lt;/<span class="name">updatePolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">pluginRepositories</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„1ï¼Œåœ¨è¯¥é…ç½®ä¸­ï¼Œä¸­å¤®ä»“åº“çš„IDä¸ºcentral</p>
<p>æ³¨æ„2ï¼Œä¸­å¤®ä»“åº“çš„åœ°å€ä¸ºï¼š<a href="https://repo.maven.apache.org/maven2">https://repo.maven.apache.org/maven2</a></p>
<p>ç›´æ¥è®¿é—®è¿™ä¸ªåœ°å€ï¼Œä¹Ÿèƒ½çœ‹åˆ°ä¸­å¤®ä»“åº“ä¸­ï¼Œå­˜æ”¾çš„æ‰€æœ‰jaråŒ…ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914194241877.png" alt="image-20200914194241877"></p>
<blockquote>
<p>æ³¨æ„ï¼Œå…¶ä»–Mavené¡¹ç›®éƒ½ä¼šé»˜è®¤ç»§æ‰¿è¿™ä¸ªsuperpomæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™äº›é¡¹ç›®éƒ½ä¼šé»˜è®¤è®¿é—®è¿™ä¸ªæŒ‡å®šåœ°å€çš„ä¸­å¤®ä»“åº“ï¼Œä½†æ˜¯è¿™ä¸ªä¸­å¤®ä»“åº“è®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œæ‰€ä»¥éœ€è¦é…ç½®ä¸€ä¸ªå›½å†…çš„<strong>é•œåƒ</strong>ï¼Œæ¥æé«˜jarçš„ä¸‹è½½é€Ÿåº¦ã€‚</p>
</blockquote>
<p>åœ¨<code>settings.xml</code>æ–‡ä»¶ä¸­ç»§ç»­é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-aliyun<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus aliyun<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">id</span>&gt;</span>jdk-1.8<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914195026044.png" alt="image-20200914195026044"></p>
<p>æ­¤é…ç½®è¡¨ç¤ºï¼Œå½“Mavenå‘é€è¯·æ±‚åˆ°IDä¸º<code>central</code>çš„è¿œç¨‹ä»“åº“çš„æ—¶å€™ï¼Œè¯¥è¯·æ±‚ä¼šè‡ªåŠ¨è½¬å‘ç»™é•œåƒä¸­æŒ‡å®šçš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œé…ç½®çš„é˜¿é‡Œäº‘æ­å»ºçš„Nexusç§æœåœ°å€ï¼Œè¿™æ ·ä¼šå¤§å¤§æäº¤Mavenä¸‹è½½jarçš„é€Ÿåº¦ï¼</p>
<blockquote>
<p>æ³¨æ„ï¼Œåœ¨settings.xmlä¸­é…ç½®é•œåƒçš„æ—¶å€™ï¼Œä¸€å®šè¦çœ‹å‡†è¦é…ç½®çš„æ ‡ç­¾ä½ç½®ï¼</p>
</blockquote>
<h2 id="1-7-åæ ‡"><a href="#1-7-åæ ‡" class="headerlink" title="1.7 åæ ‡"></a>1.7 åæ ‡</h2><p>åœ¨mavenä¸­ï¼Œæ¯ä¸€ä¸ªé¡¹ç›®éƒ½æœ‰ä¸‰ä¸ªåæ ‡ï¼ˆGAVï¼‰ï¼Œç”¨æ¥å”¯ä¸€æ ‡è¯†è¿™ä¸ªé¡¹ç›®</p>
<ul>
<li><code>groupId</code>ï¼Œè¯¥å…ƒç´ å®šä¹‰å½“å‰Mavené¡¹ç›®éš¶å±çš„å®é™…é¡¹ç›®</li>
<li><code>artifactId</code>ï¼Œè¯¥å…ƒç´ å®šä¹‰å½“å‰mavené¡¹ç›®è¡¨ç¤ºçš„å…·ä½“å­é¡¹ç›®ï¼ˆæ¨¡å—ï¼‰</li>
<li><code>version</code>ï¼Œè¯¥å…ƒç´ å®šä¹‰å½“å‰mavené¡¹ç›®çš„å…·ä½“ç‰ˆæœ¬</li>
</ul>
<p>ä¾‹å¦‚ï¼Œ<code>pom.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 1.å…¬å¸æˆ–è€…ç»„ç»‡åŸŸåå€’åº+é¡¹ç›®å --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.briup.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 2.æ¨¡å—å --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mvn-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 3.ç‰ˆæœ¬ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>mvn-test<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®å½“å‰é¡¹ç›®ä¸­ï¼Œæ‰€ä¾èµ–çš„å…¶ä»–mavené¡¹ç›®ï¼ˆjaråŒ…ï¼‰ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>	</span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­ï¼š</p>
<p>1ã€å…ˆå®šä¹‰äº†å½“å‰mavené¡¹ç›®è‡ªå·±çš„ä¸‰ä¸ªåæ ‡å€¼</p>
<p>2ã€åˆå£°æ˜äº†å½“å‰mavené¡¹ç›®æ‰€ä¾èµ–çš„å¦ä¸€ä¸ªmavené¡¹ç›®ï¼ˆjunitï¼‰çš„ä¸‰ä¸ªåæ ‡å€¼</p>
<p>3ã€<code>&lt;dependency&gt;</code> æ ‡ç­¾è¡¨ç¤ºä¾èµ–çš„æ„æ€</p>
<p>4ã€<code>&lt;scope&gt;</code>æ˜¯å¯é€‰çš„æ ‡ç­¾ï¼Œç”¨æ¥æŒ‡å®šè¿™ä¸ªä¾èµ–çš„ä½œç”¨èŒƒå›´ï¼Œtestè¡¨ç¤ºåªæœ‰åœ¨æµ‹è¯•çš„æ—¶å€™æ‰æœ‰æ•ˆ</p>
<p>mavené¡¹ç›®å°±æ˜¯é€šè¿‡åæ ‡ï¼Œæ¥å®šä½ä»“åº“ä¸­æ‰€ä¾èµ–çš„å…¶ä»–mavené¡¹ç›®çš„ä½ç½®ï¼Œåæ ‡å’Œjaråœ¨ä»“åº“ä½ç½®çš„å¯¹åº”å…³ç³»ï¼š</p>
<p><code>[groupId]\[artifactId]\[version]\[artifactId]-[version].jar</code></p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªmavené¡¹ç›®çš„jarï¼Œåœ¨ä»“åº“ä¸­çš„ä½ç½®æ˜¯ï¼š</p>
<p><code>D:\briup\repository\junit\junit\4.13\junit-4.13.jar</code></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914205921112.png" alt="image-20200914205921112"></p>
<blockquote>
<p>æ³¨æ„ï¼Œåæ ‡åœ¨ä»“åº“ä¸­ï¼Œå¯¹åº”çš„å°±æ˜¯æ–‡ä»¶å¤¹</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œåœ¨mavençš„ä¸–ç•Œé‡Œé¢ï¼Œæ¯ä¸€ä¸ªé¡¹ç›®éƒ½æœ‰å”¯ä¸€çš„æ ‡è¯†ï¼Œå°±æ˜¯è¿™ä¸‰ä¸ªåæ ‡æ¥ç¡®å®šçš„ï¼</p>
</blockquote>
<h2 id="1-8-ç»“æ„"><a href="#1-8-ç»“æ„" class="headerlink" title="1.8 ç»“æ„"></a>1.8 ç»“æ„</h2><p>åœ¨Mavenä¸­ï¼Œè¦æ±‚ä¸€ä¸ªmavené¡¹ç›®<strong>å¿…é¡»</strong>æ˜¯å›ºå®šçš„ç›®å½•ç»“æ„ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200914211537666.png" alt="image-20200914211537666"></p>
<p>å…¶ä¸­ï¼š</p>
<p><code>project</code>ï¼Œé¡¹ç›®çš„ä¸»ç›®å½•ï¼Œç›®å½•åè¡¨ç¤ºé¡¹ç›®åï¼ˆ<strong>å¿…é¡»</strong>ï¼‰</p>
<p><code>src/main/java/</code>ï¼Œå­˜æ”¾é¡¹ç›®ä¸­æºä»£ç çš„ç›®å½•ï¼ˆ<strong>å¿…é¡»</strong>ï¼‰</p>
<p><code>src/main/resources</code>ï¼Œå­˜æ”¾é¡¹ç›®ä¸­èµ„æºæ–‡ä»¶çš„ç›®å½•ï¼ˆ<strong>å¿…é¡»</strong>ï¼‰</p>
<p><code>src/test/java/</code>ï¼Œå­˜æ”¾æµ‹è¯•ä»£ç çš„ç›®å½•ï¼ˆ<strong>å¯é€‰</strong>ï¼‰</p>
<p><code>src/test/resources/</code>ï¼Œå­˜æ”¾æµ‹è¯•ä»£ç èµ„æºæ–‡ä»¶çš„ç›®å½•ï¼ˆ<strong>å¯é€‰</strong>ï¼‰</p>
<p><code>pom.xml</code>ï¼Œmavené¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯å¯¹mavené¡¹ç›®ä¿¡æ¯çš„è¯¦ç»†æè¿°ï¼ˆ<strong>å¿…é¡»</strong>ï¼‰</p>
<h2 id="1-9-pom-xml"><a href="#1-9-pom-xml" class="headerlink" title="1.9 pom.xml"></a>1.9 pom.xml</h2><p>pom.xmlæ–‡ä»¶ï¼Œæ˜¯mavené¡¹ç›®çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯å¯¹å½“å‰é¡¹ç›®çš„è¯¦ç»†æè¿°</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.briup.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mvn-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>mvn-test<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®å½“å‰é¡¹ç›®ä¸­ï¼Œæ‰€ä¾èµ–çš„å…¶ä»–mavené¡¹ç›®ï¼ˆjaråŒ…ï¼‰ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h1 id="servlet"><a href="#servlet" class="headerlink" title="servlet"></a>servlet</h1><h2 id="å®ç°æ–¹å¼"><a href="#å®ç°æ–¹å¼" class="headerlink" title="å®ç°æ–¹å¼"></a>å®ç°æ–¹å¼</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ServletæŠ€æœ¯å¯ä»¥æ‰©å±•æœåŠ¡å™¨ç«¯çš„åŠŸèƒ½ï¼Œè®©javaä»£ç åœ¨æœåŠ¡å™¨ç«¯ä¹Ÿèƒ½æˆä¸ºä¸€ç§èµ„æºï¼ˆåŠ¨æ€èµ„æºï¼‰ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨å¯ä»¥é€šè¿‡æŒ‡å®šçš„èµ„æºåœ°å€ï¼ˆURIï¼‰ï¼Œæ¥è®¿é—®è¿™ä¸ªjavaä»£ç ï¼ˆServletï¼‰ï¼ŒåŒæ—¶åœ¨Servletä»£ç ä¸­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨IOæµæŠŠç»“æœå†™å›ç»™æµè§ˆå™¨ã€‚</p>
<p>æŒ‰ç…§Servletè§„èŒƒè¦æ±‚ï¼Œç¼–å†™ä¸€ä¸ªServletç¨‹åºï¼Œåªéœ€è¦è®©è‡ªå·±çš„ç±»å®ç°<code>javax.servlet.Servlet</code>æ¥å£å°±å¯ä»¥äº†ï¼Œä½†æ˜¯è¯¥æ¥å£ä¹Ÿæœ‰ä¸€äº›é»˜è®¤çš„å®ç°ç±»ï¼Œæ‰€ä»¥é™¤äº†å®ç°æ¥å£çš„æ–¹å¼ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»§æ‰¿å®ƒé»˜è®¤çš„å‡ ä¸ªå®ç°ç±»ï¼Œå¹¶ä¸”é‡å†™æŒ‡å®šæ–¹æ³•ï¼Œä¹ŸåŒæ ·å¯ä»¥å®ŒæˆServletç¨‹åºçš„ç¼–å†™ã€‚</p>
<blockquote>
<p>ideaä¸­å¯¼å…¥servletä¾èµ–</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h3><p><code>javax.servlet.Servlet</code></p>
<p>å®ƒæ˜¯ServletæŠ€æœ¯çš„æ ¸å¿ƒæ¥å£ï¼Œæ‰€æœ‰çš„Servletç¨‹åºï¼Œéƒ½å¿…é¡»æ˜¯è¯¥æ¥å£çš„å®ç°ç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Servlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–servletå¯¹è±¡çš„æ—¶å€™è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿”å›ServletConfigå¯¹è±¡,è¯¥å¯¹è±¡å°è£…äº†Servletçš„é…ç½®ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¿é—®servletå¯¹è±¡çš„æ—¶å€™è¢«è°ƒç”¨ï¼ˆæœ€é‡è¦çš„æ–¹æ³•ï¼‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿”å›servletç›¸å…³ä¿¡æ¯,æ¯”å¦‚ä½œè€…ã€ç‰ˆæœ¬ã€ç‰ˆæƒç­‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é”€æ¯servletå¯¹è±¡çš„æ—¶å€™è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>åœ¨è¿™äº”ä¸ªæ–¹æ³•ä¸­ï¼Œæœ€é‡è¦çš„æ˜¯ <code>service(ServletRequest req, ServletResponse res)</code>æ–¹æ³•ï¼Œå› ä¸ºå½“å®¢æˆ·ç«¯æµè§ˆå™¨é€šè¿‡æŒ‡å®šåœ°å€è®¿é—®è¯¥Servletçš„æ—¶å€™ï¼ŒTomcatä¼šè‡ªåŠ¨è°ƒç”¨Servletä¸­çš„serviceæ–¹æ³•ã€‚</p>
<p>serviceæ–¹æ³•çš„ä½œç”¨å°±æ˜¯å¤„ç†å®¢æˆ·ç«¯æµè§ˆå™¨å‘é€çš„è¯·æ±‚ï¼Œå¹¶ä¸”å†™å›æœ¬æ¬¡è¯·æ±‚çš„å“åº”å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é‡å†™çš„serviceæ–¹æ³•ä¸­ï¼Œå¯ä»¥æŒ‰ç…§å½“å‰çš„åŠŸèƒ½éœ€æ±‚ï¼Œæ¥å®Œæˆä»£ç çš„ç¼–å†™ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.Servlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//æ¥æ”¶è¯·æ±‚ä¸­æºå¸¦çš„å‚æ•°ï¼ŒæŒ‡å®šå‚æ•°åä¸ºname</span></span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//è®¾ç½®æœ¬æ¬¡å“åº”å›å»å†…å®¹çš„ç±»å‹ï¼Œå¹¶ä¸”æŒ‡å®šäº†ç¼–ç ï¼Œè¿™æ˜¯ç»™æµè§ˆå™¨çœ‹çš„</span></span><br><span class="line">		res.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//é€šè¿‡å“åº”å¯¹è±¡è·å–è¾“å‡ºæµ</span></span><br><span class="line">		PrintWriter out = res.getWriter();</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//ç»™æµè§ˆå™¨å†™å›å†…å®¹</span></span><br><span class="line">		out.println(<span class="string">&quot;hello! &quot;</span>+name);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><code>web.xml</code>ä¸­è¿›è¡Œé…ç½®ï¼Œç›®çš„æ˜¯ä¸ºäº†å‘Šè¯‰tomcatï¼Œè¿™ä¸ªservletå¯¹åº”çš„URIåœ°å€æ˜¯ä»€ä¹ˆï¼Œå…¶å®å°±æ˜¯ä¸€ç§æ˜ å°„å…³ç³»çš„é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.briup.test.HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>





<p>é€šè¿‡urlåœ°å€è®¿é—®æ­¤Servletï¼Œå¹¶ä¸”æºå¸¦å‚æ•°ï¼š</p>
<p><a href="http://127.0.0.1:8989/servlet-test/hello?name=tom">http://127.0.0.1:8989/servlet-test/hello?name=tom</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200929165014319.png" alt="image-20200929165014319"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œå“åº”å¤´ä¿¡æ¯ä¸­çš„Content-Typeå­—æ®µå€¼ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨Servletä¸­è¿›è¡Œè®¾ç½®çš„å€¼</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200929165110420.png" alt="image-20200929165110420"></p>
<blockquote>
<p>ç«ç‹æµè§ˆå™¨ä¸­è¿˜æä¾›äº†è¯¦ç»†çš„å­—æ®µè§£é‡Šè¯´æ˜ï¼Œåœ¨ç”µè„‘è”ç½‘çš„æ—¶å€™ï¼Œå¯ä»¥ç‚¹å‡»å­—æ®µå‰é¢çš„é—®å·è¿›è¡ŒæŸ¥çœ‹</p>
</blockquote>
<h3 id="GenericServlet"><a href="#GenericServlet" class="headerlink" title="GenericServlet"></a>GenericServlet</h3><p><code>javax.servlet.GenericServlet</code></p>
<p>å®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå¯¹Servletæ¥å£ä¸­çš„æ–¹æ³•è¿›è¡Œäº†é»˜è®¤å®ç°ï¼Œä½†æ˜¯æœ€é‡è¦çš„<code>service</code>æ–¹æ³•å¹¶æ²¡æœ‰å®ç°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span>, <span class="title">ServletConfig</span>,</span></span><br><span class="line"><span class="class">        <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> ServletConfig config;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GenericServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// NOOP</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// NOOP by default</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getInitParameter</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getServletConfig().getInitParameter(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Enumeration&lt;String&gt; <span class="title">getInitParameterNames</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getServletConfig().getInitParameterNames();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> config;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletContext <span class="title">getServletContext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getServletConfig().getServletContext();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.config = config;</span><br><span class="line">        <span class="keyword">this</span>.init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="comment">// NOOP by default</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        getServletContext().log(getServletName() + <span class="string">&quot;: &quot;</span> + msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String message, Throwable t)</span> </span>&#123;</span><br><span class="line">        getServletContext().log(getServletName() + <span class="string">&quot;: &quot;</span> + message, t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> config.getServletName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¯¥ç±»ä¸­ï¼Œå®ç°äº†Servletæ¥å£ä¸­çš„init(ServletConfig config)æ–¹æ³•ï¼ŒåŒæ—¶åˆé‡è½½äº†ä¸€ä¸ªæ— å‚çš„initæ–¹æ³•ï¼Œå¹¶ä¸”æœ‰å‚æ•°çš„initæ–¹æ³•ä¸­åˆè°ƒç”¨äº†è¿™ä¸ªé‡è½½çš„æ— å‚initæ–¹æ³•ã€‚</p>
<p>ç”±æ­¤å¯çŸ¥ï¼Œå°†æ¥æˆ‘ä»¬å¯¹Servletè¿›è¡Œåˆå§‹åŒ–æ“ä½œçš„æ—¶å€™ï¼Œé‡å†™è¿™ä¸ªæ— å‚çš„initæ–¹æ³•å³å¯ã€‚</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.GenericServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/hello-generic&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloGenericServlet</span> <span class="keyword">extends</span> <span class="title">GenericServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		res.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = res.getWriter();</span><br><span class="line">		</span><br><span class="line">		out.println(<span class="string">&quot;hello!&quot;</span>+name);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨æ³¨è§£<code>@WebServlet</code>æ¥ä»£æ›¿web.xmlä¸­çš„æ˜ å°„é…ç½®ï¼Œä¿©è€…çš„æ•ˆæœæ˜¯ä¸€æ ·çš„</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™ç§æ–¹å¼åªè¦å®ç°ä¸€ä¸ª<code>service</code>æ–¹æ³•å³å¯ï¼Œå…¶ä»–æ–¹æ³•åœ¨çˆ¶ç±»ä¸­å·²ç»è¿›è¡Œäº†é»˜è®¤å®ç°</p>
</blockquote>
<p>é€šè¿‡urlåœ°å€è®¿é—®æ­¤Servletï¼Œå¹¶ä¸”æºå¸¦å‚æ•°ï¼š</p>
<p><a href="http://127.0.0.1:8989/servlet-test/hello-generic?name=tom">http://127.0.0.1:8989/servlet-test/hello-generic?name=tom</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200929171544550.png" alt="image-20200929171544550"></p>
<h3 id="HttpServlet"><a href="#HttpServlet" class="headerlink" title="HttpServlet"></a>HttpServlet</h3><p><code>javax.servlet.http.HttpServlet</code></p>
<p>å®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä½†æ˜¯ç±»ä¸­æ²¡æœ‰æŠ½è±¡æ–¹æ³•ã€‚</p>
<p>å®ƒç»§æ‰¿äº† <code>GenericServlet</code>ï¼Œå¯¹æ¥æ”¶åˆ°çš„å®¢æˆ·ç«¯è¯·æ±‚ï¼Œè¿›è¡Œäº†ç»†åˆ†ï¼Œå¯¹åº”ä¸åŒçš„è¯·æ±‚ç±»å‹ï¼š</p>
<ul>
<li>DELETE</li>
<li>HEAD</li>
<li>GET</li>
<li>OPTIONS</li>
<li>POST</li>
<li>PUT</li>
<li>TRACE</li>
</ul>
<p>åˆ†åˆ«ä½¿ç”¨ä¸åŒçš„æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå½“å‰å¦‚æœæ˜¯GETè¯·æ±‚ï¼Œé‚£ä¹ˆå°±è°ƒç”¨doGetæ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œå½“å‰å¦‚æœæ˜¯POSTè¯·æ±‚ï¼Œé‚£ä¹ˆå°±è°ƒç”¨doPostæ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œæ‰€ä»¥åœ¨HttpServletä¸­ï¼Œå®šä¹‰äº†å¾ˆå¤šdoXxxæ–¹æ³•ï¼Œç”¨æ¥å¤„ç†ä¸åŒç±»å‹çš„è¯·æ±‚ã€‚</p>
<p>æºç è¾ƒé•¿ï¼Œè¿™é‡Œç»™å‡ºéƒ¨åˆ†ä»£ç ï¼Œèƒ½è¯´æ˜é—®é¢˜å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpServlet</span> <span class="keyword">extends</span> <span class="title">GenericServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_DELETE = <span class="string">&quot;DELETE&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_HEAD = <span class="string">&quot;HEAD&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_GET = <span class="string">&quot;GET&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_OPTIONS = <span class="string">&quot;OPTIONS&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_POST = <span class="string">&quot;POST&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_PUT = <span class="string">&quot;PUT&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_TRACE = <span class="string">&quot;TRACE&quot;</span>;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        String msg = lStrings.getString(<span class="string">&quot;http.method_get_not_supported&quot;</span>);</span><br><span class="line">        sendMethodNotAllowed(req, resp, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doHead</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (DispatcherType.INCLUDE.equals(req.getDispatcherType())) &#123;</span><br><span class="line">            doGet(req, resp);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            NoBodyResponse response = <span class="keyword">new</span> NoBodyResponse(resp);</span><br><span class="line">            doGet(req, response);</span><br><span class="line">            response.setContentLength();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String msg = lStrings.getString(<span class="string">&quot;http.method_post_not_supported&quot;</span>);</span><br><span class="line">        sendMethodNotAllowed(req, resp, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPut</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String msg = lStrings.getString(<span class="string">&quot;http.method_put_not_supported&quot;</span>);</span><br><span class="line">        sendMethodNotAllowed(req, resp, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doDelete</span><span class="params">(HttpServletRequest req,</span></span></span><br><span class="line"><span class="params"><span class="function">                            HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String msg = lStrings.getString(<span class="string">&quot;http.method_delete_not_supported&quot;</span>);</span><br><span class="line">        sendMethodNotAllowed(req, resp, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doOptions</span><span class="params">(HttpServletRequest req,</span></span></span><br><span class="line"><span class="params"><span class="function">            HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//..</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doTrace</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//..</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String method = req.getMethod();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (method.equals(METHOD_GET)) &#123;</span><br><span class="line">            <span class="keyword">long</span> lastModified = getLastModified(req);</span><br><span class="line">            <span class="keyword">if</span> (lastModified == -<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// servlet doesn&#x27;t support if-modified-since, no reason</span></span><br><span class="line">                <span class="comment">// to go through further expensive logic</span></span><br><span class="line">                doGet(req, resp);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">long</span> ifModifiedSince;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    ifModifiedSince = req.getDateHeader(HEADER_IFMODSINCE);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalArgumentException iae) &#123;</span><br><span class="line">                    <span class="comment">// Invalid date header - proceed as if none was set</span></span><br><span class="line">                    ifModifiedSince = -<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (ifModifiedSince &lt; (lastModified / <span class="number">1000</span> * <span class="number">1000</span>)) &#123;</span><br><span class="line">                    <span class="comment">// If the servlet mod time is later, call doGet()</span></span><br><span class="line">                    <span class="comment">// Round down to the nearest second for a proper compare</span></span><br><span class="line">                    <span class="comment">// A ifModifiedSince of -1 will always be less</span></span><br><span class="line">                    maybeSetLastModified(resp, lastModified);</span><br><span class="line">                    doGet(req, resp);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    resp.setStatus(HttpServletResponse.SC_NOT_MODIFIED);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_HEAD)) &#123;</span><br><span class="line">            <span class="keyword">long</span> lastModified = getLastModified(req);</span><br><span class="line">            maybeSetLastModified(resp, lastModified);</span><br><span class="line">            doHead(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_POST)) &#123;</span><br><span class="line">            doPost(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_PUT)) &#123;</span><br><span class="line">            doPut(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_DELETE)) &#123;</span><br><span class="line">            doDelete(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_OPTIONS)) &#123;</span><br><span class="line">            doOptions(req,resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_TRACE)) &#123;</span><br><span class="line">            doTrace(req,resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            <span class="comment">// Note that this means NO servlet supports whatever</span></span><br><span class="line">            <span class="comment">// method was requested, anywhere on this server.</span></span><br><span class="line">            <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">            String errMsg = lStrings.getString(<span class="string">&quot;http.method_not_implemented&quot;</span>);</span><br><span class="line">            Object[] errArgs = <span class="keyword">new</span> Object[<span class="number">1</span>];</span><br><span class="line">            errArgs[<span class="number">0</span>] = method;</span><br><span class="line">            errMsg = MessageFormat.format(errMsg, errArgs);</span><br><span class="line"></span><br><span class="line">            resp.sendError(HttpServletResponse.SC_NOT_IMPLEMENTED, errMsg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        HttpServletRequest  request;</span><br><span class="line">        HttpServletResponse response;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            request = (HttpServletRequest) req;</span><br><span class="line">            response = (HttpServletResponse) res;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassCastException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ServletException(lStrings.getString(<span class="string">&quot;http.non_http&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        service(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„1ï¼ŒHttpServletæ˜¯æŠ½è±¡ç±»ï¼Œä½†æ˜¯é‡Œé¢æ²¡æœ‰æŠ½è±¡æ–¹æ³•</p>
<p>æ³¨æ„2ï¼ŒHttpServletç»§æ‰¿äº†GenericServletï¼Œå®ç°äº†serviceæ–¹æ³•ï¼Œå¹¶ä¸”å¯¹serviceæ–¹æ³•è¿›è¡Œäº†é‡è½½</p>
<p>æ³¨æ„3ï¼Œå®ç°çš„serviceæ–¹æ³•ä¸­ï¼Œå¯¹è¯·æ±‚å’Œå“åº”è¿›è¡Œäº†å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œå°†æ™®é€šçš„è¯·æ±‚å’Œå“åº”å¯¹è±¡ï¼Œå¼ºåˆ¶è½¬æ¢æˆäº†é’ˆå¯¹HTTPåè®®çš„è¯·æ±‚å’Œå“åº”ï¼Œç„¶åè°ƒç”¨é‡è½½çš„serviceæ–¹æ³•ï¼Œå°†è½¬æ¢çš„è¯·æ±‚å’Œå“åº”ä¼ å…¥</p>
<p>æ³¨æ„4ï¼Œé‡è½½åçš„serviceæ–¹æ³•ä¸­ï¼Œæ ¹æ®å½“å‰è¯·æ±‚çš„ç±»å‹ï¼ˆgetã€postè·å–å…¶ä»–ï¼‰ï¼Œå†è°ƒç”¨å¯¹åº”çš„doXxxæ–¹æ³•è¿›è¡Œå¤„ç†</p>
<p>æ³¨æ„5ï¼ŒdoXxxæ–¹æ³•ä¸­ä¼šæœ‰ä¸€äº›é»˜è®¤çš„å®ç°ï¼Œä¾‹å¦‚doGetæ–¹æ³•ä¸­ä¼šé»˜è®¤è¿”å›<code>http.method_delete_not_supported</code></p>
<p>ç”±ä»¥ä¸Šä»£ç å¯çŸ¥ï¼Œæˆ‘ä»¬ç¼–å†™å­ç±»ç»§æ‰¿ <code>HttpServlet</code>ï¼Œå¹¶ä¸”é‡å†™æ–¹æ³•å³å¯ï¼Œå¦‚æœéœ€è¦å¤„ç†GETæ–¹å¼çš„è¯·æ±‚ï¼Œé‚£ä¹ˆå°±é‡å†™doGetæ–¹æ³•ï¼Œå¦‚æœéœ€è¦å¤„ç†POSTæ–¹å¼çš„è¯·æ±‚ï¼Œé‚£ä¹ˆå°±é‡å†™doPostæ–¹æ³•ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/hello-http-servlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloHttpServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = resp.getWriter();</span><br><span class="line">		</span><br><span class="line">		out.println(<span class="string">&quot;GET: helloï¼&quot;</span>+name);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = resp.getWriter();</span><br><span class="line">		</span><br><span class="line">		out.println(<span class="string">&quot;POST: helloï¼&quot;</span>+name);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>åœ¨é¡µé¢ä¸­ç¼–å†™ä¸€ä¸ªè¡¨å•ï¼Œè·³è½¬è¡¨å•æäº¤çš„æ–¹å¼ï¼Œæ¥æœ€ç»ˆè§‚å¯Ÿgetå’Œpostæ–¹å¼å‘é€è¯·æ±‚åï¼ŒServletä¸­æ–¹æ³•è°ƒç”¨æƒ…å†µï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;hello-http-servlet&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">		ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ ¹æ®æµ‹è¯•ç»“æœå¯çŸ¥ï¼Œå½“å‰é¡µé¢ä¸­å‘é€GETè¯·æ±‚çš„æ—¶å€™ï¼ŒServletä¸­çš„doGetæ–¹æ³•è¢«è°ƒç”¨ï¼Œå½“é¡µé¢ä¸­å‘é€POSTè¯·æ±‚çš„æ—¶å€™ï¼ŒServletä¸­çš„doPostæ–¹æ³•è¢«è°ƒç”¨</p>
</blockquote>
<h2 id="é›†æˆtomcat"><a href="#é›†æˆtomcat" class="headerlink" title="é›†æˆtomcat"></a>é›†æˆtomcat</h2><p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20220103133043937.png" alt="image-20220103133043937"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20220103133114835.png" alt="image-20220103133114835"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20220103133222346.png" alt="image-20220103133222346"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20220103133501639.png" alt="image-20220103133501639"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20220103133518468.png" alt="image-20220103133518468"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20220103133534530.png" alt="image-20220103133534530"></p>
<blockquote>
<p><a href="https://www.cnblogs.com/shej123/p/10312806.html">è§£å†³</a>Ideaä¸­æ•´åˆtomcatä¹±ç çš„é—®é¢˜ å¯åŠ¨tomcatæ—¶æ·»åŠ vmå‚æ•°  -Dfile.encoding=UTF-8</p>
</blockquote>
<h2 id="GETå’ŒPOST"><a href="#GETå’ŒPOST" class="headerlink" title="GETå’ŒPOST"></a>GETå’ŒPOST</h2><blockquote>
<p>HTTPåè®®ä¸­ï¼Œå®šä¹‰äº†å¾ˆå¤šç§è¯·æ±‚çš„æ–¹å¼ï¼Œä½†æ˜¯æµè§ˆå™¨é»˜è®¤æƒ…å†µä¸‹ï¼Œåªèƒ½å‘å‡ºGETæ–¹å¼è¯·æ±‚å’ŒPOSTæ–¹å¼è¯·æ±‚</p>
</blockquote>
<h3 id="å¸¸è§æƒ…å†µ"><a href="#å¸¸è§æƒ…å†µ" class="headerlink" title="å¸¸è§æƒ…å†µ"></a>å¸¸è§æƒ…å†µ</h3><p>åœ¨é¡µé¢ä¸­ï¼Œå¸¸è§çš„å‘é€GETæ–¹å¼è¯·æ±‚çš„æƒ…å†µæœ‰ï¼š</p>
<ul>
<li>æµè§ˆå™¨åœ°å€æ ç›´æ¥è¾“å…¥åœ°å€è®¿é—®</li>
<li>è¶…é“¾æ¥è®¿é—®  <a href=""></li>
<li><code>&lt;image src=&quot;&quot;&gt;</code>è®¿é—®å›¾ç‰‡</li>
<li>å¤–éƒ¨jsæ–‡ä»¶çš„å¼•å…¥</li>
<li>å¤–éƒ¨cssæ–‡ä»¶çš„å¼•å…¥</li>
<li>è¡¨å•æäº¤æ•°æ®ï¼Œmethod=â€getâ€</li>
<li>åœ¨javascriptä»£ç ä¸­è®¿é—®èµ„æº</li>
<li>ajaxä¸­è®¾ç½®è¯·æ±‚ä¸ºgetæ–¹å¼</li>
<li>ä½¿ç”¨jspç›¸å…³æ ‡ç­¾è®¿é—®èµ„æº</li>
</ul>
<p>åœ¨é¡µé¢ä¸­ï¼Œå¸¸è§çš„å‘é€POSTæ–¹å¼è¯·æ±‚çš„æƒ…å†µæœ‰ï¼š</p>
<ul>
<li>è¡¨å•æäº¤æ•°æ®ï¼Œmethod=â€postâ€</li>
<li>ajaxä¸­è®¾ç½®è¯·æ±‚ä¸ºpostæ–¹å¼</li>
</ul>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œæµè§ˆå™¨ä¸­å‘å‡ºçš„è¯·æ±‚ï¼Œå¤§å¤šæ•°éƒ½æ˜¯GETæ–¹å¼è¯·æ±‚</p>
</blockquote>
<h3 id="ç‰¹ç‚¹åŒºåˆ«"><a href="#ç‰¹ç‚¹åŒºåˆ«" class="headerlink" title="ç‰¹ç‚¹åŒºåˆ«"></a>ç‰¹ç‚¹åŒºåˆ«</h3><p>httpåè®®ä¸‹çš„è¯·æ±‚æ ¼å¼ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1éƒ¨åˆ†: è¯·æ±‚è¡Œ   get /hello http 1.1			</span><br><span class="line">2éƒ¨åˆ†: è¯·æ±‚å¤´éƒ¨/æ¶ˆæ¯æŠ¥å¤´	</span><br><span class="line">3éƒ¨åˆ†: \r\n</span><br><span class="line">4éƒ¨åˆ†: è¯·æ±‚æ­£æ–‡	å‚æ•°æ”¾çš„ä½ç½®</span><br></pre></td></tr></table></figure>



<p>GETæ–¹å¼ä¼ å‚æ•°ï¼Œå‚æ•°åœ¨uriåé¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /hello?name=tom HTTP1.1</span><br><span class="line">key: value</span><br><span class="line">key: value</span><br><span class="line">key: value</span><br><span class="line">.....</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure>

<blockquote>
<p>GETæ–¹å¼ä¼ å‚ï¼Œå‚æ•°ä¼šæ˜¾ç¤ºåœ¨åœ°å€æ ä¸­ï¼Œå¹¶ä¸”å‚æ•°çš„é•¿åº¦ä¹Ÿä¼šè¢«åœ°å€æ çš„é•¿åº¦è€Œé™åˆ¶</p>
</blockquote>
<p>postæ–¹å¼ä¼ å‚ï¼Œå‚æ•°åœ¨è¯·æ±‚æ­£æ–‡ä¸­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /hello HTTP1.1</span><br><span class="line">key: value</span><br><span class="line">key: value</span><br><span class="line">key: value</span><br><span class="line">.....</span><br><span class="line">\r\n</span><br><span class="line">name=tom</span><br></pre></td></tr></table></figure>

<blockquote>
<p>POSTæ–¹å¼ä¼ å‚ï¼Œå‚æ•°ä¸ä¼šæ˜¾ç¤ºåœ¨åœ°å€ä¸­ï¼Œè€Œæ˜¯åœ¨è¯·æ±‚ä½“ä¸­ï¼Œå¹¶ä¸”å‚æ•°é•¿åº¦å¹¶æ²¡æœ‰ç›´æ¥é™åˆ¶</p>
</blockquote>
<h2 id="æ¥æ”¶å‚æ•°"><a href="#æ¥æ”¶å‚æ•°" class="headerlink" title="æ¥æ”¶å‚æ•°"></a>æ¥æ”¶å‚æ•°</h2><blockquote>
<p>åœ¨Servletä¸­ï¼Œä¸€é¡¹é‡è¦çš„å·¥ä½œï¼Œå°±æ˜¯æ¥æ”¶é¡µé¢è¯·æ±‚ä¸­æºå¸¦çš„å‚æ•°ã€‚</p>
</blockquote>
<h3 id="æ–¹å¼"><a href="#æ–¹å¼" class="headerlink" title="æ–¹å¼"></a>æ–¹å¼</h3><p>è™½ç„¶GETè¯·æ±‚å’ŒPOSTè¯·æ±‚æºå¸¦å‚æ•°çš„æ–¹å¼ï¼ˆä½ç½®ï¼‰ä¸åŒï¼Œä½†æ˜¯ç”±äºServletåº•å±‚APIçš„å°è£…ï¼Œæˆ‘ä»¬åœ¨Servletä¸­ï¼Œé€šè¿‡è¯·æ±‚ï¼ˆrequestï¼‰è·å–å‚æ•°çš„æ–¹å¼éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>æ‰€ä»¥ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œéƒ½ä»¥GETæ–¹å¼ä¼ å‚çš„æ–¹å¼è¿›è¡Œè¯´æ˜ã€‚</p>
<h3 id="å•å€¼"><a href="#å•å€¼" class="headerlink" title="å•å€¼"></a>å•å€¼</h3><p>æ¥æ”¶è¯·æ±‚ä¸­å•ä¸€çš„å‚æ•°å€¼çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå‚æ•°åå¯¹åº”ä¸€ä¸ªå€¼ï¼Œä½¿ç”¨<code>getParameter</code>æ–¹æ³•å³å¯ï¼š</p>
<p><code>/param?name=tom&amp;age=20</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/param&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParamServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		String age = req.getParameter(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">		System.out.println(name);</span><br><span class="line">		System.out.println(age);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼ŒServletè·å–åˆ°çš„å‚æ•°å€¼ï¼Œé»˜è®¤éƒ½æ˜¯Stringç±»å‹çš„ï¼Œå¦‚æœéœ€è¦å¯ä»¥è‡ªå·±è¿›è¡Œç±»è½¬æ¢</p>
</blockquote>
<h3 id="å¤šå€¼"><a href="#å¤šå€¼" class="headerlink" title="å¤šå€¼"></a>å¤šå€¼</h3><p>ä¸€ä¸ªå‚æ•°åå¯¹åº”å¤šä¸ªå€¼ï¼Œä¾‹å¦‚é¡µé¢ä¸­çš„å¤šé€‰æ¡†ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨<code>getParameterValues</code>æ–¹æ³•</p>
<p><code>/param?like=0&amp;like=1</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/param&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParamServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String[] like = req.getParameterValues(<span class="string">&quot;like&quot;</span>);</span><br><span class="line">		System.out.println(Arrays.toString(like));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¯¥æ–¹æ³•è¿”å›æ˜¯ä¸€ä¸ªStringç±»å‹æ•°ç»„ï¼Œå› ä¸ºä¸€ä¸ªå‚æ•°åå¯èƒ½ä¼šå¯¹åº”å¤šä¸ªå€¼</p>
</blockquote>
<h3 id="ç‰¹æ®Š"><a href="#ç‰¹æ®Š" class="headerlink" title="ç‰¹æ®Š"></a>ç‰¹æ®Š</h3><p>åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œéœ€è¦è·å–è¯·æ±‚ä¸­æºå¸¦çš„æ‰€æœ‰<strong>å‚æ•°å</strong>ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨<code>getParameterNames</code>æ–¹æ³•</p>
<p><code>/param?name=tom&amp;age=20&amp;like=0&amp;like=1</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/param&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParamServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		Enumeration&lt;String&gt; names = req.getParameterNames();</span><br><span class="line">		<span class="keyword">while</span>(names.hasMoreElements())&#123;</span><br><span class="line">			String paramName = names.nextElement();</span><br><span class="line">			System.out.println(paramName);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿è¡Œç»“æœï¼š</span></span><br><span class="line">name</span><br><span class="line">age</span><br><span class="line">like</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œ<code>hasMoreElements</code>å¯ä»¥åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œ<code>nextElement</code>å¯ä»¥è¿”å›ä¸€ä¸‹å…ƒç´ </p>
</blockquote>
<p>åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œéœ€è¦è·å–è¯·æ±‚ä¸­æºå¸¦çš„æ‰€æœ‰<strong>å‚æ•°</strong>å’Œå¯¹åº”çš„<strong>å€¼</strong>ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨<code>getParameterMap</code>æ–¹æ³•</p>
<p><code>/param?name=tom&amp;age=20&amp;like=0&amp;like=1</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/param&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParamServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		Map&lt;String, String[]&gt; map = req.getParameterMap();</span><br><span class="line">		<span class="keyword">for</span>(String key:map.keySet())&#123;</span><br><span class="line">			System.out.println(key+<span class="string">&quot; : &quot;</span>+Arrays.toString(map.get(key)));</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿è¡Œç»“æœï¼š</span></span><br><span class="line">name : [tom]</span><br><span class="line">age  : [<span class="number">20</span>]</span><br><span class="line">like : [<span class="number">0</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>



<p>==æ€è€ƒï¼Œä»€ä¹ˆæƒ…å†µä¸‹ï¼Œä¼šä¸çŸ¥é“å®¢æˆ·ç«¯ä¼ ä»€ä¹ˆåå­—çš„å‚æ•°ç»™æˆ‘ä»¬ï¼Ÿ==</p>
<h2 id="è·³è½¬å’Œé‡å®šå‘"><a href="#è·³è½¬å’Œé‡å®šå‘" class="headerlink" title="è·³è½¬å’Œé‡å®šå‘"></a>è·³è½¬å’Œé‡å®šå‘</h2><h3 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>å¦‚æœè®¿é—®ä¸€ä¸ªservletï¼Œéœ€è¦è®©servletæŠŠä¸€ä¸ªå·²ç»å­˜åœ¨htmlé¡µé¢è¿”å›ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨IOæµè¯»å–è¿™ä¸ªé¡µé¢ï¼Œå¹¶å†™å›.</p>
<p><code>hello.html</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world! <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/html&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HtmlServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		req.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		resp.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = resp.getWriter();</span><br><span class="line">		String realPath = getServletContext().getRealPath(<span class="string">&quot;/hello.html&quot;</span>);</span><br><span class="line">		BufferedReader in = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(realPath),<span class="string">&quot;utf-8&quot;</span>));</span><br><span class="line">		</span><br><span class="line">		String line = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">while</span>((line=in.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			out.println(line);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		in.close();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œ<code>getServletContext().getRealPath(&quot;/hello.html&quot;)</code>æ˜¯è·å–è¿™ä¸ªhtmlé¡µé¢ï¼Œéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸­çš„ç»å¯¹è·¯å¾„ï¼Œæ–¹ä¾¿IOæµçš„è¯»å–ã€‚</p>
</blockquote>
<blockquote>
<p>ç”¨ioæµçš„æ–¹å¼è¯»å–å­—èŠ‚æ— æ³•è§£å†³ä¹±ç </p>
</blockquote>
<p>ä½†æ˜¯ï¼Œè¿™æ ·å®ç°åŠŸèƒ½æœ‰ç‚¹éº»çƒ¦ï¼Œè€Œä¸”å¾ˆå¤šéƒ½æ˜¯å›ºå®šçš„ä»£ç ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œå°è£…ã€‚</p>
<p>å…¶å®Servletä¸­å·²ç»ä¸“é—¨å¯¹è¿™ç§æƒ…å†µè¿›è¡Œäº†å°è£…å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸“é—¨çš„æ–¹æ³•æ¥å®Œæˆæ­¤æ•ˆæœï¼š</p>
<ul>
<li>è·³è½¬</li>
<li>é‡å®šå‘</li>
</ul>
<h3 id="6-2-è·³è½¬"><a href="#6-2-è·³è½¬" class="headerlink" title="6.2 è·³è½¬"></a>6.2 è·³è½¬</h3><p>ä¹Ÿç§°ä¹‹ä¸ºï¼ŒæœåŠ¡å™¨å†…éƒ¨è·³è½¬ã€‚</p>
<p>å…¶æœ¬è´¨æ˜¯ï¼Œåœ¨servletæ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥å°†æ­¤è¯·æ±‚è½¬å‘ç»™æœåŠ¡å™¨å†…éƒ¨çš„å¦ä¸€ä¸ªèµ„æºä¸­ï¼Œå¦‚æœè¿™ä¸ªèµ„æºæ˜¯ä¸€ä¸ªhtmlé¡µé¢ï¼Œé‚£ä¹ˆtomcatå°±ä¼šè‡ªåŠ¨è¯»å–è¿™ä¸ªhtmlé¡µé¢å¹¶å†™å›ç»™æµè§ˆå™¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.RequestDispatcher;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/forward&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForwardServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//pathè¡¨ç¤ºä¸ºä¸€ä¸ªé¡µé¢çš„åœ°å€</span></span><br><span class="line">		String path = <span class="string">&quot;/hello.html&quot;</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//æ ¹æ®æŒ‡å®šåœ°å€ï¼Œè·å–è¯·æ±‚è½¬å‘å¯¹è±¡ï¼ˆRequestDispatcherï¼‰</span></span><br><span class="line">		RequestDispatcher dispatcher = req.getRequestDispatcher(path);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//ä½¿ç”¨è¯·æ±‚è½¬å‘å¯¹è±¡ï¼ŒæŠŠè¯·æ±‚å¯¹è±¡å’Œå“åº”å¯¹è±¡è½¬å‘ç»™æœåŠ¡å™¨å†…éƒ¨çš„å¦ä¸€ä¸ªèµ„æºï¼ˆhtmlï¼‰</span></span><br><span class="line">		<span class="comment">//å®Œæˆè·³è½¬æ•ˆæœ</span></span><br><span class="line">		dispatcher.forward(req, resp);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæœåŠ¡å™¨å†…éƒ¨è·³è½¬ï¼Œä¸ä»…å¯ä»¥ä»ä¸€ä¸ªServletè·³è½¬åˆ°ä¸€ä¸ªhtmlé¡µé¢ä¸­ï¼Œä¹Ÿå¯ä»¥ä»ä¸€ä¸ªServletè·³è½¬åˆ°å¦ä¸€ä¸ªServletä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.RequestDispatcher;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/forward&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForwardServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//pathè¡¨ç¤ºä¸ºä¸€ä¸ªservletçš„æ˜ å°„åœ°å€</span></span><br><span class="line">		String path = <span class="string">&quot;/html&quot;</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//æ ¹æ®æŒ‡å®šåœ°å€ï¼Œè·å–è¯·æ±‚è½¬å‘å¯¹è±¡ï¼ˆRequestDispatcherï¼‰</span></span><br><span class="line">		RequestDispatcher dispatcher = req.getRequestDispatcher(path);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//ä½¿ç”¨è¯·æ±‚è½¬å‘å¯¹è±¡ï¼ŒæŠŠè¯·æ±‚å¯¹è±¡å’Œå“åº”å¯¹è±¡è½¬å‘ç»™æœåŠ¡å™¨å†…éƒ¨çš„å¦ä¸€ä¸ªèµ„æºï¼ˆservletï¼‰</span></span><br><span class="line">		<span class="comment">//å®Œæˆè·³è½¬æ•ˆæœ</span></span><br><span class="line">		dispatcher.forward(req, resp);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>æ­¤æ—¶æ•´ä½“è®¿é—®æƒ…å†µå¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200930023542815.png" alt="image-20200930023542815"></p>
<p><strong>æœåŠ¡å™¨å†…éƒ¨è·³è½¬çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>éœ€è¦ä½¿ç”¨requestå¯¹è±¡æ¥å®Œæˆ</li>
<li>æœåŠ¡å™¨å†…éƒ¨è·³è½¬æœŸé—´ï¼Œå…¶å®å°±æ˜¯æŠŠè¯·æ±‚requestå’Œå“åº”responseè½¬å‘åˆ°ä¸‹ä¸€ä¸ªèµ„æºä¸­ï¼Œæ‰€ä»¥åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­,ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªrequestå’Œresponse</li>
<li>æœåŠ¡å™¨å†…éƒ¨è·³è½¬,ã€ä¸ä¼šã€‘æ”¹å˜æµè§ˆå™¨åœ°å€æ ä¸­çš„åœ°å€ï¼Œå› ä¸ºä»å§‹è‡³ç»ˆæµè§ˆå™¨åªå‘å‡ºäº†ä¸€ä¸ªè¯·æ±‚</li>
</ul>
<h3 id="6-3-é‡å®šå‘"><a href="#6-3-é‡å®šå‘" class="headerlink" title="6.3 é‡å®šå‘"></a>6.3 é‡å®šå‘</h3><p>ä¹Ÿç§°ä¹‹ä¸ºï¼Œå®¢æˆ·ç«¯é‡å®šå‘ã€‚</p>
<p>å…¶æœ¬è´¨æ˜¯ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œè®¿é—®servletè·å–èµ„æºï¼Œä½†æ˜¯æœåŠ¡å™¨ä¸­ï¼Œå·²ç»å°†èµ„æºè½¬ç§»åˆ°å¦ä¸€ä¸ªä½ç½®äº†ï¼Œæ‰€ä»¥éœ€è¦é€šçŸ¥å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œé‡æ–°å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œè®¿é—®ä¸€ä¸ªæ–°çš„èµ„æºä½ç½®ã€‚</p>
<p>æ­¤æ—¶ï¼ŒæœåŠ¡å™¨éœ€è¦é€šçŸ¥æµè§ˆå™¨å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œå¹¶ä¸”è¯·æ±‚æ–°çš„èµ„æºä½ç½®</p>
<ul>
<li>é€šè¿‡å“åº”çŠ¶æ€ç ï¼ˆ302ï¼‰ï¼Œé€šçŸ¥æµè§ˆå™¨éœ€è¦é‡å®šå‘</li>
<li>é€šè¿‡å“åº”å¤´å­—æ®µï¼ˆLocation: æ–°åœ°å€ï¼‰ï¼Œé€šçŸ¥æµè§ˆå™¨æ–°çš„èµ„æºä½ç½®</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/redirect&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedirectServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//éœ€è¦å®¢æˆ·ç«¯é‡å®šå‘çš„ä¸€ä¸ªæ–°çš„èµ„æºä½ç½®</span></span><br><span class="line">		String location = <span class="string">&quot;hello.html&quot;</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//é€šçŸ¥å®¢æˆ·ç«¯æµè§ˆå™¨è¿›è¡Œèµ„æºé‡å®šå‘</span></span><br><span class="line">		resp.sendRedirect(location);</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>è®¿é—®ç»“æœä¸ºï¼š</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200930024921090.png" alt="image-20200930024921090"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œç¬¬ä¸€æ¬¡è®¿é—®/redirectçš„å“åº”çŠ¶æ€ç æ˜¯302ï¼Œå¹¶ä¸”å“åº”å¤´ä¿¡æ¯ä¸­æŒ‡å®šäº†æ–°çš„èµ„æºåœ°å€ï¼Œæµè§ˆå™¨æ ¹æ®è¿™ä¸ªæ–°åœ°å€å‘å‡ºäº†ç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œå¹¶ä¸”å½“å‰æµè§ˆå™¨åœ°å€æ ä¸­çš„åœ°å€ï¼Œæ˜¾ç¤ºçš„æ˜¯ç¬¬äºŒæ¬¡è¯·æ±‚çš„åœ°å€</p>
</blockquote>
<p><strong>æ­¤æ—¶æ•´ä½“è®¿é—®æƒ…å†µå¦‚ä¸‹ï¼š</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200930031120256.png" alt="image-20200930031120256"></p>
<p><strong>å®¢æˆ·ç«¯é‡å®šå‘çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>éœ€è¦ä½¿ç”¨responseå¯¹è±¡æ¥å®Œæˆ</li>
<li>å®¢æˆ·ç«¯é‡å®šå‘ï¼Œä¼šè®©æµè§ˆå™¨å‘å‡ºç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œé‚£ä¹ˆåœ¨æœåŠ¡å™¨å†…éƒ¨ä¼šäº§ç”Ÿæ–°çš„requestå¯¹è±¡å’Œresponseå¯¹è±¡</li>
<li>å®¢æˆ·ç«¯é‡å®šå‘,ã€ä¼šã€‘æ”¹å˜æµè§ˆå™¨åœ°å€æ ä¸­çš„åœ°å€ï¼Œå› ä¸ºå‘å‡ºäº†ç¬¬äºŒæ¬¡è¯·æ±‚</li>
</ul>
<p>å®¢æˆ·ç«¯é‡å®šå‘ä¸ä»…å¯ä»¥é‡å®šå‘åˆ°ä¸€ä¸ªhtmlé¡µé¢ï¼Œä¹Ÿå¯ä»¥é‡å®šå‘åˆ°å¦ä¸€ä¸ªServletä¸­ï¼Œåªè¦æ”¹å˜é‡å®šå‘åœ°å€å³å¯ã€‚</p>
<h3 id="6-4-æ€»ç»“"><a href="#6-4-æ€»ç»“" class="headerlink" title="6.4 æ€»ç»“"></a>6.4 æ€»ç»“</h3><p>æœåŠ¡å™¨å†…éƒ¨è·³è½¬ï¼š</p>
<ul>
<li>ä½¿ç”¨requestå®Œæˆ</li>
<li>è·³è½¬çš„æœ¬è´¨æ˜¯åœ¨æœåŠ¡å™¨å†…éƒ¨æŠŠè¯·æ±‚å’Œå“åº”è¿›è¡Œè½¬å‘ï¼Œè½¬å‘ç»™ä¸‹ä¸€ä¸ªæŒ‡å®šçš„èµ„æº</li>
<li>å¦‚æœrequestä¸­æœ‰æ•°æ®ï¼Œåœ¨è·³è½¬åˆ°çš„ä¸‹ä¸€ä¸ªèµ„æºä¸­æ˜¯å¯ä»¥æ‹¿åˆ°è¿™ä¸ªæ•°æ®ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªrequestè¯·æ±‚å¯¹è±¡</li>
<li>ç”±äºæœåŠ¡å™¨è·³è½¬æ˜¯æŠŠè¯·æ±‚å’Œå“åº”åœ¨æœåŠ¡å™¨å†…éƒ¨ä¸­è¿›è¡Œè½¬å‘ï¼Œæ‰€ä»¥æµè§ˆå™¨çš„åœ°å€æ ä¸­çš„åœ°å€æ˜¯ä¸å—å½±å“çš„ï¼Œå§‹ç»ˆè¿˜æ˜¯ç¬¬ä¸€æ¬¡å‘å‡ºè¯·æ±‚çš„åœ°å€ï¼Œå…¶å®æµè§ˆå™¨æ ¹æœ¬å°±ä¸çŸ¥é“æœåŠ¡å™¨å†…éƒ¨çš„è¯·æ±‚è½¬å‘æƒ…å†µ</li>
<li>åœ¨è®¾ç½®è·³è½¬çš„èµ„æºåœ°å€çš„æ—¶å€™ï¼Œè·¯å¾„çš„å‰é¢ä¸€èˆ¬è¦åŠ ä¸Š/ï¼Œä¾‹å¦‚ <code>String path = &quot;/hello.html&quot;;</code></li>
</ul>
<p>å®¢æˆ·ç«¯é‡å®šå‘ï¼š</p>
<ul>
<li><p>ä½¿ç”¨responseå®Œæˆ</p>
</li>
<li><p>é‡å®šå‘çš„æœ¬è´¨æ˜¯æŠŠæ–°çš„èµ„æºè·¯å¾„è¿”å›ç»™æµè§ˆå™¨ï¼Œè®©æµè§ˆå™¨å‘è¿™ä¸ªæ–°åœ°å€å‘é€ä¸€ä¸ªæ–°è¯·æ±‚</p>
<p>æ­¤å¤„æ˜¯åˆ©ç”¨äº†å“åº”çš„çŠ¶æ€ç 302å’Œå“åº”å¤´ä¿¡æ¯ä¸­çš„Locationå­—æ®µæ¥å®Œæˆ</p>
</li>
<li><p>å¦‚æœrequestä¸­æœ‰æ•°æ®ï¼Œé‡å®šå‘ååœ¨æ–°çš„èµ„æºä¸­æ˜¯æ‹¿ä¸åˆ°è¿™ä¸ªæ•°æ®çš„ï¼Œå› ä¸ºé‡å®šå‘ä¼šå‘å‡ºæ–°çš„è¯·æ±‚ï¼Œä½†æ˜¯æ•°æ®åœ¨ä¸Šä¸€ä¸ªè€çš„è¯·æ±‚ä¸­</p>
</li>
<li><p>ç”±äºé‡å®šå‘è®©æµè§ˆå™¨å‘å‡ºæ–°çš„è¯·æ±‚ï¼Œæ‰€ä»¥æµè§ˆå™¨åœ°å€æ ä¸­çš„åœ°å€ä¼šå˜æˆæ–°è¯·æ±‚çš„åœ°å€</p>
</li>
<li><p>åœ¨è®¾ç½®é‡å®šå‘çš„èµ„æºåœ°å€çš„æ—¶å€™ï¼Œè·¯å¾„çš„å‰é¢ä¸€èˆ¬ä¸åŠ /</p>
<p>ä¾‹å¦‚ï¼Œ<code>String path = &quot;hello.html&quot;;</code></p>
<p>ä½†æ˜¯å¦‚æœä¸€å®šè¦åŠ /çš„è¯,é‚£ä¹ˆè¿˜éœ€è¦é¢å¤–åŠ ä¸Šä¸€ä¸ªé¡¹ç›®å</p>
<p>ä¾‹å¦‚ï¼Œ<code>String path = &quot;/servlet/hello.html&quot;;</code></p>
<p>åŒæ—¶ä¹Ÿå¯ä»¥åŠ¨æ€è·å–é¡¹ç›®ï¼š<code>req.getContextPath()</code></p>
<p>ä¾‹å¦‚ï¼Œ<code>String path = req.getContextPath()+&quot;/hello.html&quot;;</code></p>
</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼Œå…³äºè·¯å¾„é—®é¢˜ï¼Œåé¢ä¼šæœ‰ä¸“é—¨çš„éƒ¨åˆ†å»è®²è§£</p>
</blockquote>
<h1 id="mybatis"><a href="#mybatis" class="headerlink" title="mybatis"></a>mybatis</h1><h2 id="èµ·æº"><a href="#èµ·æº" class="headerlink" title="èµ·æº"></a>èµ·æº</h2><p><code>MyBatis</code> æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚å¼€æºæ¡†æ¶ï¼Œå®ƒæ”¯æŒè‡ªå®šä¹‰ SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚<code>MyBatis</code>å…é™¤äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç ä»¥åŠè®¾ç½®å‚æ•°å’Œè·å–ç»“æœé›†çš„å·¥ä½œã€‚<code>MyBatis</code>å¯ä»¥é€šè¿‡ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸå§‹ç±»å‹ã€æ¥å£å’Œ Java POJOï¼ˆPlain Old java Objectsï¼Œæ™®é€šè€å¼ Java å¯¹è±¡ï¼‰ä¸ºæ•°æ®åº“ä¸­çš„è®°å½•ã€‚</p>
<p>MyBatisçš„å‰èº«æ˜¯iBATISï¼ŒiBATISäº2002å¹´ç”±ClintonBeginåˆ›å»ºã€‚MyBatis3æ˜¯iBATISçš„å…¨æ–°è®¾è®¡ï¼Œæ”¯æŒæ³¨è§£å’ŒMapperã€‚</p>
<p>MyBatisæµè¡Œçš„ä¸»è¦åŸå› åœ¨äºå®ƒçš„ç®€å•æ€§å’Œæ˜“ä½¿ç”¨æ€§ã€‚åœ¨Javaåº”ç”¨ç¨‹åºä¸­ï¼Œæ•°æ®æŒä¹…åŒ–å±‚æ¶‰åŠåˆ°çš„å·¥ä½œæœ‰ï¼š</p>
<ul>
<li>å°†ä»æ•°æ®åº“æŸ¥è¯¢åˆ°çš„æ•°æ®ç”Ÿæˆæ‰€éœ€è¦çš„Javaå¯¹è±¡</li>
<li>å°†Javaå¯¹è±¡ä¸­çš„æ•°æ®é€šSQLæŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­</li>
</ul>
<p>MyBatisé€šè¿‡æŠ½è±¡åº•å±‚çš„JDBCä»£ç ï¼Œè‡ªåŠ¨åŒ–å°è£…SQLç»“æœé›†äº§ç”ŸJavaå¯¹è±¡ã€Javaå¯¹è±¡çš„æ•°æ®æŒä¹…åŒ–æ•°æ®åº“ä¸­çš„è¿‡ç¨‹ä½¿å¾—å¯¹SQLçš„ä½¿ç”¨å˜å¾—å®¹æ˜“ã€‚</p>
<h2 id="è·å–"><a href="#è·å–" class="headerlink" title="è·å–"></a>è·å–</h2><p>iBATISä¸€è¯æ¥æºäºinternetå’Œabatisçš„ç»„åˆï¼Œæ˜¯ä¸€ä¸ªåœ¨2002å¹´å‘èµ·çš„å¼€æ”¾æºä»£ç é¡¹ç›®ã€‚äº2010å¹´6æœˆ16å·è¢«è°·æ­Œæ‰˜ç®¡ï¼Œæ”¹åä¸ºMyBatisã€‚</p>
<p>ibatisçš„å®˜ç½‘ <a href="http://ibatis.apache.org/">http://ibatis.apache.org/</a> è¿›å»å®˜ç½‘ä¼šçœ‹åˆ°ä¸‹é¢æç¤º:</p>
<p>apache ibatis is retired at the apache software foundation (2010/06/16) the original project team has moved to mybatis hosted at google code. see <a href="http://www.mybatis.org/">http://www.mybatis.org/</a> for more.ç„¶è€Œ<a href="http://www.mybatis.org/%E8%BF%99%E4%B8%AA%E5%9C%B0%E5%9D%80%E4%B8%80%E7%9B%B4%E5%A4%84%E4%BA%8E%E6%89%93%E4%B8%8D%E5%BC%80%E7%8A%B6%E6%80%81">http://www.mybatis.org/è¿™ä¸ªåœ°å€ä¸€ç›´å¤„äºæ‰“ä¸å¼€çŠ¶æ€</a>â€¦</p>
<p>ä½†æ˜¯æˆ‘ä»¬æœ€ç»ˆæ˜¯å¯ä»¥åœ¨githubä¸­æ‰¾åˆ°mybatisçš„ç›¸å…³ä¸‹è½½çš„:</p>
<p>mybatisåœ¨githubä¸­çš„åœ°å€</p>
<p><a href="https://github.com/mybatis/mybatis-3">https://github.com/mybatis/mybatis-3</a></p>
<p>æœ€æ–°ç‰ˆæœ¬çš„mybatisçš„ä¸‹è½½åœ°å€</p>
<p><a href="https://github.com/mybatis/mybatis-3/releases">https://github.com/mybatis/mybatis-3/releases</a></p>
<p>docæ–‡æ¡£</p>
<p><a href="http://www.mybatis.org/mybatis-3/">http://www.mybatis.org/mybatis-3/</a></p>
<h2 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><p>é€šè¿‡ä¸Šé¢æˆ‘ä»¬äº†è§£åˆ°Mybatisçš„ä¸»è¦åŠŸèƒ½æ˜¯<strong>æ•°æ®æŒä¹…åŒ–</strong>ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯èƒ½ä¼šå›æƒ³èµ·ä¹‹å‰çš„<strong>JDBC</strong>è¯¾ç¨‹ï¼Œæ—¢ç„¶æˆ‘ä»¬å·²ç»æŒæ¡äº†JDBCä¸ºä»€ä¹ˆè¿˜è¦å†å»å­¦ä¹ Mybatiså‘¢ï¼Ÿ</p>
<p>ä¸»è¦åŸå› æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ol>
<li>Mybatisæ¶ˆé™¤äº†å¤§é‡çš„JDBCå†—ä½™ä»£ç </li>
<li>Mybatisæœ‰ä½çš„å­¦ä¹ æ›²çº¿</li>
<li>Mybatisèƒ½å¾ˆå¥½åœ°ä¸ä¼ ç»Ÿæ•°æ®åº“ååŒå·¥ä½œ</li>
<li>Mybatiså¯ä»¥æ¥å—SQLè¯­å¥</li>
<li>Mybatisæä¾›äº†ä¸Springæ¡†æ¶çš„é›†æˆæ”¯æŒ</li>
<li>Mybatisæä¾›äº†ä¸ç¬¬ä¸‰æ–¹ç¼“å­˜ç±»åº“çš„é›†æˆæ”¯æŒ</li>
<li>Mybatiså¼•å…¥äº†æ›´å¥½çš„æ€§èƒ½</li>
</ol>
<p>1ï¼‰å®ƒæ¶ˆé™¤äº†å¤§é‡çš„JDBCå†—ä½™ä»£ç </p>
<p>Javaé€šè¿‡JDBCçš„APIæ¥æ“ä½œå…³ç³»å‹æ•°æ®åº“ï¼Œä½†æ˜¯JDBCæ˜¯ä¸€ä¸ªéå¸¸åº•å±‚çš„APIï¼Œæˆ‘ä»¬éœ€è¦ä¹¦å†™å¤§é‡çš„ä»£ç æ¥å®Œæˆå¯¹æ•°æ®åº“çš„æ“ä½œã€‚ä¾‹å¦‚ä¸€ä¸ªæ’å…¥æ“ä½œ(å‚è€ƒä¹‹å‰å­¦ä¹ JDBCæ—¶å€™çš„ä»£ç å®ä¾‹)ï¼Œä½†æ˜¯ä½¿ç”¨mybatisæ¥å®Œæˆç›¸åŒçš„æ’å…¥æ“ä½œè¦ç®€å•æ–¹ä¾¿çµæ´»çš„å¤šã€‚</p>
<p>ç‰¹åˆ«ä¹‹å¤„çš„æ˜¯ï¼ŒMyBatisè¿˜æä¾›äº†å…¶ä»–çš„ä¸€äº›ç‰¹æ€§æ¥ç®€åŒ–æŒä¹…åŒ–é€»è¾‘çš„å®ç°ï¼Œå®ƒæ”¯æŒå¤æ‚çš„SQLç»“æœé›†æ•°æ®æ˜ å°„åˆ°åµŒå¥—çš„å¯¹è±¡ç»“æ„ï¼Œå®ƒæ”¯æŒä¸€å¯¹ä¸€å’Œä¸€å¯¹å¤šçš„ç»“æœé›†å’ŒJavaå¯¹è±¡çš„æ˜ å°„ï¼Œå®ƒæ”¯æŒæ ¹æ®è¾“å…¥çš„æ•°æ®æ„å»ºåŠ¨æ€çš„SQLè¯­å¥</p>
<p>2ï¼‰å®ƒæœ‰ä½çš„å­¦ä¹ æ›²çº¿</p>
<p>MyBatisèƒ½å¤Ÿæµè¡Œçš„é¦–è¦åŸå› ä¹‹ä¸€åœ¨äºå®ƒå­¦ä¹ å’Œä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œå®ƒå–å†³äºä½ Javaå’Œ SQLæ–¹é¢çš„çŸ¥è¯†ã€‚å¦‚æœå¼€å‘äººå‘˜å¾ˆç†Ÿæ‚‰Javaå’ŒSQLï¼Œä»–ä»¬ä¼šå‘ç°MyBatiså…¥é—¨éå¸¸ç®€å•ã€‚</p>
<p>3ï¼‰å®ƒèƒ½å¾ˆå¥½åœ°ä¸ä¼ ç»Ÿæ•°æ®åº“ååŒå·¥ä½œ</p>
<p>æœ‰æ—¶æˆ‘ä»¬å¯èƒ½éœ€è¦ç”¨ä¸æ­£è§„å½¢å¼ä¸ä¼ ç»Ÿæ•°æ®åº“ååŒå·¥ä½œï¼Œä½¿ç”¨æˆç†Ÿçš„ORMæ¡†æ¶(ä¾‹å¦‚å¤§å®¶ç†ŸçŸ¥çš„Hibernate)æœ‰å¯èƒ½ã€ä½†æ˜¯å¾ˆéš¾è·Ÿä¼ ç»Ÿæ•°æ®åº“å¾ˆå¥½åœ°ååŒå·¥ä½œï¼Œå› ä¸ºä»–ä»¬å°è¯•å°†Javaå¯¹è±¡é™æ€åœ°æ˜ å°„åˆ°æ•°æ®åº“çš„è¡¨ä¸Š.è€ŒMyBatisæ˜¯å°†æŸ¥è¯¢çš„ç»“æœä¸Javaå¯¹è±¡æ˜ å°„èµ·æ¥ï¼Œè¿™ä½¿å¾—MyBatiså¯ä»¥å¾ˆå¥½åœ°ä¸ä¼ ç»Ÿæ•°æ®åº“ååŒå·¥ä½œã€‚ä½ å¯ä»¥æ ¹æ®é¢ç›¸å¯¹è±¡çš„æ¨¡å‹åˆ›å»ºJavaåŸŸå¯¹è±¡ï¼Œæ‰§è¡Œä¼ ç»Ÿæ•°æ®åº“çš„æŸ¥è¯¢ï¼Œç„¶åå°†ç»“æœæ˜ å°„åˆ°å¯¹åº”çš„Javaå¯¹è±¡ä¸Šã€‚</p>
<p>4ï¼‰å®ƒå¯ä»¥æ¥å—SQLè¯­å¥</p>
<p>æˆç†Ÿçš„ORMæ¡†æ¶é¼“åŠ±ä½¿ç”¨å®ä½“å¯¹è±¡å’Œåœ¨å…¶åº•å±‚è‡ªåŠ¨äº§ç”ŸSQLè¯­å¥ã€‚ç”±äºè¿™ç§çš„SQLç”Ÿæˆæ–¹å¼ï¼Œæˆ‘ä»¬æœ‰å¯èƒ½ä¸èƒ½å¤Ÿåˆ©ç”¨åˆ°æ•°æ®åº“çš„ä¸€äº›ç‰¹æœ‰çš„ç‰¹æ€§ã€‚Hibernateå…è®¸æ‰§è¡Œæœ¬åœ°SQLï¼Œä½†æ˜¯è¿™æ ·ä¼šæ‰“ç ´æŒä¹…å±‚å’Œæ•°æ®åº“ç‹¬ç«‹çš„åŸåˆ™ã€‚MyBatisæ¡†æ¶æ¥å—SQLè¯­å¥ï¼Œè€Œä¸æ˜¯å°†å…¶å¯¹å¼€å‘äººå‘˜éšè—èµ·æ¥ã€‚ç”±äºMyBatisä¸ä¼šäº§ç”Ÿä»»ä½•çš„SQLè¯­å¥ï¼Œæ‰€ä»¥å¼€å‘äººå‘˜å°±è¦å‡†å¤‡SQLè¯­å¥ï¼Œè¿™æ ·å°±å¯ä»¥å……åˆ†åˆ©ç”¨æ•°æ®åº“ç‰¹æœ‰çš„ç‰¹æ€§å¹¶ä¸”å¯ä»¥å‡†å¤‡è‡ªå®šä¹‰çš„æŸ¥è¯¢ã€‚å¦å¤–ï¼ŒMyBatis å¯¹å­˜å‚¨è¿‡ç¨‹ä¹Ÿæä¾›äº†æ”¯æŒã€‚</p>
<p>5ï¼‰å®ƒæä¾›äº†ä¸Springæ¡†æ¶çš„é›†æˆæ”¯æŒ</p>
<p>MyBatisæä¾›äº†ä¸æµè¡Œçš„ä¾èµ–æ³¨å…¥æ¡†æ¶Springçš„å¼€åŒ…å³ç”¨çš„é›†æˆæ”¯æŒï¼Œè¿™å°†è¿›ä¸€æ­¥ç®€åŒ–MyBatisçš„ä½¿ç”¨ã€‚</p>
<p>6ï¼‰å®ƒæä¾›äº†ä¸ç¬¬ä¸‰æ–¹ç¼“å­˜ç±»åº“çš„é›†æˆæ”¯æŒ</p>
<p>MyBatisæœ‰å†…å»ºçš„SqlSessionçº§åˆ«çš„ç¼“å­˜æœºåˆ¶ï¼Œç”¨äºç¼“å­˜Selectè¯­å¥æŸ¥è¯¢å‡ºæ¥çš„ç»“æœã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒMyBatisæä¾›äº†ä¸å¤šç§ç¬¬ä¸‰æ–¹ç¼“å­˜ç±»åº“çš„é›†æˆæ”¯æŒï¼Œå¦‚EHCacheï¼ŒOSCacheï¼ŒHazelcastç­‰ã€‚</p>
<p>7ï¼‰å®ƒå¼•å…¥äº†æ›´å¥½çš„æ€§èƒ½</p>
<p>æ€§èƒ½é—®é¢˜æ˜¯å…³ä¹è½¯ä»¶åº”ç”¨æˆåŠŸä¸å¦çš„å…³é”®å› ç´ ä¹‹ä¸€ã€‚ä¸ºäº†è¾¾åˆ°æ›´å¥½çš„æ€§èƒ½ï¼Œéœ€è¦è€ƒè™‘å¾ˆå¤šäº‹æƒ…ï¼Œè€Œå¯¹å¾ˆå¤šåº”ç”¨è€Œè¨€ï¼Œæ•°æ®æŒä¹…åŒ–å±‚æ˜¯æ•´ä¸ªç³»ç»Ÿæ€§èƒ½çš„å…³é”®ã€‚MyBatisæ”¯æŒæ•°æ®åº“è¿æ¥æ± ï¼Œæ¶ˆé™¤äº†ä¸ºæ¯ä¸€ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥çš„å¼€é”€,MyBatisæä¾›äº†å†…å»ºçš„ç¼“å­˜æœºåˆ¶ï¼Œåœ¨SqlSessionçº§åˆ«æä¾›äº†å¯¹SQLæŸ¥è¯¢ç»“æœçš„ç¼“å­˜ã€‚å³:å¦‚æœä½ è°ƒç”¨äº†ç›¸åŒçš„selectæŸ¥è¯¢ï¼ŒMyBatis ä¼šå°†æ”¾åœ¨ç¼“å­˜çš„ç»“æœè¿”å›ï¼Œè€Œä¸ä¼šå»å†æŸ¥è¯¢æ•°æ®åº“ã€‚MyBatisæ¡†æ¶å¹¶æ²¡æœ‰å¤§é‡åœ°ä½¿ç”¨ä»£ç†æœºåˆ¶ï¼Œå› æ­¤å¯¹äºå…¶ä»–çš„è¿‡åº¦åœ°ä½¿ç”¨ä»£ç†çš„ORMæ¡†æ¶è€Œè¨€ï¼ŒMyBatiså¯ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½</p>
<h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><h3 id="jaråŒ…å¯¼å…¥"><a href="#jaråŒ…å¯¼å…¥" class="headerlink" title="jaråŒ…å¯¼å…¥"></a>jaråŒ…å¯¼å…¥</h3><p>mybatisçš„æ ¸å¿ƒåŒ…åªæœ‰ä¸€ä¸ªmybatis-3.x.x.jar,å¦å¤–è¿˜æœ‰ä¸€äº›ã€å¯é€‰ã€‘çš„ä¾èµ–åŒ…(æ—¥å¿—ã€ä»£ç†ç­‰æ‰€éœ€è¦çš„),åœ¨ä¸‹è½½çš„å‹ç¼©åŒ…ä¸­å¯ä»¥æ‰¾åˆ°.ä¹Ÿå¯ä»¥è‡ªè¡Œå»ä¸‹è½½ã€‚</p>
<p>å¦‚æœæ˜¯mavené¡¹ç›®ï¼Œåªæœ‰å¼•å…¥ä¾èµ–åæ ‡å³å¯ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--mybatis--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--mysql--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>å®ä½“</strong></p>
<p>ä¹‹å‰å¯¹åº”çš„demo_user</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://mybatis.org/mybatis-3/zh/getting-started.html">å¿«é€Ÿæ„å»ºmybatis</a></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.demo.mybatis.invoke;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.demo.mybatis.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.datasource.pooled.PooledDataSource;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.Environment;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.transaction.TransactionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.transaction.jdbc.JdbcTransactionFactory;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaInvoke</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        PooledDataSource dataSource = <span class="keyword">new</span> PooledDataSource();</span><br><span class="line">        dataSource.setDriver(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql:///st&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        TransactionFactory transactionFactory = <span class="keyword">new</span> JdbcTransactionFactory();</span><br><span class="line">        Environment environment = <span class="keyword">new</span> Environment(<span class="string">&quot;development&quot;</span>, transactionFactory, dataSource);</span><br><span class="line">        Configuration configuration = <span class="keyword">new</span> Configuration(environment);</span><br><span class="line">        configuration.addMapper(UserMapper.class);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(configuration);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">        UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">        System.out.println(userMapper.findAll()); </span><br><span class="line">        <span class="comment">// [User(id=4, username=tom, password=000, gender=0), User(id=5, username=lucy, password=000, gender=1)]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Select(&quot;select * from demo_user&quot;)</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>











<h3 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><p>mybatisçš„é…ç½®æ–‡ä»¶ä¸€èˆ¬æ¥è¯´åå­—æ˜¯å›ºå®šçš„ï¼Œå°±å«<code>mybatis-config.xml</code>,å…¶ä¸­åŒ…æ‹¬æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼Œç±»å‹åˆ«å,æ˜ å°„æ–‡ä»¶è·¯å¾„ç­‰ç­‰ï¼›ç›´æ¥åˆ›å»ºåœ¨srcç›®å½•ä¸‹ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql:///st&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mappers/UserMapper.xml&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="æ˜ å°„æ–‡ä»¶"><a href="#æ˜ å°„æ–‡ä»¶" class="headerlink" title="æ˜ å°„æ–‡ä»¶"></a>æ˜ å°„æ–‡ä»¶</h3><p>æ˜ å°„æ–‡ä»¶å‘½åä¸€èˆ¬éƒ½æ˜¯<code>XxxxMapper.xml</code>ï¼Œ<code>Xxxx</code>æ˜¯å¯¹åº”çš„ç±»çš„åå­—ï¼Œè¿™ä¸ªxmlæ–‡ä»¶ä¸­åŒ…æ‹¬<code>Xxxx</code>ç±»æ‰€å¯¹åº”çš„æ•°æ®åº“è¡¨çš„å„ç§å¢åˆ æ”¹æŸ¥sqlè¯­å¥ã€‚</p>
<p>ä¾‹å¦‚:<code>StudentMapper.xml</code>æ–‡ä»¶ä¸­æ˜¯<code>Student</code>ç±»å¯¹åº”çš„è¡¨çš„å„ç§<code>select</code> <code>insert</code> <code>update</code> <code>delete</code>ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.demo.mybatis.mapper.UserMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.briup.demo.mybatis.entity.User&quot;</span>&gt;</span></span><br><span class="line">        select * from demo_user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="æ˜ å°„æ¥å£"><a href="#æ˜ å°„æ¥å£" class="headerlink" title="æ˜ å°„æ¥å£"></a>æ˜ å°„æ¥å£</h3><p>mybatisä¸­çš„æ˜ å°„æ¥å£<code>XxxxMapper.java</code>(å¯¹<code>XxxxMapper.xml</code>ä¸­çš„sqlè¯­å¥è¿›è¡Œæ˜ å°„)<br>mybatisä¸­é™¤äº†å¿…é¡»çš„jaråŒ…ã€å„ç§xmlé…ç½®æ–‡ä»¶ä¹‹å¤–,ä¸€èˆ¬è¿˜éœ€è¦æœ‰è°ƒç”¨sqlè¯­å¥æ‰§è¡Œçš„æ¥å£XxxxMapper.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">//@Select(&quot;select * from demo_user&quot;)</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™ä¸ªåå­—ä¾ç„¶å¯ä»¥å«StudentDao</p>
</blockquote>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li><p>æ¥å£ä¸­çš„æ–¹æ³•çš„åå­—å’ŒXMLæ–‡ä»¶å®šä¹‰çš„SQLæ˜ å°„è¯­å¥çš„<code>id</code>å€¼è¦ç›¸åŒ</p>
</li>
<li><p>æˆ‘ä»¬ä¸éœ€è¦å»å®ç°è¯¥æ¥å£,å› ä¸ºmybatisä¸­æä¾›äº†ç›¸åº”çš„æ–¹å¼åœ¨è¿è¡ŒæœŸé—´åŠ¨æ€ç”Ÿæˆè¯¥æ¥å£çš„å®ç°ç±»å¯¹è±¡.</p>
</li>
</ol>
<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.demo.mybatis.invoke;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.demo.mybatis.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XmlInvoke</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InputStream in = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">            SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">            SqlSession session = factory.openSession();</span><br><span class="line">            UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">            System.out.println(userMapper.findAll());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="å›¾è§£"><a href="#å›¾è§£" class="headerlink" title="å›¾è§£"></a>å›¾è§£</h3><p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201019112222960.png" alt="image-20201019112222960"></p>
<blockquote>
<p>æ³¨æ„ï¼Œè¯¥å›¾æè¿°äº†ä¸Šè¿°ä¾‹å­ä¸­çš„ä¿©ä¸ªè¿‡ç¨‹ï¼Œmybatiså·¦è¾¹æ˜¯é…ç½®çš„è¿‡ç¨‹ï¼Œmybatiså³è¾¹æ˜¯å†™ä»£ç çš„è¿‡ç¨‹</p>
</blockquote>
<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>UserMapper</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">//@Select(&quot;select * from demo_user&quot;)</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.briup.demo.mybatis.mapper.UserMapper&quot;</span>&gt;</span><br><span class="line">    &lt;select id=<span class="string">&quot;findAll&quot;</span> resultType=<span class="string">&quot;com.briup.demo.mybatis.entity.User&quot;</span>&gt;</span><br><span class="line">        select * from demo_user</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">    &lt;insert id=<span class="string">&quot;insert&quot;</span>&gt;</span><br><span class="line">        <span class="function">insert into <span class="title">demo_user</span><span class="params">(id,username,password,gender)</span></span></span><br><span class="line"><span class="function">        <span class="title">values</span><span class="params">(NULL ,#&#123;username&#125;,#&#123;password&#125;,#&#123;gender&#125;)</span></span></span><br><span class="line"><span class="function">    &lt;/insert&gt;</span></span><br><span class="line"><span class="function">    &lt;update id</span>=<span class="string">&quot;update&quot;</span>&gt;</span><br><span class="line">        update demo_user</span><br><span class="line">        set username=#&#123;username&#125;,password=#&#123;password&#125;,gender=#&#123;gender&#125;</span><br><span class="line">        where id = #&#123;id&#125;</span><br><span class="line">    &lt;/update&gt;</span><br><span class="line">    &lt;delete id=<span class="string">&quot;delete&quot;</span>&gt;</span><br><span class="line">        delete from demo_user where id = #&#123;id&#125;</span><br><span class="line">    &lt;/delete&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>

<p>utils</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SqlSessionUtil</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSqlSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InputStream in = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">            SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">            SqlSession session = factory.openSession();</span><br><span class="line">            <span class="keyword">return</span> session;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>test</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XmlInvoke</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InputStream in = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">            SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">            SqlSession session = factory.openSession();</span><br><span class="line">            UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">            System.out.println(userMapper.findAll());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        SqlSession sqlSession = SqlSessionUtil.getSqlSession();</span><br><span class="line">        UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setGender(<span class="number">0</span>);</span><br><span class="line">        user.setUsername(<span class="string">&quot;è€ç‹&quot;</span>);</span><br><span class="line">        user.setPassword(<span class="string">&quot;000&quot;</span>);</span><br><span class="line">        mapper.insert(user);</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> (SqlSession sqlSession = SqlSessionUtil.getSqlSession();) &#123;</span><br><span class="line">            UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">            User user = <span class="keyword">new</span> User();</span><br><span class="line">            user.setId(<span class="number">6</span>);</span><br><span class="line">            user.setGender(<span class="number">0</span>);</span><br><span class="line">            user.setUsername(<span class="string">&quot;è€ç‹&quot;</span>);</span><br><span class="line">            user.setPassword(<span class="string">&quot;111111111&quot;</span>);</span><br><span class="line">            mapper.update(user);</span><br><span class="line">            sqlSession.commit();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> (SqlSession sqlSession = SqlSessionUtil.getSqlSession();) &#123;</span><br><span class="line">            UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">            mapper.delete(<span class="number">6</span>);</span><br><span class="line">            sqlSession.commit();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h1 id="ä¸‰å±‚æ¶æ„"><a href="#ä¸‰å±‚æ¶æ„" class="headerlink" title="ä¸‰å±‚æ¶æ„"></a>ä¸‰å±‚æ¶æ„</h1><p>åœ¨webé¡¹ç›®çš„ä»£ç ç»“æ„ä¸­ï¼Œç»å¸¸ä¼šä½¿ç”¨åˆ°ä¸‰å±‚æ¶æ„ï¼š</p>
<ul>
<li>webå±‚  servlet/filter/listener</li>
<li>serviceå±‚ </li>
<li>daoå±‚</li>
</ul>
<p>webå±‚ä¸­ä»£ç çš„ä¸»è¦ä»»åŠ¡ï¼š</p>
<ul>
<li>æ¥æ”¶å®¢æˆ·ç«¯ä¼ æ¥çš„å‚æ•°</li>
<li>æŠŠå‚æ•°å°è£…æˆå¯¹è±¡   saveUser(user)</li>
<li>æŠŠå°è£…å¥½çš„å¯¹è±¡/æ•°æ®ä¼ ç»™service</li>
<li>æ ¹æ®serviceå±‚çš„å¤„ç†ç»“æœå†³å®šæŠŠé‚£ä¸ªé¡µé¢/æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯</li>
</ul>
<p>serviceå±‚ä¸­ä»£ç çš„ä¸»è¦ä»»åŠ¡ï¼š</p>
<ul>
<li>æ¥æ”¶webå±‚ä¼ è¿‡æ¥çš„å¯¹è±¡/æ•°æ®(å¦‚æœæœ‰çš„è¯)</li>
<li>æ ¹æ®è¿™äº›ä¿¡æ¯è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†</li>
</ul>
<p>ä¾‹å¦‚ï¼Œå®Œæˆä¸€ä¸ªç™»å½•åŠŸèƒ½ï¼Œwebå±‚æ¥æ”¶åˆ°ç”¨æˆ·åå’Œå¯†ç ä¹‹åï¼ŒæŠŠæ•°æ®ä¼ ç»™serviceå±‚ï¼Œserviceå±‚å°±è¦æ ¹æ®è¿™äº›ä¿¡æ¯æ¥åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ã€å¯†ç æ˜¯å¦æ­£ç¡®ã€ç”¨æˆ·æ˜¯å¦æœ‰æƒé™ã€ç”¨æˆ·çŠ¶æ€å½“å‰æ˜¯å¦å¯ç”¨ã€ç”¨æˆ·æ˜¯å¦æ¨é€ä¿¡æ¯ã€æ˜¯å¦ç»™ç”¨æˆ·ç›¸å…³æç¤ºç­‰ï¼Œè¿™äº›éƒ½å±äºç™»å½•çš„ä¸šåŠ¡é€»è¾‘å¤„ç†</p>
<p>daoå±‚ä¸­ä»£ç çš„ä¸»è¦ä»»åŠ¡ï¼š</p>
<ul>
<li>æ¥å—serviceä¼ çš„å‚æ•°(å¦‚æœæœ‰çš„è¯)</li>
<li>å’Œæ•°æ®åº“è¿›è¡Œäº¤äº’</li>
<li>æŠŠäº¤äº’ç»“æœè¿”å›ç»™serviceå±‚</li>
</ul>
<p><strong>æ€è€ƒï¼Œé¡¹ç›®çš„ä»£ç ä¸ºä½•è¦åˆ†å±‚ç¼–å†™ï¼Œå…¨éƒ¨ä»£ç å†™åˆ°ä¸€ä¸ªç±»ä¸­è¿›è¡Œå®ç°ï¼Œæ˜¯å¦å¯ä»¥ï¼Ÿ</strong></p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/login&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        req.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        String username = req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String password = req.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        UserService userService = <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line">        User user = userService.login(username, password);</span><br><span class="line">        req.getSession().setAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">        resp.sendRedirect(<span class="string">&quot;index.jsp&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="service"><a href="#service" class="headerlink" title="service"></a>service</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmptyOrWhitespaceOnly(username))&#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        SqlSession sqlSession = SqlSessionUtil.getSqlSession();</span><br><span class="line">        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        User user = userMapper.login(username, password);</span><br><span class="line">        <span class="keyword">if</span>(user == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;ç”¨æˆ·åæˆ–è€…å¯†ç æœ‰è¯¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="dao"><a href="#dao" class="headerlink" title="dao"></a>dao</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">User <span class="title">login</span><span class="params">(<span class="meta">@Param(&quot;username&quot;)</span> String username, <span class="meta">@Param(&quot;password&quot;)</span> String password)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;select id=<span class="string">&quot;login&quot;</span> resultType=<span class="string">&quot;com.briup.login.entity.User&quot;</span>&gt;</span><br><span class="line">       select * from demo_user</span><br><span class="line">       where username=#&#123;username&#125; and password = #&#123;password&#125;</span><br><span class="line">   &lt;/select&gt;</span><br></pre></td></tr></table></figure>







<h1 id="json"><a href="#json" class="headerlink" title="json"></a><a href="https://www.runoob.com/json/json-tutorial.html">json</a></h1><h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><ul>
<li>JSON æŒ‡çš„æ˜¯ JavaScript å¯¹è±¡è¡¨ç¤ºæ³•ï¼ˆ<strong>J</strong>ava<strong>S</strong>cript <strong>O</strong>bject <strong>N</strong>otationï¼‰</li>
<li>JSON æ˜¯è½»é‡çº§çš„æ–‡æœ¬æ•°æ®äº¤æ¢æ ¼å¼</li>
<li>JSON ç‹¬ç«‹äºè¯­è¨€ï¼šJSON ä½¿ç”¨ Javascriptè¯­æ³•æ¥æè¿°æ•°æ®å¯¹è±¡ï¼Œä½†æ˜¯ JSON ä»ç„¶ç‹¬ç«‹äºè¯­è¨€å’Œå¹³å°ã€‚JSON è§£æå™¨å’Œ JSON åº“æ”¯æŒè®¸å¤šä¸åŒçš„ç¼–ç¨‹è¯­è¨€ã€‚ ç›®å‰éå¸¸å¤šçš„åŠ¨æ€ï¼ˆPHPï¼ŒJSPï¼Œ.NETï¼‰ç¼–ç¨‹è¯­è¨€éƒ½æ”¯æŒJSONã€‚</li>
<li>JSON å…·æœ‰è‡ªæˆ‘æè¿°æ€§ï¼Œæ›´æ˜“ç†è§£</li>
</ul>
<p>å®ä¾‹</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;sites&quot;</span>: [</span><br><span class="line">        &#123; <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;èœé¸Ÿæ•™ç¨‹&quot;</span> , <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;www.runoob.com&quot;</span> &#125;, </span><br><span class="line">        &#123; <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;google&quot;</span> , <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;www.google.com&quot;</span> &#125;, </span><br><span class="line">        &#123; <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å¾®åš&quot;</span> , <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;www.weibo.com&quot;</span> &#125;</span><br><span class="line">     ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ä¸ºä»€ä¹ˆä½¿ç”¨-JSONï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨-JSONï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨ JSONï¼Ÿ"></a>ä¸ºä»€ä¹ˆä½¿ç”¨ JSONï¼Ÿ</h2><p>å¯¹äº AJAX åº”ç”¨ç¨‹åºæ¥è¯´ï¼ŒJSON æ¯” XML æ›´å¿«æ›´æ˜“ä½¿ç”¨ï¼š</p>
<p>ä½¿ç”¨ XML</p>
<ul>
<li>è¯»å– XML æ–‡æ¡£</li>
<li>ä½¿ç”¨ XML DOM æ¥å¾ªç¯éå†æ–‡æ¡£</li>
<li>è¯»å–å€¼å¹¶å­˜å‚¨åœ¨å˜é‡ä¸­</li>
</ul>
<p>ä½¿ç”¨ JSON</p>
<ul>
<li>è¯»å– JSON å­—ç¬¦ä¸²</li>
<li>ç”¨ eval() å¤„ç† JSON å­—ç¬¦ä¸²</li>
</ul>
<h2 id="è½¬æ¢"><a href="#è½¬æ¢" class="headerlink" title="è½¬æ¢"></a>è½¬æ¢</h2><h3 id="2-1-JavaScript"><a href="#2-1-JavaScript" class="headerlink" title="2.1 JavaScript"></a>2.1 JavaScript</h3><blockquote>
<p>åœ¨JavaScriptä¸­ï¼Œå°†JSONå¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œå°†å­—ç¬¦ä¸²è½¬ä¸ºJSONå¯¹è±¡</p>
</blockquote>
<p>ä¾‹å¦‚ï¼ŒJSONå¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> jsonObj = &#123;<span class="attr">name</span>:<span class="string">&quot;tom&quot;</span>,<span class="attr">age</span>:<span class="number">20</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> jsonStr = <span class="built_in">JSON</span>.stringify(jsonObj);</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²è½¬ä¸ºJSONå¯¹è±¡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> jsonStr = <span class="string">&quot;&#123;\&quot;name\&quot;:\&quot;tom\&quot;,\&quot;age\&quot;:20&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> jsonObj = <span class="built_in">JSON</span>.parse(jsonStr);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼ŒJSONæ ¼å¼çš„å­—ç¬¦ä¸²ä¸­ï¼Œkeyå’Œvalueéƒ½éœ€è¦åŒå¼•å·ï¼ˆä¸€å®šä¸èƒ½ä½¿ç”¨å•å¼•å·ï¼‰ï¼Œå¦‚æœvalueæ˜¯æ•°ç»„å¯ä»¥ä¸ç”¨åŒå¼•å·</p>
</blockquote>
<p>ä¾‹å¦‚ï¼ŒJSONæ•°ç»„å¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> jsonArr = [];</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;<span class="attr">name</span>:<span class="string">&quot;tom1&quot;</span>,<span class="attr">age</span>:<span class="number">21</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;<span class="attr">name</span>:<span class="string">&quot;tom2&quot;</span>,<span class="attr">age</span>:<span class="number">22</span>&#125;;</span><br><span class="line">jsonArr.push(obj1);</span><br><span class="line">jsonArr.push(obj2);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(jsonArr));</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºçš„å†…å®¹ä¸ºï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[&#123;<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom1&quot;</span>,<span class="attr">&quot;age&quot;</span>:<span class="number">21</span>&#125;,&#123;<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom2&quot;</span>,<span class="attr">&quot;age&quot;</span>:<span class="number">22</span>&#125;]</span><br></pre></td></tr></table></figure>

<p>æ ¼å¼åŒ–åï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom1&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;age&quot;</span>:<span class="number">21</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom2&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;age&quot;</span>:<span class="number">22</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²è½¬æ¢JSONæ•°ç»„å¯¹è±¡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> jsonArrStr = <span class="string">&quot;[&#123;\&quot;name\&quot;:\&quot;tom1\&quot;,\&quot;age\&quot;:21&#125;,&#123;\&quot;name\&quot;:\&quot;tom2\&quot;,\&quot;age\&quot;:22&#125;]&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> jsonArr = <span class="built_in">JSON</span>.parse(jsonArrStr);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(jsonArr);</span><br></pre></td></tr></table></figure>



<p>è¾“å‡ºçš„ç»“æœä¸ºï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201029163538863.png" alt="image-20201029163538863"></p>
<blockquote>
<p>æ³¨æ„1ï¼Œå°†å¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²çš„ç›®çš„æ˜¯ä¸ºäº†ï¼Œåœ¨è¯·æ±‚æˆ–å“åº”ä¸­æ–¹ä¾¿æºå¸¦æ•°æ®</p>
</blockquote>
<blockquote>
<p>æ³¨æ„2ï¼Œå°†å­—ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡çš„ç›®çš„æ˜¯ä¸ºäº†ï¼Œåœ¨JavaScriptæˆ–javaä¸­æ–¹ä¾¿è§£æ</p>
</blockquote>
<h3 id="2-2-java"><a href="#2-2-java" class="headerlink" title="2.2 java"></a>2.2 java</h3><blockquote>
<p>åœ¨Javaä¸­ï¼Œå°†JSONå¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œå°†å­—ç¬¦ä¸²è½¬ä¸ºJSONå¯¹è±¡</p>
</blockquote>
<p>åœ¨javaä¸­ï¼Œå®Œæˆè¿™ä¸ªæ“ä½œï¼Œä¹Ÿå¾ˆå®¹æ˜“ï¼Œæœ‰å¾ˆå¤šç¬¬ä¸‰æ–¹jaråŒ…éƒ½æä¾›äº†è¯¥åŠŸèƒ½ï¼Œä¾‹å¦‚ jackson</p>
<p><strong>1ã€é¡¹ç›®ä¸­å¼•å…¥ä¾èµ–</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>2ã€ä»£ç ä¸­ä½¿ç”¨</strong></p>
<p>==å¯¹è±¡è½¬json==</p>
<p>ä»¥<code>User</code>ç±»å‹ä¸ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.brup.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Ignore;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonFormat;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnore;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnoreProperties;</span><br><span class="line"><span class="comment">//@JsonIgnoreProperties(value = )</span></span><br><span class="line">	<span class="comment">// ä¸€æ¬¡å¿½è§†å¤šä¸ªå±æ€§</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Date dob; <span class="comment">// è½¬json æ ¼å¼åŒ–æ—¥æœŸ</span></span><br><span class="line">	<span class="comment">// å¯†ç å°±ä¸æƒ³è½¬æˆjson</span></span><br><span class="line">	<span class="comment">//@JsonIgnore</span></span><br><span class="line">	<span class="keyword">private</span> String password; <span class="comment">//è½¬json å¿½è§†è¯¥å±æ€§</span></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(Integer id, String name, Date dob, String password)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.dob = dob;</span><br><span class="line">		<span class="keyword">this</span>.password = password;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Date <span class="title">getDob</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> dob;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDob</span><span class="params">(Date dob)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.dob = dob;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> password;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.password = password;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;User [id=&quot;</span> + id + <span class="string">&quot;, name=&quot;</span> + name + <span class="string">&quot;, dob=&quot;</span> + dob + <span class="string">&quot;, password=&quot;</span> + password + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œ<code>@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;)</code>æŒ‡å®šè¯¥å±æ€§è½¬æ¢jsonæ ¼å¼å­—ç¬¦ä¸²çš„æ—¶å€™çš„æ—¥æœŸæ ¼å¼</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œ<code>@JsonIgnoreProperties(&#123;&quot;password&quot;&#125;)</code>æŒ‡å®šæ”¹å±æ€§åœ¨è½¬jsonæ ¼å¼å­—ç¬¦ä¸²çš„æ—¶å€™å¯ä»¥å¿½ç•¥æ‰</p>
</blockquote>
<p>æµ‹è¯•ä»£ç ï¼š</p>
<p>ä¾‹å¦‚ï¼ŒUserå¯¹è±¡è½¬æ¢jsonæ ¼å¼å­—ç¬¦ä¸²</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_obj2json</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">    User user = <span class="keyword">new</span> User(<span class="number">1</span>,<span class="string">&quot;tom&quot;</span>,<span class="keyword">new</span> Date(),<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        String jsonStr = mapper.writeValueAsString(user);</span><br><span class="line">        System.out.println(jsonStr);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;id&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom&quot;</span>,<span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¼å¼åŒ–ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;id&quot;</span>:<span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œjsonæ ¼å¼å­—ç¬¦ä¸²è½¬Userå¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_json2Obj</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">    String jsonStr = <span class="string">&quot;&#123;\&quot;id\&quot;:1,\&quot;name\&quot;:\&quot;tom\&quot;,\&quot;dob\&quot;:\&quot;2022-10-29\&quot;&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        User user = mapper.readValue(jsonStr, User.class);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonMappingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼ŒMap&lt;String,String&gt;å¯¹è±¡è½¬jsonæ ¼å¼å­—ç¬¦ä¸²</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_map2Json_string</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">    Map&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;String,String&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;tom&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;21&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        String jsonStr = mapper.writeValueAsString(map);</span><br><span class="line">        System.out.println(jsonStr);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom&quot;</span>,<span class="attr">&quot;age&quot;</span>:<span class="string">&quot;21&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;age&quot;</span>:<span class="string">&quot;21&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>ä¾‹å¦‚ï¼Œjsonæ ¼å¼å­—ç¬¦ä¸²è½¬Map&lt;String,String&gt;å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_json2Map_string</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">    String jsonStr = <span class="string">&quot;&#123;\&quot;name\&quot;:\&quot;tom\&quot;,\&quot;age\&quot;:\&quot;21\&quot;&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">        Map&lt;String,String&gt; map = mapper.readValue(jsonStr, Map.class);</span><br><span class="line">        System.out.println(map);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonMappingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œmap&lt;String,User&gt;å¯¹è±¡è½¬Jsonæ ¼å¼å­—ç¬¦ä¸²</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_map2Json_user</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">    Map&lt;Integer, User&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    map.put(<span class="number">1</span>, <span class="keyword">new</span> User(<span class="number">1</span>,<span class="string">&quot;tom1&quot;</span>,<span class="keyword">new</span> Date(),<span class="string">&quot;123456&quot;</span>));</span><br><span class="line">    map.put(<span class="number">2</span>, <span class="keyword">new</span> User(<span class="number">2</span>,<span class="string">&quot;tom2&quot;</span>,<span class="keyword">new</span> Date(),<span class="string">&quot;123456&quot;</span>));</span><br><span class="line">    map.put(<span class="number">3</span>, <span class="keyword">new</span> User(<span class="number">3</span>,<span class="string">&quot;tom3&quot;</span>,<span class="keyword">new</span> Date(),<span class="string">&quot;123456&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        String jsonStr = mapper.writeValueAsString(map);</span><br><span class="line">        System.out.println(jsonStr);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;1&quot;</span>:&#123;<span class="attr">&quot;id&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom1&quot;</span>,<span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span>&#125;,<span class="attr">&quot;2&quot;</span>:&#123;<span class="attr">&quot;id&quot;</span>:<span class="number">2</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom2&quot;</span>,<span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span>&#125;,<span class="attr">&quot;3&quot;</span>:&#123;<span class="attr">&quot;id&quot;</span>:<span class="number">3</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom3&quot;</span>,<span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¼å¼åŒ–ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;1&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>:<span class="number">1</span>,</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom1&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;2&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>:<span class="number">2</span>,</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom2&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;3&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>:<span class="number">3</span>,</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom3&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<p>ä¾‹å¦‚ï¼Œjsonæ ¼å¼å­—ç¬¦ä¸²è½¬Map&lt;String,User&gt;å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_json2Map_user</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">    String jsonStr = <span class="string">&quot;&#123;\&quot;1\&quot;:&#123;\&quot;id\&quot;:1,\&quot;name\&quot;:\&quot;tom1\&quot;,\&quot;dob\&quot;:\&quot;2022-10-29\&quot;&#125;,\&quot;2\&quot;:&#123;\&quot;id\&quot;:2,\&quot;name\&quot;:\&quot;tom2\&quot;,\&quot;dob\&quot;:\&quot;2022-10-29\&quot;&#125;,\&quot;3\&quot;:&#123;\&quot;id\&quot;:3,\&quot;name\&quot;:\&quot;tom3\&quot;,\&quot;dob\&quot;:\&quot;2022-10-29\&quot;&#125;&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//æŒ‡å®šè¦è§£æè½¬æ¢javaç±»å‹æ˜¯Mapï¼Œå·²ç»Mapä¸­çš„ä¿©ä¸ªæ³›å‹çš„ç±»å‹åˆ†åˆ«æ˜¯Stringå’ŒUser</span></span><br><span class="line">        JavaType javaType = mapper.getTypeFactory().constructParametricType(Map.class, String.class,User.class);</span><br><span class="line">        Map&lt;String, User&gt; map = mapper.readValue(jsonStr, javaType);</span><br><span class="line">        <span class="keyword">for</span>(User user:map.values()) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonMappingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼ŒList&lt;String&gt; å¯¹è±¡è½¬Jsonæ ¼å¼å­—ç¬¦ä¸²</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_list2Json_string</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">    List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    list.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    list.add(<span class="string">&quot;world&quot;</span>);</span><br><span class="line">    list.add(<span class="string">&quot;briup&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        String jsonStr = mapper.writeValueAsString(list);</span><br><span class="line">        System.out.println(jsonStr);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[<span class="string">&quot;hello&quot;</span>,<span class="string">&quot;world&quot;</span>,<span class="string">&quot;briup&quot;</span>]</span><br></pre></td></tr></table></figure>





<p>ä¾‹å¦‚ï¼ŒJsonæ ¼å¼å­—ç¬¦ä¸²è½¬List&lt;String&gt;å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_json2List_string</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">    String jsonStr = <span class="string">&quot;[\&quot;hello\&quot;,\&quot;world\&quot;,\&quot;briup\&quot;]&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">        List&lt;String&gt; list = mapper.readValue(jsonStr,List.class);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼ŒList&lt;User&gt;å¯¹è±¡è½¬Jsonæ ¼å¼å­—ç¬¦ä¸²</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_list2Json_user</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    list.add(<span class="keyword">new</span> User(<span class="number">1</span>,<span class="string">&quot;tom1&quot;</span>,<span class="keyword">new</span> Date(),<span class="string">&quot;123456&quot;</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> User(<span class="number">2</span>,<span class="string">&quot;tom2&quot;</span>,<span class="keyword">new</span> Date(),<span class="string">&quot;123456&quot;</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> User(<span class="number">3</span>,<span class="string">&quot;tom3&quot;</span>,<span class="keyword">new</span> Date(),<span class="string">&quot;123456&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        String jsonStr = mapper.writeValueAsString(list);</span><br><span class="line">        System.out.println(jsonStr);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[&#123;<span class="attr">&quot;id&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom1&quot;</span>,<span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span>&#125;,&#123;<span class="attr">&quot;id&quot;</span>:<span class="number">2</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom2&quot;</span>,<span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span>&#125;,&#123;<span class="attr">&quot;id&quot;</span>:<span class="number">3</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom3&quot;</span>,<span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span>&#125;]</span><br></pre></td></tr></table></figure>

<p>æ ¼å¼åŒ–ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>:<span class="number">1</span>,</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom1&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>:<span class="number">2</span>,</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom2&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>:<span class="number">3</span>,</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;tom3&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;dob&quot;</span>:<span class="string">&quot;2020-10-29&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>





<p>ä¾‹å¦‚ï¼Œjsonæ ¼å¼å­—ç¬¦ä¸²è½¬List &lt;User&gt;å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_json2List_user</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">    String jsonStr = <span class="string">&quot;[&#123;\&quot;id\&quot;:1,\&quot;name\&quot;:\&quot;tom1\&quot;,\&quot;dob\&quot;:\&quot;2022-10-29\&quot;&#125;,&#123;\&quot;id\&quot;:2,\&quot;name\&quot;:\&quot;tom2\&quot;,\&quot;dob\&quot;:\&quot;2022-10-29\&quot;&#125;,&#123;\&quot;id\&quot;:3,\&quot;name\&quot;:\&quot;tom3\&quot;,\&quot;dob\&quot;:\&quot;2022-10-29\&quot;&#125;]&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        JavaType javaType = mapper.getTypeFactory().constructParametricType(List.class, User.class);</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; list = mapper.readValue(jsonStr,javaType);</span><br><span class="line"></span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>æ€»ç»“</code></p>
<ul>
<li><p>å¯¹è±¡è½¬json</p>
</li>
<li><p>mapper.writeValueAsString(ä»»ä½•ç±»å‹æ•°æ®)</p>
</li>
<li><p>jsonè½¬å¯¹è±¡</p>
<ul>
<li><p>å¦‚æœæ­£å¸¸ç±»å‹User</p>
<ul>
<li>mapper.readValue(msg,User);</li>
</ul>
</li>
<li><p>å¦‚æœç‰¹æ®Šç±»å‹ List<User></p>
<ul>
<li><p>å…ˆå£°æ˜è½¬æ¢ç±»å‹</p>
<ul>
<li>```java<br>JavaType type = mapper<pre><code>    .getTypeFactory()
    .constructParametricType(List.class, User.class);
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">    - mapper.readValue(msg,type);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## æ¡ˆä¾‹</span><br><span class="line"></span><br><span class="line">**å‰ç«¯** </span><br><span class="line"></span><br><span class="line">```html</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;å¯¹è±¡è½¬json&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/1.8.3/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">	function testJson()&#123;</span><br><span class="line">		$.ajax(&#123;</span><br><span class="line">			type: &quot;get&quot;,</span><br><span class="line">			url: &quot;result&quot;,</span><br><span class="line">			// è¿”å›ç±»å‹ 2.èƒ½è‡ªåŠ¨è§£ææˆjson</span><br><span class="line">			// dataType: &quot;json&quot;, </span><br><span class="line">			success: function(resp)&#123;</span><br><span class="line">				console.log(resp);</span><br><span class="line">				// var obj = JSON.parse(resp); 1.æ‰‹åŠ¨è½¬</span><br><span class="line">				//console.log(obj.flag);</span><br><span class="line">				//3.  å¦‚æœåå°è¿”å›å°±æ˜¯jsonæ ¼å¼,æ— é¡»ä»»ä½•å¤„ç†</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;button onclick=&quot;testJson()&quot;&gt;ç‚¹å‡»&lt;/button&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>åç«¯</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.brup.web.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.brup.entity.Result;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/result&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">//resp.setContentType(&quot;text/plain;charset=utf-8&quot;);</span></span><br><span class="line">		<span class="comment">// 3.åå°ç›´æ¥è¿”å›json</span></span><br><span class="line">		resp.setContentType(<span class="string">&quot;application/json;charset=utf-8&quot;</span>);</span><br><span class="line">		Result  r = <span class="keyword">new</span> Result(<span class="keyword">true</span>,<span class="string">&quot;å¯æ³¨å†Œ&quot;</span>);</span><br><span class="line">		ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">		String msg = mapper.writeValueAsString(r);</span><br><span class="line">		resp.getWriter().write(msg);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h1 id="spring"><a href="#spring" class="headerlink" title="spring"></a>spring</h1><h2 id="1-Springç®€ä»‹"><a href="#1-Springç®€ä»‹" class="headerlink" title="1.Springç®€ä»‹"></a>1.Springç®€ä»‹</h2><blockquote>
<p>Springæ˜¯ä¸€ä¸ªä½¿ç”¨javaè¯­è¨€ç¼–å†™çš„è½»é‡çº§å¼€æºæ¡†æ¶ï¼Œè§£å†³äº†é¡¹ç›®ä¸­çš„ä¸€äº›é€šç”¨é—®é¢˜ï¼Œä¾‹å¦‚ä¾èµ–æ³¨å…¥ã€åˆ‡é¢ç»‡å…¥ç­‰ï¼ŒåŒæ—¶è¿˜æä¾›äº†é¡¹ç›®ä¸­å„ç§æŠ€æœ¯çš„ä¸€ç«™å¼çš„è§£å†³ã€æ•´åˆæ–¹æ¡ˆã€‚</p>
</blockquote>
<p>Springæ˜¯äº2003 å¹´å…´èµ·çš„ä¸€ä¸ªè½»é‡çº§çš„Java å¼€æºæ¡†æ¶ï¼Œç”±Rod Johnsonåœ¨å…¶è‘—ä½œ<code>Expert One-On-One J2EE Development and Design</code>ä¸­é˜è¿°çš„éƒ¨åˆ†ç†å¿µå’ŒåŸå‹è¡ç”Ÿè€Œæ¥,ä¸ºäº†è§£å†³ä¼ä¸šåº”ç”¨å¼€å‘çš„å¤æ‚æ€§è€Œåˆ›å»ºçš„ã€‚</p>
<p>Springæ¡†æ¶çš„ä¸»è¦ä¼˜åŠ¿ä¹‹ä¸€å°±æ˜¯å…¶åˆ†å±‚æ¶æ„ï¼Œåˆ†å±‚æ¶æ„å…è®¸ä½¿ç”¨è€…é€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªç»„ä»¶ï¼ŒåŒæ—¶ä¸ºJ2EEåº”ç”¨ç¨‹åºå¼€å‘æä¾›é›†æˆçš„æ¡†æ¶ã€‚</p>
<p>Springæ¡†æ¶ä¸­çš„ç»„ä»¶æ¨¡å—ä¼—å¤šï¼Œä¸ç”¨çš„ç»„ä»¶æ¨¡å—ç”¨æ¥è§£å†³ä¸åŒçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å•ç‹¬ä½¿ç”¨æŸä¸€ä¸ªæ¨¡å—ï¼Œä¹Ÿå¯ä»¥å°†ä¼—å¤šæ¨¡å—æ ¹æ®é¡¹ç›®éœ€è¦ï¼Œè¿›è¡Œè‡ªç”±ç»„åˆã€‚</p>
<p>Springæ¡†æ¶ä¸­çš„æ‰€æœ‰ç»„ä»¶æ¨¡å—éƒ½ä¾èµ–äºSpringæä¾›çš„ä¿©ä¸ªåŸºç¡€åŠŸèƒ½ï¼šæ˜¯æ§åˆ¶åè½¬ï¼ˆ<code>IOC</code>ï¼‰å’Œé¢å‘åˆ‡é¢ï¼ˆ<code>AOP</code>ï¼‰ã€‚ </p>
<p>ä»ç®€å•æ€§ã€å¯æµ‹è¯•æ€§å’Œæ¾è€¦åˆçš„è§’åº¦è€Œè¨€ï¼Œä»»ä½•Javaåº”ç”¨éƒ½å¯ä»¥ä»Springä¸­å—ç›Šã€‚</p>
<p><a href="https://spring.io/">Spring å®˜ç½‘</a> </p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200909195909915.png" alt="image-20200909195909915"></p>
<p>Springæœ‰å¾ˆå¤šé¡¹ç›®ï¼Œä¸åŒçš„é¡¹ç›®ç”¨æ¥è§£å†³ä¸åŒé¢†åŸŸçš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ‰€è¯´çš„Springæ¡†æ¶ï¼ŒæŒ‡çš„æ˜¯Springçš„åŸºç¡€æ ¸å¿ƒé¡¹ç›®ï¼š<code>Spring Framework</code></p>
<p>ä¾‹å¦‚ï¼ŒSpringå®˜ç½‘æä¾›çš„é¡¹ç›®çš„åˆ—è¡¨ï¼Œé¡¹ç›®å¾ˆå¤šï¼Œè¿™é‡Œåªåˆ—å‡ºäº†ä¸€éƒ¨åˆ†</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201101232955221.png" alt="image-20201101232955221"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201101233023912.png" alt="image-20201101233023912"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201101233128076.png" alt="image-20201101233128076"></p>
<blockquote>
<p>æ³¨æ„ï¼ŒSpringå…¶ä»–é¡¹ç›®éƒ½ä¼šä¾èµ–äºæ ¸å¿ƒé¡¹ç›®<code>Spring Framework</code>çš„ä¸­çš„ç»„ä»¶æ¨¡å—ã€‚</p>
</blockquote>
<p><a href="https://spring.io/projects/spring-framework">Spring Frameworkå®˜ç½‘</a> </p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200909200005767.png" alt="image-20200909200005767"></p>
<p><a href="http://repo.spring.io/libs-release/org/springframework/spring/">Spring Frameworkä¸‹è½½åˆ—è¡¨</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201101233850120.png" alt="image-20201101233850120"></p>
<blockquote>
<p>æ³¨æ„ï¼Œè¯¥åˆ—è¡¨ä¸­æœ‰<code>Spring Framework</code>çš„æ¯ä¸€ä¸ªç‰ˆæœ¬çš„ä¸‹è½½</p>
</blockquote>
<h2 id="2-Springä¼˜åŠ¿"><a href="#2-Springä¼˜åŠ¿" class="headerlink" title="2.Springä¼˜åŠ¿"></a>2.Springä¼˜åŠ¿</h2><ul>
<li><p>å®¹å™¨æ€§è´¨ï¼Œæ–¹ä¾¿è§£è€¦ï¼Œç®€åŒ–å¼€å‘<strong>ï¼ˆæ ¸å¿ƒï¼‰</strong></p>
<p>Springæä¾›çš„<code>IOC</code>å®¹å™¨ï¼Œå¯ä»¥å°†å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»äº¤ç”±Springå®¹å™¨è¿›è¡Œæ§åˆ¶ï¼Œé¿å…ç¡¬ç¼–ç æ‰€é€ æˆçš„è¿‡åº¦ç¨‹åºè€¦åˆã€‚</p>
</li>
<li><p>AOPç¼–ç¨‹çš„æ”¯æŒ<strong>ï¼ˆæ ¸å¿ƒï¼‰</strong></p>
<p>é€šè¿‡Springçš„<code>AOP</code>åŠŸèƒ½ï¼Œæ–¹ä¾¿è¿›è¡Œé¢å‘åˆ‡é¢çš„ç¼–ç¨‹ï¼Œè®¸å¤šä¸å®¹æ˜“ç”¨ä¼ ç»ŸOOPå®ç°çš„åŠŸèƒ½å¯ä»¥é€šè¿‡AOPè½»æ¾åº”ä»˜ã€‚</p>
</li>
<li><p>å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒ</p>
<p>é€šè¿‡å£°æ˜å¼æ–¹å¼çµæ´»çš„è¿›è¡Œäº‹åŠ¡çš„ç®¡ç†ï¼Œæé«˜å¼€å‘æ•ˆç‡å’Œè´¨é‡</p>
</li>
<li><p>é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶</p>
<p>Springä¸ä»…ä¸æ’é™¤å…¶ä»–å„ç§ä¼˜ç§€çš„æ¡†æ¶ï¼ŒåŒæ—¶å¯¹è¿™äº›æ¡†æ¶(Mybatisã€Quartzç­‰)æä¾›äº†å¾ˆå¥½çš„æ”¯æŒ</p>
</li>
<li><p>é™ä½JavaEE APIçš„ä½¿ç”¨éš¾åº¦</p>
<p>Springå¯¹JavaEE API è¿›è¡Œäº†å°è£…ï¼Œä½¿å¾—è¿™äº›APIé™ä½äº†ä½¿ç”¨éš¾åº¦</p>
</li>
</ul>
<h2 id="3-Springæ¨¡å—"><a href="#3-Springæ¨¡å—" class="headerlink" title="3.Springæ¨¡å—"></a>3.Springæ¨¡å—</h2><p>Spring-framework æ¡†æ¶æ˜¯ä¸€ä¸ªåˆ†å±‚æ¶æ„ï¼Œå®ƒç”±å¤§çº¦20ä¸ªæ¨¡å—ç»„æˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201009162424400.png" alt="image-20201009162424400"></p>
<p>è¿™äº›æ¨¡å—åˆ†ä¸ºCore Containerã€Data Access/Integrationã€Webã€AOPï¼ˆAspect Oriented Programmingï¼‰ã€Instrumentationå’ŒTest</p>
<p><strong>1ã€Core Containerï¼Œæ ¸å¿ƒå®¹å™¨</strong></p>
<p>Core ContaineråŒ…å«æœ‰Coreã€Beansã€Contextå’ŒExpression Languageæ¨¡å—</p>
<p>Coreå’ŒBeansæ¨¡å—ï¼šæ¡†æ¶çš„åŸºç¡€éƒ¨åˆ†ï¼Œæä¾›åè½¬æ§åˆ¶ï¼ˆIOCï¼‰å’Œä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰ç‰¹æ€§ã€‚</p>
<p>Contextæ¨¡å—ï¼šæ„å»ºäºCoreå’ŒBeansæ¨¡å—åŸºç¡€ä¹‹ä¸Šï¼Œæä¾›äº†å¯¹å›½é™…åŒ–ã€äº‹ä»¶ä¼ æ’­ã€èµ„æºåŠ è½½å’Œå¯¹Contextçš„é€æ˜åˆ›å»ºçš„æ”¯æŒã€‚ApplicationContextæ¥å£æ˜¯Contextæ¨¡å—çš„å…³é”®ã€‚</p>
<p>Expression Languageæ¨¡å—ï¼šExpression Languageæ¨¡å—æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„è¡¨è¾¾å¼è¯­è¨€ç”¨äºåœ¨è¿è¡Œæ—¶æŸ¥è¯¢å’Œæ“çºµå¯¹è±¡ã€‚</p>
<p><strong>2ã€Data Access/Integrationï¼Œæ•°æ®è®¿é—®/é›†æˆéƒ¨åˆ†</strong></p>
<p>Data Access/Integrationå±‚åŒ…å«æœ‰JDBCã€ORMã€OXMã€JMSå’ŒTransactionæ¨¡å—</p>
<p>JDBCæ¨¡å—ï¼šè¯¥æ¨¡å—æä¾›äº†ä¸€ä¸ªJDBCæŠ½è±¡å±‚ï¼Œå®ƒå¯ä»¥æ¶ˆé™¤å†—é•¿çš„JDBCç¼–ç å’Œè§£ææ•°æ®åº“å‚å•†ç‰¹æœ‰çš„é”™è¯¯ä»£ç ã€‚</p>
<p>ORMæ¨¡å—ï¼šè¯¥æ¨¡å—ä¸ºæµè¡Œçš„å¯¹è±¡-å…³ç³»æ˜ å°„APIâ€”â€”JPAã€JDOã€Hibernateã€Mybatisç­‰æä¾›äº†ä¸€ä¸ªäº¤äº’å±‚ã€‚åˆ©ç”¨ORMå°è£…åŒ…ï¼Œå¯ä»¥æ··åˆä½¿ç”¨æ‰€æœ‰Springæä¾›çš„ç‰¹æ€§è¿›è¡ŒO/Ræ˜ å°„ã€‚å¦‚å‰è¾¹æåˆ°çš„ç®€å•å£°æ˜æ€§äº‹ç‰©ç®¡ç†ã€‚</p>
<p>OXMæ¨¡å—ï¼šè¯¥æ¨¡å—æä¾›äº†ä¸€ä¸ªå¯¹Object/XMLæ˜ å°„å®ç°çš„æŠ½è±¡å±‚ï¼ŒObject/XMLæ˜ å°„å®ç°åŒ…æ‹¬JAXBã€Castorã€XMLBeansã€JiBXå’ŒXStreamã€‚</p>
<p>JMSæ¨¡å—ï¼šJMS(Java Messaging Service)æ¨¡å—ä¸»è¦åŒ…å«äº†ä¸€äº›åˆ¶é€ å’Œæ¶ˆè´¹æ¶ˆæ¯çš„ç‰¹æ€§ã€‚</p>
<p>Transactionæ¨¡å—ï¼šè¯¥æ¨¡å—æ”¯æŒç¼–ç¨‹å’Œå£°æ˜æ€§çš„äº‹ç‰©ç®¡ç†ï¼Œè¿™äº›äº‹ç‰©ç±»å¿…é¡»å®ç°ç‰¹å®šçš„æ¥å£ï¼Œå¹¶ä¸”å¯¹æ‰€æœ‰çš„POJOéƒ½é€‚ç”¨ã€‚</p>
<p>3ã€<strong>Web</strong></p>
<p>Webå±‚åŒ…å«äº†Webã€Servletã€WebSocketã€Portletæ¨¡å—</p>
<p>Webæ¨¡å—ï¼šè¯¥æ¨¡å—æä¾›äº†åŸºç¡€çš„é¢å‘webçš„é›†æˆç‰¹æ€§ã€‚ä¾‹å¦‚å¤šæ–‡ä»¶ä¸Šä¼ ã€ä½¿ç”¨servlet listenersåˆå§‹åŒ–IoCå®¹å™¨ä»¥åŠä¸€ä¸ªé¢å‘webçš„åº”ç”¨ä¸Šä¸‹æ–‡ã€‚å®ƒè¿˜åŒ…å«Springè¿œç¨‹æ”¯æŒä¸­webç›¸å…³éƒ¨åˆ†ã€‚</p>
<p>Servletæ¨¡å—ï¼šè¯¥æ¨¡å—åŒ…å«Springçš„model-view-controllerï¼ˆMVCï¼‰å®ç°ã€‚Springçš„MVCæ¡†æ¶ä½¿å¾—æ¨¡å‹èŒƒå›´å†…çš„ä»£ç å’Œweb formsä¹‹é—´èƒ½å¤Ÿæ¸…æ¥šçš„åˆ†ç¦»å¼€æ¥ï¼Œå¹¶ä¸Springæ¡†æ¶çš„å…¶ä»–ç‰¹æ€§é›†æˆåœ¨ä¸€èµ·ã€‚</p>
<p>WebSocketæ¨¡å—ï¼šè¯¥æ¨¡å—æä¾›äº†å¯¹WebSocketçš„æ”¯æŒã€‚</p>
<p>Portletæ¨¡å—ï¼šæä¾›äº†ç”¨äºportletç¯å¢ƒçš„MVCçš„å®ç°ï¼ŒPortletæ˜¯å’ŒServletç±»ä¼¼çš„ä¸€ç§webæŠ€æœ¯ã€‚</p>
<p><strong>4ã€AOPå’ŒInstrumentation</strong></p>
<p>AOPæ¨¡å—ï¼šæä¾›äº†ä¸€ä¸ªç¬¦åˆAOPè”ç›Ÿæ ‡å‡†çš„é¢å‘åˆ‡é¢ç¼–ç¨‹çš„å®ç°ï¼Œå®ƒè®©ä½ å¯ä»¥å®šä¹‰æ–¹æ³•æ‹¦æˆªå™¨å’Œåˆ‡ç‚¹ï¼Œä»è€Œå°†é€»è¾‘ä»£ç åˆ†å¼€ï¼Œé™ä½å®ƒä»¬ä¹‹é—´çš„è€¦åˆæ€§ã€‚</p>
<p>Aspectsæ¨¡å—ï¼šæä¾›äº†å¯¹AspectJçš„é›†æˆæ”¯æŒï¼ŒSpringæ¡†æ¶çš„AOPåŠŸèƒ½æ˜¯ä½¿ç”¨AspectJæ¡†æ¶æ¥å®ç°çš„ã€‚</p>
<p>Instrumentationæ¨¡å—æä¾›äº†class instrumentationæ”¯æŒå’Œclassloaderå®ç°ï¼Œä½¿å¾—å¯ä»¥åœ¨ç‰¹å®šçš„åº”ç”¨æœåŠ¡å™¨ä¸Šä½¿ç”¨ã€‚</p>
<p><strong>5ã€Test</strong></p>
<p>Testæ¨¡å—ï¼šæ”¯æŒä½¿ç”¨JUnitå’ŒTestNGå¯¹Springç»„ä»¶è¿›è¡Œæµ‹è¯•ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œæ¥é€‰æ‹©å¼•å…¥å¹¶ä½¿ç”¨Spring Frameworkä¸­ä¸åŒæ¨¡å—çš„åŠŸèƒ½ï¼Œå¹¶ä¸éœ€è¦ä¸€æ¬¡å¼•å…¥æ‰€ä»¥æ¨¡å—å¯¹åº”çš„jaråŒ…ã€‚</p>
</blockquote>
<h2 id="4-Spring-IOC"><a href="#4-Spring-IOC" class="headerlink" title="4.Spring IOC"></a>4.Spring IOC</h2><h3 id="4-1-é—®é¢˜"><a href="#4-1-é—®é¢˜" class="headerlink" title="4.1.é—®é¢˜"></a>4.1.é—®é¢˜</h3><p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200909165520086.png" alt="image-20200909165520086"></p>
<p>æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„ä¸‰å±‚æ¶æ„ï¼Œè™½ç„¶èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Šè¿›è¡Œè§£è€¦ï¼Œä½†æ˜¯è¿™é‡Œä¹Ÿä¼šå¸¦æ¥ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼š</p>
<ul>
<li><code>web</code>å±‚è°ƒç”¨<code>service</code>å±‚ï¼Œè¦åœ¨<code>web</code>å±‚åˆ›å»º<code>service</code>å±‚å¯¹è±¡ï¼Œç„¶åè°ƒç”¨å…¶æ–¹æ³•</li>
<li><code>service</code>å±‚è°ƒç”¨<code>dao</code>å±‚ï¼Œè¦åœ¨<code>service</code>å±‚åˆ›å»º<code>dao</code>å±‚å¯¹è±¡ï¼Œç„¶åè°ƒç”¨å…¶æ–¹æ³•</li>
</ul>
<p>ä¹Ÿå°±æ˜¯ï¼ŒWebå±‚ä¾èµ–Serviceçš„å®ç°ï¼ŒServiceéœ€è¦ä¾èµ–Daoå±‚å®ç°ï¼Œå¹¶éœ€è¦æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨åˆ›å»ºå¹¶ç»´æŠ¤è¯¥è¿™äº›å®ç°ï¼Œéšç€é¡¹ç›®é€æ¸æ‰©å±•ï¼Œè¿™äº›åˆ›å»ºå’Œç»´æŠ¤å·¥ä½œå°†ä¼šå˜å¾—è¶Šæ¥è¶Šå¤æ‚ã€‚</p>
<p>ä¸ºäº†æ›´å¥½çš„è§£è€¦ï¼Œåœ¨å¯åŠ¨é¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œæå‰åšå¥½ä»¥ä¸‹å·¥ä½œï¼š</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼ˆä¾‹å¦‚ä¸€ä¸ªMapé›†åˆå³å¯ï¼‰</li>
<li>æŠŠé¡¹ç›®ä¸­éœ€è¦çš„å¯¹è±¡æå‰åˆ›å»ºå¥½ï¼Œå¹¶ä¸”å­˜å…¥è¯¥å®¹å™¨ä¸­</li>
<li>æ¯ä¸€ä¸ªæ¨¡å—éœ€è¦ç”¨åˆ°å¯¹è±¡ï¼Œæå‰å°±ç»™è¯¥æ¨¡å—æä¾›å¥½</li>
</ul>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸæ¥çš„ä»£ç æ˜¯è¿™æ ·å†™çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> IUserService userService = <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ä¸‹é¢ä½¿ç”¨userServiceè¿›è¡Œæ“ä½œ</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è€Œç°åœ¨ï¼Œå°±ä¸ç”¨æˆ‘ä»¬ç›´æ¥åˆ›å»ºå¯¹è±¡äº†ï¼Œå› ä¸ºå®¹å™¨ä¼šè‡ªåŠ¨å°†éœ€è¦çš„å¯¹è±¡å…¶ä»–æ³¨å…¥åˆ°Servletä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> IUserService userService;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ä¸‹é¢ä½¿ç”¨userServiceè¿›è¡Œæ“ä½œ</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œä¿©ä¸ªæ¨¡å—çš„è€¦åˆåº¦åˆé™ä½äº†ï¼Œå¹¶ä¸”å°†æ¥å¯ä»¥å¾ˆè½»è½»çš„æ›´æ¢æ¥å£çš„å®ç°</p>
</blockquote>
<p>å…¶é¡¹ç›®å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200909171150553.png" alt="image-20200909171150553"></p>
<blockquote>
<p>æ³¨æ„ï¼ŒSpring IOCå°±æ˜¯ä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„å®¹å™¨</p>
</blockquote>
<h3 id="4-2-IOC"><a href="#4-2-IOC" class="headerlink" title="4.2 IOC"></a>4.2 IOC</h3><p><code>IOC (Inverse of Control)</code>  æ§åˆ¶åè½¬ï¼Œå°†å¯¹è±¡çš„åˆ›å»ºä»¥åŠå¯¹è±¡ä¾èµ–å…³ç³»åè½¬ç»™Spring å®¹å™¨ï¼Œç¨‹åºæœ¬èº«ä¸è¿›è¡Œç»´æŠ¤ã€‚</p>
<p>Springå®˜æ–¹æ–‡æ¡£ä¸­ç»™ç»“é’©å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201011183545095.png" alt="image-20201011183545095"></p>
<blockquote>
<p>æ³¨æ„ï¼ŒåŸæ¥ç”±æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨åˆ›å»ºå¹¶ç»´æŠ¤çš„å¯¹è±¡ï¼Œç°åœ¨éƒ½å¯ä»¥äº¤ç»™Springçš„IOCå®¹å™¨å»è¿›è¡Œç®¡ç†ç»´æŠ¤</p>
</blockquote>
<h3 id="4-3-å‡†å¤‡"><a href="#4-3-å‡†å¤‡" class="headerlink" title="4.3 å‡†å¤‡"></a>4.3 å‡†å¤‡</h3><p>1ã€å‡†å¤‡Spring å¼€å‘æ‰€éœ€jaråŒ…</p>
<p>å¯ä»¥ä»å®˜ç½‘ä¸‹è½½ï¼Œä¹Ÿå¯ä»¥ä»æä¾›çš„èµ„æ–™é‡Œé¢æ‰¾åˆ°ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201011184405345.png" alt="image-20201011184405345"></p>
<ul>
<li>docs : Spring API å’Œ è§„èŒƒæ–‡æ¡£è¯´æ˜</li>
<li>libs:  jaråŒ…ä»¥åŠå¯¹åº”çš„æºç </li>
<li>schema: çº¦æŸ</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼š è¿™é‡Œä½¿ç”¨çš„Springç‰ˆæœ¬ä¸º 5.0.2.Releaseï¼Œå¯¹åº”æ ¸å¿ƒåŠŸèƒ½è€Œè¨€ï¼Œä¸åŒçš„ç‰ˆæœ¬ä¹‹é—´å·®å¼‚ä¸å¤§</p>
</blockquote>
<p>2ã€å°†æ ¸å¿ƒå®¹å™¨jaråŒ…ä»¥åŠè¾…åŠ©åŒ…å¯¼å…¥é¡¹ç›®libç›®å½•ä¸‹</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201011193514773.png" alt="image-20201011193514773"></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-expression<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>å…¶ä¸­ï¼š</p>
<ul>
<li><p>lombok ä¸å±äº Springçš„æ ¸å¿ƒå®¹å™¨ï¼Œåªæ˜¯ä¸€ä¸ªç”¨æ¥ç®€åŒ–POJOç±»å†™æ³•çš„å·¥å…·</p>
</li>
<li><p>commons-logging / log4j å±äºæ—¥å¿—å·¥å…·</p>
</li>
</ul>
<p>lombokéœ€è¦Eclipseç°åœ¨æ’ä»¶å¯¹å…¶è¿›è¡Œæ”¯æŒï¼š</p>
<blockquote>
<p>ä¸è¦æ”¾åœ¨ä¸­æ–‡ç›®å½•ä¸‹</p>
</blockquote>
<p>åŒå‡»lombok-1.18.12.jar</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102004906657.png" alt="image-20201102004906657"></p>
<p>é€‰æ‹©éœ€è¦å®‰è£…æ’ä»¶çš„STSæˆ–Eclipse</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102005003831.png" alt="image-20201102005003831"></p>
<p>ç‚¹å‡»å®‰è£…ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102005042446.png" alt="image-20201102005042446"></p>
<blockquote>
<p>æ³¨æ„ï¼Œå®‰è£…æˆåŠŸåï¼Œéœ€è¦é‡æ–°å¯åŠ¨STSæˆ–è€…Eclipse</p>
</blockquote>
<p>3ã€åˆ›å»ºpojoç±»</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102005440635.png" alt="image-20201102005440635"></p>
<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.ioc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Husband</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> salary;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”±äºä½¿ç”¨äº†Lombokä¸­çš„Dataæ³¨è§£ï¼Œè¯¥ç±»ç¼–è¯‘åï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„GET/SETæ–¹æ³•ä»¥åŠtoStringç­‰æ–¹æ³•ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102005556484.png" alt="image-20201102005556484"></p>
<h3 id="4-4-é…ç½®"><a href="#4-4-é…ç½®" class="headerlink" title="4.4 é…ç½®"></a>4.4 é…ç½®</h3><p>1ã€åœ¨srcä¸‹é¢ï¼Œåˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œåå­—ä¸ºï¼š<code>applicationContext.xml</code></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201011191654695.png" alt="image-20201011191654695"></p>
<p>2ã€xmlæ·»åŠ å¤´éƒ¨å£°æ˜</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>åœ¨Springçš„å®˜æ–¹è¯´æ˜æ–‡æ¡£ä¸­ï¼Œå¯ä»¥æ‰¾åˆ°æ¨¡æ¿æ ·ä¾‹ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201011192052332.png" alt="image-20201011192052332"></p>
<p>3ã€åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ éœ€è¦è¢«Springå®¹å™¨ç®¡ç†çš„èµ„æº</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"> 	 </span><br><span class="line">  <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">  		beanæ ‡ç­¾çš„ä½œç”¨ï¼šç”¨äºé…ç½®è®©Springå®¹å™¨åˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="comment">  			class : è¦åˆ›å»ºå¯¹è±¡çš„å…¨é™å®šç±»å</span></span><br><span class="line"><span class="comment">  			name: è¯¥å¯¹è±¡åœ¨å®¹å™¨ä¸­çš„åå­—  </span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;husband&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.ioc.Husband&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼ŒSpringIOCå®¹å™¨ç®¡ç†çš„å¯¹è±¡ï¼Œç§°ä¸ºbeanï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨beanæ ‡ç­¾æ¥è¿›è¡Œé…ç½®</p>
</blockquote>
<p>è¿™é‡Œä½¿ç”¨äº†nameå±æ€§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨id</p>
<ul>
<li>id: ä¸€ä¸ªbeançš„å”¯ä¸€æ ‡è¯† ï¼Œ å‘½åæ ¼å¼å¿…é¡»ç¬¦åˆXML IDå±æ€§çš„å‘½åè§„èŒƒ</li>
<li>name: å¯ä»¥ç”¨ç‰¹æ®Šå­—ç¬¦ï¼Œå¹¶ä¸”ä¸€ä¸ªbeanå¯ä»¥ç”¨å¤šä¸ªåç§°ï¼Œä¾‹å¦‚<code>name=&quot;bean1,bean2,bean3&quot;</code></li>
<li>å¦‚æœæ²¡æœ‰idï¼Œåˆ™nameçš„ç¬¬ä¸€ä¸ªåç§°é»˜è®¤æ˜¯id</li>
<li>å¦‚æœ ä¸€ä¸ª bean æ ‡ç­¾æœªæŒ‡å®š idã€name å±æ€§ï¼Œåˆ™ springå®¹å™¨ä¼šç»™å…¶ä¸€ä¸ªé»˜è®¤çš„idï¼Œå€¼ä¸ºå…¶ç±»å…¨å</li>
<li>å¦‚æœæœ‰å¤šä¸ªbeanæ ‡ç­¾æœªæŒ‡å®š idã€name å±æ€§ï¼Œä½†æ˜¯classç›¸åŒï¼Œåˆ™springå®¹å™¨ä¼šæŒ‰ç…§å…¶å‡ºç°çš„æ¬¡åºï¼Œåˆ†åˆ«ç»™å…¶æŒ‡å®š id å€¼ä¸º â€œç±»å…¨å#1â€, â€œç±»å…¨å#2â€</li>
</ul>
<p>4ã€æµ‹è¯•</p>
<p>åˆ›å»ºæµ‹è¯•ç±»</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201011192646045.png" alt="image-20201011192646045"></p>
<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Husband;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIoCTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 1.è§£æé…ç½®æ–‡ä»¶,åˆ›å»ºå®¹å™¨</span></span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">	</span><br><span class="line">		<span class="comment">// 2.æ ¹æ®é…ç½®çš„Idå€¼,ä»å®¹å™¨ä¸­è·å–å¯¹è±¡</span></span><br><span class="line">		Husband hunsband = (Husband) ac.getBean(<span class="string">&quot;husband&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(hunsband);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102011303778.png" alt="image-20201102011303778"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶æˆ‘ä»¬å·²ç»å¯ä»¥ä»å®¹å™¨ä¸­ï¼ˆApplicationContextå¯¹è±¡ï¼‰æ‹¿å…¶ä»–é…ç½®å¥½çš„Husbandå¯¹è±¡äº†</p>
</blockquote>
<p>è¿™é‡Œæœ‰çº¢è‰²è­¦å‘Šï¼Œæ˜¯å› ä¸ºlog4jæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚æœæœ‰éœ€è¦å¯ä»¥srcä¸‹é¢æ·»åŠ é…ç½®æ–‡ä»¶ï¼šlog4j.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG, stdout </span></span><br><span class="line"><span class="meta">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender </span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.PatternLayout </span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%d [%-5p] %c - %m%n</span></span><br></pre></td></tr></table></figure>



<h3 id="4-5-å®¹å™¨"><a href="#4-5-å®¹å™¨" class="headerlink" title="4.5 å®¹å™¨"></a>4.5 å®¹å™¨</h3><p>SpringIOCå®¹å™¨ï¼ˆApplicationContextï¼‰ç»§æ‰¿å…³ç³»å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201011194054333.png" alt="image-20201011194054333"></p>
<p>å®¹å™¨çš„é¡¶å±‚æ¥å£æ˜¯ <code>BeanFactory</code></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201011200215290.png" alt="image-20201011200215290"></p>
<p><code>BeanFactory</code>å’Œ<code>ApplicationContext</code>çš„åŒºåˆ«</p>
<ul>
<li><p>BeanFactoryæ˜¯Springå®¹å™¨çš„é¡¶å±‚æ¥å£ï¼ŒApplicationContextæ˜¯å…¶å­æ¥å£</p>
</li>
<li><p>ApplicationContextæ¥å£,å®ƒç”±BeanFactoryæ¥å£æ´¾ç”Ÿè€Œæ¥ï¼ŒåŒ…å«BeanFactoryçš„æ‰€æœ‰åŠŸèƒ½</p>
</li>
<li><p>BeanFactory åˆ›å»ºå®¹å™¨æ—¶ä¸ä¼šåˆ›å»ºå¯¹è±¡ï¼Œå½“ä»å®¹å™¨é‡Œé¢è·å–å¯¹è±¡æ—¶æ‰ä¼šåˆ›å»º</p>
</li>
<li><p>ApplicationContext åˆ›å»ºå®¹å™¨æ—¶å°±ä¼šåˆ›å»ºå¯¹è±¡</p>
</li>
</ul>
<p><code>ApplicationContext</code>æ¥å£çš„å®ç°ç±»</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201011201743451.png" alt="image-20201011201743451"></p>
<p>1ã€<code>ClassPathXmlApplication</code></p>
<p>ä»ç±»çš„æ ¹è·¯å¾„ä¸‹åŠ è½½é…ç½®æ–‡ä»¶</p>
<p>2ã€<code>FileSystemXmlApplication</code></p>
<p>ä»ç£ç›˜è·¯å¾„åŠ è½½é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶å¯ä»¥åœ¨ç£ç›˜ä»»ä½•ä½ç½®</p>
<p>ä¸€èˆ¬ä¸é€‚ç”¨  d:// </p>
<p>3ã€<code>AnnotationConfigApplicationContext</code></p>
<p>ç”¨æ³¨è§£é…ç½®å®¹å™¨å¯¹è±¡æ—¶ï¼Œéœ€è¦ä½¿ç”¨æ­¤ç±»æ¥åˆ›å»ºspringå®¹å™¨</p>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰idæˆ–è€…nameçš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡Classç±»å‹çš„å¯¹è±¡æ¥è·å–</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.ioc.Husband&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Husband;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIoCTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">	</span><br><span class="line">		Husband hunsband = ac.getBean(Husband.class);</span><br><span class="line">		</span><br><span class="line">		System.out.println(hunsband);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102012119735.png" alt="image-20201102012119735"></p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥å·¥å‚çš„æ–¹å¼æ¥åˆ›å»ºå¹¶è·å–å¯¹è±¡ï¼š</p>
<p><strong>1ã€é™æ€å·¥å‚æ–¹å¼</strong></p>
<p>åˆ›å»ºå·¥å‚ç±»</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201011210933773.png" alt="image-20201011210933773"></p>
<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.ioc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HusbandStaticFactory</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//é™æ€æ–¹æ³•</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Husband <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Husband();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		class å·¥å‚ç±»çš„å…¨é™å®šç±»å</span></span><br><span class="line"><span class="comment">		factory-method å·¥å‚ç±»é‡Œé¢çš„é™æ€æ–¹æ³•</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;husband&quot;</span>  <span class="attr">class</span>=<span class="string">&quot;com.briup.ioc.HusbandStaticFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getInstance&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Husband;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIoCTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 1.è§£æé…ç½®æ–‡ä»¶,åˆ›å»ºå®¹å™¨</span></span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">		<span class="comment">// 2.æ ¹æ®é…ç½®çš„Idå€¼,ä»å®¹å™¨ä¸­è·å–å¯¹è±¡</span></span><br><span class="line">		Husband husband = (Husband) ac.getBean(<span class="string">&quot;husband&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(husband);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102012603969.png" alt="image-20201102012603969"></p>
<p><strong>2ã€æ™®é€šå·¥å‚åˆ›å»ºæ–¹å¼</strong></p>
<p>åˆ›å»ºå·¥å‚ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.ioc;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ™®é€šå·¥å‚ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HusbandFactory</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Husband <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Husband h = <span class="keyword">new</span> Husband();</span><br><span class="line">		h.setId(<span class="number">1</span>);</span><br><span class="line">		h.setName(<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">		h.setSalary(<span class="number">2000</span>);</span><br><span class="line">		<span class="keyword">return</span> h;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		é…ç½®å·¥å‚ï¼Œè®©Springå®¹å™¨äº§ç”Ÿå·¥å‚å®ä¾‹</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;factory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.ioc.HusbandFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		factory-bean   å·¥å‚å®ä¾‹åœ¨Springå®¹å™¨ä¸­çš„å”¯ä¸€æ ‡è¯†</span></span><br><span class="line"><span class="comment">		factory-method å·¥å‚å®ä¾‹ä¸­çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;husband&quot;</span> <span class="attr">factory-bean</span>=<span class="string">&quot;factory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getInstance&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Husband;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIoCTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 1.è§£æé…ç½®æ–‡ä»¶,åˆ›å»ºå®¹å™¨</span></span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">		<span class="comment">// 2.æ ¹æ®é…ç½®çš„åå­—,ä»å®¹å™¨ä¸­è·å–å¯¹è±¡</span></span><br><span class="line">		Husband husband = (Husband) ac.getBean(<span class="string">&quot;husband&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//ä¹Ÿå¯ä»¥å¦‚ä¸‹è·å–</span></span><br><span class="line">        <span class="comment">//Husband husband = ac.getBean(Husband.class);</span></span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">		System.out.println(husband);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102013128338.png" alt="image-20201102013128338"></p>
<h3 id="4-7-bean"><a href="#4-7-bean" class="headerlink" title="4.7  bean"></a>4.7  bean</h3><p>1ã€<code>&lt;bean&gt;</code>æ ‡ç­¾çš„ä½œç”¨</p>
<ul>
<li><p>ç”¨äºé…ç½®è®©springå®¹å™¨æ¥åˆ›å»ºå¯¹è±¡</p>
</li>
<li><p>é»˜è®¤æƒ…å†µä¸‹å®ƒè°ƒç”¨çš„æ˜¯ç±»ä¸­çš„æ— å‚æ„é€ å‡½æ•°ï¼ˆåå°„ï¼‰</p>
</li>
</ul>
<p>2ã€<code>&lt;bean&gt;</code>æ ‡ç­¾çš„å±æ€§</p>
<ul>
<li><p><code>id</code> ç»™åœ¨å®¹å™¨ä¸­çš„å¯¹è±¡æä¾›ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œç”¨æ¥è·å–å¯¹è±¡</p>
</li>
<li><p><code>name</code>åŠŸèƒ½ç±»ä¼¼idï¼Œå‘½åè¦æ±‚æ²¡æœ‰idä¸¥æ ¼</p>
</li>
<li><p><code>class</code> æŒ‡å®šç±»çš„å…¨é™å®šç±»åã€‚ç”¨äºåå°„åˆ›å»ºå¯¹è±¡ã€‚é»˜è®¤æƒ…å†µä¸‹è°ƒç”¨æ— å‚æ„é€ å‡½æ•°</p>
</li>
<li><p><code>scope</code> æŒ‡å®šå¯¹è±¡èŒƒå›´</p>
<ul>
<li><p><code>sigleton</code> é»˜è®¤å€¼ï¼Œå•ä¾‹</p>
</li>
<li><p><code>prototype</code> å¤šä¾‹</p>
</li>
<li><p><code>request</code> WEBé¡¹ç›®ä¸­,Springå®¹å™¨åˆ›å»ºä¸€ä¸ªBeanå¯¹è±¡ï¼Œä¼šå°†è¯¥å¯¹è±¡å­˜å…¥request</p>
</li>
<li><p><code>session</code> WEBé¡¹ç›®ä¸­ï¼ŒSpringå®¹å™¨åˆ›å»ºä¸€ä¸ªBeanå¯¹è±¡ï¼Œä¼šå°†è¯¥å¯¹è±¡å­˜å…¥session</p>
</li>
<li><p><code>golbal session</code> åªæœ‰åº”ç”¨åœ¨åŸºäºportletçš„Webåº”ç”¨ç¨‹åºä¸­æ‰æœ‰æ„ä¹‰ï¼Œå®ƒæ˜ å°„åˆ°portletçš„globalèŒƒå›´çš„session</p>
</li>
</ul>
</li>
<li><p><code>init-method</code>: æŒ‡å®šç±»çš„åˆå§‹åŒ–æ–¹æ³•çš„åç§°</p>
</li>
<li><p><code>destory-method</code>: æŒ‡å®šç±»ä¸­é”€æ¯æ–¹æ³•çš„åç§°</p>
</li>
<li><p><code>lazy-init</code>ï¼šæŒ‡å®šä½¿ç”¨è¿›è¡Œå»¶è¿ŸåŠ è½½</p>
</li>
</ul>
<blockquote>
<p>æ³¨æ„: destory-method éœ€è¦é”€æ¯å®¹å™¨æ‰èƒ½ç”Ÿæ•ˆ,å¹¶ä¸”å¿…é¡»æ˜¯å•ä¾‹æ¨¡å¼</p>
</blockquote>
<p>å•ä¾‹å’Œå¤šä¾‹çš„åŒºåˆ«ï¼š</p>
<p><code>scope=&quot;singleton&quot;</code>ä¸€ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹ï¼ˆé»˜è®¤å€¼ï¼‰</p>
<ul>
<li>åˆ›å»ºå®¹å™¨æ—¶ï¼Œå¯¹è±¡å°±è¢«åˆ›å»ºäº†</li>
<li>åªè¦å®¹å™¨ä¸é”€æ¯ï¼Œå¯¹è±¡ä¸€ç›´å­˜åœ¨    </li>
<li>å½“å®¹å™¨é”€æ¯æ—¶ï¼Œå¯¹è±¡å°±è¢«é”€æ¯äº†</li>
</ul>
<p><code>scope=&quot;prototype&quot;</code>æ¯æ¬¡è®¿é—®è·å–å¯¹è±¡ï¼Œéƒ½ä¼šé‡æ–°åˆ›å»ºå¯¹è±¡å®ä¾‹ã€‚</p>
<ul>
<li>å½“ä»å®¹å™¨ä¸­è·å–å¯¹è±¡æ—¶ï¼Œåˆ›å»ºæ–°çš„å¯¹è±¡å®ä¾‹</li>
<li>åªè¦å¯¹è±¡åœ¨ä½¿ç”¨ä¸­ï¼Œå°±ä¸€ç›´å­˜åœ¨</li>
<li>å½“å¯¹è±¡é•¿æ—¶é—´ä¸ç”¨æ—¶ï¼Œè¢«javaçš„åƒåœ¾å›æ”¶å™¨å›æ”¶</li>
</ul>
<blockquote>
<p>æœ€åï¼Œç†è§£Spring IOCçš„ç‰¹ç‚¹ï¼Œæœ¬æ¥æ˜¯æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨åˆ›å»ºã€ç®¡ç†ã€ç»´æŠ¤çš„å¯¹è±¡ï¼Œç°åœ¨éƒ½äº¤ç»™äº†Springå®¹å™¨æ¥è¿›è¡Œæ“ä½œäº†ï¼Œæˆ‘ä»¬åªè¦åœ¨éœ€è¦ç”¨çš„æ—¶å€™å»å®¹å™¨ä¸­æ‹¿å°±å¯ä»¥äº†ã€‚</p>
</blockquote>
<h2 id="5-Spring-DI"><a href="#5-Spring-DI" class="headerlink" title="5.Spring DI"></a>5.Spring DI</h2><h3 id="5-1-æ¦‚è¿°"><a href="#5-1-æ¦‚è¿°" class="headerlink" title="5.1 æ¦‚è¿°"></a>5.1 æ¦‚è¿°</h3><blockquote>
<p>DI(Denpendency Injection)ï¼Œä¾èµ–æ³¨å…¥ï¼ŒSpringIOCå®¹å™¨ä¸­çš„æ ¸å¿ƒæ“ä½œï¼Œå¯ä»¥å°†å¯¹è±¡éœ€è¦çš„å±æ€§å€¼è‡ªåŠ¨æ³¨å…¥</p>
</blockquote>
<p>ä½¿ç”¨<code>&lt;bean&gt;</code>æ ‡ç­¾ï¼Œå¯ä»¥å°†ä¸€ä¸ªç±»é…ç½®åˆ°Springçš„IOCå®¹å™¨ä¸­ï¼Œå°†å…¶è¿›è¡Œå¯¹è±¡çš„ç®¡ç†å·¥ä½œï¼ŒåŒ…æ‹¬å¯¹è±¡çš„åˆ›å»ºã€å‡ºåˆå§‹åŒ–ã€é”€æ¯ç­‰ã€‚</p>
<p>å¦‚æœä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–éœ€è¦ä¾èµ–ä¸€äº›å±æ€§å€¼æˆ–è€…å…¶ä»–å¯¹è±¡ï¼Œé‚£ä¹ˆå°±Springä¸­çš„DIå°±å¯ä»¥å¸®æˆ‘ä»¬æ¥å®Œæˆå¯¹è±¡åˆå§‹åŒ–æ—¶å€™å±æ€§çš„ä¾èµ–æ³¨å…¥å·¥ä½œã€‚</p>
<p>ç‰¹åˆ«æ˜¯åœ¨ï¼Œé¡¹ç›®ä¸­æœ‰å¾ˆå¤šå¯¹è±¡ï¼Œå¹¶ä¸”å¯¹è±¡ä¹‹é—´è¿˜å­˜åœ¨ç€å„ç§ä¾èµ–å…³ç³»ï¼Œé‚£ä¹ˆspringIOCå®¹å™¨å°±å¯ä»¥å¸®æˆ‘ä»¬æ¥è¿›è¡Œç®¡ç†å’Œå»ºç«‹è¿™äº›å¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚</p>
<h3 id="5-2-setæ–¹æ³•æ³¨å…¥"><a href="#5-2-setæ–¹æ³•æ³¨å…¥" class="headerlink" title="5.2 setæ–¹æ³•æ³¨å…¥"></a>5.2 setæ–¹æ³•æ³¨å…¥</h3><p>1ã€POJOç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.ioc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Husband</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> salary;</span><br><span class="line">	<span class="keyword">private</span> Date date;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2ã€é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		property ç»™å±æ€§é‡‡ç”¨setæ–¹æ³•èµ‹å€¼</span></span><br><span class="line"><span class="comment">			name : å±æ€§åï¼Œè°ƒç”¨è¯¥å±æ€§çš„setæ–¹æ³•</span></span><br><span class="line"><span class="comment">			value: å±æ€§å€¼ï¼Œé€šè¿‡setæ–¹æ³•èµ‹å€¼</span></span><br><span class="line"><span class="comment">			ref: å±æ€§æ˜¯å…¶ä»–beanç±»å‹é‡‡ç”¨ref(å­—ç¬¦ä¸²é™¤å¤–)</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;hunsband&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.ioc.Hunsband&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;tom&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;salary&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2000&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;date&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;now&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;now&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.util.Date&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>3ã€æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Husband;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIoCTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">		Husband husband = (Husband) ac.getBean(<span class="string">&quot;husband&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(husband);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102015305848.png" alt="image-20201102015305848"></p>
<h3 id="5-3-æ„é€ å™¨æ³¨å…¥"><a href="#5-3-æ„é€ å™¨æ³¨å…¥" class="headerlink" title="5.3 æ„é€ å™¨æ³¨å…¥"></a>5.3 æ„é€ å™¨æ³¨å…¥</h3><p>1ã€POJO</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.ioc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Husband</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> salary;</span><br><span class="line">	<span class="keyword">private</span> Date date;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼š</p>
<p><code>@AllArgsConstructor</code>æ³¨è§£ï¼Œå¯ä»¥ç»™ç±»ä¸­è‡ªåŠ¨æ·»åŠ å…¨å‚æ„é€ å™¨</p>
<p><code>@NoArgsConstructor</code>æ³¨è§£ï¼Œå¯ä»¥ç»™ç±»ä¸­è‡ªåŠ¨æ·»åŠ æ— å‚æ„é€ å™¨</p>
<p>2ã€é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		constructor-arg è®©å±æ€§èµ‹å€¼é‡‡ç”¨æ„é€ å‡½æ•°èµ‹å€¼</span></span><br><span class="line"><span class="comment">			index: æŒ‡å®šå‚æ•°åœ¨æ„é€ å‡½æ•°ä¸­çš„ç´¢å¼•ä½ç½®</span></span><br><span class="line"><span class="comment">			type: æŒ‡å®šå‚æ•°åœ¨æ„é€ å‡½æ•°ä¸­çš„æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="comment">			name: æŒ‡å®šå‚æ•°åœ¨æ„é€ å‡½æ•°ä¸­çš„åå­—</span></span><br><span class="line"><span class="comment">			value: å…·ä½“çš„å‚æ•°å€¼</span></span><br><span class="line"><span class="comment">			ref: å¦‚æœéœ€è¦çš„æ•°æ®ä¸ºå…¶ä»–beanç±»å‹ï¼Œä½¿ç”¨ref</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;husband&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.ioc.Husband&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span>	</span><br><span class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mary&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span>	</span><br><span class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;salary&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3000&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span>	</span><br><span class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;date&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;now&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;now&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.util.Date&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨æ„é€ å™¨å‚æ•°çš„ä¸‹æ ‡è¿›è¡Œæ³¨å…¥ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;husband&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.ioc.Husband&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lucy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;5000&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;3&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;now&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;now&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.util.Date&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>





<p>3ã€æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Husband;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIoCTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">		Husband husband = (Husband) ac.getBean(<span class="string">&quot;husband&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(husband);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102015746518.png" alt="image-20201102015746518"></p>
<h3 id="5-4-åç§°ç©ºé—´æ³¨å…¥"><a href="#5-4-åç§°ç©ºé—´æ³¨å…¥" class="headerlink" title="5.4 åç§°ç©ºé—´æ³¨å…¥"></a>5.4 åç§°ç©ºé—´æ³¨å…¥</h3><p>1ã€POJOç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.ioc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Husband</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> salary;</span><br><span class="line">	<span class="keyword">private</span> Date date;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2ã€é…ç½®</p>
<p>xmlæ–‡ä»¶çš„æ·»åŠ påç§°ç©ºé—´çš„å£°æ˜ï¼Œè¿™é‡ŒpæŒ‡çš„çš„æ˜¯property</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201011222524796.png" alt="image-20201011222524796"></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span> </span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;husband&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.ioc.Husband&quot;</span> <span class="attr">p:id</span>=<span class="string">&quot;3&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;lucy&quot;</span> <span class="attr">p:salary</span>=<span class="string">&quot;4000&quot;</span> <span class="attr">p:date-ref</span>=<span class="string">&quot;now&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;now&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.util.Date&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>3ã€æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Husband;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIoCTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">		Husband husband = (Husband) ac.getBean(<span class="string">&quot;husband&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(husband);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102020150931.png" alt="image-20201102020150931"></p>
<blockquote>
<p>æ³¨æ„ï¼Œè¯¥æ–¹å¼åªæ˜¯ç®€åŒ–äº†ä¾èµ–æ³¨å…¥çš„é…ç½®ï¼Œå…¶å®æœ¬è´¨ä»ç„¶æ˜¯è°ƒç”¨ç±»ä¸­çš„setæ–¹æ³•å®ç°æ³¨å…¥åŠŸèƒ½</p>
</blockquote>
<h3 id="5-5-é›†åˆå±æ€§æ³¨å…¥"><a href="#5-5-é›†åˆå±æ€§æ³¨å…¥" class="headerlink" title="5.5 é›†åˆå±æ€§æ³¨å…¥"></a>5.5 é›†åˆå±æ€§æ³¨å…¥</h3><p>1ã€POJOç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.ioc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Entity</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String[] myStrs;</span><br><span class="line">	<span class="keyword">private</span> List&lt;String&gt; myList;</span><br><span class="line">	<span class="keyword">private</span> Set&lt;String&gt; mySet;</span><br><span class="line">	<span class="keyword">private</span> Map&lt;String, String&gt; myMap;</span><br><span class="line">	<span class="keyword">private</span> Properties myProps;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2ã€é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span> </span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;entity&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.ioc.Entity&quot;</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- æ³¨å…¥æ•°ç»„ --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;myStrs&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>AAA<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>BBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>CCC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- æ³¨å…¥List --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;myList&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>DDD<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>EEE<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>FFF<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">			</span><br><span class="line">		<span class="comment">&lt;!-- æ³¨å…¥Set --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mySet&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>GGG<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>KKK<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>LLL<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">				</span><br><span class="line">		<span class="comment">&lt;!-- æ³¨å…¥myMap --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;myMap&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!-- ä¿©ç§å½¢å¼éƒ½å¯ä»¥æ³¨å…¥ --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;tom&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;age&quot;</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">value</span>&gt;</span>20<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- æ³¨å…¥Properties --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;myProps&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;name&quot;</span>&gt;</span>mary<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;age&quot;</span>&gt;</span>30<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>3ã€æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Entity;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIoCTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		Entity entity = (Entity) ac.getBean(<span class="string">&quot;entity&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(entity);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102020821042.png" alt="image-20201102020821042"></p>
<h2 id="6-Springæ³¨è§£"><a href="#6-Springæ³¨è§£" class="headerlink" title="6.Springæ³¨è§£"></a>6.Springæ³¨è§£</h2><blockquote>
<p>springä¸­é™¤äº†ä½¿ç”¨xmlæ–¹å¼è¿›è¡Œæ³¨å…¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œæ³¨å…¥</p>
</blockquote>
<h3 id="6-1-ä½¿ç”¨"><a href="#6-1-ä½¿ç”¨" class="headerlink" title="6.1 ä½¿ç”¨"></a>6.1 ä½¿ç”¨</h3><p>1ã€POJOç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.ioc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Component</span> è¯¥æ³¨è§£åŠ åœ¨ç±»ä¸Šä»£è¡¨è¯¥ç±»éœ€è¦è®©Springå®¹å™¨å»åˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@Value</span>  ç”¨æ¥ç»™å±æ€§æ³¨å…¥æ•°æ®</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Value(&quot;1&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Value(&quot;tom&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Value(&quot;20&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2ã€é…ç½®</p>
<p>xmlæ–‡ä»¶çš„æ·»åŠ contextåç§°ç©ºé—´çš„å£°æ˜ï¼Œå·²ç»å…¶å¯¹å¯¹åº”schemaæ–‡ä»¶çš„å£°æ˜</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201012161118498.png" alt="image-20201012161118498"></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- é…ç½®è¦æ‰«æçš„æ³¨è§£åŒ… --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.briup.ioc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„çº¦æŸæœ‰ä¸‰å¤„åœ°æ–¹è¦ä¿®æ”¹</p>
</blockquote>
<p>3ã€å¼•å…¥jaråŒ…</p>
<p>ä½¿ç”¨è¯¥åŠŸèƒ½ï¼Œéœ€è¦é¢å¤–å¼•å…¥jaråŒ…ï¼šspring-aop-5.x.x.RELEASE.jar</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102022052966.png" alt="image-20201102022052966"></p>
<p>å¦åˆ™åœ¨è¿è¡Œçš„æ—¶å€™ä¼šæŠ¥é”™ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Caused by: java.lang.ClassNotFoundException: org.springframework.aop.TargetSource</span><br><span class="line">	at java.net.URLClassLoader.findClass(URLClassLoader.java:<span class="number">381</span>)</span><br><span class="line">	at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="number">424</span>)</span><br><span class="line">	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:<span class="number">331</span>)</span><br><span class="line">	at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="number">357</span>)</span><br><span class="line">	... <span class="number">25</span> more</span><br></pre></td></tr></table></figure>



<p>4ã€æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Teacher;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIoCTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		Teacher teacher = (Teacher) ac.getBean(<span class="string">&quot;teacher&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(teacher);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102022229321.png" alt="image-20201102022229321"></p>
<h3 id="6-2-å¸¸ç”¨"><a href="#6-2-å¸¸ç”¨" class="headerlink" title="6.2 å¸¸ç”¨"></a>6.2 å¸¸ç”¨</h3><p>Springä¸­å¸¸ç”¨çš„æ³¨è§£æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<ul>
<li><p><code>@Component</code></p>
<p>ä½œç”¨ï¼š</p>
<p>â€‹    è®©springå®¹å™¨æ¥ç®¡ç†å¯¹è±¡ï¼Œç›¸å½“äºåœ¨xmlä¸­é…ç½®ä¸€ä¸ªbeanã€‚</p>
<p>å±æ€§ï¼š</p>
<p>â€‹    value: æŒ‡å®šbeançš„åå­—ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤ä¸ºå½“å‰ç±»åä¸”é¦–å­—æ¯å°å†™</p>
</li>
<li><p><code>@Controller</code>,<code>@Service</code>,<code>@Repository</code></p>
<p>ä½œç”¨ï¼š</p>
<p>â€‹     åŠŸèƒ½ä¸<code>@Component</code>ä½œç”¨ä¸€æ ·ï¼Œåªä¸è¿‡å…¶è¯­ä¹‰æ›´åŠ æ˜ç¡®</p>
<p>â€‹    <code>@Controller</code> ä¸€èˆ¬ä½œç”¨äº è¡¨ç°å±‚</p>
<p>â€‹    <code>@Service</code> ä¸€èˆ¬ä½œç”¨äº ä¸šåŠ¡å±‚</p>
<p>â€‹    <code>@Repository</code> ä¸€èˆ¬ä½œç”¨äº æŒä¹…å±‚</p>
<p>å±æ€§ï¼š</p>
<p>â€‹    value : æŒ‡å®šbeançš„åå­—,å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤ä¸ºå½“å‰ç±»åï¼Œä¸”é¦–å­—æ¯å°å†™</p>
</li>
<li><p><code>@Value</code></p>
<p>ä½œç”¨ï¼š</p>
<p>â€‹    ç”¨äºç»™å±æ€§æ³¨å…¥åŸºæœ¬æ•°æ®ï¼Œæ­¤æ³¨è§£ä¸­è¿˜æ”¯æŒSpEL</p>
<p>å±æ€§ï¼š</p>
<p>â€‹    value :å…·ä½“çš„å±æ€§å€¼</p>
</li>
<li><p><code>@Autowaired</code></p>
<p>ä½œç”¨ï¼š</p>
<p>â€‹    è‡ªåŠ¨æŒ‰ç…§ç±»å‹æ³¨å…¥ï¼Œä½¿ç”¨æ³¨è§£æ³¨å…¥å±æ€§æ—¶ï¼Œsetæ–¹æ³•å¯ä»¥çœç•¥ï¼Œè¯¥æ³¨è§£åªèƒ½æ³¨å…¥beanç±»å‹ï¼Œå½“æœ‰å¤šä¸ªç›¸åŒç±»å‹æ—¶ï¼Œå°†beançš„åå­—ä½œä¸ºè¦æ³¨å…¥å¯¹è±¡çš„å±æ€§åï¼Œä¹Ÿå¯ä»¥æ³¨å…¥æˆåŠŸ</p>
</li>
<li><p><code>@Qualifier</code></p>
<p>ä½œç”¨ï¼š</p>
<p>â€‹        åœ¨<code>@Autowaired</code>æ³¨å…¥çš„åŸºç¡€ä¹‹ä¸Šï¼Œå†æŒ‰ç…§Beançš„åå­—æ³¨å…¥ã€‚åœ¨ç»™å±æ€§æ³¨å…¥æ•°æ®æ—¶ä¸èƒ½ç‹¬ç«‹ä½¿ç”¨ï¼Œå¿…é¡»å’Œ<code>@Autowaired</code>ä¸€èµ·ä½¿ç”¨</p>
</li>
</ul>
<p>  å±æ€§ï¼š</p>
<p>  â€‹    valueï¼šæŒ‡å®šbeançš„åå­—</p>
<ul>
<li><p><code>@Resource</code></p>
<p>ä½œç”¨ï¼š</p>
<p>â€‹        ç›´æ¥æŒ‰ç…§beançš„idæ³¨å…¥,åªèƒ½æ³¨å…¥beanç±»å‹</p>
<p>å±æ€§ï¼š</p>
<p>â€‹        name: beançš„åå­—</p>
</li>
<li><p><code>@Scope</code></p>
<p>ä½œç”¨ï¼š</p>
<p>â€‹    æŒ‡å®šbeançš„ä½œç”¨èŒƒå›´</p>
<p>å±æ€§ï¼š</p>
<p>â€‹    value: æŒ‡å®šèŒƒå›´å€¼</p>
<p>â€‹    å–å€¼ä¸ºï¼š <code>singleton</code>,<code>prototype</code>,<code>request</code>,<code>session</code>,<code>golbalsession</code></p>
</li>
<li><p><code>@PostConstruct</code></p>
<p>ä½œç”¨ï¼š</p>
<p>â€‹    æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•</p>
</li>
<li><p><code>@PreDestroy </code></p>
<p>ä½œç”¨ï¼š</p>
<p>â€‹    æŒ‡å®šé”€æ¯æ–¹æ³•</p>
</li>
</ul>
<h3 id="6-3-ç‰¹æ®Š"><a href="#6-3-ç‰¹æ®Š" class="headerlink" title="6.3  ç‰¹æ®Š"></a>6.3  ç‰¹æ®Š</h3><blockquote>
<p>å…¶å®ä¹Ÿå¯ä»¥å»æ‰xmlæ–‡ä»¶ï¼Œå…¨éƒ¨ä½¿ç”¨æ³¨è§£çš„æ–¹å¼å®ŒæˆICOå’ŒDIé…ç½®å’Œæ“ä½œï¼Œä½†æ˜¯éœ€è¦ä½¿ç”¨ä¸“é—¨çš„å®¹å™¨ç±»å‹ï¼šAnnotationConfigApplicationContext</p>
</blockquote>
<p>1ã€POJOç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.ioc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Value(&quot;1&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Value(&quot;tom&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Value(&quot;20&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œæ²¡æœ‰æŒ‡å®šTeacheråœ¨å®¹å™¨ä¸­åå­—ï¼Œé»˜è®¤æ˜¯ç±»åé¦–å­—æ¯å°å†™ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨å»æŒ‡å®š <code>@Component(&quot;teacher&quot;)</code></p>
</blockquote>
<p>2ã€æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.annataion;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnoTationTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> AnnotationConfigApplicationContext(<span class="string">&quot;com.briup.ioc&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		Teacher teacher = (Teacher) ac.getBean(<span class="string">&quot;teacher&quot;</span>);</span><br><span class="line">        </span><br><span class="line">		System.out.println(teacher);		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102025813812.png" alt="image-20201102025813812"></p>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨AnnotationConfigApplicationContextç±»å‹ä½œä¸ºå®¹å™¨å¯¹è±¡ï¼Œå…¶å‚æ•°æ˜¯è¦æ‰«æçš„åŒ…</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œè®°å¾—å¼•å…¥jaråŒ…spring-aop-5.x.x.RELEASE.jar</p>
</blockquote>
<p>==æ€è€ƒï¼Œå¦‚æœæ–°å¢ä¸€ä¸ªç±»Addressï¼Œç„¶åTeacherä¸­ä¾èµ–è¿™ä¸ªç±»çš„å¯¹è±¡ï¼Œé‚£ä¹ˆä½¿ç”¨xmlå’Œæ³¨è§£åˆ†åˆ«è¯¥æ€ä¹ˆé…ç½®ï¼Ÿ==</p>
<h3 id="6-4-æ–°å¢"><a href="#6-4-æ–°å¢" class="headerlink" title="6.4 æ–°å¢"></a>6.4 æ–°å¢</h3><blockquote>
<p>é™¤äº†ä»¥ä¸Šçš„å¸¸ç”¨æ³¨è§£ä¹‹å¤–ï¼Œspringä¸­è¿˜æ–°å¢çš„ä¸€äº›æ³¨è§£ç±»ï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›æ³¨è§£æ¥ä»£æ›¿ä¹‹å‰xmlçš„é…ç½®</p>
</blockquote>
<h3 id="6-1-Configuration"><a href="#6-1-Configuration" class="headerlink" title="6.1 @Configuration"></a>6.1 <code>@Configuration</code></h3><p>ä½œç”¨ï¼š</p>
<ul>
<li><p>ç”¨äºæŒ‡å®šå½“å‰ç±»æ˜¯ä¸€ä¸ªspringé…ç½®ç±»ï¼Œå½“åˆ›å»ºå®¹å™¨æ—¶ä¼šä»è¯¥ç±»ä¸ŠåŠ è½½æ³¨è§£</p>
</li>
<li><p>å¯ä»¥ä½¿ç”¨AnnotationConfigApplicationContext(é…ç½®ç±».class) åŠ è½½é…ç½®</p>
</li>
</ul>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Configuration</span></span></span><br><span class="line"><span class="comment"> * è¡¨ç¤ºå½“å‰ç±»æ˜¯springçš„ä¸€ä¸ªé…ç½®ç±»</span></span><br><span class="line"><span class="comment"> * ç›¸å½“äºä¹‹å‰çš„xmlï¼Œå¯ä»¥å®Œæˆå…¶å¯¹åº”çš„é…ç½®åŠŸèƒ½</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="6-2-ComponentScan"><a href="#6-2-ComponentScan" class="headerlink" title="6.2 @ComponentScan"></a>6.2 <code>@ComponentScan</code></h3><p>ä½œç”¨ï¼š</p>
<ul>
<li>ç”¨äºæŒ‡å®šspringåœ¨åˆå§‹åŒ–å®¹å™¨æ—¶è¦æ‰«æçš„åŒ…</li>
</ul>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Configuration</span></span></span><br><span class="line"><span class="comment"> * è¡¨ç¤ºå½“å‰ç±»æ˜¯springçš„ä¸€ä¸ªé…ç½®ç±»</span></span><br><span class="line"><span class="comment"> * ç›¸å½“äºä¹‹å‰çš„xmlï¼Œå¯ä»¥å®Œæˆå…¶å¯¹åº”çš„é…ç½®åŠŸèƒ½</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ComponentScan</span>(&quot;com.briup.ioc&quot;)</span></span><br><span class="line"><span class="comment"> * æ‰«æå½“å‰åŒ…å’ŒæŒ‡å®šåŒ…ä¸‹é¢çš„javaç±»ï¼Œå‘ç°å…¶ä¸­springæ³¨è§£</span></span><br><span class="line"><span class="comment"> * åŒ…å«æŒ‡å®šåŒ…ä¸‹é¢çš„å­åŒ…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.briup.ioc&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="6-3-Bean"><a href="#6-3-Bean" class="headerlink" title="6.3 @Bean"></a>6.3 <code>@Bean</code></h3><p>ä½œç”¨ï¼š</p>
<ul>
<li>è¯¥æ³¨è§£åªèƒ½å†™åœ¨æ–¹æ³•ä¸Šï¼Œè¡¨æ˜ä½¿ç”¨æ­¤æ–¹æ³•åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”æ”¾å…¥springå®¹å™¨</li>
</ul>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Teacher;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * ä¸€ä¸ª<span class="doctag">@Bean</span>æ³¨è§£å°±ç›¸å½“äºbeanæ ‡ç­¾</span></span><br><span class="line"><span class="comment">	 * æ–¹æ³•çš„è¿”å›å€¼å¯¹è±¡ä¼šå­˜å‚¨åœ¨Springå®¹å™¨ä¸­</span></span><br><span class="line"><span class="comment">	 * æ–¹æ³•åå°±æ˜¯è¯¥å¯¹è±¡åœ¨å®¹å™¨ä¸­çš„å”¯ä¸€æ ‡è¯† </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Teacher <span class="title">teacher</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Teacher();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šåå­—ï¼Œä¾‹å¦‚<code>@Bean(&quot;teacher&quot;)</code></p>
</blockquote>
<h3 id="6-4-PropertySource"><a href="#6-4-PropertySource" class="headerlink" title="6.4 @PropertySource"></a>6.4 <code>@PropertySource</code></h3><p>ä½œç”¨ï¼š</p>
<ul>
<li>ç”¨äºåŠ è½½<code>.properties</code>æ–‡ä»¶ä¸­çš„å€¼ï¼ŒåŠ è½½åå¯ä»¥ä½¿ç”¨ <code>@Value(&quot;$&#123;key&#125;&quot;)</code>çš„å½¢å¼æ¥è·å–</li>
</ul>
<p>ä¾‹å¦‚ï¼Œ</p>
<p>POJOç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.ioc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>é…ç½®ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.PropertySource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Teacher;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;my-value.properties&quot;)</span><span class="comment">//æŒ‡å®šè¦è¯»å–çš„èµ„æºæ–‡ä»¶ä½ç½®</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;teacher.id&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;teacher.name&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;teacher.age&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Bean(&quot;t&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Teacher <span class="title">teacher</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Teacher t = <span class="keyword">new</span> Teacher();</span><br><span class="line">		t.setId(id);</span><br><span class="line">		t.setName(name);</span><br><span class="line">		t.setAge(age);</span><br><span class="line">		<span class="keyword">return</span> t;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>propertiesæ–‡ä»¶ï¼šmy-value.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">teacher.id</span>=<span class="string">2</span></span><br><span class="line"><span class="meta">teacher.name</span>=<span class="string">mary</span></span><br><span class="line"><span class="meta">teacher.age</span>=<span class="string">30</span></span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.config.SpringConfig;</span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Teacher;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIoCTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//æŒ‡å®šè¦åŠ è½½çš„é…ç½®ç±»</span></span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> AnnotationConfigApplicationContext(SpringConfig.class);</span><br><span class="line">		</span><br><span class="line">		Teacher teacher = (Teacher) ac.getBean(<span class="string">&quot;t&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(teacher);	</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102030345032.png" alt="image-20201102030345032"></p>
<h3 id="6-5-Import"><a href="#6-5-Import" class="headerlink" title="6.5 @Import"></a>6.5 <code>@Import</code></h3><p>ä½œç”¨ï¼š</p>
<ul>
<li>ç”¨äºå¯¼å…¥å…¶ä»–é…ç½®ç±»</li>
<li>è¢«å¼•å…¥é…ç½®ç±»ä¸­ï¼Œå¯ä»¥ä¸ç”¨å†å†™<code>@Configuration</code>æ³¨è§£ã€‚å½“ç„¶ï¼Œå†™ä¸Šä¹Ÿæ²¡é—®é¢˜</li>
<li>ä¸€èˆ¬é¡¹ç›®ä¸­å†™äº†å¾ˆå¤šé…ç½®ç±»çš„æ—¶å€™ï¼Œå¯ä»¥å†å†™ä¸€ä¸ªæ€»çš„é…ç½®ç±»ï¼Œè¿™ä¸ªé…ç½®ç±»ä¸Šä½¿ç”¨<code>@Import</code>å»å¼•å…¥å…¶ä»–çš„é…ç½®ï¼Œå°†æ¥å®¹å™¨åªè¦è¯»å–è¿™ä¸ªä¸€ä¸ªæ€»çš„é…ç½®ç±»å³å¯</li>
</ul>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.PropertySource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Teacher;</span><br><span class="line"></span><br><span class="line"><span class="meta">@PropertySource(&quot;my-value.properties&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;teacher.id&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;teacher.name&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;teacher.age&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Bean(&quot;t&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Teacher <span class="title">teacher</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Teacher t = <span class="keyword">new</span> Teacher();</span><br><span class="line">		t.setId(id);</span><br><span class="line">		t.setName(name);</span><br><span class="line">		t.setAge(age);</span><br><span class="line">		<span class="keyword">return</span> t;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¯¥é…ç½®ç±»å°†ä¼šåœ¨å…¶ä»–é…ç½®ä¸­ä½¿ç”¨@Importå¼•å…¥ï¼Œæ‰€ä»¥å¯ä»¥ä¸æ·»åŠ @Configurationæ³¨è§£</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Import;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Import(value = &#123;SpringConfig.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¯¥é…ç½®ç±»åšä¸€ä¸ªæ€»çš„é…ç½®ï¼Œå¼•å…¥å…¶ä»–çš„é…ç½®</p>
</blockquote>
<p>æµ‹è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.config.AppConfig;</span><br><span class="line"><span class="keyword">import</span> com.briup.ioc.Teacher;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIoCTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		ApplicationContext ac = </span><br><span class="line">				<span class="keyword">new</span> AnnotationConfigApplicationContext(AppConfig.class);</span><br><span class="line">		</span><br><span class="line">		Teacher teacher = (Teacher) ac.getBean(<span class="string">&quot;t&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(teacher);	</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201102031229401.png" alt="image-20201102031229401"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶ä¹Ÿå¯ä»¥æ­£å¸¸çš„å®ŒæˆåŠŸèƒ½</p>
</blockquote>
<h3 id="6-6-æ€»ç»“"><a href="#6-6-æ€»ç»“" class="headerlink" title="6.6 æ€»ç»“"></a>6.6 æ€»ç»“</h3><p>åˆ°æ­¤ä½ç½®ï¼Œæˆ‘ä»¬å·²ç»è®¤è¯†äº†springä¸­çš„ä¸‰ç§é…ç½®æ–¹å¼ï¼š</p>
<ul>
<li>xmlé…ç½®</li>
<li>annotationé…ç½®</li>
<li>javaconfigé…ç½®</li>
</ul>
<p>1ã€xmlé…ç½®ï¼Œå¯ä»¥æŠŠé…ç½®ä¿¡æ¯éƒ½å†™åœ¨xmlä¸­ï¼Œæ–¹ä¾¿é˜…è¯»ã€ç»´æŠ¤å’Œä¿®æ”¹ã€‚</p>
<p>2ã€annotationé…ç½®ï¼Œå¯ä»¥ä½¿ç”¨æ³¨è§£æ¥ä»£æ›¿xmlä¸­çš„æ ‡ç­¾ï¼Œåœ¨javaä»£ç ä¸­é…ç½®ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ï¼Œä¼šè®©é…ç½®ä¿¡æ¯åˆ†æ•£åœ¨å„ä¸ªjavaç±»ä¸­ï¼Œè™½ç„¶ç®€åŒ–äº†xmlçš„ç¹çé…ç½®ï¼Œä½†æ˜¯ä¸æ–¹ä¾¿é˜…è¯»ã€ç»´æŠ¤å’Œä¿®æ”¹ã€‚</p>
<p>3ã€javaconfigé…ç½®ï¼Œä¸»è¦æ˜¯ä½¿ç”¨äº†<code>@Configuration</code>æ³¨è§£ï¼Œæ¥ä»£æ›¿åŸæ¥çš„xmlé…ç½®ï¼Œå¯ä»¥å°†é…ç½®ä¿¡æ¯è¾ƒä¸º<strong>é›†ä¸­</strong>çš„å†™åœ¨ä¸€ä¸ªjavaç±»ä¸­ï¼Œå¹¶ä¸”è¿˜æä¾›äº†ç›¸å…³çš„é…å¥—çš„å…¶ä»–æ³¨è§£ç±»ï¼Œè§£å†³äº†ä½¿ç”¨æ™®é€šæ³¨è§£é…ç½®çš„ä¸€äº›é—®é¢˜ã€‚åŒæ—¶å°†æ¥é…åˆ<strong>æ¡ä»¶æ³¨è§£</strong>å¯ä»¥å®Œæˆä¸€äº›é«˜çº§çš„é…ç½®åŠŸèƒ½ã€‚ä¾‹å¦‚springbootä¸­ä½¿ç”¨çš„è‡ªåŠ¨é…ç½®ç­‰</p>
<blockquote>
<p>æ³¨æ„ï¼Œæ ¹æ®å½“å‰é¡¹ç›®çš„æƒ…å†µï¼Œçµæ´»çš„é€‰æ‹©åˆé€‚çš„é…ç½®æ–¹å¼ï¼Œå¦‚æœæœ‰éœ€è¦ä¹Ÿå¯ä»¥å°†å¤šç§é…ç½®æ–¹å¼æ··åˆä½¿ç”¨</p>
</blockquote>
<h1 id="springmvc"><a href="#springmvc" class="headerlink" title="springmvc"></a>springmvc</h1><h2 id="2-Spring-Web-MVC"><a href="#2-Spring-Web-MVC" class="headerlink" title="2 Spring Web MVC"></a>2 Spring Web MVC</h2><h3 id="2-1-æ¦‚è¿°"><a href="#2-1-æ¦‚è¿°" class="headerlink" title="2.1 æ¦‚è¿°"></a>2.1 æ¦‚è¿°</h3><p>SpringWebMVCç®€ç§°SpringMVCï¼Œå®ƒæ˜¯Spring Frameworkæ¡†æ¶ä¸­æä¾›çš„ä¸€ä¸ªæ¨¡å—,é€šè¿‡å®ç°MVCæ¨¡å¼æ¥å¾ˆå¥½åœ°å°†æ•°æ®ã€ä¸šåŠ¡ä¸å±•ç°è¿›è¡Œåˆ†ç¦»ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201109094601635.png" alt="image-20201109094601635"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201109094646288.png" alt="image-20201109094646288"></p>
<blockquote>
<p>æ³¨æ„ï¼ŒSpringMVCæ¡†æ¶çš„ç›®çš„æ˜¯è¦ç®€åŒ–æˆ‘ä»¬æ—¥å¸¸çš„Webå¼€å‘</p>
</blockquote>
<p>SpringMVCçš„å‡ ä¸ªç‰¹ç‚¹ï¼š</p>
<ul>
<li><p>SpringMVCæ¡†æ¶è·Ÿå…¶ä»–çš„WebMVCæ¡†æ¶ä¸€æ ·,éƒ½æ˜¯è¯·æ±‚é©±åŠ¨ã€‚</p>
</li>
<li><p>SpringMVCæ¡†æ¶è®¾è®¡å¹¶å›´ç»•ä¸€ä¸ªèƒ½å¤Ÿåˆ†å‘è¯·æ±‚åˆ°æ§åˆ¶å™¨çš„æ ¸å¿ƒServlet(DispatcherServlet,å³å‰ç«¯æ§åˆ¶å™¨)ã€‚</p>
</li>
<li><p>SpringMVCæ¡†æ¶å’Œspringçš„IOCå®¹å™¨å®Œå…¨æ•´åˆ,å¹¶ä¸”å…è®¸ä½¿ç”¨springä¸­å…¶ä»–çš„æ‰€æœ‰åŠŸèƒ½ã€‚</p>
</li>
<li><p>SpringMVCæ¡†æ¶è®¾è®¡çš„ä¸€ä¸ªæ ¸å¿ƒçš„åŸåˆ™å°±æ˜¯â€å¼€é—­åŸåˆ™â€,å¯¹æ‰©å±•å¼€æ”¾,å¯¹ä¿®æ”¹å…³é—­ã€‚æ‰€ä»¥SpringMVCæ¡†æ¶ä¸­å¾ˆå¤šæ–¹æ³•éƒ½æ˜¯finalçš„,ä¸å…è®¸ç”¨æˆ·éšæ„è¦†ç›–,ä½†æ˜¯å´æä¾›ç»™ç”¨æˆ·å¾ˆå¤šå¯æ‰©å±•çš„æœºåˆ¶ã€‚</p>
</li>
<li><p>SpringMVCæ¡†æ¶ç›®å‰å·²ç»æˆä¸ºéå¸¸æµè¡Œçš„webåº”ç”¨çš„æ¡†æ¶ã€‚</p>
</li>
</ul>
<h3 id="2-1-è·å–"><a href="#2-1-è·å–" class="headerlink" title="2.1 è·å–"></a>2.1 è·å–</h3><p>ç”±äºSpringMVCæ˜¯Springæ¡†æ¶ä¸­çš„ä¸€ä¸ªæ¨¡å—,æ‰€ä»¥æˆ‘ä»¬ä¸‹è½½Springæ¡†æ¶å³å¯,å› ä¸ºé‡Œé¢åŒ…å«äº†Springæ¡†æ¶çš„å„ä¸ªæ¨¡å—çš„ç›¸å…³ä¸œè¥¿,å½“ç„¶ä¹ŸåŒ…å«äº†SpringMVCçš„(jaråŒ…ã€APIæ–‡æ¡£ã€è¯´æ˜æ–‡æ¡£ã€æºä»£ç ç­‰)</p>
<p>SpringMVCæ¡†æ¶çš„jaråŒ…åˆ†ä¸ºå››éƒ¨åˆ†ï¼š</p>
<p>1ã€webåŠwebmvcçš„jaråŒ…ï¼ˆå¿…é€‰ï¼‰</p>
<ul>
<li>spring-web-x.x.x.RELEASE</li>
<li>spring-webmvc-x.x.x.RELEASE</li>
</ul>
<p>2ã€Springæ¡†æ¶çš„æ ¸å¿ƒæ¨¡å—çš„jaråŒ…ï¼ˆå¿…é€‰ï¼‰</p>
<ul>
<li>spring-beans-x.x.x.RELEASE</li>
<li>spring-core-x.x.x.RELEASE</li>
<li>spring-context-x.x.x.RELEASE</li>
<li>spring-expression-x.x.x.RELEASE</li>
<li>spring-aop-x.x.x.RELEASE</li>
</ul>
<p>3ã€æ—¥å¿—çš„jaråŒ…ï¼ˆå¯é€‰ï¼‰</p>
<ul>
<li>commons-logging-x.x</li>
<li>log4j-x.x.x</li>
</ul>
<p>4ã€å…¶ä»–ï¼ˆå¯é€‰ï¼‰</p>
<ul>
<li>jstl-1.2.jar ï¼ˆå¦‚æœä½¿ç”¨jspçš„è¯ï¼Œå¿…é¡»å¼•å…¥ï¼‰ </li>
</ul>
<h3 id="2-3-ç»„ä»¶"><a href="#2-3-ç»„ä»¶" class="headerlink" title="2.3 ç»„ä»¶"></a>2.3 ç»„ä»¶</h3><p>SpringMVCä¸­çš„æ ¸å¿ƒç»„ä»¶ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li><p><code>DispatcherServlet</code></p>
<p>å‰ç«¯æ§åˆ¶å™¨ã€‚ç”¨æ¥è¿‡æ»¤å®¢æˆ·ç«¯å‘é€è¿‡æ¥,æƒ³è¦è¿›è¡Œé€»è¾‘å¤„ç†çš„è¯·æ±‚</p>
</li>
<li><p><code>Controller/Headler</code></p>
<p>æ§åˆ¶å™¨/å¤„ç†å™¨ã€‚å¼€å‘äººå‘˜è‡ªå®šä¹‰,ç”¨æ¥å¤„ç†ç”¨æˆ·è¯·æ±‚çš„,å¹¶ä¸”å¤„ç†å®Œæˆä¹‹åè¿”å›ç»™ç”¨æˆ·æŒ‡å®šè§†å›¾çš„å¯¹è±¡</p>
<p>ç›¸å½“äºæˆ‘ä»¬ä¹‹å‰ç¼–å†™çš„Servlet</p>
</li>
<li><p><code>HandlerMapping</code></p>
<p>å¤„ç†å™¨æ˜ å°„å™¨ï¼ˆç®€ç§°æ˜ å°„å™¨ï¼‰ã€‚DispatcherServletæ¥æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚çš„URLä¹‹å,æ ¹æ®ä¸€å®šçš„åŒ¹é…è§„åˆ™,å†æŠŠè¯·æ±‚è½¬å‘ç»™å¯¹åº”çš„Handler,è¿™ä¸ªåŒ¹é…è§„åˆ™ç”±<code>HandlerMapping</code>å†³å®š</p>
</li>
<li><p><code>HandlerAdaptor</code></p>
<p>å¤„ç†å™¨é€‚é…å™¨ï¼ˆç®€ç§°é€‚é…å™¨ï¼‰ã€‚ç”¨æ¥é€‚é…æ¯ä¸€ä¸ªè¦æ‰§è¡Œçš„Handlerå¯¹è±¡ã€‚é€šè¿‡HandlerAdapterå¯ä»¥æ”¯æŒä»»æ„çš„ç±»ä½œä¸ºå¤„ç†å™¨ã€‚ä½œç”¨æ˜¯å‘Šè¯‰SpringMVCæ¡†æ¶ï¼Œå°†æ¥éœ€è¦è°ƒç”¨Controllerä¸­çš„å“ªä¸€ä¸ªæ–¹æ³•ã€‚</p>
</li>
<li><p><code>ViewResolver</code></p>
<p>è§†å›¾è§£æå™¨ï¼ˆç®€ç§°è§£æå™¨ï¼‰ã€‚Controller/Headlerè¿”å›çš„æ˜¯é€»è¾‘è§†å›¾å,éœ€è¦æœ‰ä¸€ä¸ªè§£æå™¨èƒ½å¤Ÿå°†é€»è¾‘è§†å›¾åè½¬æ¢æˆå®é™…çš„ç‰©ç†è§†å›¾ã€‚ä¾‹å¦‚ï¼ŒControllerä¸­è¿”å›çš„é€»è¾‘è§†å›¾åå­—ä¸ºâ€helloâ€ï¼Œè§£æå™¨å¯ä»¥ç»™è¿™ä¸ªé€»è¾‘è§†å›¾åè½¬æ¢ä¸ºçœŸæ­£çš„ç‰©ç†è§†å›¾åï¼Œä¾‹å¦‚åŠ å…¥å‰ç¼€å’Œåç¼€ï¼š/WEB-INF/jsp/hello.jsp</p>
<p>SpringMVCçš„å¯æ‰©å±•æ€§ï¼Œå†³å®šäº†è§†å›¾å¯ä»¥æœ‰å¾ˆå¤šç§,æ‰€ä»¥ä¸åŒçš„æƒ…å†µä¸‹éœ€è¦ä¸åŒçš„è§†å›¾è§£æå™¨ï¼Œä¾‹å¦‚ä½¿ç”¨jspå……å½“è§†å›¾çš„æ—¶å€™ï¼Œå°±éœ€è¦ä½¿ç”¨ä¸“é—¨çš„jspè§£æå™¨</p>
</li>
</ul>
<p>å½“ä¸€ä¸ªè¯·æ±‚è¿›æ¥ä¹‹å‰ï¼ŒSpringMVCä¸­çš„æ ¸å¿ƒç»„ä»¶ä¼šä¸€èµ·é…åˆæ¥å®Œæˆæœ¬æ¬¡è¯·æ±‚çš„å¤„ç†ï¼š</p>
<ol>
<li>è¯·æ±‚è¢«å‰ç«¯æ§åˆ¶å™¨ï¼ˆDispatcherServletï¼‰æ¥æ”¶åˆ°</li>
<li>å‰ç«¯æ§åˆ¶å™¨ï¼ˆDispatcherServletï¼‰æ ¹æ®æ˜ å°„å™¨ï¼ˆHandlerMappingï¼‰ä¸­é…ç½®çš„æ˜ å°„å…³ç³»ï¼Œå°†è¿™ä¸ªè¯·æ±‚è½¬äº¤ç»™çœŸæ­£èƒ½å¤Ÿå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„å¤„ç†å™¨ï¼ˆController/Headlerï¼‰</li>
<li>å¤„ç†å™¨ï¼ˆController/Headlerï¼‰é€šè¿‡é€‚é…å™¨ï¼ˆHandlerAdaptorï¼‰ï¼Œæ‰§è¡ŒæŒ‡å®šæ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œå®Œæˆåè¿”å›ç»™ç”¨æˆ·ModelAndViewï¼ˆæ¨¡å‹å’Œè§†å›¾çš„ç»“åˆä½“ï¼‰</li>
<li>è§†å›¾è§£æå™¨ï¼ˆViewResolverï¼‰æ ¹æ®ModelAndViewä¸­çš„é€»è¾‘è§†å›¾åæ‰¾åˆ°çœŸæ­£çš„ç‰©ç†è§†å›¾</li>
<li>ä½¿ç”¨ModelAndViewä¸­çš„æ¨¡å‹å¯¹è§†å›¾è¿›è¡Œæ¸²æŸ“</li>
</ol>
<p>å¦‚å›¾1ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/SpringMVC_work_flow.png" alt="SpringMVC_work_flow"></p>
<p>å¦‚å›¾2ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201109102752002.png" alt="image-20201109102752002"></p>
<p>å¦‚å›¾3ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20201109102819924.png" alt="image-20201109102819924"></p>
<blockquote>
<p>æ³¨æ„ï¼Œä»¥ä¸Šä¸‰ä¸ªå›¾å½¢ï¼Œæè¿°çš„éƒ½æ˜¯åŒä¸€ä»¶äº‹æƒ…ï¼Œå°±æ˜¯SpringMVCå¦‚ä½•å¤„ç†ä¸€ä¸ªè¯·æ±‚</p>
</blockquote>
<h2 id="3-é¡¹ç›®æ­å»º"><a href="#3-é¡¹ç›®æ­å»º" class="headerlink" title="3 é¡¹ç›®æ­å»º"></a>3 é¡¹ç›®æ­å»º</h2><p>pom </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp.jstl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>web.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æŒ‡å®šspringmvcåœ¨é¡¹ç›®å¯åŠ¨æ—¶ï¼Œè¯»å–æ–°çš„é…ç½®æ–‡ä»¶ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:mvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>mvc.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šspringæ‰«æçš„åŒ…è·¯å¾„ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.briup.springmvc.web.controller&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼€å¯springmvcçš„æ³¨è§£åŠŸèƒ½ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®é™æ€èµ„æºä¸è¢«æ‹¦æˆª --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="comment">//@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(HttpServletRequest request)</span></span>&#123;</span><br><span class="line">        String username = request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="springboot"><a href="#springboot" class="headerlink" title="springboot"></a>springboot</h1><h2 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h2><blockquote>
<p>Spring Bootæ˜¯ç”±Pivotalå›¢é˜Ÿæä¾›çš„å…¨æ–°æ¡†æ¶ï¼Œå…¶è®¾è®¡ç›®çš„æ˜¯ç”¨æ¥ç®€åŒ–æ–°Springåº”ç”¨çš„åˆå§‹æ­å»ºä»¥åŠå¼€å‘è¿‡ç¨‹ã€‚è¯¥æ¡†æ¶ä½¿ç”¨äº†ç‰¹å®šçš„æ–¹å¼æ¥è¿›è¡Œé…ç½®ï¼Œä»è€Œä½¿å¼€å‘äººå‘˜ä¸å†éœ€è¦å®šä¹‰æ ·æ¿åŒ–çš„é…ç½®ã€‚</p>
</blockquote>
<p><strong>springboot</strong>çš„ç‰¹ç‚¹ï¼š</p>
<ol>
<li><p>åˆ›å»ºç‹¬ç«‹çš„Springåº”ç”¨ç¨‹åº</p>
</li>
<li><p>åµŒå…¥çš„Tomcatï¼Œæ— éœ€éƒ¨ç½²WARæ–‡ä»¶</p>
</li>
<li><p>ç®€åŒ–Mavené…ç½®</p>
</li>
<li><p>è‡ªåŠ¨é…ç½®Spring</p>
</li>
<li><p>æä¾›ç”Ÿäº§å°±ç»ªå‹åŠŸèƒ½ï¼Œå¦‚æŒ‡æ ‡ï¼Œå¥åº·æ£€æŸ¥å’Œå¤–éƒ¨é…ç½®</p>
</li>
<li><p>æ²¡æœ‰ä»£ç ç”Ÿæˆå’Œå¯¹XMLæ²¡æœ‰è¦æ±‚é…ç½®</p>
</li>
<li><p>çº¦å®šä¼˜äºé…ç½®</p>
</li>
</ol>
<p><strong>springboot</strong>çš„ä¼˜ç‚¹ï¼š</p>
<ol>
<li><p>spring boot å¯ä»¥å¿«é€Ÿçš„å¼€å‘å‡º restful é£æ ¼çš„ç³»ç»Ÿæ¶æ„ã€‚</p>
</li>
<li><p>æ–¹ä¾¿çš„è‡ªåŠ¨åŒ–ï¼Œéå¸¸é€‚åˆåšå¾®æœåŠ¡æ¶æ„çš„æ­å»º</p>
</li>
<li><p>å•ä¸€jaråŒ…è¿è¡Œçš„æ–¹å¼è®©éƒ¨ç½²å’Œç®¡ç†ä¹Ÿéå¸¸æ–¹ä¾¿ã€‚</p>
</li>
<li><p>é™¤äº†ç²¾ç®€é…ç½®è¿™æ–¹é¢, å¦å¤–è¿˜å¯ä»¥è®©springç”Ÿæ€åœˆå’Œå…¶ä»–å·¥å…·é“¾è¿›è¡Œæ–¹ä¾¿å¿«é€Ÿçš„æ•´åˆ(æ¯”å¦‚redis, email, hibernate,mybatis,amqpç­‰)</p>
</li>
</ol>
<p><a href="https://spring.io/">springå®˜ç½‘</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519092628202.png" alt="image-20200519092628202"></p>
<p><strong>springbootæ˜¯springçš„ä¸€ä¸ªé¡¶çº§é¡¹ç›®</strong>ï¼š</p>
<blockquote>
<p>æˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„springæ ¸å¿ƒï¼Œå…¶å®æ˜¯spring-frameworkï¼Œè¿™ä¸ªæ˜¯å…¶ä»–æ‰€æœ‰springé¡¹ç›®çš„åŸºç¡€ã€‚</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519092803832.png" alt="image-20200519092803832"></p>
<p><strong>springbootç›¸å…³çš„é¡µé¢ï¼š</strong></p>
<blockquote>
<p>CURRENTè¡¨ç¤ºå½“å‰springbootæ¨èä½¿ç”¨çš„æœ€æ–°ç‰ˆæœ¬ã€‚</p>
<p>General Availabilityï¼ˆGAï¼‰è¡¨ç¤ºæ­£å¼å‘å¸ƒçš„ç‰ˆæœ¬ï¼Œå®˜æ–¹å¼€å§‹æ¨èå¹¿æ³›ä½¿ç”¨ï¼Œæœ‰æ—¶å€™ä¹Ÿä¼šç”¨releaseç‰ˆæœ¬è¡¨ç¤ºã€‚</p>
<p>SNAPSHOTè¡¨ç¤ºå¿«ç…§ç‰ˆï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œä½†è¯¥ç‰ˆæœ¬ä»åœ¨ç»§ç»­æ”¹è¿›ã€‚</p>
<p>Reference Doc å®˜æ–¹æä¾›çš„springbootå‚è€ƒæŒ‡å—ã€‚ï¼ˆ<strong>å¾ˆé‡è¦</strong>ï¼‰</p>
<p>API Doc å®˜æ–¹æä¾›çš„apiæ–‡æ¡£ï¼Œç±»ä¼¼äºåˆšå¼€å§‹å­¦ä¹ javaæ—¶ä½¿ç”¨çš„javase-apiæ–‡æ¡£ã€‚</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519093710955.png" alt="image-20200519093710955"></p>
<p><strong>å¿«é€Ÿåˆ›å»ºspringbooté¡¹ç›®çš„æ–¹å¼ï¼š</strong>  spring initializr æ˜¯å®˜ç½‘æä¾›çš„å¿«é€Ÿåˆ›å»ºspringbooté¡¹ç›®çš„å¼•å¯¼ç¨‹åºã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519095709591.png" alt="image-20200519095709591"></p>
<p><strong>é€šè¿‡å¯¹ä»¥ä¸‹å‡ é¡¹å†…å®¹çš„é€‰æ‹©å’Œå¡«å†™ï¼Œå°±å¯ä»¥å¯¼å‡ºä¸€ä¸ªæ­å»ºå¥½çš„springbooté¡¹ç›®ï¼Œæˆ‘ä»¬åç»­çš„ä»£ç åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ·»åŠ å’Œè°ƒæ•´å³å¯ï¼š</strong> å‡ ä¹æ‰€æœ‰çš„åœ°æ–¹éƒ½æœ‰é»˜è®¤çš„é€‰æ‹©å’Œå€¼ï¼Œå¯ä»¥ç›´æ¥å¯¼å‡ºé¡¹ç›®ä»£ç ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519100909061.png" alt="image-20200519100909061"></p>
<p>å¯¼å‡ºä»£ç ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519100929634.png" alt="image-20200519100929634"></p>
<h2 id="äºŒã€springbooté¡¹ç›®"><a href="#äºŒã€springbooté¡¹ç›®" class="headerlink" title="äºŒã€springbooté¡¹ç›®"></a>äºŒã€springbooté¡¹ç›®</h2><h3 id="1-pomæ–‡ä»¶"><a href="#1-pomæ–‡ä»¶" class="headerlink" title="1.pomæ–‡ä»¶"></a>1.pomæ–‡ä»¶</h3><p>â€‹        springbooté¡¹ç›®æœ€æ ¸å¿ƒçš„æ˜¯å…¶mavenå·¥ç¨‹ä¸­çš„pomæ–‡ä»¶çš„ç¼–å†™ï¼Œæˆ‘ä»¬æœ‰å¤šç§æ–¹å¼å¯ä»¥åœ¨mavenä¸­æ„å»ºä¸€ä¸ªspringbooté¡¹ç›®ã€‚</p>
<p>â€‹        springbooté¡¹ç›®ä¸­çš„pomæ–‡ä»¶ï¼ŒæŒ‰ç…§å®˜æ–¹è¦æ±‚ï¼Œä¸€èˆ¬éœ€è¦åœ¨åŸºæœ¬çš„pomé…ç½®ä¸­æ·»åŠ é¢å¤–å‡ ä¸ªåœ°æ–¹:</p>
<ol>
<li><p><strong>ç»§æ‰¿Springbootæä¾›çš„ä¸€ä¸ªçˆ¶é¡¹ç›®ã€‚</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519104909102.png" alt="image-20200519104909102"></p>
<p>springbootå®˜æ–¹æ¨èæˆ‘ä»¬ä½¿ç”¨spring-boot-starter-parentï¼Œåœ¨spring-boot-starter-parentä¸­åŒ…å«äº†ä»¥ä¸‹ä¿¡æ¯:</p>
<ul>
<li><p>Javaç‰ˆæœ¬</p>
</li>
<li><p>é¡¹ç›®ç¼–ç </p>
</li>
<li><p>æµ‹è¯•æ¡†æ¶</p>
</li>
<li><p>èµ„æºè¿‡æ»¤</p>
</li>
<li><p>æ’ä»¶é…ç½®</p>
<p>ã€‚ã€‚ã€‚</p>
<p>ä¹Ÿå¯ä»¥è‡ªå·±åœ¨pomä¸­è¦†ç›–è¿™äº›é»˜è®¤å€¼ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519105512655.png" alt="image-20200519105512655"></p>
</li>
</ul>
</li>
<li><p><strong>æ ¹æ®éœ€æ±‚æ·»åŠ å¯¹åº”å¯åŠ¨å™¨starterçš„ä¾èµ–ã€‚</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519104926713.png" alt="image-20200519104926713"></p>
<p>springbootä¸­æä¾›äº†å¾ˆå¤šå¯é€‰çš„å¯åŠ¨å™¨starterï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519110002121.png" alt="image-20200519110002121"></p>
<p>springbootçš„å¯åŠ¨å™¨ starterä¸»è¦ç”¨æ¥ç®€åŒ–ä¾èµ–ç”¨çš„ï¼Œä¾‹å¦‚åŸæ¥åœ¨mavené¡¹ç›®ä¸­éœ€è¦ä½¿ç”¨webç›¸å…³çš„åŠŸèƒ½å’Œæ¡†æ¶ï¼Œé‚£ä¹ˆå°±è¦å¼•å…¥å¯¹åº”çš„ä¸€äº›webç›¸å…³çš„ä¾èµ–ï¼Œå¹¶ä¸”éœ€è¦è‡ªå·±å»æ‰¾è¿™äº›ä¾èµ–çš„åæ ‡å’Œç‰ˆæœ¬ï¼Œä½†æ˜¯springbootä¸­åªéœ€è¦å¼•å…¥ä¸€ä¸ªstarterå°±è¡Œäº†ï¼šspring-boot-starter-webã€‚</p>
<p>starterä¼šæŠŠä½ éœ€è¦çš„ç›¸å…³jaråŒ…å…¨éƒ¨å…³è”åˆ°ä¾èµ–ä¸­ã€‚åœ¨eclipseä¸­çš„ä¾èµ–æ ‘ä¸­å¯ä»¥çœ‹åˆ°è¿™ä¸ªwebç›¸å…³çš„starteråŒ…å«äº†å“ªäº›ä¾èµ–:</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519110658582.png" alt="image-20200519110658582"></p>
<p>ä¸€ä¸ªwebç›¸å…³çš„starterçš„ä¾èµ–å£°æ˜ï¼ŒåŸºæœ¬è§£å†³äº†é¡¹ç›®ä¸­ä¸€èˆ¬webæ¨¡å—åŠŸèƒ½æ‰€ä¾èµ–jarçš„ç®¡ç†ã€‚</p>
<p>å½“ç„¶ï¼Œå¦‚æœæ›´æ¢starterä¸­é»˜è®¤çš„ä¾èµ–ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä¾‹å¦‚ï¼Œspring-boot-starter-webä¸­é»˜è®¤ä½¿ç”¨çš„æ˜¯å†…åµŒçš„tomcatæœåŠ¡å™¨ï¼Œå¯ä»¥æ›¿æ¢ä¸ºjettyæœåŠ¡å™¨,å…·ä½“å¦‚ä¸‹ï¼š ==å…ˆæ’é™¤ä¸ç”¨çš„é»˜è®¤ä¾èµ–ï¼Œåœ¨æ‰‹åŠ¨æ·»åŠ è‡ªå·±éœ€è¦çš„ä¾èµ–ã€‚==</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519111147673.png" alt="image-20200519111147673"></p>
<p>spring-boot-starter æ˜¯æ ¸å¿ƒå¯åŠ¨å™¨ï¼Œå…¶ä»–å¯åŠ¨å™¨çš„åå­—éƒ½æ˜¯è¿™æ ·çš„è§„å¾‹ï¼šspring-boot-starter-xxxï¼Œå…¶ä¸­è¿™ä¸ªxxxå°±è¡¨ç¤ºè¯¥å¯åŠ¨å™¨æ³¨æ„è´Ÿè´£çš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Œä¾‹å¦‚ï¼šspring-boot-starter-jdbcã€spring-boot-starter-webã€spring-boot-starter-redisã€spring-boot-starter-aopã€spring-boot-starter-cacheç­‰ç­‰ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼Œå¾ˆå¤šå¯åŠ¨å™¨ä¸­éƒ½åŒ…å«äº†æ ¸å¿ƒå¯åŠ¨å™¨ï¼šspring-boot-starterï¼Œæ‰€ä»¥spring-boot-starterä¸éœ€è¦åå¤å¤šæ¬¡å¼•å…¥ã€‚</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519111902161.png" alt="image-20200519111902161"></p>
</li>
<li><p><strong>é…ç½®springbootçš„mavenæ’ä»¶ã€‚</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519104938006.png" alt="image-20200519104938006"></p>
<p>springbootçš„Mavenæ’ä»¶ï¼ˆSpring Boot Maven pluginï¼‰èƒ½å¤Ÿä»¥Mavençš„æ–¹å¼ä¸ºåº”ç”¨æä¾›springbootçš„æ”¯æŒï¼Œå³ä¸ºSpring Bootåº”ç”¨æä¾›äº†æ‰§è¡ŒMavenæ“ä½œçš„å¯èƒ½ã€‚è¯¥æ’ä»¶èƒ½å¤Ÿå°†Spring Bootåº”ç”¨æ‰“åŒ…ä¸ºå¯æ‰§è¡Œçš„jaræˆ–waræ–‡ä»¶ï¼Œç„¶åä»¥æ™®é€šçš„jaråŒ…æ–¹å¼è¿è¡Œspringbootåº”ç”¨ã€‚</p>
<p>Spring Boot Maven pluginçš„5ä¸ªGoalsï¼š</p>
<ul>
<li><p><strong>spring-boot:repackage</strong>ï¼Œé»˜è®¤goalã€‚</p>
<p>åœ¨mvn packageä¹‹åï¼Œå†æ¬¡è‡ªåŠ¨æ‰“åŒ…æˆå¯æ‰§è¡Œçš„jar/warï¼ŒåŒæ—¶ä¿ç•™mvn packageç”Ÿæˆçš„jar/waræ–‡ä»¶ä¸º.originç»“å°¾çš„æ–‡ä»¶ã€‚</p>
</li>
<li><p><strong>spring-boot:run</strong></p>
<p>æ¯”è¾ƒå¸¸ç”¨ï¼Œæ˜¯è¿è¡Œspringbooté¡¹ç›®çš„æ–¹å¼ä¹‹ä¸€ã€‚</p>
</li>
<li><p>spring-boot:start</p>
<p>åœ¨mvn integration-testé˜¶æ®µï¼Œè¿›è¡ŒSpring Bootåº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ã€‚</p>
</li>
<li><p>spring-boot:stop</p>
<p>åœ¨mvn integration-testé˜¶æ®µï¼Œè¿›è¡ŒSpring Bootåº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ã€‚</p>
</li>
<li><p>spring-boot:build-info</p>
<p>ç”ŸæˆActuatorä½¿ç”¨çš„æ„å»ºä¿¡æ¯æ–‡ä»¶build-info.propertiesã€‚</p>
</li>
</ul>
<p>å¯¹äºé»˜è®¤çš„Goalsï¼Œspring-boot:repackageï¼Œåœ¨è¿è¡Œmavençš„æ‰“åŒ…packageå‘½ä»¤åä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œå¹¶ä¸”å¦‚æœæ˜¯javaé¡¹ç›®(éweb),åœ¨<strong>æŒ‡å®šç¨‹åºå…¥å£</strong>å(start-class)ï¼Œå¯ä»¥ç›´æ¥æ‰“åŒ…æˆå¯æ‰§è¡ŒjaråŒ…ï¼Œè‡ªåŠ¨æ‰§è¡Œæˆ‘ä»¬æŒ‡å®šçš„ç¨‹åºå…¥å£:</p>
<p>â€‹    <img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519132543278.png" alt="image-20200519132543278"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519130947865.png" alt="image-20200519130947865"></p>
<p>ä½¿ç”¨mvnå‘½ä»¤è¿›è¡Œæ‰“åŒ…: pomä¸­åŠ å…¥skipTestsæ ‡ç­¾å¹¶æŒ‡å®šå…¶å€¼ä¸ºtrueï¼Œ å¯è·³è¿‡æµ‹è¯•ï¼š</p>
<p><code>&lt;skipTests&gt;true&lt;/skipTests&gt;</code></p>
<p>mvn clean package</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519132909273.png" alt="image-20200519132909273"></p>
<p><strong>æ³¨æ„ï¼Œåœ¨STSä¸­æ‰§è¡Œmavenå‘½ä»¤çš„æ—¶å€™ï¼Œå‰é¢ä¸éœ€è¦å¸¦mvn</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519132939804.png" alt="image-20200519132939804"></p>
<p><strong>æ‰“åŒ…åç”Ÿæˆä¿©ä¸ªæ–‡ä»¶ï¼š</strong></p>
<p>demo-0.0.1-SNAPSHOT.jar   </p>
<p>â€‹    è¿™ä¸ªæ˜¯springbootæ’ä»¶æ‰“çš„jaråŒ…</p>
<p>demo-0.0.1-SNAPSHOT.jar.original </p>
<p>â€‹    è¿™ä¸ªæ˜¯clean packageå‘½ä»¤æ‰“çš„åŸå§‹jaråŒ…</p>
<p><strong>é€‰æ‹©ç¬¬ä¸€ä¸ªjarå³é”®ï¼š</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519132754425.png" alt="image-20200519132754425"></p>
<p><strong>åœ¨å‘½ä»¤è¡Œä¸­ï¼Œä½¿ç”¨å‘½ä»¤çš„æ–¹å¼æ‰§è¡Œè¿™ä¸ªjarï¼š</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519133302674.png" alt="image-20200519133302674"></p>
<blockquote>
<p>æ³¨æ„ï¼Œæ“ä½œå®Œä¹‹åï¼ŒæŠŠTerminalé€‰é¡¹å¡ç»™å…³é—­äº†ï¼Œå¦åˆ™å†æ‰§è¡Œcleanå‘½ä»¤ä¼š==æŠ¥é”™==ã€‚å› ä¸ºcleanå‘½ä»¤ä¼šåˆ é™¤targetç›®å½•ä¸‹çš„å†…å®¹ï¼Œä½†æ˜¯Terminalæ­£åœ¨æ‰“å¼€targetç›®å½•ä½¿ç”¨å…¶ä¸­çš„æ–‡ä»¶ï¼Œä¸è®©å…¶ä»–ç¨‹åºåˆ é™¤ã€‚</p>
</blockquote>
</li>
</ol>
<h3 id="2-ç¨‹åºå…¥å£"><a href="#2-ç¨‹åºå…¥å£" class="headerlink" title="2.ç¨‹åºå…¥å£"></a>2.ç¨‹åºå…¥å£</h3><p>â€‹        springbooté¡¹ç›®ä¸­éœ€è¦ä¸€ä¸ªç¨‹åºå…¥å£ï¼Œå°±æ˜¯ä¸€ä¸ªç±»ä¸­å«æœ‰mainæ–¹æ³•ï¼Œä½†æ˜¯éœ€è¦åœ¨è¿™ä¸ªç±»ä¸Šä½¿ç”¨springbootçš„ä¸“ç”¨æ³¨è§£@SpringBootApplication</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(DemoApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¯¥æ³¨è§£å¯ä»¥è®©å½“å‰ç±»æˆä¸ºä¸€ä¸ª<strong>é…ç½®ç±»</strong>ï¼Œè‡ªåŠ¨æ‰«æç”¨æˆ·çš„åŒ…ï¼Œä»¥åŠæœ€é‡è¦çš„ä¸€ä¸ªåŠŸèƒ½:å¼€å¯springbootçš„è‡ªåŠ¨é…ç½®åŠŸèƒ½:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="meta">@ComponentScan(excludeFilters = &#123; @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),</span></span><br><span class="line"><span class="meta">		@Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SpringBootApplication &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>æ³¨æ„ï¼Œmainæ–¹æ³•ä¸­çš„è¿™å¥ä»£ç SpringApplication.run(DemoApplication.class, args)ï¼Œmainæ–¹æ³•è¿è¡Œåspringbootå°±å¯ä»¥è¯»å–åˆ°DemoApplicationç±»ä¸Šçš„æ³¨è§£ä»è€Œå¼€å¯å„ç§åŠŸèƒ½ã€‚</p>
</blockquote>
<p>è¿è¡Œspringbooté¡¹ç›®åæ§åˆ¶å°ä¸­å¯ä»¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519134457148.png" alt="image-20200519134457148"></p>
<h3 id="3-æµ‹è¯•ä»£ç "><a href="#3-æµ‹è¯•ä»£ç " class="headerlink" title="3.æµ‹è¯•ä»£ç "></a>3.æµ‹è¯•ä»£ç </h3><p>â€‹        springbooté¡¹ç›®ä¸­çš„æµ‹è¯•ç±»ï¼Œé»˜è®¤ä½¿ç”¨äº†spring-testæ¨¡å—ä»¥åŠç»“åˆäº†junitæµ‹è¯•æ¡†æ¶ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼Œä¸åŒçš„springbootç‰ˆæœ¬ï¼Œå†…ç½®çš„ä½¿ç”¨çš„junitç‰ˆæœ¬ä¹Ÿä¸åŒã€‚</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519134650836.png" alt="image-20200519134650836"></p>
<blockquote>
<p>è¿™ä¸ªæµ‹è¯•ç±»å’Œspringbooté¡¹ç›®çš„å…¥å£ç±»çš„ä½ç½®çš„å…³ç³»ï¼Œè¿è¡Œæµ‹è¯•ç±»çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å…ˆè¿è¡Œå…¥å£ç±»ï¼Œå› ä¸ºè¦å…ˆè¯»å–é…ç½®ã€æ‰«æåŒ…ã€å¼€å¯è‡ªåŠ¨é…ç½®åŠŸèƒ½ç­‰ã€‚è¦è®°å¾—ï¼Œå…¥å£ç±»ä¹Ÿæ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚</p>
</blockquote>
<blockquote>
<p>==ä¸€èˆ¬ä¼šåœ¨åŒåŒ…ä»¥åŠå­åŒ…ä¸‹è‡ªåŠ¨æŸ¥æ‰¾è¦ä½¿ç”¨çš„ç±»ã€‚==<br>å½“å‰ä¾‹å­ä¸­ï¼Œæµ‹è¯•ç±»å’Œå…¥å£çš„ç±»çš„ä½ç½®å°±æ˜¯åœ¨åŒä¸€ä¸ªåŒ…ä¸‹é¢ã€‚</p>
</blockquote>
<p>å¦‚æœæµ‹è¯•ç±»å’Œå…¥å£ç±»(é…ç½®ç±»)çš„ä½ç½®æ¯”è¾ƒå¤æ‚æˆ–è€…æ··åˆï¼Œä¹Ÿå¯ä»¥è‡ªå·±å»æ˜ç¡®æŒ‡å®šï¼Œä¾‹å¦‚ :</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest(classes = &#123;DemoApplication.class&#125;)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="4-é…ç½®æ–‡ä»¶"><a href="#4-é…ç½®æ–‡ä»¶" class="headerlink" title="4.é…ç½®æ–‡ä»¶"></a>4.é…ç½®æ–‡ä»¶</h3><p>åœ¨springbooté¡¹ç›®ä¸­ï¼Œé»˜è®¤åªæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¿™ä¸ªä¸€ä¸ªé…ç½®æ–‡ä»¶ä¹Ÿå°±è¶³å¤Ÿäº†ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519135514278.png" alt="image-20200519135514278"></p>
<p>springbootçš„é…ç½®æ–‡ä»¶ï¼Œé»˜è®¤æ”¯æŒä¿©ç§æ–¹å¼ï¼š</p>
<ol>
<li><p>propertiesæ–‡ä»¶</p>
<p>application.properties :</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8081</span></span><br><span class="line"><span class="meta">server.servlet.context-path</span>=<span class="string">/</span></span><br><span class="line"><span class="meta">server.tomcat.uri-encoding</span>=<span class="string">utf-8</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>ymlæ–‡ä»¶</p>
<p>application.yml :</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8082</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/</span></span><br><span class="line">  <span class="attr">tomcat:</span></span><br><span class="line">    <span class="attr">uri-encoding:</span> <span class="string">utf-8</span></span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>
<p>ä¿©ç§æ–‡ä»¶çš„é…ç½®å†…å®¹ä¸€è‡´ï¼Œä½†æ˜¯é…ç½®çš„æ ¼å¼ä¸åŒã€‚ä¿©ä¸ªæ–‡ä»¶åŒæ—¶å­˜åœ¨ï¼Œä¼˜å…ˆä½¿ç”¨propertiesæ–‡ä»¶ä¸­çš„é…ç½®ã€‚</p>
</blockquote>
<p>pomæ–‡ä»¶ä¸­æ·»åŠ webå¯åŠ¨å™¨çš„ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œspringbootçš„ç¨‹åºå…¥å£ç±»DemoApplicationï¼š</p>
<p>ä»æ—¥å¿—ä¸­å¯ä»¥çœ‹å‡ºå½“å‰ä½¿ç”¨äº†8081ç«¯å£ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519141258964.png" alt="image-20200519141258964"></p>
<p><strong>åœ¨springbootå®˜ç½‘ä¸­</strong>ï¼š æœ‰é…ç½®æ–‡ä»¶æ”¯æŒçš„æ‰€æœ‰çš„å±æ€§é…ç½®ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519142001917.png" alt="image-20200519142001917"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519142124461.png" alt="image-20200519142124461"></p>
<p>â€‹    <img src="https://gitee.com/vanse/images/raw/master/out_before/image-20200519142153437.png" alt="image-20200519142153437"></p>
<h1 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h1><h2 id="pom"><a href="#pom" class="headerlink" title="pom"></a>pom</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.briup<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ssm<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>ssm<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">exclude</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="properties"><a href="#properties" class="headerlink" title="properties"></a>properties</h2><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8989</span></span><br><span class="line"><span class="comment">#é…ç½®æ•°æ®æº</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/st?characterEncoding=utf8&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=GMT%2B8</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">root</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">mybatis.mapper-locations</span>=<span class="string">classpath:mappers/**/*.xml</span></span><br><span class="line"><span class="meta">logging.level.com.briup.ssm</span>=<span class="string">debug</span></span><br></pre></td></tr></table></figure>



<h2 id="main"><a href="#main" class="headerlink" title="main"></a>main</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.briup.ssm.dao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SsmApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(SsmApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ä¸šåŠ¡"><a href="#ä¸šåŠ¡" class="headerlink" title="ä¸šåŠ¡"></a>ä¸šåŠ¡</h2><h3 id="controlelr"><a href="#controlelr" class="headerlink" title="controlelr"></a>controlelr</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IUserService userService;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;findAll&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.findAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="service-1"><a href="#service-1" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserService</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">IUserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.findAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="dao-1"><a href="#dao-1" class="headerlink" title="dao"></a>dao</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.briup.ssm.dao.UserMapper&quot;</span>&gt;</span><br><span class="line">    &lt;select id=<span class="string">&quot;findAll&quot;</span> resultType=<span class="string">&quot;com.briup.ssm.entity.User&quot;</span>&gt;</span><br><span class="line">        select * from demo_user</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>project</category>
      </categories>
      <tags>
        <tag>briup</tag>
      </tags>
  </entry>
  <entry>
    <title>briup_servlet</title>
    <url>/archives/briup/briup-servlet.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="servletï¼ˆä¸€ï¼‰"><a href="#servletï¼ˆä¸€ï¼‰" class="headerlink" title="servletï¼ˆä¸€ï¼‰"></a>servletï¼ˆä¸€ï¼‰</h1><h2 id="1-JavaEE"><a href="#1-JavaEE" class="headerlink" title="1 JavaEE"></a>1 JavaEE</h2><h3 id="1-1-æ¦‚è¿°"><a href="#1-1-æ¦‚è¿°" class="headerlink" title="1.1 æ¦‚è¿°"></a>1.1 æ¦‚è¿°</h3><p>JavaEEï¼ŒJava å¹³å°ä¼ä¸šç‰ˆï¼ˆJava Platform Enterprise Editionï¼‰æ˜¯ Sun å…¬å¸ä¸ºä¼ä¸šçº§åº”ç”¨æ¨å‡ºçš„æ ‡å‡†å¹³å°ï¼Œç”¨æ¥å¼€å‘B/Sæ¶æ„è½¯ä»¶ï¼Œå¯ä»¥è¯´å®ƒæ˜¯ä¸€ç§ä¼ä¸šçº§åº”ç”¨å¼€å‘è§„èŒƒã€‚2018å¹´3æœˆæ›´åä¸º Jakarta EEã€‚ï¼ˆOracleå°†JavaEEäº¤ç»™EclipseåŸºé‡‘ä¼šæ¥ç»´æŠ¤ï¼‰</p>
<p>JavaEE 5/6/7  ç‰ˆæœ¬éƒ½åœ¨oracleå®˜ç½‘ç»´æŠ¤ï¼š</p>
<p><a href="https://docs.oracle.com/javaee/7/">javaee 5/6/7</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132228230.png" alt="image-20200928160813377"></p>
<p>JavaEE 8 åœ¨oracleå®˜ç½‘ä¸­ä¹Ÿç»™å‡ºäº†ä»‹ç»ï¼š</p>
<p><a href="https://www.oracle.com/java/technologies/java-ee-glance.html">JavaEE 8</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132228198.png" alt="image-20200928161001881"></p>
<p>æ›´å¤šå…³äºJavaEEæ–°ç‰ˆæœ¬çš„åŠ¨å‘ï¼Œéœ€è¦åˆ°JakartaEEå®˜ç½‘ä¸ŠæŸ¥çœ‹ï¼š</p>
<p><a href="https://jakarta.ee/">JakartaEE</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132228767.png" alt="image-20200928161146662"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132228536.png" alt="image-20200928161250020"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132228814.png" alt="image-20200928161312140"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œå½“å‰JakartaEEå®˜ç½‘ä¸­ï¼Œä¸»æ¨çš„æ˜¯JakartaEE 8ç‰ˆæœ¬ï¼ŒåŒæ—¶JakartaEE 9ä¹Ÿå¤„äºå¯ç”¨çŠ¶æ€</p>
</blockquote>
<blockquote>
<p>è™½ç„¶JavaEEå·²ç»æ›´åä¸ºJakartaEEï¼Œä½†æ˜¯ç°åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¤§å®¶è¿˜æ˜¯ä¹ æƒ¯å«å®ƒJavaEE</p>
</blockquote>
<h3 id="1-2-ç»„æˆ"><a href="#1-2-ç»„æˆ" class="headerlink" title="1.2 ç»„æˆ"></a>1.2 ç»„æˆ</h3><p>JavaEE æ˜¯ä¼ä¸šçº§åº”ç”¨å¼€å‘è§„èŒƒï¼Œå®ƒæœ¬èº«å¹¶ä¸æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œè€Œæ˜¯å¤šç§æŠ€æœ¯è§£å†³æ–¹æ¡ˆçš„é›†åˆï¼Œè¿™äº›æŠ€æœ¯å’Œè§£å†³æ–¹æ¡ˆï¼Œä¼šæ¶‰åŠåˆ°ä¼ä¸šçº§åº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ‰€é‡åˆ°çš„å„ç§å„æ ·çš„é—®é¢˜ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨javaå¼€å‘ä¼ä¸šçº§åº”ç”¨çš„æ—¶å€™ï¼Œå¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨JavaEEä¸­ï¼Œæ‰€æŒ‡å®šçš„æŠ€æœ¯è§„èŒƒæ¥è¿›è¡Œé—®é¢˜çš„è§£å†³ã€‚ä½†æ˜¯ä¸€ä¸ªé—®é¢˜çš„è§£å†³ï¼Œä¸€èˆ¬ä¼šæœ‰å¾ˆå¤šç§æ–¹æ¡ˆï¼ŒJavaEEåªæ˜¯æ”¶å½•äº†å…¶ä¸­ä¸€ç§æ–¹æ¡ˆï¼Œå¹¶åˆ¶å®šæˆäº†è§„èŒƒæ ‡å‡†ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ<strong>JavaEE 5 ä¸­çš„æŠ€æœ¯è§„èŒƒ</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132228278.png" alt="image-20200928162515955"></p>
<blockquote>
<p>JavaEEä¸­çš„æ¯ä¸€ç§æŠ€æœ¯è§„èŒƒï¼Œéƒ½å¯ä»¥æè¿°ä¸ºJavaEEä¸­çš„ä¸€ç§æŠ€æœ¯ç»„ä»¶</p>
</blockquote>
<p>éšç€æ—¶ä»£çš„è¿›æ­¥ï¼Œä»¥åŠè¶Šæ¥è¶Šå¤šçš„å…¬å¸å’Œç»„ç»‡å‚ä¸åˆ°Javaä¸–ç•Œï¼Œå‡ºç°äº†å„ç§å„æ ·çš„Java EEç»„ä»¶çš„ä»£æ›¿è€…ï¼Œæ¯”å¦‚Hibernateã€Springå°±æ˜¯å…¶ä¸­ä¸¤ä¸ªå…¸å‹ï¼ˆç¬¬ä¸‰æ–¹æ¡†æ¶ï¼‰ã€‚</p>
<p>åŒæ—¶ï¼ŒJavaå®˜æ–¹åˆ¶å®šçš„ä¸€äº›Java EEæŠ€æœ¯è§„èŒƒå¹¶ä¸å¤ªå—æ¬¢è¿ï¼Œä¾‹å¦‚</p>
<ul>
<li>å®ƒä»¬åˆ¶å®šäº†JSFè§„èŒƒï¼Œä½†å®é™…ä¼ä¸šå¼€å‘å–œæ¬¢ç”¨Struts 2ã€Spring MVCï¼›</li>
<li>å®ƒä»¬åˆ¶å®šäº†EJBè§„èŒƒï¼Œä½†å®é™…ä¼ä¸šå¼€å‘å¾€å¾€è¿˜æ˜¯å–œæ¬¢ç”¨Springï¼›</li>
<li>å®ƒä»¬åˆ¶å®šäº†JPAè§„èŒƒï¼Œä½†å®é™…ä¼ä¸šå¼€å‘å¾€å¾€è¿˜æ˜¯å–œæ¬¢ç›´æ¥ç”¨Hibernateã€MyBatisã€‚</li>
</ul>
<p>ä½†æ˜¯ï¼ŒJavaEEè§„èŒƒä¸­ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›éå¸¸é‡è¦çš„æŠ€æœ¯è§„èŒƒï¼Œæˆä¸ºjavaEEè¢«å¹¿æ³›ä½¿ç”¨çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œä¾‹å¦‚Servletã€Jsp</p>
<p>é™¤äº†ï¼ŒServletå’ŒJspä¹‹å¤–ï¼ŒJavaEEä¸­è¿˜æœ‰å…¶ä»–ä¸€äº›æŠ€æœ¯è§„èŒƒï¼Œå…¶ä¸­æ ¸å¿ƒçš„å¯ä»¥å¤§è‡´åˆ†ä¸º13ç§ï¼š</p>
<ul>
<li><p>JDBC(Java Database Connectivity)</p>
<p>JDBC APIä¸ºè®¿é—®ä¸åŒçš„æ•°æ®åº“æä¾›äº†ä¸€ç§ç»Ÿä¸€çš„é€”å¾„</p>
</li>
<li><p>JNDI(Java Name and Directory Interface)</p>
<p>JNDI APIè¢«ç”¨äºæ‰§è¡Œåå­—å’Œç›®å½•æœåŠ¡</p>
</li>
<li><p>EJB(Enterprise JavaBean) </p>
<p>J2EEæŠ€æœ¯ä¹‹æ‰€ä»¥èµ¢å¾—åª’ä½“å¹¿æ³›é‡è§†çš„åŸå› ä¹‹ä¸€å°±æ˜¯EJBã€‚å®ƒä»¬æä¾›äº†ä¸€ä¸ªæ¡†æ¶æ¥å¼€å‘å’Œå®æ–½åˆ†å¸ƒå¼å•†åŠ¡é€»è¾‘ï¼Œç”±æ­¤å¾ˆæ˜¾è‘—åœ°ç®€åŒ–äº†å…·æœ‰å¯ä¼¸ç¼©æ€§å’Œé«˜åº¦å¤æ‚çš„ä¼ä¸šçº§åº”ç”¨çš„å¼€å‘</p>
</li>
<li><p>RMI(Remote Method Invoke)</p>
<p>è°ƒç”¨è¿œç¨‹å¯¹è±¡ä¸Šçš„æ–¹æ³•</p>
</li>
<li><p>Java IDL/CORBA</p>
<p>åœ¨Java IDLçš„æ”¯æŒä¸‹ï¼Œå¼€å‘äººå‘˜å¯ä»¥å°†Javaå’ŒCORBAé›†æˆåœ¨ä¸€èµ·</p>
</li>
<li><p>JSP(Java Server Pages)</p>
<p>JSPé¡µé¢ç”±HTMLä»£ç å’ŒåµŒå…¥å…¶ä¸­çš„Javaä»£ç æ‰€ç»„æˆ</p>
</li>
<li><p>Java Servlet</p>
<p>Servletæ˜¯ä¸€ç§Javaç¨‹åºï¼Œå®ƒæ‰©å±•äº†WebæœåŠ¡å™¨çš„åŠŸèƒ½ï¼Œä½œä¸ºä¸€ç§æœåŠ¡å™¨ç«¯çš„åº”ç”¨ï¼Œå½“è¢«è¯·æ±‚æ—¶å¼€å§‹æ‰§è¡Œã€‚</p>
</li>
<li><p>XML(Extensible Markup Language)</p>
<p>Javaä¸­å¯¹XMLçš„æ”¯æŒ</p>
</li>
<li><p>JMS(Java Message Service)<br>JMSæ˜¯ç”¨äºå’Œé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶ç›¸äº’é€šä¿¡çš„åº”ç”¨ç¨‹åºæ¥å£</p>
</li>
<li><p>JTA(Java Transaction Architecture)</p>
<p>JTAå®šä¹‰äº†ä¸€ç§æ ‡å‡†çš„APIï¼Œåº”ç”¨ç³»ç»Ÿç”±æ­¤å¯ä»¥è®¿é—®å„ç§äº‹åŠ¡ç›‘æ§</p>
</li>
<li><p>JTS(Java Transaction Service)<br>JTSäº‹åŠ¡ç®¡ç†å™¨ï¼Œå¯¹JTAæä¾›æ”¯æŒå’Œç®¡ç†æœåŠ¡</p>
</li>
<li><p>JavaMail</p>
<p>JavaMailæ˜¯ç”¨äºå­˜å–é‚®ä»¶æœåŠ¡å™¨çš„APIï¼Œå®ƒæä¾›äº†ä¸€å¥—é‚®ä»¶æœåŠ¡å™¨çš„æŠ½è±¡ç±»</p>
</li>
<li><p>JAF(JavaBeans Activation Framework)</p>
<p>JavaMailå¯ä»¥åˆ©ç”¨JAFæ¥å¤„ç†MIMEç¼–ç çš„é‚®ä»¶é™„ä»¶</p>
</li>
</ul>
<h3 id="1-3-åŒºåˆ«"><a href="#1-3-åŒºåˆ«" class="headerlink" title="1.3 åŒºåˆ«"></a>1.3 åŒºåˆ«</h3><p>åœ¨æ¯ä¸€ä¸ªJavaEEçš„ç‰ˆæœ¬ä¸­ï¼Œä¼šå¯¹ä¸€äº›æŒ‡å®šçš„æ ¸å¿ƒæŠ€æœ¯è§„èŒƒè¿›è¡Œç‰ˆæœ¬å‡çº§ï¼Œæˆ–è€…æ–°å¢ä¸€äº›æŠ€æœ¯è§„èŒƒ</p>
<p>ä¾‹å¦‚ï¼Œ<strong>JavaEE 7 ä¸­çš„æŠ€æœ¯è§„èŒƒ</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132228790.png" alt="image-20200928164809409"></p>
<blockquote>
<p>å…¶ä¸­ï¼Œä½¿ç”¨ä¸åŒçš„é¢œè‰²ï¼Œè¡¨ç¤ºå‡ºåœ¨æ­¤ç‰ˆæœ¬ä¸­ï¼Œæ–°å¢äº†å“ªäº›æŠ€æœ¯è§„èŒƒï¼Œä»¥åŠå“ªäº›æ˜¯å¯é€‰çš„æŠ€æœ¯è§„èŒƒ</p>
</blockquote>
<p>åœ¨å®˜ç½‘ä¸­ï¼Œä¼šå¯¹JavaEEä¸­ï¼Œæ¯é¡¹æŠ€æœ¯è§„èŒƒçš„ç‰ˆæœ¬ç½—åˆ—å‡ºæ¥ï¼Œå¹¶è¿›è¡Œè¯´æ˜</p>
<p><a href="https://www.oracle.com/java/technologies/javaee/javaeetechnologies.html#javaee7">JavaEE 7ä¸­æŠ€æœ¯è§„èŒƒç‰ˆæœ¬</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132231046.png" alt="image-20200928165437589"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132231800.png" alt="image-20200928165535726"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œè¿™é‡Œåˆ—å‡ºäº†JavaEE 7ä¸­ï¼Œå…³äºwebåº”ç”¨å¼€å‘æŠ€æœ¯ä¸­ï¼Œæ¯é¡¹æŠ€æœ¯è§„èŒƒçš„ç‰ˆæœ¬</p>
</blockquote>
<p>ä¸‹å›¾æ˜¯<strong>JavaEE 5</strong>ä¸­ï¼Œå¯¹webå¼€å‘æŠ€æœ¯ä¸­ï¼Œæ¯é¡¹æŠ€æœ¯è§„èŒƒçš„ç‰ˆæœ¬ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132231340.png" alt="image-20200928165737079"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼ŒJavaEE 5 å’Œ JavaEE 7ç‰ˆæœ¬ä¸­ï¼Œå¾ˆå¤šæŠ€æœ¯è§„èŒƒçš„ç‰ˆæœ¬çš„éƒ½æœ‰æ‰€å‡çº§</p>
</blockquote>
<p>JakartaEEå®˜ç½‘ä¸­ï¼Œå¯¹å…¶æ–°ç‰ˆæœ¬ä¸­çš„è§„èŒƒæŠ€æœ¯ä¹Ÿæœ‰è¯¦ç»†è¯´æ˜ï¼š</p>
<p><a href="https://jakarta.ee/specifications/">JakartaEEå®˜ç½‘ç‰ˆæœ¬è¯´æ˜</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132231316.png" alt="image-20200928170022610"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132231141.png" alt="image-20200928170055327"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132231332.png" alt="image-20200928170131504"></p>
<h3 id="1-4-é€‰æ‹©"><a href="#1-4-é€‰æ‹©" class="headerlink" title="1.4 é€‰æ‹©"></a>1.4 é€‰æ‹©</h3><p>åœ¨JavaEEæŠ€æœ¯è§„èŒƒä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯Servletå’ŒJspçš„ç‰ˆæœ¬ï¼Œç‰¹åˆ«æ˜¯Servletï¼Œç‰ˆæœ¬ä¸åŒï¼Œä¼šç›´æ¥å½±å“å°†æ¥ä»£ç ä¸­åŠŸèƒ½å®ç°çš„æ–¹å¼ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨<strong>JavaEE 7</strong>ä¸­çš„<strong>Servlet3.1</strong>ç‰ˆæœ¬ï¼Œè¿™ä¸ªä¹Ÿæ˜¯å½“å‰ä½¿ç”¨æœ€å¹¿æ³›çš„ç‰ˆæœ¬ã€‚</p>
<p>é€šè¿‡Mavenä¸­å¤®ä»“åº“ä¸­çš„servletä¾èµ–ä½¿ç”¨æƒ…å†µï¼Œä¹Ÿå¯ä»¥çœ‹å‡ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232740.png" alt="image-20200928171345590"></p>
<blockquote>
<p>æ³¨æ„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé«˜ç‰ˆæœ¬æ˜¯ä¼šå…¼å®¹ä½ç‰ˆæœ¬çš„åŠŸèƒ½çš„</p>
</blockquote>
<h3 id="1-5-ä¸‹è½½"><a href="#1-5-ä¸‹è½½" class="headerlink" title="1.5 ä¸‹è½½"></a>1.5 ä¸‹è½½</h3><p><a href="https://download.oracle.com/otndocs/jcp/java_ee-7-fr-eval-spec/index.html">JavaEE 7å®˜æ–¹è¯´æ˜æ–‡æ¡£ä¸‹è½½</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232860.png" alt="image-20200928171849967"></p>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™ä¸ªæ˜¯JavaEE 7çš„æ€»æ–‡æ¡£ï¼Œé‡Œé¢åŒ…å«å„ç§æŠ€æœ¯ç»„ä»¶çš„è¯´æ˜</p>
</blockquote>
<p><a href="https://download.oracle.com/otndocs/jcp/servlet-3_1-fr-eval-spec/index.html">Servlet3.1 å®˜æ–¹æ–‡æ¡£ä¸‹è½½</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232934.png" alt="image-20200928171933203"></p>
<blockquote>
<p>æ³¨æ„ï¼Œç¬¬ä¸€ä¸ªæ˜¯Servlet3.1çš„è¯´æ˜æ–‡æ¡£ï¼Œç¬¬äºŒä¸ªæ˜¯Servlet3.1çš„APIæ–‡æ¡£</p>
</blockquote>
<h3 id="1-6-å®¹å™¨"><a href="#1-6-å®¹å™¨" class="headerlink" title="1.6 å®¹å™¨"></a>1.6 å®¹å™¨</h3><p>é€šè¿‡å‰é¢çš„JavaEEæŠ€æœ¯ç»„ä»¶å›¾ä¸­ï¼Œå¯ä»¥çœ‹å‡ºServletå’ŒJspï¼Œå¹¶ä¸èƒ½åƒä¹‹å‰æ™®é€šjavaç¨‹åºä¸€æ ·ï¼Œå†™ä¸€ä¸ªmainæ–¹æ³•è¿è¡Œï¼Œè€Œæ˜¯éœ€è¦å°†Servletå’ŒJspç¨‹åºï¼Œæ”¾åˆ°Webå®¹å™¨ä¸­è¿è¡Œï¼š</p>
<p><strong>JavaEE 5ä¸­çš„æŠ€æœ¯ç»„ä»¶å›¾ï¼š</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232449.png" alt="image-20200928172533726"></p>
<p><strong>JavaEE 7ä¸­çš„æŠ€æœ¯ç»„ä»¶å›¾ï¼š</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232112.png" alt="image-20200928172504604"></p>
<p>Webå®¹å™¨ï¼Œä¹Ÿç§°ä¸ºWeb Containerï¼Œå®ƒå…¶å®æ˜¯ä¸€ä¸ªè¿è¡Œç¯å¢ƒï¼Œå®ƒå¯ä»¥ç»™Servletå’ŒJspç¨‹åºçš„è¿è¡Œï¼Œæä¾›ä¸€ä¸ªåˆé€‚çš„è¿è¡Œç¯å¢ƒã€‚æ‰€ä»¥ï¼Œå°†æ¥åœ¨å°†webé¡¹ç›®éƒ¨ç½²åˆ°æœåŠ¡å™¨é‡Œé¢çš„æ—¶å€™ï¼Œä¼šè¦æ±‚æœåŠ¡å™¨ä¸­å«æœ‰<strong>webå®¹å™¨</strong>ï¼Œä»¥ä¾¿æ”¯æŒServletå’ŒJspç¨‹åºçš„è¿è¡Œã€‚å¦‚æœæœåŠ¡å™¨ä¸­æ²¡æœ‰webå®¹å™¨ï¼Œé‚£ä¹ˆè¿™ä¸ªæœåŠ¡å™¨ä¸­å°†ä¸èƒ½è¿è¡Œservletå’Œjspçš„ç¨‹åºã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹å¯¹æœåŠ¡å™¨çš„æè¿°æœ‰ï¼š</p>
<ul>
<li><p>webæœåŠ¡å™¨</p>
<p>ä¹Ÿç§°ä¸ºweb serveræˆ–è€…http serverï¼Œä¸»è¦ç”¨äºå¤„ç†httpè¯·æ±‚ä»¥åŠè¿”å›å“åº”ã€‚å®ƒå¯ä»¥å¤„ç†è¯·æ±‚ï¼Œä¹Ÿå¯ä»¥å°†è¯·æ±‚è½¬å‘è‡³å…¶ä»–æœåŠ¡å™¨ï¼Œå¤šç”¨äºå¤„ç†webä¸­çš„é™æ€èµ„æºã€‚ä¾‹å¦‚ï¼ŒNginx ã€apache</p>
</li>
<li><p>webå®¹å™¨</p>
<p>ä¸»è¦ç”¨äºæ”¯æŒServletå’ŒJspçš„è¿è¡Œ(æ²¡æœ‰ä¸»å‡½æ•°)ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å¤„ç†httpåè®®ä¸‹çš„é™æ€èµ„æºçš„è®¿é—®ï¼Œå› ä¸ºä¸€èˆ¬æ˜¯åœ¨==webæœåŠ¡å™¨ä¸­å†…åµŒäº†webå®¹å™¨ã€‚ä¾‹å¦‚ï¼Œtomcatã€jetty==</p>
</li>
<li><p>JavaEEåº”ç”¨æœåŠ¡å™¨</p>
<p>å®ƒå…·å¤‡äº† Web Server å¤„ç†httpè¯·æ±‚çš„èƒ½åŠ›ï¼ˆæ²¡æœ‰Web Serverä¸“ä¸šï¼‰ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒäº†JavaEE æŠ€æœ¯ç»„ä»¶ï¼Œæ¯”å¦‚JMSã€DIã€JPAã€Transactionsã€Concurrencyç­‰ï¼ŒåŒæ—¶ä¹ŸåŒ…å«äº†Web Containerã€‚ä¾‹å¦‚ï¼ŒWebLogicã€WebSphere.(ä¸€èˆ¬é…åˆwebæœåŠ¡å™¨ä½¿ç”¨tomcat+nginx)</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232595.png" alt="image-20200928195857793"></p>
<blockquote>
<p>åé¢ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©tomcatä½œä¸ºwebå®¹å™¨ï¼Œå»éƒ¨ç½²è¿è¡Œservletå’Œjspç›¸å…³çš„ç¨‹åº</p>
</blockquote>
<p>==æ€è€ƒï¼ŒJavaEEã€Servletã€Jspã€Web Containerã€tomcatè¿™å‡ è€…ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ==</p>
<h2 id="2-Tomcat"><a href="#2-Tomcat" class="headerlink" title="2 Tomcat"></a>2 Tomcat</h2><h3 id="2-1-æ¦‚è¿°"><a href="#2-1-æ¦‚è¿°" class="headerlink" title="2.1 æ¦‚è¿°"></a>2.1 æ¦‚è¿°</h3><p>Tomcatæ˜¯ç”±ApacheåŸºé‡‘ç»„ç»‡ç»´æŠ¤çš„ä¸€æ¬¾å¼€æºã€å…è´¹ã€Javaè¯­è¨€å®ç°çš„webå®¹å™¨ï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯ä¸€ä¸ªwebæœåŠ¡å™¨ï¼Œæ”¯æŒHttpåè®®ä¸‹çš„èµ„æºè®¿é—®ï¼ˆé™æ€èµ„æºã€åŠ¨æ€èµ„æºï¼‰ã€‚</p>
<p>åœ¨TomcatæœåŠ¡å™¨ä¸­ï¼Œå¯ä»¥éƒ¨ç½²webåº”ç”¨ï¼Œç„¶åå¯¹å¤–æä¾›Httpåè®®ä¸‹çš„èµ„æºè®¿é—®</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232808.png" alt="image-20200928202700541"></p>
<h3 id="2-2-ä¸‹è½½"><a href="#2-2-ä¸‹è½½" class="headerlink" title="2.2 ä¸‹è½½"></a>2.2 ä¸‹è½½</h3><p><a href="https://tomcat.apache.org/">apache-tomcatå®˜ç½‘</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232498.png" alt="image-20200928202942725"></p>
<p>å®˜ç½‘åˆ—å‡ºäº†tomcatå’ŒServletã€Jspç­‰ç›¸å…³æŠ€æœ¯è§„èŒƒçš„ç‰ˆæœ¬å…³ç³»ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232937.png" alt="image-20200928203045326"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œtomcat8.5åˆšå¥½æ”¯æŒJavaEE 7é‡Œé¢çš„servlet3.1è§„èŒƒ</p>
</blockquote>
<p><a href="https://tomcat.apache.org/download-80.cgi">tomcat 8.5ä¸‹è½½</a></p>
<p>å®˜ç½‘ä¸­åˆ†åˆ«æä¾›äº†æºç å’Œç¼–è¯‘åçš„è½¯ä»¶ä¸‹è½½ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232866.png" alt="image-20200928203537201"></p>
<h3 id="2-3-å®‰è£…"><a href="#2-3-å®‰è£…" class="headerlink" title="2.3 å®‰è£…"></a>2.3 å®‰è£…</h3><p>å°†ä¸‹è½½å®Œæˆçš„å‹ç¼©åŒ…ï¼Œç›´æ¥è§£å‹åˆ°æ–‡ä»¶ä¸­å³å¯ï¼Œä¾‹å¦‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232776.png" alt="image-20200928203849722"></p>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™ä¸ªè§£å‹å®‰è£…çš„è·¯å¾„ä¸­ï¼Œä¸è¦æœ‰ä¸­æ–‡ã€ç©ºæ ¼ã€ç‰¹æ®Šç¬¦å·ç­‰</p>
</blockquote>
<h3 id="2-4-ç›®å½•"><a href="#2-4-ç›®å½•" class="headerlink" title="2.4 ç›®å½•"></a>2.4 ç›®å½•</h3><p>tomcatè§£å‹åï¼Œæ¯ä¸ªç›®å½•çš„ä½œç”¨ï¼š</p>
<ul>
<li><p>binç›®å½•ï¼Œå­˜æ”¾è¿è¡Œtomcatéœ€è¦çš„å‘½ä»¤æ–‡ä»¶</p>
<p>ä¾‹å¦‚ï¼Œtomcatå¯åŠ¨å’Œå…³é—­çš„å‘½ä»¤</p>
<p>windowsä¸­ï¼Œstartup.batã€shutdown.bat</p>
<p>Unixä¸­ï¼Œstartup.shã€shutdown.sh</p>
</li>
<li><p>confç›®å½•ï¼Œå­˜æ”¾tomcatç›¸å…³çš„é…ç½®æ–‡ä»¶</p>
<p>å…¶ä¸­æœ€é‡è¦çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶å°±æ˜¯server.xml</p>
<p>ä¾‹å¦‚ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­é…ç½®tomcatå¯åŠ¨åç›‘å¬çš„ç«¯å£å·</p>
</li>
<li><p>libç›®å½•ï¼Œå­˜æ”¾é¡¹ç›®è¿è¡Œæ—¶éœ€è¦çš„jaråŒ…</p>
<p>è¿™ä¸ªç›®å½•ä¸­å­˜æ”¾çš„æ˜¯å…¬å…±çš„jaråŒ…ï¼Œéƒ¨ç½²åˆ°tomcatæœåŠ¡å™¨ä¸­çš„å¤šä¸ªwebé¡¹ç›®ï¼Œå¯ä»¥å…±äº«è¿™äº›jaråŒ…</p>
<p>ä¾‹å¦‚ï¼Œservlet-api.jarï¼Œåœ¨ä½¿ç”¨servletè§„èŒƒç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œéœ€è¦è¯¥jarä¸­çš„æ¥å£</p>
</li>
<li><p>logsç›®å½•ï¼Œå­˜æ”¾tomcatè¿è¡Œæ—¶çš„æ—¥å¿—æ–‡ä»¶</p>
<p>tomcatæŠŠä¼šè¿è¡Œæ—¶çš„é‡è¦ä¿¡æ¯è®°å½•ä¸‹æ¥</p>
<p>ä¾‹å¦‚ï¼Œtomcatä¸­éƒ¨ç½²çš„webé¡¹ç›®å‘ç”Ÿäº†ä¸¥é‡é”™è¯¯</p>
</li>
<li><p>tempç›®å½•ï¼Œå­˜æ”¾tomcatè¿è¡Œæ—¶äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶</p>
<p>tomcatåœ¨è¿è¡ŒæœŸé—´ï¼Œå¯èƒ½ä¼šäº§ç”Ÿä¸€äº›ä¸´æ—¶æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶é»˜è®¤æ”¾åˆ°è¿™ä¸ªç›®å½•ä¸‹</p>
</li>
<li><p>webappsç›®å½•ï¼Œéƒ¨ç½²webé¡¹ç›®çš„ä½ç½®</p>
<p>æŠŠwebé¡¹ç›®éƒ¨ç½²åˆ°tomcatæœåŠ¡å™¨ä¸­ï¼Œå…¶å®å°±æ˜¯æŠŠé¡¹ç›®æ”¾åˆ°è¿™ä¸ªç›®å½•ä¸‹é¢</p>
</li>
<li><p>workç›®å½•ï¼Œç¼–è¯‘Jspé¡µé¢åæ‰€å­˜æ”¾çš„ç›®å½•</p>
</li>
</ul>
<h3 id="2-5-ç«¯å£"><a href="#2-5-ç«¯å£" class="headerlink" title="2.5 ç«¯å£"></a>2.5 ç«¯å£</h3><p>tomcatå¯åŠ¨åï¼Œä¼šé»˜è®¤ç›‘å¬ç«¯å£8080ï¼Œå¦‚æœå’Œæœ¬æœºä¸­çš„å…¶ä»–æœåŠ¡å™¨ç¨‹åº(oracle)æœ‰å†²çªï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ï¼š</p>
<p><code>conf/server.xml</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132232264.png" alt="image-20200928205335160"></p>
<p>ä¾‹å¦‚ï¼Œå¯ä»¥ä¿®æ”¹æˆ8989</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132233106.png" alt="image-20200928205414023"></p>
<blockquote>
<p>æ³¨æ„ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹æˆå…¶å®ƒï¼Œè‡ªå·±æƒ³ä½¿ç”¨çš„ç«¯å£å·ï¼Œå’Œæœ¬åœ°å·²æœ‰çš„ç¨‹åºæ²¡æœ‰å†²çªå³å¯</p>
</blockquote>
<h3 id="2-6-è¿è¡Œ"><a href="#2-6-è¿è¡Œ" class="headerlink" title="2.6 è¿è¡Œ"></a>2.6 è¿è¡Œ</h3><p>å› ä¸ºtomcatè½¯ä»¶æ˜¯javaç¼–å†™çš„ï¼Œæ‰€ä»¥åœ¨å¯åŠ¨è¿è¡Œtomcatçš„æ—¶å€™ï¼Œéœ€è¦æœ‰JDKçš„æ”¯æŒï¼Œå¹¶ä¸”é€šè¿‡tomcatå®˜ç½‘ç»™å‡ºçš„ç‰ˆæœ¬å…³ç³»å›¾å¯çŸ¥ï¼Œå½“å‰ä½¿ç”¨çš„Tomcat 8.5 éœ€è¦æœ‰JDK7æˆ–ä»¥ä¸Šçš„ç‰ˆæœ¬æ”¯æŒã€‚</p>
<p>ç¬¬ä¸€æ­¥ï¼Œå®‰è£…JDK7æˆ–ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¹¶æ­£ç¡®é…ç½®å¥½JAVA_HOMEï¼Œä»¥ä¾¿è®©Tomcatåœ¨å¯åŠ¨æ—¶å¯ä»¥æ‰¾åˆ°å®‰è£…çš„JDK</p>
<p>ç¬¬äºŒæ­¥ï¼Œè¿è¡Œbinç›®å½•ä¸‹çš„å¯åŠ¨æ–‡ä»¶å³å¯ï¼ˆåŒå‡»startup.batï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132233282.png" alt="image-20200928210142789"></p>
<blockquote>
<p>æ³¨æ„ï¼Œå¦‚æœå‡ºç°å‘½ä»¤çª—å£ä¸€é—ªè€Œè¿‡ï¼Œå¹¶ä¸”æ¶ˆå¤±ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½æ˜¯JAVA_HOMEé…ç½®é—®é¢˜</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œå‡ºç°æ—¥å¿—æ˜¾ç¤ºä¹±ç ï¼Œæ˜¯å› ä¸ºWindowsä¸­é»˜è®¤ç¼–ç çš„é—®é¢˜</p>
</blockquote>
<h3 id="2-7-è®¿é—®"><a href="#2-7-è®¿é—®" class="headerlink" title="2.7 è®¿é—®"></a>2.7 è®¿é—®</h3><p>TomcatæˆåŠŸå¯åŠ¨åï¼Œå¯ä»¥ä½¿ç”¨URLåœ°å€ï¼Œæ¥è®¿é—®éƒ¨ç½²åˆ°Tomcatä¸­çš„webé¡¹ç›®ï¼š</p>
<p><a href="http://localhost:8989/your_project/resource_in_project">http://localhost:8989/your_project/resource_in_project</a><br><a href="http://127.0.0.1:8989/your_project/resource_in_project">http://127.0.0.1:8989/your_project/resource_in_project</a></p>
<p>webappsç›®å½•æ˜¯Tomcatä¸­éƒ¨ç½²é¡¹ç›®çš„ä½ç½®ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œé‡Œé¢å·²ç»æœ‰äº†ä¸€äº›ç¤ºä¾‹é¡¹ç›®ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132233796.png" alt="image-20200928210721010"></p>
<blockquote>
<p>æ³¨æ„ï¼Œwebappsä¸­ï¼Œæ–‡ä»¶å¤¹çš„åå­—ï¼Œé»˜è®¤å°±æ˜¯éƒ¨ç½²çš„é¡¹ç›®åå­—</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œ<a href="http://127.0.0.1:8989/examples/index.html">http://127.0.0.1:8989/examples/index.html</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132233426.png" alt="image-20200928210821686"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132233211.png" alt="image-20200928210912034"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132233570.png" alt="image-20200928210928468"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132233217.png" alt="image-20200928210941237"></p>
<h3 id="2-8-å…³é—­"><a href="#2-8-å…³é—­" class="headerlink" title="2.8 å…³é—­"></a>2.8 å…³é—­</h3><p>tomcatå¯åŠ¨åï¼Œå¦‚æœå…³é—­ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œbinç›®å½•ä¸‹çš„shutdown.batæ–‡ä»¶ï¼Œæˆ–è€…åœ¨tomcatçš„è¿è¡Œçª—å£çš„å³ä¸Šè§’ï¼Œç›´æ¥ç‚¹å‡»å‰å·ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132233650.png" alt="image-20200928211342512"></p>
<blockquote>
<p>æ³¨æ„ï¼ŒåŒå‡»shutdown.batå…³é—­æœåŠ¡å™¨å’Œç‚¹å‡»å‰å·å…³é—­æœåŠ¡å™¨ï¼Œä¿©ç§è™½ç„¶éƒ½å¯ä»¥å…³é—­ï¼Œä½†æ˜¯å…³é—­çš„ç»†èŠ‚æœ‰æ‰€ä¸åŒï¼Œç‰¹æ®Šåœºæ™¯ä¸‹ä¼šå¯¼å‡ºç¨‹åºå†æ¬¡è¿è¡Œçš„ç»“æœä¸åŒï¼Œåé¢åœ¨å®é™…æ“ä½œè¿‡ç¨‹ä¸­ï¼Œä¼šå…·ä½“è§£é‡Š</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œä»£ç +ç¯å¢ƒ+æ“ä½œ = æ­£å¸¸çš„ç¨‹åºæ‰§è¡Œç»“æœ</p>
</blockquote>
<h2 id="3-Project"><a href="#3-Project" class="headerlink" title="3 Project"></a>3 Project</h2><h3 id="3-1-æ¦‚è¿°"><a href="#3-1-æ¦‚è¿°" class="headerlink" title="3.1 æ¦‚è¿°"></a>3.1 æ¦‚è¿°</h3><p>åœ¨Tomcatä¸­ï¼Œéƒ¨ç½²çš„Webé¡¹ç›®ï¼Œæ˜¯æœ‰å›ºå®šçš„ç»“æ„è¦æ±‚çš„ï¼Œå‡è®¾ä»¥web-testé¡¹ç›®ä¸ºä¾‹ï¼Œè¿›è¡Œè¯´æ˜ã€‚</p>
<p>è¿™é‡Œæè¿°çš„æ˜¯ï¼ŒæŠŠwebé¡¹ç›®éƒ¨ç½²åˆ°Tomcatä¸­ä¹‹åçš„ç›®å½•ç»“æ„ï¼Œå¹¶ä¸æ˜¯é¡¹ç›®åœ¨Eclipseä¸­çš„ç»“æ„ï¼Œæ‰€ä»¥Eclipseå¸®æˆ‘ä»¬éƒ¨ç½²é¡¹ç›®çš„æ—¶å€™ï¼Œå…¶å®æ˜¯æŠŠåŸæ¥çš„é¡¹ç›®ç»“æ„è¿›è¡Œå¤„ç†ï¼Œå˜ä¸ºtomcatä¸­è¦æ±‚çš„é¡¹ç›®ç»“æ„ï¼Œç„¶åå†éƒ¨ç½²åˆ°tomcaté‡Œé¢çš„webappsç›®å½•ä¸­çš„ã€‚</p>
<p>å¯¹åº”ä¸€ä¸ªwebé¡¹ç›®ï¼ˆä¾‹å¦‚ï¼Œweb-testï¼‰ï¼Œéƒ¨ç½²åæœ€åŸºæœ¬çš„é¡¹ç›®ç»“æ„ä¸ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">web-test/</span><br><span class="line">â””â”€WEB-INF/</span><br><span class="line">    â”‚  web.xml</span><br><span class="line">    â”‚</span><br><span class="line">    â”œâ”€classes/</span><br><span class="line">    â””â”€lib/</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œ</p>
<p>web-testï¼Œå®ƒæ˜¯é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œä¹Ÿæ˜¯webé¡¹ç›®çš„åå­—</p>
<ul>
<li>è¿™é‡Œé¢ä¸€å®šè¦æœ‰å­ç›®å½•WEB-INF</li>
<li>é™¤æ­¤ä¹‹å¤–ï¼Œè¿™é‡Œè¿˜å¯ä»¥å­˜æ”¾webé¡¹ç›®çš„é™æ€èµ„æºï¼ˆhtmlã€cssã€jsã€imageï¼‰</li>
<li>è¿™é‡Œè¿˜å¯ä»¥æ–°å»ºå…¶å®ƒå­ç›®å½•</li>
</ul>
<p>WEB-INFï¼Œå®ƒæ˜¯webé¡¹ç›®ä¸­çš„æ ¸å¿ƒç›®å½•ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨æ˜¯æ— æ³•ç›´æ¥è®¿é—®è¯¥ç›®å½•ä¸‹çš„èµ„æº</p>
<ul>
<li>classesï¼Œå­˜æ”¾é¡¹ç›®ä¸­ç¼–è¯‘å¥½çš„classæ–‡ä»¶</li>
<li>libï¼Œå­˜æ”¾é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„ç¬¬ä¸‰æ–¹jaråŒ…ï¼ˆä¸ä¼šç»™å…¶ä»–tomcatéƒ¨ç½²çš„webé¡¹ç›®å…±äº«ï¼‰</li>
<li>web.xmlï¼Œå®ƒæ˜¯webé¡¹ç›®ä¸­æ ¸å¿ƒçš„é…ç½®æ–‡ä»¶ï¼Œtomcatå¯åŠ¨åä¼šè‡ªåŠ¨è¯»å–é¡¹ç›®ä¸­web.xmlæ–‡ä»¶</li>
</ul>
<h3 id="3-2-æ“ä½œ"><a href="#3-2-æ“ä½œ" class="headerlink" title="3.2 æ“ä½œ"></a>3.2 æ“ä½œ</h3><p>åœ¨æ¡Œé¢åˆ›å»ºå¥½web-testé¡¹ç›®ï¼Œå…¶ç»“æ„æŒ‰ç…§ä¸Šé¢æè¿°çš„è§„åˆ™ã€‚</p>
<p>ç„¶åè¿›è¡Œä»¥ä¸‹æ“ä½œï¼Œ<strong>æ„Ÿå—</strong>ä¸€ä¸ªwebé¡¹ç›®ç¼–å†™ã€ç¼–è¯‘ã€éƒ¨ç½²ã€è¿è¡Œã€è®¿é—®çš„è¿‡ç¨‹</p>
<p>1ã€æ–°å»ºindex.htmlé¡µé¢ï¼Œå­˜æ”¾åˆ°web-testé¡¹ç›®ç›®å½•ä¸‹</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>2ã€åœ¨æ¡Œé¢åˆ›å»ºjavaç±»ï¼ˆservletï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> IOException, ServletException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">        PrintWriter out = response.getWriter();</span><br><span class="line">        out.println(<span class="string">&quot;&lt;html&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;head&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;title&gt;index&lt;/title&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/head&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;body&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;h1&gt;Hello World! briup&lt;/h1&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/body&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/html&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>3ã€ç¼–è¯‘æ­¤javaç±»ï¼ˆservletï¼‰</p>
<p>å½“å‰ç±»ä¸­ï¼Œä½¿ç”¨åˆ°äº†servletè§„èŒƒï¼Œéœ€è¦ç”¨åˆ°servlet-api.jarï¼Œæ­¤jaråŒ…åœ¨tomcatä¸­libé‡Œé¢ä¸­ï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šjaræ‰€åœ¨çš„è·¯å¾„ï¼š</p>
<p><code>javac -cp D:\briup\apache-tomcat-8.5.58\lib\servlet-api.jar -d . HelloWorld.java</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132233637.png" alt="image-20200928215132763"></p>
<p>4ã€å°†ç¼–è¯‘å¥½çš„classæ–‡ä»¶ï¼Œè¿åŒåŒ…å¯¹åº”çš„ç›®å½•ï¼Œä¸€èµ·å‰ªåˆ‡åˆ°WEB-INFä¸‹é¢çš„classesç›®å½•</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132233057.png" alt="image-20200928215359894"></p>
<p>5ã€é…ç½®web.xml</p>
<p>åœ¨tomcatçš„ç›®å½•ä¸­ï¼Œæœ‰web.xmlæ–‡ä»¶çš„é…ç½®æ¨¡æ¿ï¼šconf/web.xml</p>
<p>å¤åˆ¶è¿‡æ¥ï¼Œè¿›è¡Œä¿®æ”¹ï¼Œå¦‚ä¸‹</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee</span></span></span><br><span class="line"><span class="string"><span class="tag">                      http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.briup.test.HelloWorld<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment">&lt;!-- å½“å‰æµè§ˆå™¨è®¿é—®web-testé¡¹ç›®ä¸­çš„åŠ¨æ€èµ„æº/hello-worldçš„æ—¶å€™--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- tomcatä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è°ƒç”¨com.briup.test.HelloWorldä¸­çš„æ–¹æ³•æ¥è¿›è¡Œå¤„ç†--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello-world<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>6ã€éƒ¨ç½²é¡¹ç›®</p>
<p>å°†å®Œæˆä»¥ä¸Šæ­¥éª¤çš„web-testé¡¹ç›®ï¼Œéƒ¨ç½²åˆ°tomcatä¸­çš„webappsç›®å½•ä¸­ã€‚ï¼ˆå¤åˆ¶è¿‡å»å³å¯ï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234649.png" alt="image-20200928220234198"></p>
<p>7ã€å¯åŠ¨</p>
<p>å¦‚æœtomcatä¹‹å‰å·²ç»å¯åŠ¨äº†ï¼Œå¯ä»¥å…³é—­åé‡å†™å¯åŠ¨ã€‚</p>
<p>8ã€è®¿é—®</p>
<p>å…ˆè®¿é—®web-testé¡¹ç›®ä¸­çš„é™æ€èµ„æº</p>
<p><a href="http://127.0.0.1:8989/web-test/index.html">http://127.0.0.1:8989/web-test/index.html</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234796.png" alt="image-20200928220545658"></p>
<p>å†è®¿é—®web-testé¡¹ç›®ä¸­çš„åŠ¨æ€èµ„æº</p>
<p><a href="http://127.0.0.1:8989/web-test/hello-world">http://127.0.0.1:8989/web-test/hello-world</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234475.png" alt="image-20200928220623329"></p>
<h3 id="3-3-æ€è€ƒ"><a href="#3-3-æ€è€ƒ" class="headerlink" title="3.3 æ€è€ƒ"></a>3.3 æ€è€ƒ</h3><p>ä»¥ä¸Šä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ–°å»ºäº†ä¸€ä¸ªjavaç±»<code>HelloWorld</code>ï¼Œæ­¤ç±»ä¸­å¹¶æ²¡æœ‰ç¼–å†™mainæ–¹æ³•ï¼Œåªæœ‰ä¸€ä¸ª<code>doGet</code>æ–¹æ³•ï¼Œé‚£ä¹ˆæœ€åæˆ‘ä»¬é€šè¿‡æµè§ˆå™¨è®¿é—®/hello-worldè·¯å¾„çš„æ—¶å€™ï¼Œè¯¥æ–¹æ³•æ˜¯æ€ä¹ˆæ‰§è¡Œçš„ï¼Ÿ</p>
<p>å¤§è‡´æ€è·¯å¦‚ä¸‹ï¼š</p>
<ol>
<li>æµè§ˆå™¨å‘é€è¯·æ±‚ï¼Œè®¿é—®web-testé¡¹ç›®ä¸­çš„/hello-worldèµ„æº</li>
<li>tomcatæ¥æ”¶åˆ°è¯·æ±‚ï¼Œæ ¹æ®web.xmlæ–‡ä»¶çš„é…ç½®ä¿¡æ¯ï¼Œæ‰¾åˆ°/hello-worldå¯¹åº”çš„æ˜¯com.briup.test.HelloWorld</li>
<li>tomcatåˆ›å»ºHelloWorldç±»çš„å¯¹è±¡ï¼ˆåå°„ï¼‰</li>
<li>tomcatè°ƒç”¨HelloWorldå¯¹è±¡ä¸­çš„æ–¹æ³•</li>
<li>æœ€ådoGetæ–¹æ³•è¢«æ‰§è¡Œï¼Œå‘æµè§ˆå™¨å†™å›ä¸€ä¸ªhtmlé¡µé¢çš„æºä»£ç </li>
<li>æµè§ˆå™¨æ¥åˆ°tomcatå†™å›æ¥çš„htmlé¡µé¢æºä»£ç ï¼Œè§£æå¹¶æ˜¾ç¤ºå‡ºæ¥</li>
</ol>
<h2 id="4-Eclipse"><a href="#4-Eclipse" class="headerlink" title="4 Eclipse"></a>4 Eclipse</h2><p>ä¸Šé¢ç¤ºä¾‹ï¼Œæ˜¯è‡ªå·±é€šè¿‡æ‰‹åŠ¨çš„æ–¹å¼ï¼Œåˆ›å»ºä¸€ä¸ªwebé¡¹ç›®ï¼Œç„¶åå†è¿›è¡Œç¼–å†™ã€ç¼–è¯‘ã€éƒ¨ç½²ã€å¯åŠ¨ã€è¿è¡Œã€‚</p>
<p>åŒæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Eclipseæ¥ç®€åŒ–ä»¥ä¸Šæ“ä½œçš„æ­¥éª¤</p>
<h3 id="4-1-å…³è”"><a href="#4-1-å…³è”" class="headerlink" title="4.1 å…³è”"></a>4.1 å…³è”</h3><p>åœ¨Eclipseä¸­ï¼Œæ–°å»ºæœåŠ¡å™¨ï¼Œå…³è”å¤–éƒ¨è§£å‹çš„tomcat</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234546.png" alt="image-20200928222557951"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234299.png" alt="image-20200928222617948"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234469.png" alt="image-20200928222700920"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234155.png" alt="image-20200928222718421"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234715.png" alt="image-20200928222756686"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234340.png" alt="image-20200928222838990"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234110.png" alt="image-20200928222859017"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132238143.png" alt="image-20200928223031128"></p>
<blockquote>
<p>æ­¤æ—¶ï¼ŒEclipseä¸­å¤šäº†ä¸€ä¸ªServersçš„é¡¹ç›®ï¼Œé‡Œé¢æ˜¯å…³è”äº†å¤–éƒ¨tomcatçš„é…ç½®æ–‡ä»¶</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234472.png" alt="image-20200928223226355"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234871.png" alt="image-20200928223345650"></p>
<p>å¯¹é»˜è®¤é…ç½®è¿›è¡Œä¿®æ”¹ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234868.png" alt="image-20200928223455105"></p>
<blockquote>
<p>æ³¨æ„ï¼Œç¬¬ä¸€ä¸ªä¿®æ”¹åœ°æ–¹è¡¨ç¤ºä½¿ç”¨å¤–éƒ¨çš„tomcatçš„ä½ç½®ï¼Œç¬¬äºŒä¸ªä¿®æ”¹çš„åœ°æ–¹è¡¨ç¤ºwebé¡¹ç›®éƒ¨ç½²çš„ä½ç½®</p>
</blockquote>
<p>å¦‚æœè¿˜è¦ä¿®æ”¹ç«¯å£å·ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234951.png" alt="image-20200928224641385"></p>
<h3 id="4-2-å¯åŠ¨"><a href="#4-2-å¯åŠ¨" class="headerlink" title="4.2 å¯åŠ¨"></a>4.2 å¯åŠ¨</h3><p>å¯åŠ¨ä¹‹å‰ï¼Œå¯ä»¥å…ˆæŠŠä¹‹å‰æ‰‹åŠ¨ä¸æ˜¯çš„web-testé¡¹ç›®ï¼Œä»webappsç›®å½•ä¸­åˆ é™¤æ‰ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234200.png" alt="image-20200928223607332"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234606.png" alt="image-20200928224006472"></p>
<blockquote>
<p>æ§åˆ¶å°ä¸­ï¼Œå¯ä»¥çœ‹åˆ°tomcatå¯åŠ¨çš„æ—¥å¿—ä¿¡æ¯</p>
</blockquote>
<h3 id="4-2-å…³é—­"><a href="#4-2-å…³é—­" class="headerlink" title="4.2 å…³é—­"></a>4.2 å…³é—­</h3><p>åœ¨Eclipseï¼Œå…³é—­å·²ç»å¯åŠ¨çš„TomcatæœåŠ¡å™¨ï¼Œä¹Ÿå¾ˆç®€å•ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234615.png" alt="image-20200928224358321"></p>
<p>æˆ–è€…ï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»consoleå³ä¸Šæ–¹çš„çº¢ç‚¹ï¼Œç›´æ¥åœæ­¢JVMçš„è¿è¡Œï¼Œé‚£ä¹ˆtomcatæœåŠ¡å™¨ä¹Ÿå°±åœæ­¢äº†ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234188.png" alt="image-20200928224457926"></p>
<h3 id="4-3-dynamic-web"><a href="#4-3-dynamic-web" class="headerlink" title="4.3 dynamic-web"></a>4.3 dynamic-web</h3><p>åœ¨Eclipseä¸­ï¼Œåˆ›å»ºwebé¡¹ç›®ï¼Œå¯ä»¥ä½¿ç”¨Eclipseä¸­çš„åŠ¨æ€webé¡¹ç›®ï¼ˆdynamic  webï¼‰</p>
<h4 id="4-3-1-åˆ›å»º"><a href="#4-3-1-åˆ›å»º" class="headerlink" title="4.3.1 åˆ›å»º"></a>4.3.1 åˆ›å»º</h4><p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234262.png" alt="image-20200928225125715"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132234892.png" alt="image-20200928225158905"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235938.png" alt="image-20200928225449055"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235761.png" alt="image-20200928225547450"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235870.png" alt="image-20200928225750688"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235462.png" alt="image-20200928230110222"></p>
<p>å¦‚æœä¹‹å‰æ²¡æœ‰æ‰“é’©è‡ªåŠ¨ç”Ÿæˆweb.xmlæ–‡ä»¶ï¼Œè¿™æ—¶å€™ä¹Ÿå¯ä»¥ç‚¹å‡»é¡¹ç›®ç„¶åè‡ªåŠ¨ç”Ÿæˆï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235958.png" alt="image-20200928230230925"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235431.png" alt="image-20200928230339161"></p>
<blockquote>
<p>æ³¨æ„ï¼Œå¦‚æœéœ€è¦å…³è”servlet-api.jarçš„æºä»£ç ï¼Œå¯ä»¥ç›´æ¥å°†apache-tomcat-8.5.58-src.zipé…ç½®å…³è”è¿‡å»å³å¯</p>
</blockquote>
<h4 id="4-3-2-ç¼–å†™"><a href="#4-3-2-ç¼–å†™" class="headerlink" title="4.3.2 ç¼–å†™"></a>4.3.2 ç¼–å†™</h4><p>é¡¹ç›®ä¸­ï¼Œsrcé‡Œé¢æ˜¯ç¼–å†™javaæºä»£ç çš„åœ°æ–¹</p>
<p><code>HelloWorld</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/hello-world&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">        PrintWriter out = resp.getWriter();</span><br><span class="line">        out.println(<span class="string">&quot;&lt;html&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;head&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;title&gt;index&lt;/title&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/head&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;body&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;h1&gt;Hello World! dynamic web&lt;/h1&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/body&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/html&gt;&quot;</span>);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨ä¸€ä¸ªæ³¨è§£ <code>@WebServlet</code>ï¼Œæ¥ä»£æ›¿äº†ä¹‹å‰web.xmlä¸­çš„é…ç½®ï¼Œå…¶æ•ˆæœæ˜¯ä¸€æ ·çš„</p>
</blockquote>
<p>==æ€è€ƒï¼Œè¿™é‡Œç”¨åˆ°çš„servletè§„èŒƒï¼Œåœ¨servlet-api.jaré‡Œé¢ï¼Œæ­¤jaråœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œè¯¥é¡¹ç›®æ˜¯æ€ä¹ˆå¼•å…¥çš„ï¼Ÿ==</p>
<p>é¡¹ç›®ä¸­ï¼ŒWebContenté‡Œé¢æ˜¯ç¼–å†™é¡µé¢çš„åœ°æ–¹</p>
<p><code>index.html</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world!dynamic web<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235327.png" alt="image-20200928231330732"></p>
<h4 id="4-3-3-éƒ¨ç½²"><a href="#4-3-3-éƒ¨ç½²" class="headerlink" title="4.3.3 éƒ¨ç½²"></a>4.3.3 éƒ¨ç½²</h4><p>ä»”ç»†è§‚å¯Ÿä¼šå‘ç°ï¼Œæ­¤æ—¶Eclipseä¸­çš„webé¡¹ç›®ç»“æ„ï¼Œå’Œè¦æ±‚çš„éƒ¨ç½²åˆ°Tomcatä¸­çš„é¡¹ç›®ç»“æ„ï¼Œæ˜¯æœ‰æ‰€ä¸åŒçš„ï¼Œé‚£ä¹ˆåœ¨éƒ¨ç½²çš„æ—¶å€™ï¼ŒEclipseé‡Œä¼šè¿›è¡Œè‡ªåŠ¨å¤„ç†ï¼Œå› ä¸ºEclipseä¸­å¯¹é¡¹ç›®çš„éƒ¨ç½²åšæ˜ å°„é…ç½®ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235095.png" alt="image-20200928231721322"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235815.png" alt="image-20200928231953209"></p>
<blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒEclipseå·²ç»æŠŠå½“å‰çš„é¡¹ç›®ç»“æ„ï¼Œå’Œæœ€åéƒ¨ç½²åˆ°Tomcatä¸­çš„é¡¹ç›®ç»“æ„çš„å¯¹åº”å…³ç³»ï¼Œéƒ½é…ç½®å¥½äº†</p>
</blockquote>
<p><strong>æ¥ä¸‹æ¥éƒ¨ç½²é¡¹ç›®ï¼š</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235359.png" alt="image-20200928232133403"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235343.png" alt="image-20200928232144212"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235486.png" alt="image-20200928232157368"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235319.png" alt="image-20200928232217507"></p>
<h4 id="4-3-4-å¯åŠ¨"><a href="#4-3-4-å¯åŠ¨" class="headerlink" title="4.3.4 å¯åŠ¨"></a>4.3.4 å¯åŠ¨</h4><p>éƒ¨ç½²å®Œæˆåï¼Œå°±å¯ä»¥å¯åŠ¨tomcatäº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235248.png" alt="image-20200928232300519"></p>
<p>å¯åŠ¨æˆåŠŸåï¼Œè§‚å¯Ÿtomcatä¸­çš„webappsç›®å½•é‡Œé¢ï¼Œæ˜¯å¦å·²ç»å®Œæˆäº†é¡¹ç›®éƒ¨ç½²ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235713.png" alt="image-20200928232422146"></p>
<h4 id="4-3-5-è®¿é—®"><a href="#4-3-5-è®¿é—®" class="headerlink" title="4.3.5 è®¿é—®"></a>4.3.5 è®¿é—®</h4><p>è®¿é—®é™æ€èµ„æºï¼š</p>
<p><a href="http://127.0.0.1:8989/dynamic-web/index.html">http://127.0.0.1:8989/dynamic-web/index.html</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132235992.png" alt="image-20200928232510037"></p>
<p>è®¿é—®åŠ¨æ€èµ„æºï¼š</p>
<p><a href="http://127.0.0.1:8989/dynamic-web/hello-world">http://127.0.0.1:8989/dynamic-web/hello-world</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236656.png" alt="image-20200928232537584"></p>
<h4 id="4-3-6-ç§»é™¤"><a href="#4-3-6-ç§»é™¤" class="headerlink" title="4.3.6 ç§»é™¤"></a>4.3.6 ç§»é™¤</h4><p>é¡¹ç›®å¦‚æœä¸éœ€è¦è¿è¡Œäº†ï¼Œè¿˜å¯ä»¥ä»tomcatçš„éƒ¨ç½²ä¸­ç§»é™¤ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236980.png" alt="image-20200928232644327"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236319.png" alt="image-20200928232716802"></p>
<p>è§‚å¯Ÿtomcatä¸­çš„webappsç›®å½•ä¸­æ˜¯å¦å·²ç»å°†å½“å‰é¡¹ç›®ç»™ç§»é™¤ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236234.png" alt="image-20200928232744989"></p>
<p>å› ä¸ºé¡¹ç›®ç§»é™¤äº†ï¼Œæ­¤æ—¶æµè§ˆå™¨è®¿é—®ä¼šå‡ºç°404ï¼Œèµ„æºæ‰¾ä¸åˆ°çš„æƒ…å†µï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236145.png" alt="image-20200928233122326"></p>
<h3 id="4-4-maven-web"><a href="#4-4-maven-web" class="headerlink" title="4.4 maven-web"></a>4.4 maven-web</h3><p>åœ¨Eclipseä¸­ï¼Œåˆ›å»ºwebé¡¹ç›®ï¼Œè¿˜å¯ä»¥ä½¿ç”¨mavené¡¹ç›®</p>
<h4 id="4-4-1-åˆ›å»º"><a href="#4-4-1-åˆ›å»º" class="headerlink" title="4.4.1 åˆ›å»º"></a>4.4.1 åˆ›å»º</h4><p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236632.png" alt="image-20200928233325758"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236128.png" alt="image-20200928233343830"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236653.png" alt="image-20200928233530045"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236351.png" alt="image-20200928233606264"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236439.png" alt="image-20200928234300664"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236000.png" alt="image-20220512103524555"></p>
<p>åœ¨webappä¸­ï¼Œæ–°å»ºç›®å½•WEB-INFï¼Œé‡Œé¢åœ¨æ–°å»ºweb.xml</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236616.png" alt="image-20200928234426964"></p>
<p><code>web.xml</code> æ–‡ä»¶å†…å®¹ï¼š </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">display-name</span>&gt;</span>maven-web<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.htm<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>default.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>default.htm<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>default.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯ä»¥å¤åˆ¶ä¹‹å‰çš„web.xmlï¼Œä¿®æ”¹ä¸‹å³å¯</p>
</blockquote>
<p>é…ç½®pom.xmlæ–‡ä»¶ï¼ŒæŒ‡å®šmavené¡¹ç›®çš„JDKç‰ˆæœ¬ã€é¡¹ç›®ç¼–ç ã€ä»¥åŠç›¸å…³é¡¹ç›®ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.briup.test<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- å¼•å…¥servlet3.1çš„ä¾èµ– --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">        <span class="comment">&lt;!-- å¼•å…¥jstlçš„ä¾èµ–ï¼Œjspé¡µé¢ä¸­ä¼šä½¿ç”¨åˆ° --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œå°†servletçš„ä¾èµ–èŒƒå›´ï¼ˆscopeï¼‰è®¾ç½®ä¸ºäº†providedï¼Œå› ä¸ºtomcatçš„libç›®å½•ä¸­ä¹Ÿæœ‰è¿™ä¸ªjaråŒ…ï¼Œå°†æ¥éƒ¨ç½²çš„æ—¶å€™ï¼Œä½¿ç”¨tomcatè‡ªå¸¦çš„jaråŒ…å³å¯</p>
</blockquote>
<p>ä¿®æ”¹å®Œè¿™äº›é…ç½®åï¼Œè®°å¾—å¯¹mavené¡¹ç›®è¿›è¡Œupdateæ“ä½œï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236897.png" alt="image-20200928234927413"></p>
<p>æ­¤æ—¶ï¼Œmavené¡¹ç›®ä¸­å°±ä¸ä¼šæŠ¥é”™äº†ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236135.png" alt="image-20200928235011223"></p>
<blockquote>
<p>æ³¨æ„ï¼Œå› ä¸ºmavené¡¹ç›®ä¸­ä¼šå¯¹web.xmlæ–‡ä»¶è¿›è¡ŒéªŒè¯ï¼Œä»ç½‘ç»œä¸Šä¸‹è½½schameï¼Œä½†æ˜¯å¯èƒ½ä¼šå› ä¸ºç½‘ç»œåŸå› ä¸‹è½½éªŒè¯å¤±è´¥ï¼Œå¯¼è‡´mavené¡¹ç›®è¿˜ä¼šæŠ¥é”™ï¼Œè¿™ä¸ªé”™è¯¯ä¸å½±å“è¿è¡Œï¼Œæˆ–å¤šæ›´æ–°å‡ æ¬¡é¡¹ç›®å°±å¯ä»¥äº†ã€‚</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œæ­¤æ—¶çš„mavené¡¹ç›®å¹¶æ²¡æœ‰åƒåŠ¨æ€webé¡¹ç›®ä¸€æ ·ï¼Œå¼•ç”¨äº†tomcatçš„è¿è¡Œç¯å¢ƒï¼Œè€Œä¸”æˆ‘ä»¬åœ¨pomæ–‡ä»¶ä¸­ï¼Œè‡ªå·±æ·»åŠ äº†ä¾èµ–ï¼Œå°†éœ€è¦ç”¨çš„çš„servlet-api.jarå¼•å…¥äº†è¿›æ¥</p>
</blockquote>
<h4 id="4-4-2-ç¼–å†™"><a href="#4-4-2-ç¼–å†™" class="headerlink" title="4.4.2 ç¼–å†™"></a>4.4.2 ç¼–å†™</h4><p>åœ¨mavené¡¹ç›®ä¸­ï¼Œå®Œæˆå’Œä¸Šé¢é¡¹ç›®ä¸­ä¸€æ ·çš„åŠŸèƒ½ï¼Œè¿›è¡Œæµ‹è¯•ã€‚</p>
<p>é¡¹ç›®ä¸­ï¼Œsrc/main/javaé‡Œé¢æ˜¯ç¼–å†™javaæºä»£ç çš„åœ°æ–¹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/hello-world&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">        PrintWriter out = resp.getWriter();</span><br><span class="line">        out.println(<span class="string">&quot;&lt;html&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;head&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;title&gt;index&lt;/title&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/head&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;body&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;h1&gt;Hello World! maven web&lt;/h1&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/body&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/html&gt;&quot;</span>);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œè¾“å‡ºçš„æ˜¯maven webï¼Œä¹‹å‰ä¸Šä¸ªä¾‹å­æœ‰æ‰€ä¸åŒ</p>
</blockquote>
<p>é¡¹ç›®ä¸­ï¼Œwebappé‡Œé¢æ˜¯ç¼–å†™é¡µé¢çš„åœ°æ–¹</p>
<p><code>index.html</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236069.png" alt="image-20200928235843519"></p>
<h4 id="4-4-3-éƒ¨ç½²"><a href="#4-4-3-éƒ¨ç½²" class="headerlink" title="4.4.3 éƒ¨ç½²"></a>4.4.3 éƒ¨ç½²</h4><p>Eclipseä¸­ï¼Œä¹Ÿå¯¹Mavené¡¹ç›®ï¼Œåšäº†éƒ¨ç½²æ˜ å°„ï¼Œå¯ä»¥å°†mavené¡¹ç›®çš„ç»“æ„ï¼Œè½¬æ¢ä¸ºTomcatä¸­éƒ¨ç½²é¡¹ç›®çš„ç»“æ„è¦æ±‚ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132236836.png" alt="image-20200929000015319"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237705.png" alt="image-20200929000050330"></p>
<blockquote>
<p>æ‰€ä»¥ï¼Œmavené¡¹ç›®çš„ç»“æ„è™½ç„¶å’ŒTomcatä¸­éƒ¨ç½²é¡¹ç›®çš„ç»“æ„æœ‰å¾ˆå¤§åŒºåˆ«ï¼Œä½†æ˜¯æœ€ç»ˆéƒ¨ç½²å®Œæˆåï¼Œè¿˜æ˜¯ä¼šå˜æˆæœ€ç»ˆè¦æ±‚çš„é¡¹ç›®ç»“æ„</p>
</blockquote>
<p>æ¥ä¸‹æ¥è¿›è¡Œé¡¹ç›®çš„éƒ¨ç½²ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237905.png" alt="image-20200929000230541"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237642.png" alt="image-20200929000304499"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237468.png" alt="image-20200929000325275"></p>
<h4 id="4-4-4-å¯åŠ¨"><a href="#4-4-4-å¯åŠ¨" class="headerlink" title="4.4.4 å¯åŠ¨"></a>4.4.4 å¯åŠ¨</h4><p>éƒ¨ç½²å®Œæˆåï¼Œå°±å¯ä»¥å¯åŠ¨tomcatäº†ï¼Œå¦‚æœå·²ç»å¯åŠ¨äº†ï¼Œä¹Ÿå¯ä»¥é‡å¯ä¸€æ¬¡ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237020.png" alt="image-20200929000447419"></p>
<p>å¯åŠ¨æˆåŠŸåï¼Œè§‚å¯Ÿtomcatä¸­çš„webappsç›®å½•é‡Œé¢ï¼Œæ˜¯å¦å·²ç»å®Œæˆäº†é¡¹ç›®éƒ¨ç½²ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237794.png" alt="image-20200929000522218"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237331.png" alt="image-20220512110054611"></p>
<h4 id="4-4-5-è®¿é—®"><a href="#4-4-5-è®¿é—®" class="headerlink" title="4.4.5 è®¿é—®"></a>4.4.5 è®¿é—®</h4><p>è®¿é—®é™æ€èµ„æºï¼š</p>
<p><a href="http://127.0.0.1:8989/maven-web/index.html">http://127.0.0.1:8989/maven-web/index.html</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237115.png" alt="image-20200929000612531"></p>
<p>è®¿é—®åŠ¨æ€èµ„æºï¼š</p>
<p><a href="http://127.0.0.1:8989/maven-web/hello-world">http://127.0.0.1:8989/maven-web/hello-world</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237403.png" alt="image-20200929000712569"></p>
<h4 id="4-4-6-ç§»é™¤"><a href="#4-4-6-ç§»é™¤" class="headerlink" title="4.4.6 ç§»é™¤"></a>4.4.6 ç§»é™¤</h4><p>é¡¹ç›®å¦‚æœä¸éœ€è¦è¿è¡Œäº†ï¼Œè¿˜å¯ä»¥ä»tomcatçš„éƒ¨ç½²ä¸­ç§»é™¤ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237499.png" alt="image-20200929000824385"></p>
<blockquote>
<p>æ³¨æ„ï¼Œå¦‚æœtomactè¿˜åœ¨è¿è¡ŒæœŸé—´ï¼ŒæŠŠé¡¹ç›®ç§»é™¤äº†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ§åˆ¶å°ä¸­è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œä½†æ˜¯è¿™ä¸ªå½±å“ï¼Œé‡æ–°å¯åŠ¨tomcatå°±å¯ä»¥äº†ã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237805.png" alt="image-20200929000934737"></p>
<p>è§‚å¯Ÿtomcatä¸­çš„webappsç›®å½•ä¸­æ˜¯å¦å·²ç»å°†å½“å‰é¡¹ç›®ç»™ç§»é™¤ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237141.png" alt="image-20200929001001172"></p>
<p>å› ä¸ºé¡¹ç›®ç§»é™¤äº†ï¼Œæ­¤æ—¶æµè§ˆå™¨è®¿é—®ä¼šå‡ºç°404ï¼Œèµ„æºæ‰¾ä¸åˆ°çš„æƒ…å†µï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237814.png" alt="image-20200929001046633"></p>
<h2 id="5-Http"><a href="#5-Http" class="headerlink" title="5 Http"></a>5 Http</h2><blockquote>
<p>åœ¨ä¸Šé¢çš„æµ‹è¯•ä¸­ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨å’ŒtomcatæœåŠ¡å™¨è¿›è¡Œè®¿é—®äº¤äº’ï¼Œå…¶é‡‡ç”¨çš„åè®®æ˜¯httpï¼Œè¯¥åè®®è§„å®šäº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„äº¤äº’æ–¹å¼ï¼Œä»¥åŠäº¤äº’å†…å®¹çš„æ ¼å¼è¦æ±‚ã€‚</p>
</blockquote>
<h3 id="5-1-æ¦‚è¿°"><a href="#5-1-æ¦‚è¿°" class="headerlink" title="5.1 æ¦‚è¿°"></a>5.1 æ¦‚è¿°</h3><p>è¶…æ–‡æœ¬ä¼ è¾“åè®® (HTTP-Hypertext transfer protocol) æ˜¯ä¸€ç§è¯¦ç»†è§„å®šäº†æµè§ˆå™¨å’Œä¸‡ç»´ç½‘æœåŠ¡å™¨ä¹‹é—´äº’ç›¸é€šä¿¡çš„è§„åˆ™ï¼Œé€šè¿‡å› ç‰¹ç½‘ä¼ é€ä¸‡ç»´ç½‘æ–‡æ¡£çš„æ•°æ®ä¼ é€åè®®ã€‚HTTPæ˜¯ä¸€ä¸ªåº”ç”¨å±‚åè®®ï¼Œç”±è¯·æ±‚å’Œå“åº”æ„æˆï¼Œæ˜¯ä¸€ä¸ªæ ‡å‡†çš„å®¢æˆ·ç«¯æœåŠ¡å™¨æ¨¡å‹ã€‚</p>
<h3 id="5-2-äº¤äº’æ–¹å¼"><a href="#5-2-äº¤äº’æ–¹å¼" class="headerlink" title="5.2 äº¤äº’æ–¹å¼"></a>5.2 äº¤äº’æ–¹å¼</h3><p>httpåè®®è§„å®šï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼š</p>
<ul>
<li>å…ˆç”±å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‘æœåŠ¡å™¨ï¼ˆtomcatï¼‰å‘é€è¯·æ±‚ï¼ˆrequestï¼‰</li>
<li>æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œæ ¹æ®è¯·æ±‚çš„èµ„æºè·¯å¾„ï¼Œåœ¨æœåŠ¡å™¨å†…éƒ¨éƒ¨ç½²çš„é¡¹ç›®ä¸­ï¼ŒæŸ¥æ‰¾æ˜¯å¦æœ‰è¯¥èµ„æº</li>
<li>å¦‚æœè¯¥èµ„æºå­˜åœ¨ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±ä¼šå°†è¯¥èµ„æºè¿”å›ï¼ˆé™æ€èµ„æºï¼‰ï¼Œæˆ–è€…æŠŠè¯¥èµ„æºçš„è¿è¡Œç»“æœè¿”å›ï¼ˆåŠ¨æ€èµ„æºï¼‰</li>
<li>å¦‚æœè¯¥èµ„æºä¸å­˜åœ¨ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±ä¼šè¿”å›ä¸€ä¸ªçŠ¶æ€ç ï¼ˆ404ï¼‰ï¼Œè¡¨ç¤ºæœ¬æ¬¡è®¿é—®çš„èµ„æºæ‰¾ä¸åˆ°</li>
<li>ä¸ç®¡èµ„æºå­˜åœ¨è¿˜æ˜¯ä¸å­˜åœ¨ï¼ŒæœåŠ¡å™¨éƒ½ä¼šé’ˆå¯¹è¿™æ¬¡è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ªç»“æœï¼Œè¿™ä¸ªç»“æœå°±è¢«ç§°ä¹‹ä¸ºå“åº”ï¼ˆresponseï¼‰</li>
<li>å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰æ¥æ”¶åˆ°æœ¬æ¬¡è¯·æ±‚çš„å“åº”å†…å®¹åï¼Œè§£æå¹¶æ˜¾ç¤ºå‡ºæ¥</li>
</ul>
<p>æ­¤æ—¶ï¼Œæœ¬æ¬¡httpåè®®ä¸‹çš„è®¿é—®ç»“æŸã€‚ç”¨æˆ·è¿˜å¯ä»¥å†æ¬¡å‘å‡ºè¯·æ±‚ï¼Œé‚£ä¹ˆå°±é‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚</p>
<h3 id="5-3-å†…å®¹æ ¼å¼"><a href="#5-3-å†…å®¹æ ¼å¼" class="headerlink" title="5.3 å†…å®¹æ ¼å¼"></a>5.3 å†…å®¹æ ¼å¼</h3><blockquote>
<p>æ— è®ºæ˜¯å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚å†…å®¹ï¼Œè¿˜æ˜¯æœåŠ¡å™¨è¿”å›çš„å“åº”å†…å®¹ï¼Œåœ¨httpåè®®ä¸­ï¼Œéƒ½æ˜¯æœ‰å›ºå®šçš„æ ¼å¼è¦æ±‚çš„ã€‚</p>
</blockquote>
<h4 id="5-3-1-è¯·æ±‚"><a href="#5-3-1-è¯·æ±‚" class="headerlink" title="5.3.1 è¯·æ±‚"></a>5.3.1 è¯·æ±‚</h4><p>å®¢æˆ·ç«¯å‘é€åˆ°æœåŠ¡å™¨ç«¯çš„è¯·æ±‚æ¶ˆæ¯ï¼Œç§°ä¹‹ä¸ºè¯·æ±‚(request)ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªæŒ‰ç…§httpåè®®çš„è§„åˆ™æ‹¼æ¥è€Œæˆçš„å­—ç¬¦ä¸²</p>
<p>Requestè¯·æ±‚æ¶ˆæ¯åŒ…å«ä¸‰éƒ¨åˆ†ï¼š</p>
<ul>
<li>è¯·æ±‚è¡Œï¼Œrequest line</li>
<li>æ¶ˆæ¯æŠ¥å¤´ï¼ˆè¯·æ±‚å¤´ï¼‰ï¼Œrequest head</li>
<li>è¯·æ±‚æ­£æ–‡ï¼Œrequest body</li>
</ul>
<p><strong>1ã€è¯·æ±‚è¡Œï¼Œrequest line</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ ¼å¼: CRLFè¡¨ç¤ºå›è½¦å’Œæ¢è¡Œ</span><br><span class="line">Method Request-URI HTTP-Version CRLF</span><br></pre></td></tr></table></figure>

<ul>
<li>Methodè¡¨ç¤ºè¯·æ±‚æ–¹æ³•ï¼›ä¸€èˆ¬ä¸ºGETæˆ–è€…POST</li>
<li>Request-URIæ˜¯ä¸€ä¸ªç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼Œæœ¬æ¬¡è¯·æ±‚çš„èµ„æºè·¯å¾„</li>
<li>HTTP-Versionè¡¨ç¤ºè¯·æ±‚çš„HTTPåè®®ç‰ˆæœ¬ï¼ŒHTTP/1.1</li>
</ul>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /test.html HTTP/1.1</span><br></pre></td></tr></table></figure>



<p><strong>2ã€æ¶ˆæ¯æŠ¥å¤´ï¼ˆè¯·æ±‚å¤´ï¼‰ï¼Œrequest head</strong></p>
<blockquote>
<p>æ³¨æ„ï¼Œæ­¤éƒ¨åˆ†ä½œä¸ºäº†è§£ï¼Œé‡åˆ°å…·ä½“æƒ…å†µå†è¿›è¡ŒæŸ¥é˜…å³å¯</p>
</blockquote>
<p>httpè¯·æ±‚æŠ¥å¤´çš„ç”Ÿæˆï¼Œä¸»è¦æœ‰ä¸‰ç§æƒ…å†µï¼š</p>
<ul>
<li><p>æµè§ˆå™¨è‡ªåŠ¨ç”Ÿæˆçš„è¯·æ±‚</p>
<p>ç»å¤§éƒ¨åˆ†æ­£å¸¸ç”¨æˆ·è®¿é—®éƒ½æ˜¯è¿™ç±»æƒ…å†µï¼Œåªè¦æ˜¯ç”¨æˆ·ä¸»åŠ¨è¾“å…¥ç½‘å€è®¿é—®æ—¶å‘é€çš„httpè¯·æ±‚ï¼Œé‚£è¿™äº›å¤´éƒ¨å­—æ®µéƒ½æ˜¯æµè§ˆå™¨è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œæ¯”å¦‚hostï¼Œcookieï¼Œuser-agent, Accept-Encoding:ç­‰</p>
</li>
<li><p>æµè§ˆå™¨æ’ä»¶</p>
<p>javascriptè„šæœ¬å¢åŠ æˆ–è€…ä¿®æ”¹çš„headerã€‚JSèƒ½å¤Ÿæ§åˆ¶æµè§ˆå™¨å‘èµ·è¯·æ±‚ï¼Œä¹Ÿèƒ½åœ¨è¿™é‡Œå¢åŠ ä¸€äº›headerï¼Œä½†æ˜¯è€ƒè™‘åˆ°å®‰å…¨å’Œæ€§èƒ½çš„åŸå› ï¼Œå¯¹JSæ§åˆ¶ headerçš„èƒ½åŠ›åšäº†ä¸€äº›é™åˆ¶ï¼Œæ¯”å¦‚hostå’Œcookie, user-agentç­‰è¿™äº›å­—æ®µï¼ŒJSæ˜¯æ— æ³•å¹²é¢„çš„</p>
</li>
<li><p>ä¸­é—´ä»£ç†</p>
<p>å¦‚æœç”¨æˆ·è¯·æ±‚è¦ç»è¿‡ä¸€äº›ä¸­é—´ä»£ç†ï¼ˆæ¯”å¦‚è¿è¥å•†æˆ–è€…å…¬å¸ç½‘å…³ï¼‰ï¼Œä¸­é—´ä»£ç†èƒ½å¤ŸæŸ¥çœ‹å’Œä¿®æ”¹ç”¨æˆ·çš„å…¨éƒ¨æ•°æ®å’Œä»»ä½•å¤´éƒ¨å­—æ®µã€‚é™¤éä½¿ç”¨äº†HTTPS</p>
</li>
</ul>
<p>httpæ¶ˆæ¯æŠ¥å¤´åŒ…æ‹¬æ™®é€šæŠ¥å¤´ã€è¯·æ±‚æŠ¥å¤´ã€å“åº”æŠ¥å¤´ã€å®ä½“æŠ¥å¤´è¿™å››å¤§ç±»ï¼Œå®ƒä»¬çš„ä½œç”¨æ˜¯æè¿° å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡å™¨ çš„å±æ€§ï¼Œå¹¶ä¸”éƒ½æ˜¯ç”± åå­—+å†’å·+ç©ºæ ¼+å€¼ ç»„æˆï¼Œä¾‹å¦‚ï¼Œ Content-Type: text/html</p>
<ul>
<li><p>æ™®é€šæŠ¥å¤´</p>
<p>å³å¯ç”¨äºè¯·æ±‚ï¼Œä¹Ÿå¯ç”¨äºå“åº”ï¼Œæ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“è€Œä¸æ˜¯ç‰¹å®šèµ„æºä¸äº‹åŠ¡ç›¸å…³è”</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p>Cache-Control<br>Connection<br>Date<br>Pragma<br>Transfer-Encoding<br>Upgrade<br>Via</p>
</li>
<li><p>è¯·æ±‚æŠ¥å¤´</p>
<p>å…è®¸å®¢æˆ·ç«¯ä¼ é€’å…³äºè‡ªèº«ä¿¡æ¯å’Œå¸Œæœ›çš„å“åº”å½¢å¼</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p>Accept<br>Accept-Charset<br>Accept-Encoding<br>Accept-Language<br>Authorization<br>Host<br>User-Agent<br>From<br>If-Modified-Since<br>If-Match<br>If-None-Match<br>If-Range<br>If-Unmodified-Since<br>Max-Forwards<br>Proxy-Authorization<br>Range<br>Referer</p>
</li>
<li><p>å“åº”æŠ¥å¤´</p>
<p>å…è®¸æœåŠ¡å™¨ä¼ é€’å…³äºè‡ªèº«ä¿¡æ¯çš„å“åº”</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p>Location<br>Server<br>WWW-Authenticate<br>Age<br>Proxy-Authenticate<br>Public<br>Retry-After<br>Vary<br>Warning</p>
</li>
<li><p>å®ä½“æŠ¥å¤´</p>
<p>å®šä¹‰è¢«ä¼ é€èµ„æºçš„ä¿¡æ¯ã€‚å³å¯ç”¨äºè¯·æ±‚ï¼Œä¹Ÿå¯ç”¨äºå“åº”</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p>Content-Encoding<br>Content-Language<br>Content-Length<br>Content-Type<br>Last-Modified<br>Expires<br>Allow<br>Content-Base<br>Content-Location<br>Content-MD5<br>Content-Range<br>Etag<br>extension-header</p>
</li>
</ul>
<p>ä¾‹å¦‚:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /test.html HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:9999</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,en;q=0.8,zh;q=0.5,en-US;q=0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: keep-alive</span><br></pre></td></tr></table></figure>

<p>â€‹        </p>
<p>å…·ä½“çš„å¯ä»¥åœ¨æµè§ˆå™¨çš„webæ§åˆ¶å°ä¸­ï¼Œè¿›è¡ŒæŸ¥çœ‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132237163.png" alt="image-20200929004449654"></p>
<p><strong>3ã€è¯·æ±‚æ­£æ–‡ï¼Œrequest body</strong></p>
<p>è¯·æ±‚å¤´å’Œè¯·æ±‚æ­£æ–‡ä¹‹é—´æ˜¯ä¸€ä¸ªç©ºè¡Œï¼Œè¿™ä¸ªè¡Œéå¸¸é‡è¦ï¼Œå®ƒè¡¨ç¤ºè¯·æ±‚å¤´å·²ç»ç»“æŸï¼Œæ¥ä¸‹æ¥çš„æ˜¯è¯·æ±‚æ­£æ–‡ã€‚</p>
<p>è¯·æ±‚æ­£æ–‡ä¸­å¯ä»¥åŒ…å«å®¢æˆ·æäº¤çš„å­—ç¬¦ä¸²ä¿¡æ¯</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /test.html HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:9999</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,en;q=0.8,zh;q=0.5,en-US;q=0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">id=1&amp;name=tom&amp;age=20</span><br></pre></td></tr></table></figure>



<h4 id="5-3-2-å“åº”"><a href="#5-3-2-å“åº”" class="headerlink" title="5.3.2 å“åº”"></a>5.3.2 å“åº”</h4><p>æœåŠ¡å™¨åœ¨æ¥æ”¶å’Œè§£æå®¢æˆ·ç«¯çš„è¯·æ±‚æ¶ˆæ¯åï¼Œä¼šè¿”å›ç»™å®¢æˆ·ç«¯ä¸€ä¸ªHTTPå“åº”æ¶ˆæ¯ï¼ˆresponseï¼‰ã€‚</p>
<p>å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‰ç…§httpåè®®çš„è§„åˆ™æ‹¼æ¥è€Œæˆçš„ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p>HTTPå“åº”ä¹Ÿæ˜¯ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li>å“åº”çŠ¶æ€è¡Œï¼Œresponse status line</li>
<li>æ¶ˆæ¯æŠ¥å¤´ï¼ˆå“åº”å¤´ï¼‰ï¼Œresponse head</li>
<li>å“åº”æ­£æ–‡ï¼Œresponse body</li>
</ul>
<p><strong>1ã€å“åº”çŠ¶æ€è¡Œï¼Œresponse status line</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ ¼å¼å¦‚ä¸‹ï¼šCRLFè¡¨ç¤ºå›è½¦å’Œæ¢è¡Œ</span><br><span class="line">HTTP-Version Status-Code Reason-Phrase CRLF</span><br></pre></td></tr></table></figure>

<ul>
<li>HTTP-Versionè¡¨ç¤ºæœåŠ¡å™¨HTTPåè®®çš„ç‰ˆæœ¬</li>
<li>Status-Codeè¡¨ç¤ºæœåŠ¡å™¨å‘å›çš„å“åº”çŠ¶æ€ä»£ç </li>
<li>Reason-Phraseè¡¨ç¤ºçŠ¶æ€ä»£ç çš„æ–‡æœ¬æè¿°</li>
</ul>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br></pre></td></tr></table></figure>



<p>å…³äºå“åº”çŠ¶æ€ä»£ç ï¼Œå…±åˆ†ä¸º5ç§ç±»å‹ï¼š</p>
<table>
<thead>
<tr>
<th align="left">åˆ†ç±»</th>
<th align="left">åˆ†ç±»æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1xx</td>
<td align="left">ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œ</td>
</tr>
<tr>
<td align="left">2xx</td>
<td align="left">æˆåŠŸï¼Œæ“ä½œè¢«æˆåŠŸæ¥æ”¶å¹¶å¤„ç†</td>
</tr>
<tr>
<td align="left">3xx</td>
<td align="left">é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚</td>
</tr>
<tr>
<td align="left">4xx</td>
<td align="left">å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚</td>
</tr>
<tr>
<td align="left">5xx</td>
<td align="left">æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯</td>
</tr>
</tbody></table>
<p><strong>HTTPçŠ¶æ€ç åˆ—è¡¨</strong></p>
<table>
<thead>
<tr>
<th align="left">çŠ¶æ€ç </th>
<th align="left">çŠ¶æ€ç è‹±æ–‡åç§°</th>
<th align="left">ä¸­æ–‡æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">100</td>
<td align="left">Continue</td>
<td align="left">ç»§ç»­ã€‚å®¢æˆ·ç«¯åº”ç»§ç»­å…¶è¯·æ±‚</td>
</tr>
<tr>
<td align="left">101</td>
<td align="left">Switching Protocols</td>
<td align="left">åˆ‡æ¢åè®®ã€‚æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ‡æ¢åè®®ã€‚åªèƒ½åˆ‡æ¢åˆ°æ›´é«˜çº§çš„åè®®ï¼Œä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ°HTTPçš„æ–°ç‰ˆæœ¬åè®®</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">200</td>
<td align="left">OK</td>
<td align="left">è¯·æ±‚æˆåŠŸã€‚ä¸€èˆ¬ç”¨äºGETä¸POSTè¯·æ±‚</td>
</tr>
<tr>
<td align="left">201</td>
<td align="left">Created</td>
<td align="left">å·²åˆ›å»ºã€‚æˆåŠŸè¯·æ±‚å¹¶åˆ›å»ºäº†æ–°çš„èµ„æº</td>
</tr>
<tr>
<td align="left">202</td>
<td align="left">Accepted</td>
<td align="left">å·²æ¥å—ã€‚å·²ç»æ¥å—è¯·æ±‚ï¼Œä½†æœªå¤„ç†å®Œæˆ</td>
</tr>
<tr>
<td align="left">203</td>
<td align="left">Non-Authoritative Information</td>
<td align="left">éæˆæƒä¿¡æ¯ã€‚è¯·æ±‚æˆåŠŸã€‚ä½†è¿”å›çš„metaä¿¡æ¯ä¸åœ¨åŸå§‹çš„æœåŠ¡å™¨ï¼Œè€Œæ˜¯ä¸€ä¸ªå‰¯æœ¬</td>
</tr>
<tr>
<td align="left">204</td>
<td align="left">No Content</td>
<td align="left">æ— å†…å®¹ã€‚æœåŠ¡å™¨æˆåŠŸå¤„ç†ï¼Œä½†æœªè¿”å›å†…å®¹ã€‚åœ¨æœªæ›´æ–°ç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯ç¡®ä¿æµè§ˆå™¨ç»§ç»­æ˜¾ç¤ºå½“å‰æ–‡æ¡£</td>
</tr>
<tr>
<td align="left">205</td>
<td align="left">Reset Content</td>
<td align="left">é‡ç½®å†…å®¹ã€‚æœåŠ¡å™¨å¤„ç†æˆåŠŸï¼Œç”¨æˆ·ç»ˆç«¯ï¼ˆä¾‹å¦‚ï¼šæµè§ˆå™¨ï¼‰åº”é‡ç½®æ–‡æ¡£è§†å›¾ã€‚å¯é€šè¿‡æ­¤è¿”å›ç æ¸…é™¤æµè§ˆå™¨çš„è¡¨å•åŸŸ</td>
</tr>
<tr>
<td align="left">206</td>
<td align="left">Partial Content</td>
<td align="left">éƒ¨åˆ†å†…å®¹ã€‚æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†éƒ¨åˆ†GETè¯·æ±‚</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">300</td>
<td align="left">Multiple Choices</td>
<td align="left">å¤šç§é€‰æ‹©ã€‚è¯·æ±‚çš„èµ„æºå¯åŒ…æ‹¬å¤šä¸ªä½ç½®ï¼Œç›¸åº”å¯è¿”å›ä¸€ä¸ªèµ„æºç‰¹å¾ä¸åœ°å€çš„åˆ—è¡¨ç”¨äºç”¨æˆ·ç»ˆç«¯ï¼ˆä¾‹å¦‚ï¼šæµè§ˆå™¨ï¼‰é€‰æ‹©</td>
</tr>
<tr>
<td align="left">301</td>
<td align="left">Moved Permanently</td>
<td align="left">æ°¸ä¹…ç§»åŠ¨ã€‚è¯·æ±‚çš„èµ„æºå·²è¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°æ–°URIï¼Œè¿”å›ä¿¡æ¯ä¼šåŒ…æ‹¬æ–°çš„URIï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®šå‘åˆ°æ–°URIã€‚ä»Šåä»»ä½•æ–°çš„è¯·æ±‚éƒ½åº”ä½¿ç”¨æ–°çš„URIä»£æ›¿</td>
</tr>
<tr>
<td align="left">302</td>
<td align="left">Found</td>
<td align="left">ä¸´æ—¶ç§»åŠ¨ã€‚ä¸301ç±»ä¼¼ã€‚ä½†èµ„æºåªæ˜¯ä¸´æ—¶è¢«ç§»åŠ¨ã€‚å®¢æˆ·ç«¯åº”ç»§ç»­ä½¿ç”¨åŸæœ‰URI</td>
</tr>
<tr>
<td align="left">303</td>
<td align="left">See Other</td>
<td align="left">æŸ¥çœ‹å…¶å®ƒåœ°å€ã€‚ä¸301ç±»ä¼¼ã€‚ä½¿ç”¨GETå’ŒPOSTè¯·æ±‚æŸ¥çœ‹</td>
</tr>
<tr>
<td align="left">304</td>
<td align="left">Not Modified</td>
<td align="left">æœªä¿®æ”¹ã€‚æ‰€è¯·æ±‚çš„èµ„æºæœªä¿®æ”¹ï¼ŒæœåŠ¡å™¨è¿”å›æ­¤çŠ¶æ€ç æ—¶ï¼Œä¸ä¼šè¿”å›ä»»ä½•èµ„æºã€‚å®¢æˆ·ç«¯é€šå¸¸ä¼šç¼“å­˜è®¿é—®è¿‡çš„èµ„æºï¼Œé€šè¿‡æä¾›ä¸€ä¸ªå¤´ä¿¡æ¯æŒ‡å‡ºå®¢æˆ·ç«¯å¸Œæœ›åªè¿”å›åœ¨æŒ‡å®šæ—¥æœŸä¹‹åä¿®æ”¹çš„èµ„æº</td>
</tr>
<tr>
<td align="left">305</td>
<td align="left">Use Proxy</td>
<td align="left">ä½¿ç”¨ä»£ç†ã€‚æ‰€è¯·æ±‚çš„èµ„æºå¿…é¡»é€šè¿‡ä»£ç†è®¿é—®</td>
</tr>
<tr>
<td align="left">306</td>
<td align="left">Unused</td>
<td align="left">å·²ç»è¢«åºŸå¼ƒçš„HTTPçŠ¶æ€ç </td>
</tr>
<tr>
<td align="left">307</td>
<td align="left">Temporary Redirect</td>
<td align="left">ä¸´æ—¶é‡å®šå‘ã€‚ä¸302ç±»ä¼¼ã€‚ä½¿ç”¨GETè¯·æ±‚é‡å®šå‘</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">400</td>
<td align="left">Bad Request</td>
<td align="left">å®¢æˆ·ç«¯è¯·æ±‚çš„è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£</td>
</tr>
<tr>
<td align="left">401</td>
<td align="left">Unauthorized</td>
<td align="left">è¯·æ±‚è¦æ±‚ç”¨æˆ·çš„èº«ä»½è®¤è¯</td>
</tr>
<tr>
<td align="left">402</td>
<td align="left">Payment Required</td>
<td align="left">ä¿ç•™ï¼Œå°†æ¥ä½¿ç”¨</td>
</tr>
<tr>
<td align="left">403</td>
<td align="left">Forbidden</td>
<td align="left">æœåŠ¡å™¨ç†è§£è¯·æ±‚å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œæ­¤è¯·æ±‚</td>
</tr>
<tr>
<td align="left">404</td>
<td align="left">Not Found</td>
<td align="left">æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚é€šè¿‡æ­¤ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯è®¾ç½®â€æ‚¨æ‰€è¯·æ±‚çš„èµ„æºæ— æ³•æ‰¾åˆ°â€çš„ä¸ªæ€§é¡µé¢</td>
</tr>
<tr>
<td align="left">405</td>
<td align="left">Method Not Allowed</td>
<td align="left">å®¢æˆ·ç«¯è¯·æ±‚ä¸­çš„æ–¹æ³•è¢«ç¦æ­¢</td>
</tr>
<tr>
<td align="left">406</td>
<td align="left">Not Acceptable</td>
<td align="left">æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚çš„å†…å®¹ç‰¹æ€§å®Œæˆè¯·æ±‚</td>
</tr>
<tr>
<td align="left">407</td>
<td align="left">Proxy Authentication Required</td>
<td align="left">è¯·æ±‚è¦æ±‚ä»£ç†çš„èº«ä»½è®¤è¯ï¼Œä¸401ç±»ä¼¼ï¼Œä½†è¯·æ±‚è€…åº”å½“ä½¿ç”¨ä»£ç†è¿›è¡Œæˆæƒ</td>
</tr>
<tr>
<td align="left">408</td>
<td align="left">Request Time-out</td>
<td align="left">æœåŠ¡å™¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ—¶é—´è¿‡é•¿ï¼Œè¶…æ—¶</td>
</tr>
<tr>
<td align="left">409</td>
<td align="left">Conflict</td>
<td align="left">æœåŠ¡å™¨å®Œæˆå®¢æˆ·ç«¯çš„PUTè¯·æ±‚æ˜¯å¯èƒ½è¿”å›æ­¤ä»£ç ï¼ŒæœåŠ¡å™¨å¤„ç†è¯·æ±‚æ—¶å‘ç”Ÿäº†å†²çª</td>
</tr>
<tr>
<td align="left">410</td>
<td align="left">Gone</td>
<td align="left">å®¢æˆ·ç«¯è¯·æ±‚çš„èµ„æºå·²ç»ä¸å­˜åœ¨ã€‚410ä¸åŒäº404ï¼Œå¦‚æœèµ„æºä»¥å‰æœ‰ç°åœ¨è¢«æ°¸ä¹…åˆ é™¤äº†å¯ä½¿ç”¨410ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯é€šè¿‡301ä»£ç æŒ‡å®šèµ„æºçš„æ–°ä½ç½®</td>
</tr>
<tr>
<td align="left">411</td>
<td align="left">Length Required</td>
<td align="left">æœåŠ¡å™¨æ— æ³•å¤„ç†å®¢æˆ·ç«¯å‘é€çš„ä¸å¸¦Content-Lengthçš„è¯·æ±‚ä¿¡æ¯</td>
</tr>
<tr>
<td align="left">412</td>
<td align="left">Precondition Failed</td>
<td align="left">å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯çš„å…ˆå†³æ¡ä»¶é”™è¯¯</td>
</tr>
<tr>
<td align="left">413</td>
<td align="left">Request Entity Too Large</td>
<td align="left">ç”±äºè¯·æ±‚çš„å®ä½“è¿‡å¤§ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†ï¼Œå› æ­¤æ‹’ç»è¯·æ±‚ã€‚ä¸ºé˜²æ­¢å®¢æˆ·ç«¯çš„è¿ç»­è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šå…³é—­è¿æ¥ã€‚å¦‚æœåªæ˜¯æœåŠ¡å™¨æš‚æ—¶æ— æ³•å¤„ç†ï¼Œåˆ™ä¼šåŒ…å«ä¸€ä¸ªRetry-Afterçš„å“åº”ä¿¡æ¯</td>
</tr>
<tr>
<td align="left">414</td>
<td align="left">Request-URI Too Large</td>
<td align="left">è¯·æ±‚çš„URIè¿‡é•¿ï¼ˆURIé€šå¸¸ä¸ºç½‘å€ï¼‰ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†</td>
</tr>
<tr>
<td align="left">415</td>
<td align="left">Unsupported Media Type</td>
<td align="left">æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚é™„å¸¦çš„åª’ä½“æ ¼å¼</td>
</tr>
<tr>
<td align="left">416</td>
<td align="left">Requested range not satisfiable</td>
<td align="left">å®¢æˆ·ç«¯è¯·æ±‚çš„èŒƒå›´æ— æ•ˆ</td>
</tr>
<tr>
<td align="left">417</td>
<td align="left">Expectation Failed</td>
<td align="left">æœåŠ¡å™¨æ— æ³•æ»¡è¶³Expectçš„è¯·æ±‚å¤´ä¿¡æ¯</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">500</td>
<td align="left">Internal Server Error</td>
<td align="left">æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚</td>
</tr>
<tr>
<td align="left">501</td>
<td align="left">Not Implemented</td>
<td align="left">æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚çš„åŠŸèƒ½ï¼Œæ— æ³•å®Œæˆè¯·æ±‚</td>
</tr>
<tr>
<td align="left">502</td>
<td align="left">Bad Gateway</td>
<td align="left">ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œä»è¿œç¨‹æœåŠ¡å™¨æ¥æ”¶åˆ°äº†ä¸€ä¸ªæ— æ•ˆçš„å“åº”</td>
</tr>
<tr>
<td align="left">503</td>
<td align="left">Service Unavailable</td>
<td align="left">ç”±äºè¶…è½½æˆ–ç³»ç»Ÿç»´æŠ¤ï¼ŒæœåŠ¡å™¨æš‚æ—¶çš„æ— æ³•å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å»¶æ—¶çš„é•¿åº¦å¯åŒ…å«åœ¨æœåŠ¡å™¨çš„Retry-Afterå¤´ä¿¡æ¯ä¸­</td>
</tr>
<tr>
<td align="left">504</td>
<td align="left">Gateway Time-out</td>
<td align="left">å……å½“ç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼ŒæœªåŠæ—¶ä»è¿œç«¯æœåŠ¡å™¨è·å–è¯·æ±‚</td>
</tr>
<tr>
<td align="left">505</td>
<td align="left">HTTP Version not supported</td>
<td align="left">æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚çš„HTTPåè®®çš„ç‰ˆæœ¬ï¼Œæ— æ³•å®Œæˆå¤„ç†</td>
</tr>
</tbody></table>
<p><strong>å¸¸è§çŠ¶æ€ç &amp;å«ä¹‰</strong></p>
<pre><code> 200 - è¯·æ±‚æˆåŠŸï¼Œå·²ç»æ­£å¸¸å¤„ç†å®Œæ¯•
</code></pre>
<p>â€‹    301 - è¯·æ±‚æ°¸ä¹…é‡å®šå‘ï¼Œè½¬ç§»åˆ°å…¶å®ƒURL</p>
<p>â€‹    302 - è¯·æ±‚ä¸´æ—¶é‡å®šå‘</p>
<p>â€‹    304 - è¯·æ±‚è¢«é‡å®šå‘åˆ°å®¢æˆ·ç«¯æœ¬åœ°ç¼“å­˜</p>
<p>â€‹    400 - å®¢æˆ·ç«¯è¯·æ±‚å­˜åœ¨è¯­æ³•é”™è¯¯</p>
<p>â€‹    401 - å®¢æˆ·ç«¯è¯·æ±‚æ²¡æœ‰ç»è¿‡æˆæƒ</p>
<p>â€‹    403 - å®¢æˆ·ç«¯çš„è¯·æ±‚è¢«æœåŠ¡å™¨æ‹’ç»ï¼Œä¸€èˆ¬ä¸ºå®¢æˆ·ç«¯æ²¡æœ‰è®¿é—®æƒé™</p>
<p>â€‹    404 - å®¢æˆ·ç«¯è¯·æ±‚çš„URLåœ¨æœåŠ¡ç«¯ä¸å­˜åœ¨</p>
<p>â€‹    500 - æœåŠ¡ç«¯é”™è¯¯</p>
<p><strong>2ã€æ¶ˆæ¯æŠ¥å¤´ï¼ˆå“åº”å¤´ï¼‰ï¼Œresponse head</strong></p>
<p>å’Œè¯·æ±‚æŠ¥å¤´ä¸­çš„æè¿°ä¸€è‡´ã€‚</p>
<p>é¢å¤–çš„ï¼Œåœ¨å“åº”çš„æ¶ˆæ¯æŠ¥å¤´ä¸­ï¼Œä¸€èˆ¬éƒ½ä¼šæœ‰Content-Typeå­—æ®µï¼Œç”¨æ¥å‘Šè¯‰æµè§ˆå™¨ï¼Œæœ¬æ¬¡å“åº”å›å»çš„å†…å®¹æ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®ï¼Œæµè§ˆå™¨å¯ä»¥æ ¹æ®å°±è¿™ä¸ªå¯¹å†…å®¹è¿›è¡Œè§£æã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœå“åº”çš„æ•°æ®æ˜¯htmlï¼Œåˆ™å“åº”æŠ¥å¤´ä¸­åº”è¯¥æœ‰ï¼Œ<code>Content-Type: text/html</code></p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœå“åº”çš„æ•°æ®æ˜¯xmlï¼Œåˆ™å“åº”æŠ¥å¤´ä¸­åº”è¯¥æœ‰ï¼Œ<code>Content-Type: text/xml</code></p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœå“åº”çš„æ•°æ®æ˜¯æ™®é€šæ–‡æœ¬ï¼Œåˆ™å“åº”æŠ¥å¤´ä¸­åº”è¯¥æœ‰ï¼Œ<code>Content-Type: text/plain</code></p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœå“åº”çš„æ•°æ®æ˜¯pngå›¾ç‰‡ï¼Œåˆ™å“åº”æŠ¥å¤´ä¸­åº”è¯¥æœ‰ï¼Œ<code>Content-Type: image/png</code></p>
<p><strong>3ã€å“åº”æ­£æ–‡ï¼Œresponse body</strong></p>
<p>å“åº”æ­£æ–‡å°±æ˜¯æœåŠ¡å™¨è¿”å›çš„èµ„æºçš„å†…å®¹ï¼Œå“åº”æ­£æ–‡å’Œæ¶ˆæ¯æŠ¥å¤´ä¹‹é—´ä¹Ÿéœ€è¦æœ‰ä¸€ä¸ªç©ºè¡Œï¼</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: text/html;charset=ISO-8859-1</span><br><span class="line">Content-Length: 106</span><br><span class="line">Date: Mon, 28 Sep 2020 16:59:15 GMT</span><br><span class="line">Keep-Alive: timeout=20</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;index&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Hello World! maven web&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>



<p>å…·ä½“çš„å¯ä»¥åœ¨æµè§ˆå™¨çš„æ§åˆ¶å°ä¸­æŸ¥çœ‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132238815.png" alt="image-20200929010159867"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132239046.png" alt="image-20200929010227874"></p>
<h1 id="servletï¼ˆäºŒï¼‰"><a href="#servletï¼ˆäºŒï¼‰" class="headerlink" title="servletï¼ˆäºŒï¼‰"></a>servletï¼ˆäºŒï¼‰</h1><h2 id="1-å®ç°æ–¹å¼"><a href="#1-å®ç°æ–¹å¼" class="headerlink" title="1 å®ç°æ–¹å¼"></a>1 å®ç°æ–¹å¼</h2><h3 id="1-1-æ¦‚è¿°-1"><a href="#1-1-æ¦‚è¿°-1" class="headerlink" title="1.1 æ¦‚è¿°"></a>1.1 æ¦‚è¿°</h3><p>ServletæŠ€æœ¯å¯ä»¥æ‰©å±•æœåŠ¡å™¨ç«¯çš„åŠŸèƒ½ï¼Œè®©javaä»£ç åœ¨æœåŠ¡å™¨ç«¯ä¹Ÿèƒ½æˆä¸ºä¸€ç§èµ„æºï¼ˆåŠ¨æ€èµ„æºï¼‰ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨å¯ä»¥é€šè¿‡æŒ‡å®šçš„èµ„æºåœ°å€ï¼ˆURIï¼‰ï¼Œæ¥è®¿é—®è¿™ä¸ªjavaä»£ç ï¼ˆServletï¼‰ï¼ŒåŒæ—¶åœ¨Servletä»£ç ä¸­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨IOæµæŠŠç»“æœå†™å›ç»™æµè§ˆå™¨ã€‚</p>
<p>æŒ‰ç…§Servletè§„èŒƒè¦æ±‚ï¼Œç¼–å†™ä¸€ä¸ªServletç¨‹åºï¼Œåªéœ€è¦è®©è‡ªå·±çš„ç±»å®ç°<code>javax.servlet.Servlet</code>æ¥å£å°±å¯ä»¥äº†ï¼Œä½†æ˜¯è¯¥æ¥å£ä¹Ÿæœ‰ä¸€äº›é»˜è®¤çš„å®ç°ç±»ï¼Œæ‰€ä»¥é™¤äº†å®ç°æ¥å£çš„æ–¹å¼ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»§æ‰¿å®ƒé»˜è®¤çš„å‡ ä¸ªå®ç°ç±»ï¼Œå¹¶ä¸”é‡å†™æŒ‡å®šæ–¹æ³•ï¼Œä¹ŸåŒæ ·å¯ä»¥å®ŒæˆServletç¨‹åºçš„ç¼–å†™ã€‚</p>
<h3 id="1-2-Servlet"><a href="#1-2-Servlet" class="headerlink" title="1.2 Servlet"></a>1.2 Servlet</h3><p><code>javax.servlet.Servlet</code></p>
<p>å®ƒæ˜¯ServletæŠ€æœ¯çš„æ ¸å¿ƒæ¥å£ï¼Œæ‰€æœ‰çš„Servletç¨‹åºï¼Œéƒ½å¿…é¡»æ˜¯è¯¥æ¥å£çš„å®ç°ç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Servlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–servletå¯¹è±¡çš„æ—¶å€™è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿”å›ServletConfigå¯¹è±¡,è¯¥å¯¹è±¡å°è£…äº†Servletçš„é…ç½®ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¿é—®servletå¯¹è±¡çš„æ—¶å€™è¢«è°ƒç”¨ï¼ˆæœ€é‡è¦çš„æ–¹æ³•ï¼‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿”å›servletç›¸å…³ä¿¡æ¯,æ¯”å¦‚ä½œè€…ã€ç‰ˆæœ¬ã€ç‰ˆæƒç­‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é”€æ¯servletå¯¹è±¡çš„æ—¶å€™è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>åœ¨è¿™äº”ä¸ªæ–¹æ³•ä¸­ï¼Œæœ€é‡è¦çš„æ˜¯ <code>service(ServletRequest req, ServletResponse res)</code>æ–¹æ³•ï¼Œå› ä¸ºå½“å®¢æˆ·ç«¯æµè§ˆå™¨é€šè¿‡æŒ‡å®šåœ°å€è®¿é—®è¯¥Servletçš„æ—¶å€™ï¼ŒTomcatä¼šè‡ªåŠ¨è°ƒç”¨Servletä¸­çš„serviceæ–¹æ³•ã€‚</p>
<p>serviceæ–¹æ³•çš„ä½œç”¨å°±æ˜¯å¤„ç†å®¢æˆ·ç«¯æµè§ˆå™¨å‘é€çš„è¯·æ±‚ï¼Œå¹¶ä¸”å†™å›æœ¬æ¬¡è¯·æ±‚çš„å“åº”å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é‡å†™çš„serviceæ–¹æ³•ä¸­ï¼Œå¯ä»¥æŒ‰ç…§å½“å‰çš„åŠŸèƒ½éœ€æ±‚ï¼Œæ¥å®Œæˆä»£ç çš„ç¼–å†™ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.Servlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//æ¥æ”¶è¯·æ±‚ä¸­æºå¸¦çš„å‚æ•°ï¼ŒæŒ‡å®šå‚æ•°åä¸ºname</span></span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//è®¾ç½®æœ¬æ¬¡å“åº”å›å»å†…å®¹çš„ç±»å‹ï¼Œå¹¶ä¸”æŒ‡å®šäº†ç¼–ç ï¼Œè¿™æ˜¯ç»™æµè§ˆå™¨çœ‹çš„</span></span><br><span class="line">		res.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//é€šè¿‡å“åº”å¯¹è±¡è·å–è¾“å‡ºæµ</span></span><br><span class="line">		PrintWriter out = res.getWriter();</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//ç»™æµè§ˆå™¨å†™å›å†…å®¹</span></span><br><span class="line">		out.println(<span class="string">&quot;hello! &quot;</span>+name);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><code>web.xml</code>ä¸­è¿›è¡Œé…ç½®ï¼Œç›®çš„æ˜¯ä¸ºäº†å‘Šè¯‰tomcatï¼Œè¿™ä¸ªservletå¯¹åº”çš„URIåœ°å€æ˜¯ä»€ä¹ˆï¼Œå…¶å®å°±æ˜¯ä¸€ç§æ˜ å°„å…³ç³»çš„é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.briup.test.HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>





<p>é€šè¿‡urlåœ°å€è®¿é—®æ­¤Servletï¼Œå¹¶ä¸”æºå¸¦å‚æ•°ï¼š</p>
<p><a href="http://127.0.0.1:8989/servlet-test/hello?name=tom">http://127.0.0.1:8989/servlet-test/hello?name=tom</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132226977.png" alt="image-20200929165014319"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œå“åº”å¤´ä¿¡æ¯ä¸­çš„Content-Typeå­—æ®µå€¼ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨Servletä¸­è¿›è¡Œè®¾ç½®çš„å€¼</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132226729.png" alt="image-20200929165110420"></p>
<blockquote>
<p>ç«ç‹æµè§ˆå™¨ä¸­è¿˜æä¾›äº†è¯¦ç»†çš„å­—æ®µè§£é‡Šè¯´æ˜ï¼Œåœ¨ç”µè„‘è”ç½‘çš„æ—¶å€™ï¼Œå¯ä»¥ç‚¹å‡»å­—æ®µå‰é¢çš„é—®å·è¿›è¡ŒæŸ¥çœ‹</p>
</blockquote>
<h3 id="1-3-GenericServlet"><a href="#1-3-GenericServlet" class="headerlink" title="1.3 GenericServlet"></a>1.3 GenericServlet</h3><p><code>javax.servlet.GenericServlet</code></p>
<p>å®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå¯¹Servletæ¥å£ä¸­çš„æ–¹æ³•è¿›è¡Œäº†é»˜è®¤å®ç°ï¼Œä½†æ˜¯æœ€é‡è¦çš„<code>service</code>æ–¹æ³•å¹¶æ²¡æœ‰å®ç°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span>, <span class="title">ServletConfig</span>,</span></span><br><span class="line"><span class="class">        <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> ServletConfig config;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GenericServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// NOOP</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// NOOP by default</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getInitParameter</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getServletConfig().getInitParameter(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Enumeration&lt;String&gt; <span class="title">getInitParameterNames</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getServletConfig().getInitParameterNames();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> config;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletContext <span class="title">getServletContext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getServletConfig().getServletContext();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.config = config;</span><br><span class="line">        <span class="keyword">this</span>.init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="comment">// NOOP by default</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        getServletContext().log(getServletName() + <span class="string">&quot;: &quot;</span> + msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String message, Throwable t)</span> </span>&#123;</span><br><span class="line">        getServletContext().log(getServletName() + <span class="string">&quot;: &quot;</span> + message, t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> config.getServletName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¯¥ç±»ä¸­ï¼Œå®ç°äº†Servletæ¥å£ä¸­çš„init(ServletConfig config)æ–¹æ³•ï¼ŒåŒæ—¶åˆé‡è½½äº†ä¸€ä¸ªæ— å‚çš„initæ–¹æ³•ï¼Œå¹¶ä¸”æœ‰å‚æ•°çš„initæ–¹æ³•ä¸­åˆè°ƒç”¨äº†è¿™ä¸ªé‡è½½çš„æ— å‚initæ–¹æ³•ã€‚</p>
<p>ç”±æ­¤å¯çŸ¥ï¼Œå°†æ¥æˆ‘ä»¬å¯¹Servletè¿›è¡Œåˆå§‹åŒ–æ“ä½œçš„æ—¶å€™ï¼Œé‡å†™è¿™ä¸ªæ— å‚çš„initæ–¹æ³•å³å¯ã€‚</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.GenericServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/hello-generic&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloGenericServlet</span> <span class="keyword">extends</span> <span class="title">GenericServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		res.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = res.getWriter();</span><br><span class="line">		</span><br><span class="line">		out.println(<span class="string">&quot;hello!&quot;</span>+name);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨æ³¨è§£<code>@WebServlet</code>æ¥ä»£æ›¿web.xmlä¸­çš„æ˜ å°„é…ç½®ï¼Œä¿©è€…çš„æ•ˆæœæ˜¯ä¸€æ ·çš„</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™ç§æ–¹å¼åªè¦å®ç°ä¸€ä¸ª<code>service</code>æ–¹æ³•å³å¯ï¼Œå…¶ä»–æ–¹æ³•åœ¨çˆ¶ç±»ä¸­å·²ç»è¿›è¡Œäº†é»˜è®¤å®ç°</p>
</blockquote>
<p>é€šè¿‡urlåœ°å€è®¿é—®æ­¤Servletï¼Œå¹¶ä¸”æºå¸¦å‚æ•°ï¼š</p>
<p><a href="http://127.0.0.1:8989/servlet-test/hello-generic?name=tom">http://127.0.0.1:8989/servlet-test/hello-generic?name=tom</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132226402.png" alt="image-20200929171544550"></p>
<h3 id="1-4-HttpServlet"><a href="#1-4-HttpServlet" class="headerlink" title="1.4 HttpServlet"></a>1.4 HttpServlet</h3><p><code>javax.servlet.http.HttpServlet</code></p>
<p>å®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä½†æ˜¯ç±»ä¸­æ²¡æœ‰æŠ½è±¡æ–¹æ³•ã€‚</p>
<p>å®ƒç»§æ‰¿äº† <code>GenericServlet</code>ï¼Œå¯¹æ¥æ”¶åˆ°çš„å®¢æˆ·ç«¯è¯·æ±‚ï¼Œè¿›è¡Œäº†ç»†åˆ†ï¼Œå¯¹åº”ä¸åŒçš„è¯·æ±‚ç±»å‹ï¼š</p>
<ul>
<li>DELETE</li>
<li>HEAD</li>
<li>GET</li>
<li>OPTIONS</li>
<li>POST</li>
<li>PUT</li>
<li>TRACE</li>
</ul>
<p>åˆ†åˆ«ä½¿ç”¨ä¸åŒçš„æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå½“å‰å¦‚æœæ˜¯GETè¯·æ±‚ï¼Œé‚£ä¹ˆå°±è°ƒç”¨doGetæ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œå½“å‰å¦‚æœæ˜¯POSTè¯·æ±‚ï¼Œé‚£ä¹ˆå°±è°ƒç”¨doPostæ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œæ‰€ä»¥åœ¨HttpServletä¸­ï¼Œå®šä¹‰äº†å¾ˆå¤šdoXxxæ–¹æ³•ï¼Œç”¨æ¥å¤„ç†ä¸åŒç±»å‹çš„è¯·æ±‚ã€‚</p>
<p>æºç è¾ƒé•¿ï¼Œè¿™é‡Œç»™å‡ºéƒ¨åˆ†ä»£ç ï¼Œèƒ½è¯´æ˜é—®é¢˜å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpServlet</span> <span class="keyword">extends</span> <span class="title">GenericServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_DELETE = <span class="string">&quot;DELETE&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_HEAD = <span class="string">&quot;HEAD&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_GET = <span class="string">&quot;GET&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_OPTIONS = <span class="string">&quot;OPTIONS&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_POST = <span class="string">&quot;POST&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_PUT = <span class="string">&quot;PUT&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String METHOD_TRACE = <span class="string">&quot;TRACE&quot;</span>;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        String msg = lStrings.getString(<span class="string">&quot;http.method_get_not_supported&quot;</span>);</span><br><span class="line">        sendMethodNotAllowed(req, resp, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doHead</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (DispatcherType.INCLUDE.equals(req.getDispatcherType())) &#123;</span><br><span class="line">            doGet(req, resp);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            NoBodyResponse response = <span class="keyword">new</span> NoBodyResponse(resp);</span><br><span class="line">            doGet(req, response);</span><br><span class="line">            response.setContentLength();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String msg = lStrings.getString(<span class="string">&quot;http.method_post_not_supported&quot;</span>);</span><br><span class="line">        sendMethodNotAllowed(req, resp, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPut</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String msg = lStrings.getString(<span class="string">&quot;http.method_put_not_supported&quot;</span>);</span><br><span class="line">        sendMethodNotAllowed(req, resp, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doDelete</span><span class="params">(HttpServletRequest req,</span></span></span><br><span class="line"><span class="params"><span class="function">                            HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String msg = lStrings.getString(<span class="string">&quot;http.method_delete_not_supported&quot;</span>);</span><br><span class="line">        sendMethodNotAllowed(req, resp, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doOptions</span><span class="params">(HttpServletRequest req,</span></span></span><br><span class="line"><span class="params"><span class="function">            HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//..</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doTrace</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//..</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String method = req.getMethod();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (method.equals(METHOD_GET)) &#123;</span><br><span class="line">            <span class="keyword">long</span> lastModified = getLastModified(req);</span><br><span class="line">            <span class="keyword">if</span> (lastModified == -<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// servlet doesn&#x27;t support if-modified-since, no reason</span></span><br><span class="line">                <span class="comment">// to go through further expensive logic</span></span><br><span class="line">                doGet(req, resp);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">long</span> ifModifiedSince;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    ifModifiedSince = req.getDateHeader(HEADER_IFMODSINCE);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalArgumentException iae) &#123;</span><br><span class="line">                    <span class="comment">// Invalid date header - proceed as if none was set</span></span><br><span class="line">                    ifModifiedSince = -<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (ifModifiedSince &lt; (lastModified / <span class="number">1000</span> * <span class="number">1000</span>)) &#123;</span><br><span class="line">                    <span class="comment">// If the servlet mod time is later, call doGet()</span></span><br><span class="line">                    <span class="comment">// Round down to the nearest second for a proper compare</span></span><br><span class="line">                    <span class="comment">// A ifModifiedSince of -1 will always be less</span></span><br><span class="line">                    maybeSetLastModified(resp, lastModified);</span><br><span class="line">                    doGet(req, resp);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    resp.setStatus(HttpServletResponse.SC_NOT_MODIFIED);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_HEAD)) &#123;</span><br><span class="line">            <span class="keyword">long</span> lastModified = getLastModified(req);</span><br><span class="line">            maybeSetLastModified(resp, lastModified);</span><br><span class="line">            doHead(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_POST)) &#123;</span><br><span class="line">            doPost(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_PUT)) &#123;</span><br><span class="line">            doPut(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_DELETE)) &#123;</span><br><span class="line">            doDelete(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_OPTIONS)) &#123;</span><br><span class="line">            doOptions(req,resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_TRACE)) &#123;</span><br><span class="line">            doTrace(req,resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            <span class="comment">// Note that this means NO servlet supports whatever</span></span><br><span class="line">            <span class="comment">// method was requested, anywhere on this server.</span></span><br><span class="line">            <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">            String errMsg = lStrings.getString(<span class="string">&quot;http.method_not_implemented&quot;</span>);</span><br><span class="line">            Object[] errArgs = <span class="keyword">new</span> Object[<span class="number">1</span>];</span><br><span class="line">            errArgs[<span class="number">0</span>] = method;</span><br><span class="line">            errMsg = MessageFormat.format(errMsg, errArgs);</span><br><span class="line"></span><br><span class="line">            resp.sendError(HttpServletResponse.SC_NOT_IMPLEMENTED, errMsg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        HttpServletRequest  request;</span><br><span class="line">        HttpServletResponse response;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            request = (HttpServletRequest) req;</span><br><span class="line">            response = (HttpServletResponse) res;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassCastException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ServletException(lStrings.getString(<span class="string">&quot;http.non_http&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        service(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„1ï¼ŒHttpServletæ˜¯æŠ½è±¡ç±»ï¼Œä½†æ˜¯é‡Œé¢æ²¡æœ‰æŠ½è±¡æ–¹æ³•</p>
<p>æ³¨æ„2ï¼ŒHttpServletç»§æ‰¿äº†GenericServletï¼Œå®ç°äº†serviceæ–¹æ³•ï¼Œå¹¶ä¸”å¯¹serviceæ–¹æ³•è¿›è¡Œäº†é‡è½½</p>
<p>æ³¨æ„3ï¼Œå®ç°çš„serviceæ–¹æ³•ä¸­ï¼Œå¯¹è¯·æ±‚å’Œå“åº”è¿›è¡Œäº†å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œå°†æ™®é€šçš„è¯·æ±‚å’Œå“åº”å¯¹è±¡ï¼Œå¼ºåˆ¶è½¬æ¢æˆäº†é’ˆå¯¹HTTPåè®®çš„è¯·æ±‚å’Œå“åº”ï¼Œç„¶åè°ƒç”¨é‡è½½çš„serviceæ–¹æ³•ï¼Œå°†è½¬æ¢çš„è¯·æ±‚å’Œå“åº”ä¼ å…¥</p>
<p>æ³¨æ„4ï¼Œé‡è½½åçš„serviceæ–¹æ³•ä¸­ï¼Œæ ¹æ®å½“å‰è¯·æ±‚çš„ç±»å‹ï¼ˆgetã€postè·å–å…¶ä»–ï¼‰ï¼Œå†è°ƒç”¨å¯¹åº”çš„doXxxæ–¹æ³•è¿›è¡Œå¤„ç†</p>
<p>æ³¨æ„5ï¼ŒdoXxxæ–¹æ³•ä¸­ä¼šæœ‰ä¸€äº›é»˜è®¤çš„å®ç°ï¼Œä¾‹å¦‚doGetæ–¹æ³•ä¸­ä¼šé»˜è®¤è¿”å›<code>http.method_delete_not_supported</code></p>
<p>ç”±ä»¥ä¸Šä»£ç å¯çŸ¥ï¼Œæˆ‘ä»¬ç¼–å†™å­ç±»ç»§æ‰¿ <code>HttpServlet</code>ï¼Œå¹¶ä¸”é‡å†™æ–¹æ³•å³å¯ï¼Œå¦‚æœéœ€è¦å¤„ç†GETæ–¹å¼çš„è¯·æ±‚ï¼Œé‚£ä¹ˆå°±é‡å†™doGetæ–¹æ³•ï¼Œå¦‚æœéœ€è¦å¤„ç†POSTæ–¹å¼çš„è¯·æ±‚ï¼Œé‚£ä¹ˆå°±é‡å†™doPostæ–¹æ³•ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/hello-http-servlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloHttpServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = resp.getWriter();</span><br><span class="line">		</span><br><span class="line">		out.println(<span class="string">&quot;GET: helloï¼&quot;</span>+name);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = resp.getWriter();</span><br><span class="line">		</span><br><span class="line">		out.println(<span class="string">&quot;POST: helloï¼&quot;</span>+name);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>åœ¨é¡µé¢ä¸­ç¼–å†™ä¸€ä¸ªè¡¨å•ï¼Œè·³è½¬è¡¨å•æäº¤çš„æ–¹å¼ï¼Œæ¥æœ€ç»ˆè§‚å¯Ÿgetå’Œpostæ–¹å¼å‘é€è¯·æ±‚åï¼ŒServletä¸­æ–¹æ³•è°ƒç”¨æƒ…å†µï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;hello-http-servlet&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">		ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ ¹æ®æµ‹è¯•ç»“æœå¯çŸ¥ï¼Œå½“å‰é¡µé¢ä¸­å‘é€GETè¯·æ±‚çš„æ—¶å€™ï¼ŒServletä¸­çš„doGetæ–¹æ³•è¢«è°ƒç”¨ï¼Œå½“é¡µé¢ä¸­å‘é€POSTè¯·æ±‚çš„æ—¶å€™ï¼ŒServletä¸­çš„doPostæ–¹æ³•è¢«è°ƒç”¨</p>
</blockquote>
<h2 id="2-GETå’ŒPOST"><a href="#2-GETå’ŒPOST" class="headerlink" title="2 GETå’ŒPOST"></a>2 GETå’ŒPOST</h2><blockquote>
<p>HTTPåè®®ä¸­ï¼Œå®šä¹‰äº†å¾ˆå¤šç§è¯·æ±‚çš„æ–¹å¼ï¼Œä½†æ˜¯æµè§ˆå™¨é»˜è®¤æƒ…å†µä¸‹ï¼Œåªèƒ½å‘å‡ºGETæ–¹å¼è¯·æ±‚å’ŒPOSTæ–¹å¼è¯·æ±‚</p>
</blockquote>
<h3 id="2-1-å¸¸è§æƒ…å†µ"><a href="#2-1-å¸¸è§æƒ…å†µ" class="headerlink" title="2.1 å¸¸è§æƒ…å†µ"></a>2.1 å¸¸è§æƒ…å†µ</h3><p>åœ¨é¡µé¢ä¸­ï¼Œå¸¸è§çš„å‘é€GETæ–¹å¼è¯·æ±‚çš„æƒ…å†µæœ‰ï¼š</p>
<ul>
<li>æµè§ˆå™¨åœ°å€æ ç›´æ¥è¾“å…¥åœ°å€è®¿é—®</li>
<li>è¶…é“¾æ¥è®¿é—®  <a href=""></li>
<li><code>&lt;image src=&quot;&quot;&gt;</code>è®¿é—®å›¾ç‰‡</li>
<li>å¤–éƒ¨jsæ–‡ä»¶çš„å¼•å…¥</li>
<li>å¤–éƒ¨cssæ–‡ä»¶çš„å¼•å…¥</li>
<li>è¡¨å•æäº¤æ•°æ®ï¼Œmethod=â€getâ€</li>
<li>åœ¨javascriptä»£ç ä¸­è®¿é—®èµ„æº</li>
<li>ajaxä¸­è®¾ç½®è¯·æ±‚ä¸ºgetæ–¹å¼</li>
<li>ä½¿ç”¨jspç›¸å…³æ ‡ç­¾è®¿é—®èµ„æº</li>
</ul>
<p>åœ¨é¡µé¢ä¸­ï¼Œå¸¸è§çš„å‘é€POSTæ–¹å¼è¯·æ±‚çš„æƒ…å†µæœ‰ï¼š</p>
<ul>
<li>è¡¨å•æäº¤æ•°æ®ï¼Œmethod=â€postâ€</li>
<li>ajaxä¸­è®¾ç½®è¯·æ±‚ä¸ºpostæ–¹å¼</li>
</ul>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œæµè§ˆå™¨ä¸­å‘å‡ºçš„è¯·æ±‚ï¼Œå¤§å¤šæ•°éƒ½æ˜¯GETæ–¹å¼è¯·æ±‚</p>
</blockquote>
<h3 id="2-2-ç‰¹ç‚¹åŒºåˆ«"><a href="#2-2-ç‰¹ç‚¹åŒºåˆ«" class="headerlink" title="2.2 ç‰¹ç‚¹åŒºåˆ«"></a>2.2 ç‰¹ç‚¹åŒºåˆ«</h3><p>httpåè®®ä¸‹çš„è¯·æ±‚æ ¼å¼ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1éƒ¨åˆ†: è¯·æ±‚è¡Œ   get /hello http 1.1			</span><br><span class="line">2éƒ¨åˆ†: è¯·æ±‚å¤´éƒ¨/æ¶ˆæ¯æŠ¥å¤´	</span><br><span class="line">3éƒ¨åˆ†: \r\n</span><br><span class="line">4éƒ¨åˆ†: è¯·æ±‚æ­£æ–‡	å‚æ•°æ”¾çš„ä½ç½®</span><br></pre></td></tr></table></figure>



<p>GETæ–¹å¼ä¼ å‚æ•°ï¼Œå‚æ•°åœ¨uriåé¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /hello?name=tom HTTP1.1</span><br><span class="line">key: value</span><br><span class="line">key: value</span><br><span class="line">key: value</span><br><span class="line">.....</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure>

<blockquote>
<p>GETæ–¹å¼ä¼ å‚ï¼Œå‚æ•°ä¼šæ˜¾ç¤ºåœ¨åœ°å€æ ä¸­ï¼Œå¹¶ä¸”å‚æ•°çš„é•¿åº¦ä¹Ÿä¼šè¢«åœ°å€æ çš„é•¿åº¦è€Œé™åˆ¶</p>
</blockquote>
<p>postæ–¹å¼ä¼ å‚ï¼Œå‚æ•°åœ¨è¯·æ±‚æ­£æ–‡ä¸­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /hello HTTP1.1</span><br><span class="line">key: value</span><br><span class="line">key: value</span><br><span class="line">key: value</span><br><span class="line">.....</span><br><span class="line">\r\n</span><br><span class="line">name=tom</span><br></pre></td></tr></table></figure>

<blockquote>
<p>POSTæ–¹å¼ä¼ å‚ï¼Œå‚æ•°ä¸ä¼šæ˜¾ç¤ºåœ¨åœ°å€ä¸­ï¼Œè€Œæ˜¯åœ¨è¯·æ±‚ä½“ä¸­ï¼Œå¹¶ä¸”å‚æ•°é•¿åº¦å¹¶æ²¡æœ‰ç›´æ¥é™åˆ¶</p>
</blockquote>
<h2 id="3-ç”Ÿå‘½å‘¨æœŸ"><a href="#3-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="3 ç”Ÿå‘½å‘¨æœŸ"></a>3 ç”Ÿå‘½å‘¨æœŸ</h2><blockquote>
<p>Servletç”Ÿå‘½å‘¨æœŸï¼Œæ˜¯æŒ‡ä¸€ä¸ªServletåˆ›å»ºã€åˆå§‹åŒ–ã€æ‰§è¡Œã€é”€æ¯çš„è¿‡ç¨‹</p>
</blockquote>
<h3 id="3-1-åˆ›å»º"><a href="#3-1-åˆ›å»º" class="headerlink" title="3.1 åˆ›å»º"></a>3.1 åˆ›å»º</h3><p>é¡¹ç›®ä¸­ï¼Œç¼–å†™Servletç¨‹åºï¼Œç„¶åè¿›è¡Œæ˜ å°„é…ç½®ï¼ˆæŒ‡å®šURIåœ°å€ï¼‰ï¼Œæœ€åæŠŠé¡¹ç›®éƒ¨ç½²åˆ°Tomcatä¸­è¿è¡Œã€‚</p>
<p>åœ¨Tomcatå¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œä¼šæ£€æŸ¥Servletçš„é…ç½®ï¼Œæ ¹æ®é…ç½®æ¥å†³å®šServletå®ä¾‹ä½•æ—¶åˆ›å»ºï¼š</p>
<ul>
<li>ç¬¬ä¸€æ¬¡è¢«è®¿é—®çš„æ—¶å€™åˆ›å»ºï¼ˆé»˜è®¤ï¼‰</li>
<li>Tomcatå¯åŠ¨è¿‡ç¨‹ä¸­åˆ›å»ºï¼ˆéœ€è¦é…ç½®ï¼‰</li>
</ul>
<p><strong>ç¬¬ä¸€æ¬¡è¢«è®¿é—®çš„æ—¶å€™åˆ›å»ºï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">LifeServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆ›å»º&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletæ‰§è¡Œ&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>life<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.briup.test.LifeServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>life<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/life<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä»ç»“æœå¯ä»¥çœ‹å‡ºï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è®¿é—®çš„æ—¶å€™åˆ›å»ºäº†servletå®ä¾‹ï¼Œä¹‹åå°±ä¸å†åˆ›äº†ï¼Œè®¿é—®åç›´æ¥æ‰§è¡Œæ–¹æ³•</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œservletåœ¨è¿è¡ŒæœŸé—´æ˜¯å•ä¾‹æ¨¡å¼</p>
</blockquote>
<p><strong>Tomcatå¯åŠ¨è¿‡ç¨‹ä¸­åˆ›å»ºï¼š</strong></p>
<p>é…ç½®ä¸­åŠ å…¥æ ‡ç­¾ <code>&lt;load-on-startup&gt;</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>life<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.briup.test.LifeServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>life<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/life<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¿®æ”¹é…ç½®åï¼Œå¯åŠ¨Tomcatè¿‡ç¨‹ä¸­ï¼Œå°±å¯ä»¥çœ‹åˆ°servletå®ä¾‹è¢«åˆ›å»ºï¼Œå¦‚æœæœ‰å¤šä¸ªservletå®ä¾‹éƒ½éœ€è¦åœ¨å¯åŠ¨æœŸé—´è¿›åˆ›å»ºï¼Œé‚£ä¹ˆ <code>&lt;load-on-startup&gt;</code> æ ‡ç­¾ä¸­çš„å€¼è¶Šå°ï¼Œè¶Šä¼šè¢«ä¼˜å…ˆåˆ›å»º (è¯¥å€¼&gt;=0)</p>
</blockquote>
<h3 id="3-2-åˆå§‹åŒ–"><a href="#3-2-åˆå§‹åŒ–" class="headerlink" title="3.2 åˆå§‹åŒ–"></a>3.2 åˆå§‹åŒ–</h3><p>Servletå®ä¾‹è¢«åˆ›å»ºä¹‹åï¼ŒTomcatè¿˜ä¼šè°ƒç”¨Servletå®ä¾‹ä¸­çš„initæ–¹æ³•ï¼Œæ¥å¯¹è¯¥Servletå®ä¾‹åšåˆå§‹åŒ–å·¥ä½œï¼Œæ‰€ä»¥å¦‚æœæœ‰éœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥é‡å†™Servletä¸­çš„initæ–¹æ³•ï¼ˆé‡å†™æ— å‚initå³å¯ï¼‰ï¼Œç»™å½“å‰Servletåšåˆå§‹åŒ–</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">LifeServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆ›å»º&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆå§‹åŒ–&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletæ‰§è¡Œ&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼ŒTomcatåˆ›å»ºServletå®ä¾‹ä¹‹åï¼Œå°±ä¼šè°ƒç”¨å…¶initæ–¹æ³•åšåˆå§‹åŒ–å·¥ä½œ</p>
</blockquote>
<p><strong>åˆå§‹åŒ–ä¼ å‚ï¼š</strong></p>
<p>é€šè¿‡é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥ç»™Servletè¿›è¡Œåˆå§‹åŒ–å‚æ•°ï¼Œinitæ–¹æ³•ä¸­å¯ä»¥é€šè¿‡<code>ServletConfig</code>å¯¹è±¡æ¥è·å–è¯¥å‚æ•°ã€‚</p>
<p>åœ¨é…ç½®ä¸­ï¼Œä½¿ç”¨<code>&lt;init-param&gt;</code>å¯ä»¥è¿›è¡Œåˆå§‹åŒ–ä¼ å‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>life<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.briup.test.LifeServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>username<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>briup<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>password<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>life<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/life<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">LifeServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆ›å»º&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆå§‹åŒ–&quot;</span>);</span><br><span class="line">		String username = getServletConfig().getInitParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		String password = getServletConfig().getInitParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;\tåˆå§‹åŒ–å‚æ•°ï¼šusername=&quot;</span>+username);</span><br><span class="line">		System.out.println(<span class="string">&quot;\tåˆå§‹åŒ–å‚æ•°ï¼špassword=&quot;</span>+password);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletæ‰§è¡Œ&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œ<code>getServletConfig()</code>æ–¹æ³•åœ¨çˆ¶ç±»ä¸­å·²ç»å®ç°ï¼Œè¯¥æ–¹æ³•å¯ä»¥è¿”å›ServletConifgå¯¹è±¡ï¼Œå¯¹è±¡ä¸­å°è£…äº†å½“å‰Servletçš„ç›¸å…³é…ç½®ä¿¡æ¯</p>
</blockquote>
<h3 id="3-3-æ‰§è¡Œ"><a href="#3-3-æ‰§è¡Œ" class="headerlink" title="3.3 æ‰§è¡Œ"></a>3.3 æ‰§è¡Œ</h3><p>å½“å®¢æˆ·ç«¯æµè§ˆå™¨é€šè¿‡URIåœ°å€è®¿é—®Servletçš„æ—¶å€™ï¼ŒTomcatä¼šæ ¹æ®æˆ‘ä»¬é…ç½®çš„æ˜ å°„å…³ç³»ï¼Œé€šè¿‡å½“å‰URIåœ°å€æ‰¾åˆ°å¯¹åº”çš„Servletå®ä¾‹ï¼Œç„¶åè°ƒç”¨å…¶<code>service(ServletRequest req, ServletResponse res)</code>æ–¹æ³•ã€‚</p>
<p>ç”±äºçˆ¶ç±»ä¸­ï¼Œserviceæ–¹æ³•çš„é‡è½½ï¼Œæœ€ç»ˆä¼šæ ¹æ®å½“å‰è¯·æ±‚æ–¹æ³•ï¼ˆgetæˆ–postç­‰ï¼‰ï¼Œè°ƒç”¨åˆ°å¯¹åº”çš„doXxxæ–¹æ³•ï¼Œç„¶åæˆ‘ä»¬åœ¨å­ç±»ä¸­é‡å†™äº†è¿™ä¸ªdoXxxæ–¹æ³•ï¼Œé‚£ä¹ˆæœ€åä¼šè°ƒç”¨åˆ°æˆ‘ä»¬é‡å†™çš„doXxxæ–¹æ³•ã€‚</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒTomcatæ¥æ”¶åˆ°è¯·æ±‚åï¼Œåªä¼šè°ƒç”¨Servletæ¥å£ä¸­çš„serviceæ–¹æ³•ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨æˆ‘ä»¬çš„doGetæ–¹æ³•ç­‰ï¼Œç”±äºæ–¹æ³•çš„å±‚å±‚è°ƒç”¨ï¼Œæœ€åæ‰è°ƒç”¨åˆ°æˆ‘ä»¬é‡å†™çš„doGetç­‰æ–¹æ³•ã€‚</p>
<p>==æ€è€ƒï¼Œå¦‚æœæˆ‘ä»¬åœ¨å­ç±»ä¸­æ²¡æœ‰é‡å†™doGetæ–¹æ³•ï¼Œè¿™æ—¶å€™æµè§ˆå™¨å‘é€getæ–¹æ³•è¿›è¡Œè®¿é—®ï¼Œä¼šå‡ºç°ä»€ä¹ˆç»“æœï¼Ÿ==</p>
<h3 id="3-4-é”€æ¯"><a href="#3-4-é”€æ¯" class="headerlink" title="3.4 é”€æ¯"></a>3.4 é”€æ¯</h3><p>å½“å‰æœåŠ¡å™¨è¿›è¡Œæ­£å¸¸å…³é—­æˆ–è€…é‡å¯çš„æ—¶å€™ï¼ŒTomcatä¼šè°ƒç”¨Servletå®ä¾‹çš„<code>destroy()</code>æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬é‡å†™äº†è¯¥æ–¹æ³•ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨åˆ°æˆ‘ä»¬é‡å†™ä¹‹åçš„æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">LifeServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆ›å»º&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆå§‹åŒ–&quot;</span>);</span><br><span class="line">		String username = getServletConfig().getInitParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		String password = getServletConfig().getInitParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;\tåˆå§‹åŒ–å‚æ•°ï¼šusername=&quot;</span>+username);</span><br><span class="line">		System.out.println(<span class="string">&quot;\tåˆå§‹åŒ–å‚æ•°ï¼špassword=&quot;</span>+password);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletæ‰§è¡Œ&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servleté”€æ¯&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼ŒæœåŠ¡å™¨éœ€è¦æ­£å¸¸å…³é—­æˆ–è€…é‡å¯çš„æ—¶å€™æ‰ä¼šè°ƒç”¨é”€æ¯çš„æ–¹æ³•ï¼Œå¦‚æœç›´æ¥è°ƒç”¨consoleå³ä¸Šè§’çš„çº¢ç‚¹å…³é—­æœåŠ¡å™¨çš„è¯ï¼Œæ˜¯çœ‹ä¸åˆ°æ‰§è¡Œé”€æ¯æ–¹æ³•çš„ã€‚</p>
</blockquote>
<p>:tipping_hand_man: vanse</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.life;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * servletç”Ÿå‘½å‘¨æœŸ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> vanse</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * åˆ›å»º</span></span><br><span class="line"><span class="comment">	 * 	é»˜è®¤: è®¿é—®è¯¥èµ„æºæ—¶æ‰åˆ›å»º(æ‡’åŠ è½½) å¹¶ä¸”åªä¼šåˆ›å»ºä¸€æ¬¡(å•ä¾‹)</span></span><br><span class="line"><span class="comment">	 *  ä¿®æ”¹: å¯åŠ¨æœåŠ¡å™¨å°±åˆ›å»º(åŠæ—¶åŠ è½½) å¹¶ä¸”åªä¼šåˆ›å»ºä¸€æ¬¡(å•ä¾‹)</span></span><br><span class="line"><span class="comment">	 *  	web.xml  load-on-startup è¯¥å€¼&gt;=0 å³å¯ </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">LifeServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆ›å»º&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * åˆå§‹åŒ–</span></span><br><span class="line"><span class="comment">	 * 		å’Œåˆ›å»ºæ–¹æ³•ä¸€èµ·è°ƒç”¨ åªä¼šåˆå§‹åŒ–ä¸€æ¬¡</span></span><br><span class="line"><span class="comment">	 * 		å¯ä»¥è·å–é…ç½®ä¿¡æ¯çš„åˆå§‹åŒ–å€¼</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line"><span class="comment">//	@Override</span></span><br><span class="line"><span class="comment">//	public void init() throws ServletException &#123;</span></span><br><span class="line"><span class="comment">//		System.out.println(&quot;servlet...init&quot;);</span></span><br><span class="line"><span class="comment">//	&#125;</span></span><br><span class="line">	String username = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	String password = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		username = config.getInitParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		password = config.getInitParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">	 * 		æ¯è®¿é—®ä¸€æ¬¡èµ„æºè·¯å¾„æ—¶æ‰§è¡Œ (æ‰§è¡Œå¤šæ¬¡)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servelt...service&quot;</span>);</span><br><span class="line">		<span class="comment">// å‡†å¤‡å¥½çš„æ•°æ®</span></span><br><span class="line">		System.out.println(username + <span class="string">&quot;=&quot;</span> + password);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * é”€æ¯</span></span><br><span class="line"><span class="comment">	 * 		æ­£å¸¸å…³é—­(é‡å¯)æœåŠ¡å™¨ è¯¥servleté”€æ¯ è°ƒç”¨ä¸€æ¬¡</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servlet...destory&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="3-5-æ³¨è§£"><a href="#3-5-æ³¨è§£" class="headerlink" title="3.5 æ³¨è§£"></a>3.5 æ³¨è§£</h3><p>ä»¥ä¸Šåœ¨web.xmlä¸­çš„é…ç½®ï¼Œéƒ½å¯ä»¥ä½¿ç”¨æ³¨è§£é…ç½®æ¥ä»£æ›¿ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebInitParam;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@WebServlet(value = &quot;/life&quot;,initParams = &#123;&#125;,loadOnStartup = 1)</span></span><br><span class="line"><span class="meta">@WebServlet(value = &quot;/life&quot;,initParams = &#123;</span></span><br><span class="line"><span class="meta">		@WebInitParam(name = &quot;username&quot;,value = &quot;briup&quot;),</span></span><br><span class="line"><span class="meta">		@WebInitParam(name = &quot;password&quot;,value = &quot;123456&quot;)</span></span><br><span class="line"><span class="meta">&#125;,loadOnStartup = 1)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">LifeServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆ›å»º&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆå§‹åŒ–&quot;</span>);</span><br><span class="line">		String username = getServletConfig().getInitParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		String password = getServletConfig().getInitParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;\tåˆå§‹åŒ–å‚æ•°ï¼šusername=&quot;</span>+username);</span><br><span class="line">		System.out.println(<span class="string">&quot;\tåˆå§‹åŒ–å‚æ•°ï¼špassword=&quot;</span>+password);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletæ‰§è¡Œ&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servleté”€æ¯&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…¶æ•ˆæœå’Œä¹‹å‰ä½¿ç”¨xmlé…ç½®æ˜¯ä¸€æ ·çš„</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>life<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.briup.web.servlet.LifeServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>username<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>briup<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>password<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>life<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/life<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢XMLä¸­çš„é…ç½®ï¼Œå’Œä¸‹é¢ç±»ä¸­æ³¨è§£çš„é…ç½®ï¼Œæ˜¯ç­‰ä»·çš„ï¼Œæ•ˆæœä¸€æ ·</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//@WebServlet(value = &quot;/life&quot;,initParams = &#123;&#125;,loadOnStartup = 1)</span></span><br><span class="line"><span class="meta">@WebServlet(value = &quot;/life&quot;,initParams = &#123;</span></span><br><span class="line"><span class="meta">	@WebInitParam(name = &quot;username&quot;,value = &quot;briup&quot;),</span></span><br><span class="line"><span class="meta">	@WebInitParam(name = &quot;password&quot;,value = &quot;123456&quot;)</span></span><br><span class="line"><span class="meta">&#125;,loadOnStartup = 1)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">    <span class="comment">//..</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-6-æ€è€ƒ"><a href="#3-6-æ€è€ƒ" class="headerlink" title="3.6 æ€è€ƒ"></a>3.6 æ€è€ƒ</h3><p>é€šè¿‡ä¸Šé¢Servletç”Ÿå‘½å‘¨æœŸçš„æè¿°å¯çŸ¥ï¼Œåœ¨Tomcatè¿è¡ŒæœŸé—´ï¼Œä¸€ä¸ªServletçš„å®ä¾‹åªä¼šæœ‰ä¸€ä¸ªï¼ˆå•ä¾‹ï¼‰ï¼Œé‚£ä¹ˆåœ¨å®é™…è®¿é—®è¿‡ç¨‹ä¸­ï¼Œæ˜¯å¦ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿ</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebInitParam;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@WebServlet(value = &quot;/life&quot;,initParams = &#123;&#125;,loadOnStartup = 1)</span></span><br><span class="line"><span class="meta">@WebServlet(value = &quot;/life&quot;,initParams = &#123;</span></span><br><span class="line"><span class="meta">		@WebInitParam(name = &quot;username&quot;,value = &quot;briup&quot;),</span></span><br><span class="line"><span class="meta">		@WebInitParam(name = &quot;password&quot;,value = &quot;123456&quot;)</span></span><br><span class="line"><span class="meta">&#125;,loadOnStartup = 1)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">LifeServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆ›å»º&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletåˆå§‹åŒ–&quot;</span>);</span><br><span class="line">		String username = getServletConfig().getInitParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		String password = getServletConfig().getInitParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;\tåˆå§‹åŒ–å‚æ•°ï¼šusername=&quot;</span>+username);</span><br><span class="line">		System.out.println(<span class="string">&quot;\tåˆå§‹åŒ–å‚æ•°ï¼špassword=&quot;</span>+password);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servletæ‰§è¡Œ&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">&quot;name = &quot;</span>+name);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;servleté”€æ¯&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯åŠ¨æœåŠ¡å™¨åï¼Œè¿ç»­ä¸¤æ¬¡è®¿é—®è¯¥Servletï¼Œå¹¶ä¸”åˆ†åˆ«ä¼ ä¸åŒçš„å‚æ•°ï¼Œè§‚å¯Ÿå…¶æ‰§è¡Œç»“æœã€‚</p>
</blockquote>
<blockquote>
<p>ç»“è®ºï¼Œåœ¨Servletä¸­ï¼Œåº”è¯¥å°½é‡é¿å…ä½¿ç”¨æˆå‘˜å˜é‡ï¼Œå¦‚æœæœ‰éœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨synchronizedè¿›è¡Œä»£ç å—åŠ é”</p>
</blockquote>
<h2 id="4-æ¥æ”¶å‚æ•°-request"><a href="#4-æ¥æ”¶å‚æ•°-request" class="headerlink" title="4 æ¥æ”¶å‚æ•°(request)"></a>4 æ¥æ”¶å‚æ•°(request)</h2><blockquote>
<p>åœ¨Servletä¸­ï¼Œä¸€é¡¹é‡è¦çš„å·¥ä½œï¼Œå°±æ˜¯æ¥æ”¶é¡µé¢è¯·æ±‚ä¸­æºå¸¦çš„å‚æ•°ã€‚</p>
</blockquote>
<h3 id="4-1-æ–¹å¼"><a href="#4-1-æ–¹å¼" class="headerlink" title="4.1 æ–¹å¼"></a>4.1 æ–¹å¼</h3><p>è™½ç„¶GETè¯·æ±‚å’ŒPOSTè¯·æ±‚æºå¸¦å‚æ•°çš„æ–¹å¼ï¼ˆä½ç½®ï¼‰ä¸åŒï¼Œä½†æ˜¯ç”±äºServletåº•å±‚APIçš„å°è£…ï¼Œæˆ‘ä»¬åœ¨Servletä¸­ï¼Œé€šè¿‡è¯·æ±‚ï¼ˆrequestï¼‰è·å–å‚æ•°çš„æ–¹å¼éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>æ‰€ä»¥ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œéƒ½ä»¥GETæ–¹å¼ä¼ å‚çš„æ–¹å¼è¿›è¡Œè¯´æ˜ã€‚</p>
<h3 id="4-2-å•å€¼"><a href="#4-2-å•å€¼" class="headerlink" title="4.2 å•å€¼"></a>4.2 å•å€¼</h3><p>æ¥æ”¶è¯·æ±‚ä¸­å•ä¸€çš„å‚æ•°å€¼çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå‚æ•°åå¯¹åº”ä¸€ä¸ªå€¼ï¼Œä½¿ç”¨<code>getParameter</code>æ–¹æ³•å³å¯ï¼š</p>
<p><code>/param?name=tom&amp;age=20</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/param&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParamServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		String age = req.getParameter(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">		System.out.println(name);</span><br><span class="line">		System.out.println(age);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼ŒServletè·å–åˆ°çš„å‚æ•°å€¼ï¼Œé»˜è®¤éƒ½æ˜¯Stringç±»å‹çš„ï¼Œå¦‚æœéœ€è¦å¯ä»¥è‡ªå·±è¿›è¡Œç±»è½¬æ¢</p>
</blockquote>
<h3 id="4-3-å¤šå€¼"><a href="#4-3-å¤šå€¼" class="headerlink" title="4.3 å¤šå€¼"></a>4.3 å¤šå€¼</h3><p>ä¸€ä¸ªå‚æ•°åå¯¹åº”å¤šä¸ªå€¼ï¼Œä¾‹å¦‚é¡µé¢ä¸­çš„å¤šé€‰æ¡†ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨<code>getParameterValues</code>æ–¹æ³•</p>
<p><code>/param?like=0&amp;like=1</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/param&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParamServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String[] like = req.getParameterValues(<span class="string">&quot;like&quot;</span>);</span><br><span class="line">		System.out.println(Arrays.toString(like));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¯¥æ–¹æ³•è¿”å›æ˜¯ä¸€ä¸ªStringç±»å‹æ•°ç»„ï¼Œå› ä¸ºä¸€ä¸ªå‚æ•°åå¯èƒ½ä¼šå¯¹åº”å¤šä¸ªå€¼</p>
</blockquote>
<h3 id="4-4-ç‰¹æ®Š"><a href="#4-4-ç‰¹æ®Š" class="headerlink" title="4.4 ç‰¹æ®Š"></a>4.4 ç‰¹æ®Š</h3><p>åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œéœ€è¦è·å–è¯·æ±‚ä¸­æºå¸¦çš„æ‰€æœ‰<strong>å‚æ•°å</strong>ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨<code>getParameterNames</code>æ–¹æ³•</p>
<p><code>/param?name=tom&amp;age=20&amp;like=0&amp;like=1</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/param&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParamServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		Enumeration&lt;String&gt; names = req.getParameterNames();</span><br><span class="line">		<span class="keyword">while</span>(names.hasMoreElements())&#123;</span><br><span class="line">			String paramName = names.nextElement();</span><br><span class="line">			System.out.println(paramName);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿è¡Œç»“æœï¼š</span></span><br><span class="line">name</span><br><span class="line">age</span><br><span class="line">like</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œ<code>hasMoreElements</code>å¯ä»¥åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œ<code>nextElement</code>å¯ä»¥è¿”å›ä¸€ä¸‹å…ƒç´ </p>
</blockquote>
<p>åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œéœ€è¦è·å–è¯·æ±‚ä¸­æºå¸¦çš„æ‰€æœ‰<strong>å‚æ•°</strong>å’Œå¯¹åº”çš„<strong>å€¼</strong>ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨<code>getParameterMap</code>æ–¹æ³•</p>
<p><code>/param?name=tom&amp;age=20&amp;like=0&amp;like=1</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/param&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParamServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		Map&lt;String, String[]&gt; map = req.getParameterMap();</span><br><span class="line">		<span class="keyword">for</span>(String key:map.keySet())&#123;</span><br><span class="line">			System.out.println(key+<span class="string">&quot; : &quot;</span>+Arrays.toString(map.get(key)));</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿è¡Œç»“æœï¼š</span></span><br><span class="line">name : [tom]</span><br><span class="line">age  : [<span class="number">20</span>]</span><br><span class="line">like : [<span class="number">0</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>



<p>==æ€è€ƒï¼Œä»€ä¹ˆæƒ…å†µä¸‹ï¼Œä¼šä¸çŸ¥é“å®¢æˆ·ç«¯ä¼ ä»€ä¹ˆåå­—çš„å‚æ•°ç»™æˆ‘ä»¬ï¼Ÿ==</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.requestparam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åå°å¤„ç†è¯·æ±‚å‚æ•°  HttpServletRequest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> vanse</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/requestParam&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestParamServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * HttpServletRequest: å°è£…äº†è¯·æ±‚å†…å®¹</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">// 1.è·å–å•ä¸ªå‚æ•°å€¼</span></span><br><span class="line">		<span class="comment">// String name = req.getParameter(&quot;name&quot;);</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 2.è·å–å¤šä¸ªå‚æ•°å€¼</span></span><br><span class="line"><span class="comment">//		String[] hobby = req.getParameterValues(&quot;hobby&quot;);</span></span><br><span class="line"><span class="comment">//		System.out.println(Arrays.toString(hobby));</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 3.è·å–æ‰€æœ‰åç§° (åŸºæœ¬ä¸ç”¨)</span></span><br><span class="line"><span class="comment">//		Enumeration&lt;String&gt; names = req.getParameterNames();</span></span><br><span class="line"><span class="comment">//		while(names.hasMoreElements()) &#123;</span></span><br><span class="line"><span class="comment">//			System.out.println(names.nextElement());</span></span><br><span class="line"><span class="comment">//		&#125;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">// è·å–æ‰€æœ‰åç§°å’Œå€¼</span></span><br><span class="line">		Map&lt;String, String[]&gt; map = req.getParameterMap();</span><br><span class="line">		map.forEach((k,v) -&gt; System.out.println(k+<span class="string">&quot;=&quot;</span>+Arrays.toString(v)));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * å°†æ¥å¯ä»¥å°è£…class User&#123;</span></span><br><span class="line"><span class="comment">		 * 	private String name;</span></span><br><span class="line"><span class="comment">		 *  private String[] hobby;</span></span><br><span class="line"><span class="comment">		 * &#125;</span></span><br><span class="line"><span class="comment">		 * åå°„è°ƒç”¨ setName(lucy)  springmvc</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="comment">//	public void saveUser(User user) &#123;</span></span><br><span class="line"><span class="comment">//		</span></span><br><span class="line"><span class="comment">//	&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="5-å‚æ•°ä¹±ç "><a href="#5-å‚æ•°ä¹±ç " class="headerlink" title="5 å‚æ•°ä¹±ç "></a>5 å‚æ•°ä¹±ç </h2><p>å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚ä¸­ï¼Œæºå¸¦å‚æ•°ç»™Servletï¼Œæˆ–è€…ServletæŠŠæ•°æ®å†™å›ç»™å®¢æˆ·ç«¯ï¼Œåœ¨è¿™æœŸé—´ï¼Œå¦‚æœå‡ºç°ä¸­æ–‡ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰å¯èƒ½å‡ºç°ä¸­æ–‡ä¹±ç çš„é—®é¢˜ã€‚</p>
<h3 id="5-1-GETä¼ å‚"><a href="#5-1-GETä¼ å‚" class="headerlink" title="5.1 GETä¼ å‚"></a>5.1 GETä¼ å‚</h3><p>å¦‚æœæ˜¯GETè¯·æ±‚ä¸­æºå¸¦çš„å‚æ•°ï¼Œå‡ºç°ä¹±ç ï¼Œå¯ä»¥åœ¨TomcatæœåŠ¡å™¨çš„server.xmlæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ã€‚</p>
<p>å› ä¸ºGETè¯·æ±‚çš„å‚æ•°å†™åœ¨URIåçš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨<code>&lt;Connector&gt;</code>ä¸­åŠ å…¥æ–°çš„å±æ€§URIEncoding=â€XXXâ€</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">URIEncoding</span>=<span class="string">&quot;UTF-8&quot;</span> <span class="attr">connectionTimeout</span>=<span class="string">&quot;20000&quot;</span> <span class="attr">port</span>=<span class="string">&quot;8989&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;HTTP/1.1&quot;</span> <span class="attr">redirectPort</span>=<span class="string">&quot;8443&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œ</p>
<p><code>/encoding?name=å¼ ä¸‰</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/encoding&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EncodingServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">&quot;name = &quot;</span>+name);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>å¦‚æœæ˜¯server.xmlä¸­é…ç½®ä¸ºï¼š<code>URIEncoding=&quot;GBK&quot;</code></p>
<p>æ‰§è¡Œç»“æœä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name = å¯®çŠ±ç¬</span><br></pre></td></tr></table></figure>



<p>å¦‚æœæ˜¯server.xmlä¸­é…ç½®ä¸ºï¼š<code>URIEncoding=&quot;UTF-8&quot;</code></p>
<p>æ‰§è¡Œç»“æœä¸º</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">name = å¼ ä¸‰</span><br></pre></td></tr></table></figure>



<blockquote>
<p>å…·ä½“çš„æƒ…å†µï¼Œè¿˜è¦çœ‹å½“å‰è‡ªå·±ç”µè„‘ä¸­è¿è¡Œç¯å¢ƒæ‰è¡Œï¼Œå› ä¸ºæœ‰å¯èƒ½æ ¹æ®å½“å‰ç¯å¢ƒï¼Œè®¾ç½®ä¸ºGBKåˆšå¥½ä¸æ˜¯ä¹±ç </p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™ç§è®¾ç½®ç¼–ç æ–¹å¼ï¼Œåªèƒ½è§£å†³GETæ–¹å¼ä¼ å‚ä¹±ç ï¼Œå¯¹POSTæ–¹å¼æ— æ•ˆ</p>
</blockquote>
<h3 id="5-2-POSTä¼ å‚"><a href="#5-2-POSTä¼ å‚" class="headerlink" title="5.2 POSTä¼ å‚"></a>5.2 POSTä¼ å‚</h3><p>å¦‚æœæ˜¯POSTè¯·æ±‚ä¸­æºå¸¦çš„å‚æ•°ï¼Œå‡ºç°ä¹±ç ï¼Œå¯ä»¥è°ƒç”¨<code>setCharacterEncoding</code>æ–¹æ³•è®¾ç½®è·å–å‚æ•°æ—¶ä½¿ç”¨çš„ç¼–ç </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world! dynamic web<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;encoding&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">		ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>é¡µé¢è¡¨å•ä¸­æäº¤å‚æ•°<code>name=å¼ ä¸‰</code>ç»™å½“å‰Servlet</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/encoding&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EncodingServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//æ³¨æ„ï¼Œæ­¤æ—¶æ˜¯POSTæäº¤æ–¹å¼ï¼ŒServletä¸­é‡å†™çš„æ˜¯doPostæ–¹æ³•</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//req.setCharacterEncoding(&quot;UTF-8&quot;);</span></span><br><span class="line">		</span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">&quot;name = &quot;</span>+name);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰§è¡Œç»“æœï¼š</span></span><br><span class="line">name = Ã¥Â¼Â Ã¤Â¸</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœåœ¨è·å–å‚æ•°ä¹‹å‰ï¼Œå…ˆä½¿ç”¨setCharacterEncodingæ–¹æ³•è®¾ç½®ç¼–ç UTF-8ï¼Œæ‰§è¡Œç»“æœä¸º name = å¼ ä¸‰</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™ç§æ–¹å¼åªé’ˆå¯¹POSTæ–¹å¼ä¼ å‚ä¹±ç ï¼Œå¯¹GETæ–¹å¼æ— æ•ˆ</p>
</blockquote>
<h3 id="5-3-å†™å›æ•°æ®"><a href="#5-3-å†™å›æ•°æ®" class="headerlink" title="5.3 å†™å›æ•°æ®"></a>5.3 å†™å›æ•°æ®</h3><p>Servletä¸­å°†ä¸­æ–‡å†™å›ç»™æµè§ˆå™¨çš„æ—¶å€™ï¼Œä¹Ÿå¯èƒ½ä¼šå‡ºç°ä¸­æ–‡ä¹±ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/encoding&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EncodingServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">	</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/plain&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = resp.getWriter();</span><br><span class="line">		</span><br><span class="line">		out.println(<span class="string">&quot;ä½ å¥½ï¼Œç¨‹åºå‘˜&quot;</span>);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>è®¿é—®åï¼Œæµè§ˆå™¨ä¸­å‡ºç°ä¹±ç ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132227716.png" alt="image-20200930015814334"></p>
<p><strong>ä¿®æ”¹ä»£ç ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/encoding&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EncodingServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//è®¾ç½®å“åº”ä¸­çš„ç¼–ç ä¸ºUTF-8</span></span><br><span class="line">		resp.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//å‘Šè¯‰æµè§ˆå™¨å½“å‰å“åº”ä¸­çš„å†…å®¹çš„ç±»å‹ï¼Œå’Œå†…å®¹çš„ç¼–ç ä¸ºUTF-8</span></span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/plain;charset=UTF-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = resp.getWriter();</span><br><span class="line">		</span><br><span class="line">		out.println(<span class="string">&quot;ä½ å¥½ï¼Œç¨‹åºå‘˜&quot;</span>);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>è®¿é—®åï¼Œæµè§ˆå™¨ä¸­æ˜¾ç¤ºæ­£å¸¸ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132227067.png" alt="image-20200930020103012"></p>
<h3 id="5-4-æ€»ç»“"><a href="#5-4-æ€»ç»“" class="headerlink" title="5.4 æ€»ç»“"></a>5.4 æ€»ç»“</h3><p>ä¸€èˆ¬åœ¨Servletä¸­ï¼Œä¼š<strong>å…ˆ</strong>è¿›è¡Œç¼–ç è®¾ç½®ï¼Œæ–¹æ³•POSTæ–¹å¼ä¼ å‚ä¹±ç ï¼Œå’Œæ–¹æ³•å“åº”å†™å›æ•°æ®ä¹±ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">response.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure>



<p>åŒæ—¶ï¼Œåœ¨ç»™æµè§ˆå™¨å†™å›æ•°æ®çš„æ—¶å€™ï¼Œå…ˆè®¾ç½®å“åº”çš„ç±»å‹å’Œç¼–ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">resp.setContentType(<span class="string">&quot;text/plain;charset=UTF-8&quot;</span>);</span><br><span class="line"><span class="comment">//æˆ–è€…</span></span><br><span class="line">resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"><span class="comment">//æˆ–è€…</span></span><br><span class="line">resp.setContentType(<span class="string">&quot;application/json;charset=UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œå› ä¸ºä¸€èˆ¬å†™å›ç»™æµè§ˆå™¨çš„æ•°æ®æ˜¯æ™®é€šæ–‡æœ¬æˆ–è€…htmlé¡µé¢ï¼Œå°†æ¥è¿˜å¯èƒ½æ˜¯jsonæ ¼å¼å­—ç¬¦ä¸²æ•°æ®</p>
<p>å…¶ç›®çš„æ˜¯ï¼Œè®©æµè§ˆå™¨åœ¨è§£ææ•°æ®ä¹‹å‰ï¼Œæœ‰ä¸ªå‡†å¤‡ï¼Œæå‰çŸ¥é“æ•°æ®çš„ç±»å‹å’Œç¼–ç </p>
</blockquote>
<p>å¦‚æœGETæ–¹å¼ä¼ å‚å‡ºç°ä¹±ç ï¼Œåˆ™éœ€è¦åœ¨server.xmlæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">URIEncoding</span>=<span class="string">&quot;UTF-8&quot;</span> <span class="attr">connectionTimeout</span>=<span class="string">&quot;20000&quot;</span> <span class="attr">port</span>=<span class="string">&quot;8989&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;HTTP/1.1&quot;</span> <span class="attr">redirectPort</span>=<span class="string">&quot;8443&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<p>:tipping_hand_man: vanse</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.encode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/responseEncoding&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseEncodingServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">// è®¾ç½®è¯·æ±‚ç¼–ç </span></span><br><span class="line">		req.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		<span class="comment">// è®¾ç½®å“åº”ç¼–ç </span></span><br><span class="line">		resp.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		<span class="comment">// æµè§ˆå™¨ä¹±ç  </span></span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>); <span class="comment">// æ™®é€šæ–‡æœ¬</span></span><br><span class="line">		<span class="comment">// resp.setContentType(&quot;text/html;charset=utf-8&quot;); // html</span></span><br><span class="line">		</span><br><span class="line">		String name = req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		System.out.println(name);</span><br><span class="line">		PrintWriter writer = resp.getWriter();</span><br><span class="line">		<span class="comment">// æµè¾“å‡ºåˆ°æµè§ˆå™¨ ä¸­æ–‡</span></span><br><span class="line">		writer.write(name);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<hr>
<p>é¢å¤–çš„ï¼Œäº†è§£ä¸€ä¸‹Unicode(å­—ç¬¦é›†)å’ŒUTF-8(ç¼–ç è§„åˆ™)çš„å¯¹åº”å…³ç³»ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Unicodeç¬¦å·èŒƒå›´      | UTF-8ç¼–ç æ–¹å¼</span><br><span class="line">åå…­è¿›åˆ¶			   äºŒè¿›åˆ¶</span><br><span class="line">0000 0000-0000 007F | 0xxxxxxx</span><br><span class="line">0000 0080-0000 07FF | 110xxxxx 10xxxxxx</span><br><span class="line">0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx</span><br><span class="line">0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ‰€ä»¥ï¼Œåœ¨UTF-8çš„ç¼–ç è§„åˆ™ä¸‹ï¼Œä¸€ä¸ªå­—ç¬¦å¯èƒ½æ˜¯1å­—èŠ‚ï¼Œ2å­—èŠ‚ã€3å­—èŠ‚ã€4å­—èŠ‚ï¼Œä¸»è¦æ˜¯çœ‹è¯¥å­—ç¬¦çš„Unicodeå€¼çš„æ‰€åœ¨èŒƒå›´ã€‚</p>
</blockquote>
<p>ä¾‹å¦‚â€œæ±‰â€å­—çš„Unicodeç¼–ç æ˜¯6C49ã€‚6C49åœ¨0800-FFFFä¹‹é—´ï¼Œæ‰€ä»¥è‚¯å®šè¦ç”¨3å­—èŠ‚æ¨¡æ¿äº†ï¼š1110xxxx 10xxxxxx 10xxxxxxã€‚</p>
<h2 id="6-è·³è½¬å’Œé‡å®šå‘-response"><a href="#6-è·³è½¬å’Œé‡å®šå‘-response" class="headerlink" title="6 è·³è½¬å’Œé‡å®šå‘(response)"></a>6 è·³è½¬å’Œé‡å®šå‘(response)</h2><h3 id="6-1-æ¦‚è¿°"><a href="#6-1-æ¦‚è¿°" class="headerlink" title="6.1 æ¦‚è¿°"></a>6.1 æ¦‚è¿°</h3><p>å¦‚æœè®¿é—®ä¸€ä¸ªservletï¼Œéœ€è¦è®©servletæŠŠä¸€ä¸ªå·²ç»å­˜åœ¨htmlé¡µé¢è¿”å›ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨IOæµè¯»å–è¿™ä¸ªé¡µé¢ï¼Œå¹¶å†™å›.</p>
<p><code>hello.html</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world! <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/html&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HtmlServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		req.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		resp.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = resp.getWriter();</span><br><span class="line">		String realPath = getServletContext().getRealPath(<span class="string">&quot;/hello.html&quot;</span>);</span><br><span class="line">		BufferedReader in = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(realPath),<span class="string">&quot;utf-8&quot;</span>));</span><br><span class="line">		</span><br><span class="line">		String line = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">while</span>((line=in.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			out.println(line);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		in.close();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œ<code>getServletContext().getRealPath(&quot;/hello.html&quot;)</code>æ˜¯è·å–è¿™ä¸ªhtmlé¡µé¢ï¼Œéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸­çš„ç»å¯¹è·¯å¾„ï¼Œæ–¹ä¾¿IOæµçš„è¯»å–ã€‚</p>
</blockquote>
<blockquote>
<p>ç”¨ioæµçš„æ–¹å¼è¯»å–å­—èŠ‚æ— æ³•è§£å†³ä¹±ç </p>
</blockquote>
<p>ä½†æ˜¯ï¼Œè¿™æ ·å®ç°åŠŸèƒ½æœ‰ç‚¹éº»çƒ¦ï¼Œè€Œä¸”å¾ˆå¤šéƒ½æ˜¯å›ºå®šçš„ä»£ç ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œå°è£…ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å“åº”å·²ç»å­˜åœ¨çš„html</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> vanse</span></span><br><span class="line"><span class="comment"> *	ioæµ</span></span><br><span class="line"><span class="comment"> *		è¯»è¯¥htmlæ–‡ä»¶</span></span><br><span class="line"><span class="comment"> *	        å°†å†…å®¹å†™åˆ°é¡µé¢</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/responseReadyHtml&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseReadyHtmlServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">// 1.è®¾ç½®ç¼–ç </span></span><br><span class="line">		resp.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">		<span class="comment">// 2.æ‰¾åˆ°è¯¥æ–‡ä»¶</span></span><br><span class="line">			<span class="comment">// 2.1 æ–‡ä»¶è·¯å¾„ (æœ¬åœ°ç£ç›˜å†™æ­»)</span></span><br><span class="line">		<span class="comment">// D:\å¤‡è¯¾\ç›¸å…³è½¯ä»¶\jd12\day61-web-maven\src\main\webapp\test.html</span></span><br><span class="line">		<span class="comment">//String path = &quot;D:\\å¤‡è¯¾\\ç›¸å…³è½¯ä»¶\\jd12\\day61-web-maven\\src\\main\\webapp\\test.html&quot;;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">// åŠ¨æ€è·å–test.htmlåœ¨æœåŠ¡å™¨(é¡¹ç›®)ä¸­çš„è·¯å¾„</span></span><br><span class="line">		<span class="comment">// å®¹å™¨(é¡¹ç›®)çš„ä¸Šä¸‹æ–‡</span></span><br><span class="line">		String path = getServletContext().getRealPath(<span class="string">&quot;test.html&quot;</span>);</span><br><span class="line">		<span class="comment">// E:\soft-it\tomcat\apache-tomcat-8.5.58\webapps\day61-web-maven\test.html</span></span><br><span class="line">		System.out.println(path);</span><br><span class="line">		File file = <span class="keyword">new</span> File(path);</span><br><span class="line">		<span class="comment">// 3.è¯»å†™æ–‡ä»¶</span></span><br><span class="line">			<span class="comment">// è¾“å…¥æµ è¯»</span></span><br><span class="line">		BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(file),<span class="string">&quot;utf-8&quot;</span>));</span><br><span class="line">			<span class="comment">// è¾“å‡ºæµ å†™</span></span><br><span class="line">		PrintWriter writer = resp.getWriter();</span><br><span class="line">		String line = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">while</span>( (line = reader.readLine()) != <span class="keyword">null</span>  ) &#123;</span><br><span class="line">			<span class="comment">// è¯»ä¸€è¡Œå†™ä¸€è¡Œ</span></span><br><span class="line">			writer.write(line);  <span class="comment">// </span></span><br><span class="line">			writer.flush();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// è¯¥æµéœ€è¦æ‰‹åŠ¨å…³</span></span><br><span class="line">		reader.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>å…¶å®Servletä¸­å·²ç»ä¸“é—¨å¯¹è¿™ç§æƒ…å†µè¿›è¡Œäº†å°è£…å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸“é—¨çš„æ–¹æ³•æ¥å®Œæˆæ­¤æ•ˆæœï¼š</p>
<ul>
<li>è·³è½¬</li>
<li>é‡å®šå‘</li>
</ul>
<h3 id="6-2-è·³è½¬"><a href="#6-2-è·³è½¬" class="headerlink" title="6.2 è·³è½¬"></a>6.2 è·³è½¬</h3><p>ä¹Ÿç§°ä¹‹ä¸ºï¼ŒæœåŠ¡å™¨å†…éƒ¨è·³è½¬ã€‚</p>
<p>å…¶æœ¬è´¨æ˜¯ï¼Œåœ¨servletæ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥å°†æ­¤è¯·æ±‚è½¬å‘ç»™æœåŠ¡å™¨å†…éƒ¨çš„å¦ä¸€ä¸ªèµ„æºä¸­ï¼Œå¦‚æœè¿™ä¸ªèµ„æºæ˜¯ä¸€ä¸ªhtmlé¡µé¢ï¼Œé‚£ä¹ˆtomcatå°±ä¼šè‡ªåŠ¨è¯»å–è¿™ä¸ªhtmlé¡µé¢å¹¶å†™å›ç»™æµè§ˆå™¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.RequestDispatcher;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/forward&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForwardServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//pathè¡¨ç¤ºä¸ºä¸€ä¸ªé¡µé¢çš„åœ°å€</span></span><br><span class="line">		String path = <span class="string">&quot;/hello.html&quot;</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//æ ¹æ®æŒ‡å®šåœ°å€ï¼Œè·å–è¯·æ±‚è½¬å‘å¯¹è±¡ï¼ˆRequestDispatcherï¼‰</span></span><br><span class="line">		RequestDispatcher dispatcher = req.getRequestDispatcher(path);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//ä½¿ç”¨è¯·æ±‚è½¬å‘å¯¹è±¡ï¼ŒæŠŠè¯·æ±‚å¯¹è±¡å’Œå“åº”å¯¹è±¡è½¬å‘ç»™æœåŠ¡å™¨å†…éƒ¨çš„å¦ä¸€ä¸ªèµ„æºï¼ˆhtmlï¼‰</span></span><br><span class="line">		<span class="comment">//å®Œæˆè·³è½¬æ•ˆæœ</span></span><br><span class="line">		dispatcher.forward(req, resp);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæœåŠ¡å™¨å†…éƒ¨è·³è½¬ï¼Œä¸ä»…å¯ä»¥ä»ä¸€ä¸ªServletè·³è½¬åˆ°ä¸€ä¸ªhtmlé¡µé¢ä¸­ï¼Œä¹Ÿå¯ä»¥ä»ä¸€ä¸ªServletè·³è½¬åˆ°å¦ä¸€ä¸ªServletä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.RequestDispatcher;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/forward&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForwardServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//pathè¡¨ç¤ºä¸ºä¸€ä¸ªservletçš„æ˜ å°„åœ°å€</span></span><br><span class="line">		String path = <span class="string">&quot;/html&quot;</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//æ ¹æ®æŒ‡å®šåœ°å€ï¼Œè·å–è¯·æ±‚è½¬å‘å¯¹è±¡ï¼ˆRequestDispatcherï¼‰</span></span><br><span class="line">		RequestDispatcher dispatcher = req.getRequestDispatcher(path);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//ä½¿ç”¨è¯·æ±‚è½¬å‘å¯¹è±¡ï¼ŒæŠŠè¯·æ±‚å¯¹è±¡å’Œå“åº”å¯¹è±¡è½¬å‘ç»™æœåŠ¡å™¨å†…éƒ¨çš„å¦ä¸€ä¸ªèµ„æºï¼ˆservletï¼‰</span></span><br><span class="line">		<span class="comment">//å®Œæˆè·³è½¬æ•ˆæœ</span></span><br><span class="line">		dispatcher.forward(req, resp);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>æ­¤æ—¶æ•´ä½“è®¿é—®æƒ…å†µå¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132227141.png" alt="image-20200930023542815"></p>
<p><strong>æœåŠ¡å™¨å†…éƒ¨è·³è½¬çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>éœ€è¦ä½¿ç”¨requestå¯¹è±¡æ¥å®Œæˆ</li>
<li>æœåŠ¡å™¨å†…éƒ¨è·³è½¬æœŸé—´ï¼Œå…¶å®å°±æ˜¯æŠŠè¯·æ±‚requestå’Œå“åº”responseè½¬å‘åˆ°ä¸‹ä¸€ä¸ªèµ„æºä¸­ï¼Œæ‰€ä»¥åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­,ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªrequestå’Œresponse</li>
<li>æœåŠ¡å™¨å†…éƒ¨è·³è½¬,ã€ä¸ä¼šã€‘æ”¹å˜æµè§ˆå™¨åœ°å€æ ä¸­çš„åœ°å€ï¼Œå› ä¸ºä»å§‹è‡³ç»ˆæµè§ˆå™¨åªå‘å‡ºäº†ä¸€ä¸ªè¯·æ±‚</li>
</ul>
<h3 id="6-3-é‡å®šå‘"><a href="#6-3-é‡å®šå‘" class="headerlink" title="6.3 é‡å®šå‘"></a>6.3 é‡å®šå‘</h3><p>ä¹Ÿç§°ä¹‹ä¸ºï¼Œå®¢æˆ·ç«¯é‡å®šå‘ã€‚</p>
<p>å…¶æœ¬è´¨æ˜¯ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œè®¿é—®servletè·å–èµ„æºï¼Œä½†æ˜¯æœåŠ¡å™¨ä¸­ï¼Œå·²ç»å°†èµ„æºè½¬ç§»åˆ°å¦ä¸€ä¸ªä½ç½®äº†ï¼Œæ‰€ä»¥éœ€è¦é€šçŸ¥å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œé‡æ–°å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œè®¿é—®ä¸€ä¸ªæ–°çš„èµ„æºä½ç½®ã€‚</p>
<p>æ­¤æ—¶ï¼ŒæœåŠ¡å™¨éœ€è¦é€šçŸ¥æµè§ˆå™¨å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œå¹¶ä¸”è¯·æ±‚æ–°çš„èµ„æºä½ç½®</p>
<ul>
<li>é€šè¿‡å“åº”çŠ¶æ€ç ï¼ˆ302ï¼‰ï¼Œé€šçŸ¥æµè§ˆå™¨éœ€è¦é‡å®šå‘</li>
<li>é€šè¿‡å“åº”å¤´å­—æ®µï¼ˆLocation: æ–°åœ°å€ï¼‰ï¼Œé€šçŸ¥æµè§ˆå™¨æ–°çš„èµ„æºä½ç½®</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/redirect&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedirectServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//éœ€è¦å®¢æˆ·ç«¯é‡å®šå‘çš„ä¸€ä¸ªæ–°çš„èµ„æºä½ç½®</span></span><br><span class="line">		String location = <span class="string">&quot;hello.html&quot;</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//é€šçŸ¥å®¢æˆ·ç«¯æµè§ˆå™¨è¿›è¡Œèµ„æºé‡å®šå‘</span></span><br><span class="line">		resp.sendRedirect(location);</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>è®¿é—®ç»“æœä¸ºï¼š</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132227347.png" alt="image-20200930024921090"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œç¬¬ä¸€æ¬¡è®¿é—®/redirectçš„å“åº”çŠ¶æ€ç æ˜¯302ï¼Œå¹¶ä¸”å“åº”å¤´ä¿¡æ¯ä¸­æŒ‡å®šäº†æ–°çš„èµ„æºåœ°å€ï¼Œæµè§ˆå™¨æ ¹æ®è¿™ä¸ªæ–°åœ°å€å‘å‡ºäº†ç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œå¹¶ä¸”å½“å‰æµè§ˆå™¨åœ°å€æ ä¸­çš„åœ°å€ï¼Œæ˜¾ç¤ºçš„æ˜¯ç¬¬äºŒæ¬¡è¯·æ±‚çš„åœ°å€</p>
</blockquote>
<p><strong>æ­¤æ—¶æ•´ä½“è®¿é—®æƒ…å†µå¦‚ä¸‹ï¼š</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132227837.png" alt="image-20200930031120256"></p>
<p><strong>å®¢æˆ·ç«¯é‡å®šå‘çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>éœ€è¦ä½¿ç”¨responseå¯¹è±¡æ¥å®Œæˆ</li>
<li>å®¢æˆ·ç«¯é‡å®šå‘ï¼Œä¼šè®©æµè§ˆå™¨å‘å‡ºç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œé‚£ä¹ˆåœ¨æœåŠ¡å™¨å†…éƒ¨ä¼šäº§ç”Ÿæ–°çš„requestå¯¹è±¡å’Œresponseå¯¹è±¡</li>
<li>å®¢æˆ·ç«¯é‡å®šå‘,ã€ä¼šã€‘æ”¹å˜æµè§ˆå™¨åœ°å€æ ä¸­çš„åœ°å€ï¼Œå› ä¸ºå‘å‡ºäº†ç¬¬äºŒæ¬¡è¯·æ±‚</li>
</ul>
<p>å®¢æˆ·ç«¯é‡å®šå‘ä¸ä»…å¯ä»¥é‡å®šå‘åˆ°ä¸€ä¸ªhtmlé¡µé¢ï¼Œä¹Ÿå¯ä»¥é‡å®šå‘åˆ°å¦ä¸€ä¸ªServletä¸­ï¼Œåªè¦æ”¹å˜é‡å®šå‘åœ°å€å³å¯ã€‚</p>
<h3 id="6-4-æ€»ç»“"><a href="#6-4-æ€»ç»“" class="headerlink" title="6.4 æ€»ç»“"></a>6.4 æ€»ç»“</h3><p>æœåŠ¡å™¨å†…éƒ¨è·³è½¬ï¼š</p>
<ul>
<li>ä½¿ç”¨requestå®Œæˆ</li>
<li>è·³è½¬çš„æœ¬è´¨æ˜¯åœ¨æœåŠ¡å™¨å†…éƒ¨æŠŠè¯·æ±‚å’Œå“åº”è¿›è¡Œè½¬å‘ï¼Œè½¬å‘ç»™ä¸‹ä¸€ä¸ªæŒ‡å®šçš„èµ„æº</li>
<li>å¦‚æœrequestä¸­æœ‰æ•°æ®ï¼Œåœ¨è·³è½¬åˆ°çš„ä¸‹ä¸€ä¸ªèµ„æºä¸­æ˜¯å¯ä»¥æ‹¿åˆ°è¿™ä¸ªæ•°æ®ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªrequestè¯·æ±‚å¯¹è±¡</li>
<li>ç”±äºæœåŠ¡å™¨è·³è½¬æ˜¯æŠŠè¯·æ±‚å’Œå“åº”åœ¨æœåŠ¡å™¨å†…éƒ¨ä¸­è¿›è¡Œè½¬å‘ï¼Œæ‰€ä»¥æµè§ˆå™¨çš„åœ°å€æ ä¸­çš„åœ°å€æ˜¯ä¸å—å½±å“çš„ï¼Œå§‹ç»ˆè¿˜æ˜¯ç¬¬ä¸€æ¬¡å‘å‡ºè¯·æ±‚çš„åœ°å€ï¼Œå…¶å®æµè§ˆå™¨æ ¹æœ¬å°±ä¸çŸ¥é“æœåŠ¡å™¨å†…éƒ¨çš„è¯·æ±‚è½¬å‘æƒ…å†µ</li>
<li>åœ¨è®¾ç½®è·³è½¬çš„èµ„æºåœ°å€çš„æ—¶å€™ï¼Œè·¯å¾„çš„å‰é¢ä¸€èˆ¬è¦åŠ ä¸Š/ï¼Œä¾‹å¦‚ <code>String path = &quot;/hello.html&quot;;</code></li>
</ul>
<p>å®¢æˆ·ç«¯é‡å®šå‘ï¼š</p>
<ul>
<li><p>ä½¿ç”¨responseå®Œæˆ</p>
</li>
<li><p>é‡å®šå‘çš„æœ¬è´¨æ˜¯æŠŠæ–°çš„èµ„æºè·¯å¾„è¿”å›ç»™æµè§ˆå™¨ï¼Œè®©æµè§ˆå™¨å‘è¿™ä¸ªæ–°åœ°å€å‘é€ä¸€ä¸ªæ–°è¯·æ±‚</p>
<p>æ­¤å¤„æ˜¯åˆ©ç”¨äº†å“åº”çš„çŠ¶æ€ç 302å’Œå“åº”å¤´ä¿¡æ¯ä¸­çš„Locationå­—æ®µæ¥å®Œæˆ</p>
</li>
<li><p>å¦‚æœrequestä¸­æœ‰æ•°æ®ï¼Œé‡å®šå‘ååœ¨æ–°çš„èµ„æºä¸­æ˜¯æ‹¿ä¸åˆ°è¿™ä¸ªæ•°æ®çš„ï¼Œå› ä¸ºé‡å®šå‘ä¼šå‘å‡ºæ–°çš„è¯·æ±‚ï¼Œä½†æ˜¯æ•°æ®åœ¨ä¸Šä¸€ä¸ªè€çš„è¯·æ±‚ä¸­</p>
</li>
<li><p>ç”±äºé‡å®šå‘è®©æµè§ˆå™¨å‘å‡ºæ–°çš„è¯·æ±‚ï¼Œæ‰€ä»¥æµè§ˆå™¨åœ°å€æ ä¸­çš„åœ°å€ä¼šå˜æˆæ–°è¯·æ±‚çš„åœ°å€</p>
</li>
<li><p>åœ¨è®¾ç½®é‡å®šå‘çš„èµ„æºåœ°å€çš„æ—¶å€™ï¼Œè·¯å¾„çš„å‰é¢ä¸€èˆ¬ä¸åŠ /</p>
<p>ä¾‹å¦‚ï¼Œ<code>String path = &quot;hello.html&quot;;</code></p>
<p>ä½†æ˜¯å¦‚æœä¸€å®šè¦åŠ /çš„è¯,é‚£ä¹ˆè¿˜éœ€è¦é¢å¤–åŠ ä¸Šä¸€ä¸ªé¡¹ç›®å</p>
<p>ä¾‹å¦‚ï¼Œ<code>String path = &quot;/servlet/hello.html&quot;;</code></p>
<p>åŒæ—¶ä¹Ÿå¯ä»¥åŠ¨æ€è·å–é¡¹ç›®ï¼š<code>req.getContextPath()</code></p>
<p>ä¾‹å¦‚ï¼Œ<code>String path = req.getContextPath()+&quot;/hello.html&quot;;</code></p>
</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼Œå…³äºè·¯å¾„é—®é¢˜ï¼Œåé¢ä¼šæœ‰ä¸“é—¨çš„éƒ¨åˆ†å»è®²è§£</p>
</blockquote>
<h1 id="servletï¼ˆä¸‰ï¼‰"><a href="#servletï¼ˆä¸‰ï¼‰" class="headerlink" title="servletï¼ˆä¸‰ï¼‰"></a>servletï¼ˆä¸‰ï¼‰</h1><h2 id="1-é¡¹ç›®è·¯å¾„"><a href="#1-é¡¹ç›®è·¯å¾„" class="headerlink" title="1 é¡¹ç›®è·¯å¾„"></a>1 é¡¹ç›®è·¯å¾„</h2><h3 id="1-1-æ–œæ ï¼ˆ-ï¼‰"><a href="#1-1-æ–œæ ï¼ˆ-ï¼‰" class="headerlink" title="1.1 æ–œæ ï¼ˆ/ï¼‰"></a>1.1 æ–œæ ï¼ˆ/ï¼‰</h3><p>æ–œæ ï¼ˆ/ï¼‰åœ¨è·¯å¾„ä¸­ï¼Œä¸€èˆ¬çš„æ„æ€å°±æ˜¯è·¯å¾„ä¹‹é—´çš„åˆ†å‰²ï¼Œä½†æ˜¯webé¡¹ç›®ä¸­ç»å¸¸ä¼šæ¥çœ‹åˆ°æœ‰ä¸€äº›è·¯å¾„ï¼Œå®ƒçš„æœ€å‰é¢ä¼šæœ‰ä¸€ä¸ªæ–œæ ï¼ˆ/ï¼‰ï¼Œä¾‹å¦‚</p>
<ul>
<li>/index.html</li>
<li>/hello</li>
<li>/servlet/user/hello</li>
</ul>
<p>é‚£ä¹ˆè¿™ä¸ªè·¯å¾„ä¸­å¼€å¤´æ–œæ ï¼ˆ/ï¼‰çš„è§£æï¼Œæœ‰ä¿©ç§æƒ…å†µï¼š</p>
<ul>
<li>ç”±æœåŠ¡å™¨è§£æ</li>
<li>ç”±å®¢æˆ·ç«¯è§£æ</li>
</ul>
<h4 id="1-1-1-å®¢æˆ·ç«¯è§£æ"><a href="#1-1-1-å®¢æˆ·ç«¯è§£æ" class="headerlink" title="1.1.1 å®¢æˆ·ç«¯è§£æ"></a>1.1.1 å®¢æˆ·ç«¯è§£æ</h4><p>å½“ç”±å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰è§£æè·¯å¾„æœ€å·¦è¾¹æ–œæ ï¼ˆ/ï¼‰çš„æ—¶å€™ï¼Œè¿™ä¸ªæ–œæ æŒ‡çš„æ˜¯ç«¯å£å·åé¢çš„æ–œæ ï¼ˆ/ï¼‰</p>
<p><a href="http://ip:port/">http://ip:port/</a></p>
<p>ä¾‹å¦‚ï¼Œåœ¨é¡µé¢ä¸­æœ‰ä¸€ä¸ªè¶…é“¾æ¥</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/hello.html&quot;</span>&gt;</span>æµ‹è¯•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ–œæ ï¼ˆ/ï¼‰ç”±å®¢æˆ·ç«¯æµè§ˆå™¨è¿›è¡Œè§£æï¼Œå½“ç‚¹å‡»è¿™ä¸ªè¶…é“¾æ¥çš„æ—¶å€™ï¼Œåœ°å€æ ä¸­çš„ä¸­ä¼šå˜æˆï¼š</p>
<p><a href="http://ip:port/hello.html">http://ip:port/hello.html</a></p>
<p>ä¾‹å¦‚ï¼Œåœ¨servletä¸­ï¼Œå®Œæˆå®¢æˆ·ç«¯é‡å®šå‘</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String url = <span class="string">&quot;/hello.html&quot;</span>;</span><br><span class="line">response.sendRedirect(url);</span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯é‡å®šæ˜¯æŠŠurlåœ°å€è¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨è§£æä¹‹åï¼Œå‘å‡ºæ–°çš„è¯·æ±‚ï¼Œè¿™æ—¶å€™æµè§ˆå™¨åœ°å€æ ä¸­çš„urlåœ°å€å˜ä¸ºï¼š</p>
<p><a href="http://ip:port/hello.html">http://ip:port/hello.html</a></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œè¿™ç§æƒ…å†µä»£ç è™½ç„¶æ˜¯å†™åœ¨æœåŠ¡å™¨ç«¯çš„ï¼Œä½†æ˜¯è·¯å¾„æœ€åæ˜¯è¿”å›ç»™æµè§ˆå™¨è¿›è¡Œè§£æ</p>
</blockquote>
<h4 id="1-1-2-æœåŠ¡å™¨è§£æ"><a href="#1-1-2-æœåŠ¡å™¨è§£æ" class="headerlink" title="1.1.2 æœåŠ¡å™¨è§£æ"></a>1.1.2 æœåŠ¡å™¨è§£æ</h4><p>å½“ç”±æœåŠ¡å™¨ç«¯è§£æè·¯å¾„æœ€å·¦è¾¹æ–œæ ï¼ˆ/ï¼‰çš„æ—¶å€™ï¼Œè¿™ä¸ªæ–œæ æŒ‡çš„æ˜¯é¡¹ç›®ååé¢çš„æ–œæ ï¼ˆ/ï¼‰</p>
<p><a href="http://ip:port/projectName/">http://ip:port/projectName/</a></p>
<p>ä¾‹å¦‚ï¼Œåœ¨web.xmlæ–‡ä»¶ä¸­é…ç½®servletçš„æ˜ å°„è·¯å¾„</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ–œæ ï¼ˆ/ï¼‰ç”±æœåŠ¡å™¨ç«¯è¿›è¡Œè§£æï¼Œå®ƒä»£è¡¨çš„æ˜¯é¡¹ç›®ååçš„æ–œæ ï¼ˆ/ï¼‰ï¼Œè¿™ä¸ªèµ„æºçš„è®¿é—®éœ€è¦ä½¿ç”¨ä»¥ä¸‹URLï¼š</p>
<p><a href="http://ip:port/projectName/hello">http://ip:port/projectName/hello</a></p>
<blockquote>
<p>æ³¨æ„ï¼Œä½¿ç”¨æ³¨è§£çš„æ–¹å¼é…ç½®servletçš„æ•ˆæœä¹Ÿæ˜¯ä¸€æ ·çš„æ•ˆæœ</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œåœ¨servletä¸­è¿›è¡ŒæœåŠ¡å™¨å†…éƒ¨è·³è½¬æ“ä½œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String url = <span class="string">&quot;/test&quot;</span>;</span><br><span class="line">request.getRequestDispatcher(url).forward(request, response);</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ–œæ ï¼ˆ/ï¼‰ç”±æœåŠ¡å™¨ç«¯è¿›è¡Œè§£æï¼Œå®ƒä»£è¡¨çš„æ˜¯é¡¹ç›®ååçš„æ–œæ ï¼ˆ/ï¼‰ï¼Œæœ€åå†…éƒ¨è·³è½¬æ‰€è®¿é—®çš„URLåœ°å€å°±æ˜¯ï¼š</p>
<p><a href="http://ip:port/projectName/test">http://ip:port/projectName/test</a></p>
<h3 id="1-2-æ–¹æ³•"><a href="#1-2-æ–¹æ³•" class="headerlink" title="1.2 æ–¹æ³•"></a>1.2 æ–¹æ³•</h3><blockquote>
<p>Servletä¸­æä¾›äº†ä¸€äº›å’Œè·¯å¾„ç›¸å…³çš„æ–¹æ³•</p>
</blockquote>
<h4 id="1-2-1-HttpServletRequest"><a href="#1-2-1-HttpServletRequest" class="headerlink" title="1.2.1 HttpServletRequest"></a>1.2.1 HttpServletRequest</h4><p><code>javax.servlet.http.HttpServletRequest</code>æ¥å£ï¼Œè¡¨ç¤ºhttpåè®®çš„è¯·æ±‚</p>
<p>å¸¸ç”¨çš„å’Œè·¯å¾„ç›¸å…³çš„æ–¹æ³•ï¼š</p>
<ul>
<li><code>getContextPath()</code>ï¼Œè·å–é¡¹ç›®çš„æ ¹è·¯å¾„ï¼ˆé»˜è®¤æ˜¯é¡¹ç›®åï¼‰</li>
<li><code>getServletPath()</code>ï¼Œè·å–å½“å‰è®¿é—®çš„servletåœ°å€</li>
<li><code>getRequestURL()</code>ï¼Œè·å–å½“å‰è¯·æ±‚çš„URLåœ°å€</li>
<li><code>getRequestURI()</code>ï¼Œè·å–å½“å‰è¯·æ±‚çš„URIåœ°å€</li>
</ul>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/path&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PathServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;req.getContextPath() = &quot;</span>+req.getContextPath());</span><br><span class="line">		System.out.println(<span class="string">&quot;req.getServletPath() = &quot;</span>+req.getServletPath());</span><br><span class="line">		System.out.println(<span class="string">&quot;req.getRequestURL()  = &quot;</span>+req.getRequestURL());</span><br><span class="line">		System.out.println(<span class="string">&quot;req.getRequestURI()  = &quot;</span>+req.getRequestURI());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>è®¿é—®åœ°å€ <a href="http://127.0.0.1:8989/servlet-test/path">http://127.0.0.1:8989/servlet-test/path</a></p>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">req.getContextPath() = /servlet-test</span><br><span class="line">req.getServletPath() = /path</span><br><span class="line">req.getRequestURL()  = http://127.0.0.1:8989/servlet-test/path</span><br><span class="line">req.getRequestURI()  = /servlet-test/path</span><br></pre></td></tr></table></figure>





<h4 id="1-2-2-ServletContext"><a href="#1-2-2-ServletContext" class="headerlink" title="1.2.2 ServletContext"></a>1.2.2 ServletContext</h4><p><code>javax.servlet.ServletContext</code>æ¥å£ï¼Œè¡¨ç¤ºServletä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä»£è¡¨äº†æ•´ä¸ªwebé¡¹ç›®ï¼Œæ˜¯éå¸¸é‡è¦çš„ä¸€ä¸ªå¯¹è±¡</p>
<p>å¸¸ç”¨çš„å’Œè·¯å¾„ç›¸å…³çš„æ–¹æ³•ï¼š</p>
<ul>
<li><p><code>getContextPath()</code>ï¼Œè·å–å½“å‰é¡¹ç›®çš„æ ¹è·¯å¾„ï¼ˆé»˜è®¤å°±æ˜¯é¡¹ç›®åï¼‰</p>
</li>
<li><p><code>getRealPath(String path)</code>ï¼Œè·å–ä¸€ä¸ªèµ„æºåœ¨æœåŠ¡å™¨ä¸­çš„ç»å¯¹è·¯å¾„</p>
</li>
<li><p><code>getResourcePaths(String path)</code>ï¼Œè·å–ä¸€ä¸ªè·¯å¾„ä¸‹é¢çš„æ‰€æœ‰èµ„æº</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/path&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PathServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">//é€šè¿‡requestå¯¹è±¡è·å–ServletContextå¯¹è±¡</span></span><br><span class="line">		ServletContext servletContext = getServletContext();</span><br><span class="line">		</span><br><span class="line">		String contextPath = servletContext.getContextPath();</span><br><span class="line">		System.out.println(<span class="string">&quot;contextPath = &quot;</span>+contextPath);</span><br><span class="line">		</span><br><span class="line">		String realPath = servletContext.getRealPath(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;realPath = &quot;</span>+realPath);</span><br><span class="line">		</span><br><span class="line">		Set&lt;String&gt; resourcePaths = servletContext.getResourcePaths(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">		resourcePaths.forEach(System.out::println);</span><br><span class="line">			</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>è®¿é—®åœ°å€ <a href="http://127.0.0.1:8989/servlet-test/path">http://127.0.0.1:8989/servlet-test/path</a></p>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contextPath = /servlet-test</span><br><span class="line">realPath = D:\briup\apache-tomcat-8.5.58\webapps\servlet-test\</span><br><span class="line">/META-INF/</span><br><span class="line">/hello.html</span><br><span class="line">/WEB-INF/</span><br><span class="line">/index.html</span><br></pre></td></tr></table></figure>



<h3 id="1-3-ç›¸å¯¹è·¯å¾„"><a href="#1-3-ç›¸å¯¹è·¯å¾„" class="headerlink" title="1.3 ç›¸å¯¹è·¯å¾„"></a>1.3 ç›¸å¯¹è·¯å¾„</h3><p><strong>ä¾‹å¦‚1</strong>ï¼Œå‡è®¾path.htmlå’Œhello.htmlåœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ã€‚</p>
<p>path.htmlé¡µé¢ä¸­æœ‰ä¸€ä¸ªè¶…é“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;hello.html&quot;</span>&gt;</span>æµ‹è¯•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¶…é“¾æ¥ä¸­çš„è¿™ä¸ªè·¯å¾„å°±æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œç›¸å¯¹äº<strong>å½“å‰è·¯å¾„</strong>ï¼Œå½“å‰è·¯å¾„æŒ‡çš„æ˜¯æµè§ˆå™¨åœ°å€æ ä¸­è¿™ä¸ªæ—¶å€™çš„è·¯å¾„ã€‚</p>
<p>æ‰€ä»¥å½“ç‚¹å‡»è¶…é“¾æ¥çš„æ—¶å€™ï¼Œå°±æ˜¯åœ¨å½“å‰è·¯å¾„åé¢åŠ ä¸Šè¿™ä¸ªç›¸å¯¹è·¯å¾„ï¼š</p>
<p>1ã€è®¿é—®path.htmlçš„urlåœ°å€ï¼š</p>
<p><a href="http://127.0.0.1:8989/servlet-test/path.html">http://127.0.0.1:8989/servlet-test/path.html</a></p>
<p>2ã€ç‚¹å‡»è¶…é“¾æ¥ä¹‹åï¼Œåœ°å€æ ä¸­çš„åœ°å€å˜ä¸ºï¼šå½“å‰è·¯å¾„+ç›¸å¯¹è·¯å¾„</p>
<p><a href="http://127.0.0.1:8989/servlet_test/">http://127.0.0.1:8989/servlet_test/</a><br>+<br>hello.html<br>=<br><a href="http://127.0.0.1:8989/servlet-test/hello.html">http://127.0.0.1:8989/servlet-test/hello.html</a></p>
<p><strong>ä¾‹å¦‚2</strong>ï¼Œå‡è®¾path.htmlå’Œhello.htmlä¸åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œpath.htmlåœ¨testç›®å½•ä¸‹</p>
<p>path.htmlé¡µé¢ä¸­æœ‰ä¸€ä¸ªè¶…é“¾æ¥</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;hello.html&quot;</span>&gt;</span>æµ‹è¯•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¶…é“¾æ¥ä¸­çš„è¿™ä¸ªè·¯å¾„å°±æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œç›¸å¯¹äºå½“å‰è·¯å¾„ï¼Œå½“å‰è·¯å¾„æŒ‡çš„æ˜¯æµè§ˆå™¨åœ°å€æ ä¸­è¿™ä¸ªæ—¶å€™çš„è·¯å¾„ã€‚</p>
<p>æ‰€ä»¥å½“ç‚¹å‡»è¶…é“¾æ¥çš„æ—¶å€™ï¼Œå°±æ˜¯åœ¨å½“å‰è·¯å¾„åé¢åŠ ä¸Šè¿™ä¸ªç›¸å¯¹è·¯å¾„ï¼š</p>
<p>1ã€è®¿é—®path.htmlçš„urlåœ°å€ï¼š</p>
<p><a href="http://127.0.0.1:8989/servlet-test/test/path.html">http://127.0.0.1:8989/servlet-test/test/path.html</a></p>
<p>2ã€ç‚¹å‡»è¶…é“¾æ¥ä¹‹å,åœ°å€æ ä¸­çš„åœ°å€å˜ä¸ºï¼šå½“å‰è·¯å¾„+ç›¸å¯¹è·¯å¾„</p>
<p><a href="http://127.0.0.1:8989/servlet-test/test">http://127.0.0.1:8989/servlet-test/test</a><br>+<br>hello.html<br>=<br><a href="http://127.0.0.1:8989/servlet-test/test/hello.html">http://127.0.0.1:8989/servlet-test/test/hello.html</a></p>
<p>è¿™æ—¶å€™å‡ºç°404é”™è¯¯ï¼Œé¡µé¢æ‰¾ä¸åˆ°ï¼Œå› ä¸ºè®¿é—®åœ°å€ä¸å¯¹ã€‚<br>ä¿®æ”¹è¿æ¥åœ°å€å¦‚ä¸‹ï¼Œå³å¯æ­£å¸¸ç‚¹å‡»è®¿é—®ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;../hello.html&quot;</span>&gt;</span>æµ‹è¯•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>ä¾‹å¦‚3</strong>ï¼Œå‡è®¾path.htmlå’Œhello.htmlåœ¨åŒä¸€ä¸ªç›®å½•ä¸‹(æ­¤æ—¶web.xml)</p>
<p>path.htmlé¡µé¢ä¸­æœ‰ä¸€ä¸ªè¶…é“¾æ¥</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;hello.html&quot;</span>&gt;</span>æµ‹è¯•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>web.xmlä¸­æ˜ å°„çš„è·¯å¾„ä¸ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet/path<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>è®¿é—®è¿™ä¸ªservletä¹‹åï¼Œè¿›è¡Œä¸€ä¸ªæœåŠ¡å™¨å†…éƒ¨è·³è½¬ï¼Œè·³è½¬åˆ°path.htmlé¡µé¢<br>è¿™æ—¶å€™ï¼Œæµè§ˆå™¨åœ°å€æ ä¸­åœ°å€ä¸ºservletåœ°å€ï¼Œæ˜¾ç¤ºçš„å†…å®¹ä¸ºpath.htmlé¡µé¢ï¼Œç‚¹å‡»è¶…é“¾æ¥è§‚å¯Ÿæ•ˆæœã€‚</p>
<p>1ã€è®¿é—®servletçš„urlåœ°å€ï¼š</p>
<p><a href="http://127.0.0.1:8989/servlet-test/servlet/path">http://127.0.0.1:8989/servlet-test/servlet/path</a></p>
<p>2ã€ç„¶åç‚¹å‡»é¡µé¢ä¸­çš„è¶…é“¾æ¥</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;hello.html&quot;</span>&gt;</span>æµ‹è¯•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¶…é“¾æ¥ä¸­çš„è¿™ä¸ªè·¯å¾„å°±æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œç›¸å¯¹äºå½“å‰è·¯å¾„ï¼Œå½“å‰è·¯å¾„æŒ‡çš„æ˜¯æµè§ˆå™¨åœ°å€æ ä¸­è¿™ä¸ªæ—¶å€™çš„è·¯å¾„ã€‚</p>
<p>æ‰€ä»¥å½“ç‚¹å‡»è¶…é“¾æ¥çš„æ—¶å€™ï¼Œå°±æ˜¯åœ¨å½“å‰è·¯å¾„åé¢åŠ ä¸Šè¿™ä¸ªç›¸å¯¹è·¯å¾„ï¼š</p>
<p>3ã€ç‚¹å‡»è¶…é“¾æ¥ä¹‹å,åœ°å€æ ä¸­çš„åœ°å€å˜ä¸ºï¼šå½“å‰è·¯å¾„+ç›¸å¯¹è·¯å¾„</p>
<p><a href="http://127.0.0.1:8989/servlet-test/servlet">http://127.0.0.1:8989/servlet-test/servlet</a><br>+<br>hello.html<br>=<br><a href="http://127.0.0.1:8989/servlet-test/servlet/hello.html">http://127.0.0.1:8989/servlet-test/servlet/hello.html</a></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶åˆä¼šå‡ºç°404é”™è¯¯</p>
</blockquote>
<p><strong>ä¾‹å¦‚4</strong>ï¼Œé¡µé¢ä¸­ä½¿ç”¨<code>&lt;base&gt;</code>æ ‡ç­¾</p>
<p>åœ¨htmlé¡µé¢æ·»åŠ baseæ ‡ç­¾ä¹‹åï¼Œè¿™ä¸ªé¡µé¢ä¸­çš„æ‰€æœ‰ç›¸å¯¹è·¯å¾„ï¼Œå°±ä¸å†æ˜¯ç›¸å¯¹äºåœ°å€æ ä¸­çš„è·¯å¾„äº†ï¼Œè€Œæ˜¯ç›¸å¯¹äºbaseæ ‡ç­¾ä¸­è®¾ç½®çš„è·¯å¾„</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span> <span class="meta-string">&quot;http://www.w3.org/TR/html4/loose.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">&quot;http://127.0.0.1:8989/servlet-test/&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>path.html<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;hello.html&quot;</span>&gt;</span>æµ‹è¯•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé¡µé¢ä¸­çš„ç›¸å¯¹è·¯å¾„ï¼Œå‚ç…§ç‚¹æ˜¯æµè§ˆå™¨åœ°å€æ ä¸­çš„å½“å‰åœ°å€ï¼Œä½¿ç”¨<code>&lt;base&gt;</code>æ ‡ç­¾ä¹‹å‰ï¼Œé¡µé¢ä¸­è¿™äº›ç›¸å¯¹è·¯å¾„çš„å‚ç…§ç‚¹ï¼Œå°±å˜æˆäº†<code>&lt;base href=&quot;...&quot;&gt;</code>æ ‡ç­¾ä¸­æŒ‡å®šçš„åœ°å€</p>
</blockquote>
<h3 id="1-4-ä¿®æ”¹è·¯å¾„"><a href="#1-4-ä¿®æ”¹è·¯å¾„" class="headerlink" title="1.4 ä¿®æ”¹è·¯å¾„"></a>1.4 ä¿®æ”¹è·¯å¾„</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé¡¹ç›®éƒ¨ç½²åï¼Œé¡¹ç›®è·¯å¾„ï¼ˆContextPathï¼‰å°±æ˜¯é¡¹ç›®çš„åå­—ï¼Œä¹Ÿå¯ä»¥æ ¹æ®æƒ…å†µå¯¹è¯¥è·¯å¾„è¿›è¡Œä¿®æ”¹ã€‚</p>
<p>ä¾‹å¦‚ï¼ŒæŠŠContextPathä¿®æ”¹ä¸º/</p>
<p>åœ¨Eclipseä¸­éƒ¨ç½²åï¼Œserver.xmlæ–‡ä»¶ä¸­ä¼šå¤šä¸€ä¸ªé…ç½®ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">docBase</span>=<span class="string">&quot;servlet&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/servlet&quot;</span> <span class="attr">reloadable</span>=<span class="string">&quot;true&quot;</span> <span class="attr">source</span>=<span class="string">&quot;org.eclipse.jst.jee.server:servlet&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">Host</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>æ­¤æ—¶é¡¹ç›®çš„ContextPathä¸º <code>/servlet</code>ï¼Œå¯ä»¥åœ¨è¿™é‡Œç›´æ¥ä¿®æ”¹ä¸º <code>/</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">docBase</span>=<span class="string">&quot;servlet&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">reloadable</span>=<span class="string">&quot;true&quot;</span> <span class="attr">source</span>=<span class="string">&quot;org.eclipse.jst.jee.server:servlet&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">Host</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>å¯åŠ¨åï¼ŒåŸæ¥æ˜¯è¿™æ ·è®¿é—®çš„è·¯å¾„ï¼š<a href="http://127.0.0.1:8989/servlet/index.html">http://127.0.0.1:8989/servlet/index.html</a></p>
<p>ç°åœ¨å¯ä»¥è¿™æ ·æ¥è®¿é—®ï¼š<a href="http://127.0.0.1:8989/index.html">http://127.0.0.1:8989/index.html</a></p>
<p>æˆ–è€…åœ¨éƒ¨ç½²ä¹‹å‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹é¡¹ç›®çš„ContextPathï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132228502.png" alt="image-20201005213218225"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132224597.png" alt="image-20201005213239196"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132224812.png" alt="image-20201005213315890"></p>
<blockquote>
<p>æœ€åï¼Œéƒ¨ç½²å¯åŠ¨å³å¯</p>
</blockquote>
<h2 id="2-èŒƒå›´å¯¹è±¡"><a href="#2-èŒƒå›´å¯¹è±¡" class="headerlink" title="2 èŒƒå›´å¯¹è±¡"></a>2 èŒƒå›´å¯¹è±¡</h2><h3 id="2-1-æ¦‚è¿°-1"><a href="#2-1-æ¦‚è¿°-1" class="headerlink" title="2.1 æ¦‚è¿°"></a>2.1 æ¦‚è¿°</h3><p>åœ¨webé¡¹ç›®ä¸­ï¼Œå¦‚æœæœ‰æ•°æ®ï¼Œéœ€è¦è¿›è¡Œä¼ é€’ï¼Œå¹¶ä¸”è¦æ±‚åœ¨æŸä¸€ä¸ªèŒƒå›´å†…è¿›è¡Œä¼ é€’ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨servletä¸­ä½¿ç”¨ä»¥ä¸‹å‡ ä¸ªå¯¹è±¡ï¼Œåœ¨æŒ‡å®šçš„èŒƒå›´å†…ï¼Œè¿›è¡Œæ•°æ®ä¼ é€’ã€‚</p>
<table>
<thead>
<tr>
<th>æ¥å£ç±»å‹</th>
<th>å¯¹è±¡å</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>javax.servlet.http.HttpServletRequest</td>
<td>request</td>
<td>è¯·æ±‚èŒƒå›´ï¼Œæ•°æ®å­˜å…¥åï¼Œåœ¨åŒä¸€ä¸ªè¯·æ±‚å†…æœ‰æ•ˆ</td>
</tr>
<tr>
<td>javax.servlet.http.HttpSession</td>
<td>session</td>
<td>ä¼šè¯èŒƒå›´ï¼Œæ•°æ®å­˜å…¥åï¼Œåœ¨åŒä¸€ä¸ªä¼šè¯å†…æœ‰æ•ˆ</td>
</tr>
<tr>
<td>javax.servlet.ServletContext</td>
<td>application</td>
<td>åº”ç”¨èŒƒå›´ï¼Œæ•°æ®å­˜å…¥åï¼Œåœ¨åŒä¸€ä¸ªé¡¹ç›®å†…æœ‰æ•ˆ</td>
</tr>
</tbody></table>
<h3 id="2-2-è·å–"><a href="#2-2-è·å–" class="headerlink" title="2.2 è·å–"></a>2.2 è·å–</h3><p>åœ¨servletç¨‹åºä¸­ï¼Œå¦‚ä½•è·å–è¿™ä¸‰ç§å¯¹è±¡</p>
<p>1ã€requestå¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">	<span class="comment">//requestå’Œresponseæ˜¯æ–¹æ³•çš„å‚æ•°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨</span></span><br><span class="line">		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>2ã€sessionå¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">	<span class="comment">//ä½¿ç”¨requestå¯¹è±¡ï¼Œè°ƒç”¨getSessionæ–¹æ³•å³å¯</span></span><br><span class="line">	HttpSession session = request.getSession();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å¦‚æœrequestæœ‰å¯¹åº”çš„session,åˆ™è¿”å›è¿™ä¸ªsession</span></span><br><span class="line">    <span class="comment">//å¦‚æœrequestæ²¡æœ‰å¯¹åº”çš„session,åˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„sessionå¹¶è¿”å›</span></span><br><span class="line">    <span class="comment">//request.getSession()ç­‰ä»·äºè¿™ç§æƒ…å†µ</span></span><br><span class="line">    HttpSession session = request.getSession(<span class="keyword">true</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å¦‚æœrequestæœ‰å¯¹åº”çš„session,åˆ™è¿”å›è¿™ä¸ªsession</span></span><br><span class="line">    <span class="comment">//å¦‚æœrequestæ²¡æœ‰å¯¹åº”çš„session,åˆ™è¿”å›null</span></span><br><span class="line">	HttpSession session = request.getSession(<span class="keyword">false</span>);</span><br><span class="line">		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>3ã€applicationå¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		ServletContext application = request.getServletContext();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//æˆ–è€…ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ï¼Œé»˜è®¤å½“å‰servletç»§æ‰¿äº†HttpServlet</span></span><br><span class="line"><span class="comment">//		request.getSession().getServletContext();</span></span><br><span class="line"><span class="comment">//		super.getServletContext();</span></span><br><span class="line"><span class="comment">//		super.getServletConfig().getServletContext();</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œapplicationå¯¹è±¡æœ‰ä¸”åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥æ— è®ºä»€ä¹ˆæ–¹å¼è·å–åˆ°çš„ï¼Œéƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼ˆå†…å­˜åœ°å€ä¸€æ ·ï¼‰</p>
</blockquote>
<h3 id="2-3-å£°æ˜å‘¨æœŸ"><a href="#2-3-å£°æ˜å‘¨æœŸ" class="headerlink" title="2.3 å£°æ˜å‘¨æœŸ"></a>2.3 å£°æ˜å‘¨æœŸ</h3><p>1ã€requestå¯¹è±¡</p>
<p>å®¢æˆ·ç«¯æ¯æ¬¡å‘è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„requestå¯¹è±¡ï¼Œæœ¬æ¬¡è®¿é—®ç»“æŸåï¼Œè¯¥requestå¯¹è±¡å°±ä¼šè¢«é”€æ¯ï¼Œæ‰€ä»¥æ¯æ¬¡è¯·æ±‚éƒ½æ˜¯ä¸€ä¸ªå…¨æ–°çš„requestå¯¹è±¡ã€‚</p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œå­˜å…¥requestä¸­çš„æ•°æ®ï¼Œåªèƒ½åœ¨ä¸€æ¬¡è¯·æ±‚ä¹‹å†…æœ‰æ•ˆ</p>
</blockquote>
<p>2ã€sessionå¯¹è±¡</p>
<p><code>request.getSession()</code>æ–¹æ³•ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶ï¼Œä¼šåˆ›å»ºsessionå¯¹è±¡ï¼Œ<code>session.invalidate()</code>è°ƒç”¨çš„æ—¶å€™ä¼šé”€æ¯sessionã€‚</p>
<p>sessionå¦‚æœè‡ªåŠ¨è¶…æ—¶çš„è¯ï¼Œä¹Ÿä¼šè¢«é”€æ¯ï¼Œé»˜è®¤è¶…æ—¶æ—¶é—´ä¸º30åˆ†é’Ÿï¼Œå¯ä»¥åœ¨web.xmlä¸­è¿›è¡Œè®¾ç½®ï¼Œå•ä½æ˜¯åˆ†é’Ÿ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">session-config</span>&gt;</span>  </span><br><span class="line">	<span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>30<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œsessionè¶…æ—¶æ—¶é—´æŒ‡çš„æ˜¯ï¼Œå®¢æˆ·ç«¯ä¸ä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’çš„æ—¶é—´</p>
</blockquote>
<blockquote>
<p>ä¸€ä¸ªä¼šè¯ä¸­å¯ä»¥æœ‰å¤šä¸ªrequestè¯·æ±‚ï¼Œæ‰€ä»¥æ”¾åœ¨sessionä¸­çš„æ•°æ®ï¼Œå¯ä»¥è¢«å¤šä¸ªè¯·æ±‚æ‰€å…±äº«</p>
</blockquote>
<p>3ã€applicationå¯¹è±¡</p>
<p>å¯åŠ¨tomcatæœåŠ¡å™¨çš„æ—¶å€™ï¼Œå°±ä¼šè¢«åˆ›å»ºï¼Œå…³é—­tomcatæœåŠ¡å™¨çš„æ—¶å€™ï¼Œå°±ä¼šè¢«é”€æ¯ã€‚</p>
<p>æ¯ä¸ªé¡¹ç›®åœ¨è¿è¡ŒæœŸé—´ï¼Œéƒ½ä¼š<strong>æœ‰ä¸”åªæœ‰ä¸€ä¸ª</strong>applicationå¯¹è±¡ï¼Œä¸è¿™ä¸ªé¡¹ç›®å¯¹åº”ã€‚</p>
<blockquote>
<p>æ•´ä¸ªé¡¹ç›®åœ¨è¿è¡ŒæœŸé—´ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªapplicationå¯¹è±¡ï¼Œæ‰€ä»¥è¿™ä¸ªå¯¹è±¡æ˜¯æ‰€æœ‰ç”¨æˆ·å…±äº«çš„ã€‚å¤§å®¶éƒ½å¯ä»¥å‘è¿™ä¸ªå¯¹è±¡é‡Œé¢å­˜å€¼ï¼Œä¹Ÿå¯ä»¥å†æ‹¿å‡ºæ¥ã€‚</p>
</blockquote>
<h3 id="2-4-å­˜å–æ•°æ®"><a href="#2-4-å­˜å–æ•°æ®" class="headerlink" title="2.4 å­˜å–æ•°æ®"></a>2.4 å­˜å–æ•°æ®</h3><p>ä½¿ç”¨ä¸‰ç§å¯¹è±¡è¿›è¡Œå­˜æ•°æ®ã€å–æ•°æ®çš„æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼š</p>
<p>ä¾‹å¦‚ï¼Œå­˜å€¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">request.setAttribute(<span class="string">&quot;key&quot;</span>, value);</span><br><span class="line">session.setAttribute(<span class="string">&quot;key&quot;</span>, value);</span><br><span class="line">application.setAttribute(<span class="string">&quot;key&quot;</span>, value);</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œå–å€¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">request.getAttribute(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">session.getAttribute(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">application.getAttribute(<span class="string">&quot;key&quot;</span>);</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œè¿˜å¯ä»¥åˆ é™¤æŒ‡å®šçš„æ•°æ®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">request.removeAttribute(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">session.removeAttribute(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">application.removeAttribute(<span class="string">&quot;key&quot;</span>);</span><br></pre></td></tr></table></figure>



<h3 id="2-5-æ€è€ƒ"><a href="#2-5-æ€è€ƒ" class="headerlink" title="2.5 æ€è€ƒ"></a>2.5 æ€è€ƒ</h3><p>1ã€æ¯æ¬¡requestå¯¹è±¡åˆ›å»ºä¹‹åï¼ŒæœåŠ¡å™¨æ€ä¹ˆçŸ¥é“è¿™ä¸ªrequestå’Œå“ªä¸ªsessionå¯¹è±¡ç›¸å¯¹åº”?</p>
<p>2ã€æœåŠ¡å™¨æ­£å¸¸å…³é—­å’Œéæ­£å¸¸å…³é—­å¯¹sessionå¯¹è±¡æ˜¯å¦æœ‰å½±å“ï¼Ÿ</p>
<ul>
<li>æ­£å¸¸å…³é—­å†æ‰“å¼€,sessionè¿˜åœ¨</li>
<li>éæ­£å¸¸å…³é—­å†æ‰“å¼€,sessionä¸åœ¨</li>
</ul>
<h2 id="3-ä¼šè¯è¿½è¸ª"><a href="#3-ä¼šè¯è¿½è¸ª" class="headerlink" title="3 ä¼šè¯è¿½è¸ª"></a>3 ä¼šè¯è¿½è¸ª</h2><h3 id="3-1-æ— çŠ¶æ€è®¿é—®"><a href="#3-1-æ— çŠ¶æ€è®¿é—®" class="headerlink" title="3.1 æ— çŠ¶æ€è®¿é—®"></a>3.1 æ— çŠ¶æ€è®¿é—®</h3><p>httpåè®®çš„è®¿é—®æ˜¯æ— çŠ¶æ€çš„è®¿é—®ï¼Œå½“å‰è®¿é—®æ˜¯ä¸ä¼šçŸ¥é“ä¹‹å‰è®¿é—®çš„çŠ¶æ€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´httpåè®®çš„è®¿é—®æ˜¯ä¸ä¼šå¸®æˆ‘ä»¬ä¿å­˜è®¿é—®çš„è®°å½•/ç—•è¿¹çš„ã€‚</p>
<p>ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™æˆ‘ä»¬éœ€è¦è®°å½•ä¹‹å‰çš„è®¿é—®çŠ¶æ€ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨è´­ç‰©ç½‘ç«™ä¸­ï¼Œç¬¬ä¸€æ¬¡è®¿é—®ç‚¹å‡»è´­ä¹°äº†ä¸€ä¸ªæ‰‹æœºï¼Œç¬¬äºŒæ¬¡è®¿é—®ç‚¹å‡»è´­ä¹°äº†ä¸€ä¸ªç”µè„‘ï¼Œç¬¬ä¸‰æ¬¡è®¿é—®ç‚¹å‡»è´­ç‰©è½¦ç»“ç®—ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¿…é¡»çŸ¥é“å‰ä¸¤æ¬¡è®¿é—®çš„æ—¶å€™è´­ä¹°äº†ä»€ä¹ˆï¼Œè¦ä¸ç„¶å°±æ²¡æœ‰æ–¹æ³•å»ç»“ç®—ã€‚</p>
<blockquote>
<p>ä¼šè¯è¿½è¸ªæŠ€æœ¯ï¼Œå°±å¯ä»¥ç”¨æ¥è§£å†³è¿™ç§ç±»ä¼¼çš„é—®é¢˜</p>
</blockquote>
<h3 id="3-2-cookie"><a href="#3-2-cookie" class="headerlink" title="3.2 cookie"></a>3.2 cookie</h3><p>cookieæ˜¯å¸¸ç”¨åˆ°çš„ä¸€ç§ä¼šè¯è¿½è¸ªæŠ€æœ¯ï¼Œcookieæ˜¯æµè§ˆå™¨ä¸­ç”¨æ¥å­˜å‚¨ä¿¡æ¯çš„ä¸€ç§æœ¬åœ°æ–‡ä»¶ï¼Œæµè§ˆå™¨å†å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥æ ¹æ®æœåŠ¡å™¨çš„åœ°å€ï¼Œå°†å¯¹åº”çš„cookieä¸­çš„ä¿¡æ¯ï¼Œæºå¸¦åˆ°è¯·æ±‚å¤´ä¸­ï¼Œä¸€èµ·å‘é€ç»™æœåŠ¡å™¨ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼Œsessionæ˜¯ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯çš„å¯¹è±¡ï¼Œè€Œcookieæ˜¯ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰çš„ä¸€ç§æœ¬åœ°æ–‡ä»¶</p>
</blockquote>
<p>ä¸åŒçš„æµè§ˆå™¨ï¼ŒæŸ¥çœ‹cookieçš„æ–¹å¼ä¸åŒï¼Œä½†æ˜¯åŸºæœ¬éƒ½åœ¨å†…ç½®çš„â€œéšç§ä¸å®‰å…¨â€é€‰é¡¹ä¸­ï¼š</p>
<p>ä¾‹å¦‚ï¼Œç«ç‹æµè§ˆå™¨</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132224108.png" alt="image-20201004195948843"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132224861.png" alt="image-20201004200024202"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132224036.png" alt="image-20201004200055613"></p>
<p><strong>ä¹Ÿå¯ä»¥åœ¨ç«ç‹ä¸­å®‰è£…æ’ä»¶ï¼Œæ›´åŠ æ–¹ä¾¿æŸ¥çœ‹cookieï¼š</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132224092.png" alt="image-20201004200153391"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132224700.png" alt="image-20201004200222127"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132224076.png" alt="image-20201004200246170"></p>
<p>ä¾‹å¦‚ï¼Œä½¿ç”¨chromeæµè§ˆå™¨</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132224759.png" alt="image-20201004200721510"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132224941.png" alt="image-20201004200747122"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132225236.png" alt="image-20201004200802686"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132225425.png" alt="image-20201004202955925"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132225719.png" alt="image-20201004203015415"></p>
<h4 id="3-2-1-cookieå’Œsession"><a href="#3-2-1-cookieå’Œsession" class="headerlink" title="3.2.1 cookieå’Œsession"></a>3.2.1 cookieå’Œsession</h4><p>å¦‚æœåœ¨ä¸€æ¬¡è¯·æ±‚çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ç«¯äº§ç”Ÿäº†sessionï¼Œé‚£ä¹ˆè¿™ä¸ªsessionçš„idå€¼ï¼Œä¼šå†™å…¥åˆ°å“åº”ï¼ˆresponseï¼‰ä¸­ï¼Œç„¶åç”±å“åº”å°†sessionçš„idå€¼ï¼Œå¸¦å›åˆ°æµè§ˆå™¨ä¸­ï¼Œæµè§ˆå™¨æ”¶åˆ°åï¼Œå†æŠŠè¿™ä¸ªidå€¼å†™å…¥åˆ°æœ¬åœ°çš„cookieçš„æ–‡ä»¶ä¸­ã€‚</p>
<p>å¹¶ä¸”è¿™ä¸ªsessionçš„idå€¼ï¼Œåœ¨æµè§ˆå™¨çš„cookieçš„æ–‡ä»¶ä¸­ï¼Œæœ‰ä¸€ä¸ªé»˜è®¤çš„åå­—ï¼šJSESSIONID</p>
<p>ä¹‹åï¼Œæµè§ˆå™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä¼šæŠŠä¹‹å‰ä¿å­˜åœ¨cookieæ–‡ä»¶ä¸­çš„JSESSIONIDçš„å€¼ï¼Œä¼ ç»™æœåŠ¡å™¨ã€‚</p>
<p>æœåŠ¡å™¨é€šè¿‡è¿™ä¸ªJESSIONIDçš„å€¼ï¼Œå°±èƒ½å¤ŸçŸ¥é“æœåŠ¡å™¨å†…å­˜ä¸­æ˜¯å“ªä¸€ä¸ªsessionå¯¹è±¡ï¼Œå’Œå½“å‰è¿™ä¸ªå®¢æˆ·ç«¯å¯¹åº”ã€‚</p>
<blockquote>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œå°±èƒ½åˆ°è¾¾ä¸€ä¸ªæ•ˆæœï¼Œå®¢æˆ·ç«¯çš„æ¯ä¸€æ¬¡è®¿é—®ï¼Œåœ¨æœåŠ¡å™¨ç«¯éƒ½èƒ½å¤Ÿæ‹¿åˆ°ç›¸åŒçš„ä¸€ä¸ªsessionå¯¹è±¡ï¼Œä»è€Œå®ç°ä¸åŒè¯·æ±‚ä¹‹é—´é€šè¿‡ç›¸åŒçš„sessionå¯¹è±¡è¿›è¡Œæ•°æ®çš„å…±äº«</p>
</blockquote>
<h4 id="3-3-2-æœåŠ¡å™¨å†™å›cookie"><a href="#3-3-2-æœåŠ¡å™¨å†™å›cookie" class="headerlink" title="3.3.2 æœåŠ¡å™¨å†™å›cookie"></a>3.3.2 æœåŠ¡å™¨å†™å›cookie</h4><p>ä½¿ç”¨responseå¯¹è±¡ï¼Œå¯ä»¥æŠŠcookieå¸¦å›åˆ°æµè§ˆå™¨ï¼Œç„¶åæµè§ˆå™¨æŠŠcookieå¯¹è±¡ä¸­çš„å†…å®¹ä¿å­˜åˆ°å¯¹åº”çš„ä¸€ä¸ªcookieçš„æ–‡ä»¶ä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºcookieå¯¹è±¡</span></span><br><span class="line">Cookie c1 = <span class="keyword">new</span> Cookie(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">Cookie c2 = <span class="keyword">new</span> Cookie(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"><span class="comment">//è®¾ç½®cookieçš„æœ‰æ•ˆæ—¶é—´</span></span><br><span class="line">c1.setMaxAge(<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">365</span>);</span><br><span class="line">c2.setMaxAge(<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">365</span>*<span class="number">10</span>);</span><br><span class="line"><span class="comment">//æŠŠcookieæ”¾åˆ°responseé‡Œé¢</span></span><br><span class="line">response.addCookie(c1);</span><br><span class="line">response.addCookie(c2);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®cookieç”Ÿæ•ˆçš„æ—¶é—´ï¼Œé‚£ä¹ˆè¿™ä¸ªcookieå°±æ˜¯ä¼šè¯cookieï¼Œä¹Ÿå°±æ˜¯å½“å…³é—­æµè§ˆå™¨çš„æ—¶å€™cookieå°±æ˜¯å¤±æ•ˆäº†ã€‚</p>
</blockquote>
<h4 id="3-2-3-æœåŠ¡å™¨è¯»å–cookie"><a href="#3-2-3-æœåŠ¡å™¨è¯»å–cookie" class="headerlink" title="3.2.3 æœåŠ¡å™¨è¯»å–cookie"></a>3.2.3 æœåŠ¡å™¨è¯»å–cookie</h4><p>servletä¸­ï¼Œå¯ä»¥ä½¿ç”¨requestå¯¹è±¡æ‹¿åˆ°ä»æµè§ˆå™¨å‘é€è¿‡æ¥çš„cookieæ•°æ®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä»requestä¸­æ‹¿åˆ°ä¸€ä¸ªcookieæ•°ç»„</span></span><br><span class="line"><span class="comment">//å¦‚æœæ²¡ä»»ä½•cookieæ•°æ®åˆ™è¿”å›null</span></span><br><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line"><span class="comment">//éå†æ•°ç»„ æ‹¿å‡ºkeyå’Œvalue</span></span><br><span class="line"><span class="keyword">for</span>(Cookie c:cookies)&#123;</span><br><span class="line">    String key = c.getName();</span><br><span class="line">    String value = c.getValue();</span><br><span class="line">    System.out.println(key+<span class="string">&quot; : &quot;</span>+value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>==æ€è€ƒï¼Œæµè§ˆå™¨å‘Aç½‘ç«™å‘é€è¯·æ±‚ï¼Œé‚£ä¹ˆä¼šä¸ä¼šæŠŠBç½‘ç«™çš„cookieæºå¸¦è¿‡å»(è·¨åŸŸ)ï¼Ÿ==</p>
<h3 id="3-3-URLé‡å†™"><a href="#3-3-URLé‡å†™" class="headerlink" title="3.3 URLé‡å†™"></a>3.3 URLé‡å†™</h3><blockquote>
<p>ä¼šè¯è¿½è¸ªï¼Œé™¤äº†ä½¿ç”¨cookieæŠ€æœ¯æ¥å®ç°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ–¹å¼æ¥å®ç°ï¼šURLé‡å†™</p>
</blockquote>
<h4 id="3-3-1-æ¦‚è¿°"><a href="#3-3-1-æ¦‚è¿°" class="headerlink" title="3.3.1 æ¦‚è¿°"></a>3.3.1 æ¦‚è¿°</h4><p>å½“ç”¨æˆ·æŠŠæµè§ˆå™¨çš„cookieåŠŸèƒ½ç¦ç”¨ä¹‹åï¼Œæµè§ˆå™¨åœ¨å‘è¯·æ±‚çš„æ—¶å€™ï¼Œå“åº”ï¼ˆresponseï¼‰æŠŠcookieå¸¦å›æ¥ï¼Œä½†æ˜¯æµè§ˆå™¨æ— æ³•æ¥æ”¶ï¼Œè¿™å…¶ä¸­å°±åŒ…æ‹¬æœ€é‡è¦çš„JSESSIONIDã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132225127.png" alt="image-20201004213359668"></p>
<blockquote>
<p>è¿™æ—¶å€™ï¼Œæµè§ˆå™¨æ— æ³•æ¥æ”¶å“åº”æºå¸¦å›æ¥çš„cookieå€¼ï¼Œè¯·æ±‚ä¸­ä¹Ÿä¸ä¼šæºå¸¦cookieã€‚</p>
</blockquote>
<h4 id="3-3-2-ä½¿ç”¨"><a href="#3-3-2-ä½¿ç”¨" class="headerlink" title="3.3.2 ä½¿ç”¨"></a>3.3.2 ä½¿ç”¨</h4><p>æµè§ˆå™¨cookieè¢«ç¦ç”¨åï¼Œå¯ä»¥URLé‡å†™æŠ€æœ¯ï¼Œä¹Ÿå¯ä»¥åˆ°è¾¾ä¼šè¯è¿½è¸ªçš„æ•ˆæœã€‚</p>
<p>å°†éœ€è¦è¿›è¡Œä¼šè¯è¿½è¸ªçš„é“¾æ¥ï¼Œä½¿ç”¨æŒ‡å®šæ–¹æ³•è¿›è¡Œå¤„ç†åï¼Œå¾—åˆ°æ–°çš„é“¾æ¥åœ°å€ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String url = response.encodeURL(<span class="string">&quot;url&quot;</span>);  <span class="comment">// lookUserCookie?jesssionId</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œé‡å†™åçš„urlå’ŒåŸæ¥çš„urlæ¯”è¾ƒï¼Œå…¶å®å°±æ˜¯åœ¨urlåé¢æ‹¼æ¥ä¸Šäº†JSESSIONIDçš„å€¼ï¼Œä»¥ä¾¿ç‚¹å‡»é“¾æ¥çš„æ—¶å€™å¯ä»¥æŠŠJSESSIONIDçš„å€¼ä¹Ÿä¼ è¿‡æ¥ï¼Œä»è€Œè¾¾åˆ°ä¼šè¯è¿½è¸ªçš„æ•ˆæœ</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/url&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">URLServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		request.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">		response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		request.getSession().setAttribute(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;tom&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = response.getWriter();</span><br><span class="line">		</span><br><span class="line">		String url = request.getContextPath()+<span class="string">&quot;/sayHello&quot;</span>;</span><br><span class="line">		<span class="comment">//è¿™é‡Œå°±æ˜¯å¯¹å½“å‰è¿™ä¸ªurlè¿›è¡Œçš„é‡å†™çš„æ“ä½œ</span></span><br><span class="line">        <span class="comment">//åŸæ¥çš„urlä¸ºï¼š/servlet-test/sayHello</span></span><br><span class="line">        <span class="comment">//é‡å†™åurlä¸ºï¼š/servlet-test/sayHello;jsessionid=587325D14741A0DB1688E98D8D30AE59</span></span><br><span class="line">        <span class="comment">//url = response.encodeURL(url);  æ­¤æ—¶éœ€è¦ç¦ç”¨cookie</span></span><br><span class="line">		</span><br><span class="line">		out.println(<span class="string">&quot;&lt;html&gt;&quot;</span>);</span><br><span class="line">		out.println(<span class="string">&quot;&lt;head&gt;&quot;</span>);</span><br><span class="line">		out.println(<span class="string">&quot;&lt;/head&gt;&quot;</span>);</span><br><span class="line">		out.println(<span class="string">&quot;&lt;body&gt;&quot;</span>);</span><br><span class="line">		out.write(<span class="string">&quot;&lt;a href = &quot;</span>+url+<span class="string">&quot;&gt;ç‚¹å‡»&lt;/a&gt;&quot;</span>);</span><br><span class="line">      </span><br><span class="line">		out.println(<span class="string">&quot;&lt;/body&gt;&quot;</span>);</span><br><span class="line">		out.println(<span class="string">&quot;&lt;/html&gt;&quot;</span>);</span><br><span class="line">			</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/sayHello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SayHelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String name = (String)request.getSession().getAttribute(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">&quot;hello!&quot;</span>+name);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>æ³¨æ„äº‹é¡¹ï¼Œ</p>
<p>1ã€æµ‹è¯•å‰å…ˆç¡®ä¿æµè§ˆå™¨çš„cookieåŠŸèƒ½å·²ç»è¢«ç¦ç”¨</p>
<p>2ã€<code>response.encodeURL(url);</code>æ ¸å¿ƒä»£ç åˆ†åˆ«æ³¨é‡Šæ‰å’Œä»£å¼€ï¼Œæ¥è§‚å¯Ÿæµ‹è¯•ç»“æœ</p>
<blockquote>
<p>æ³¨æ„ï¼Œæ— è®ºæ˜¯cookieè¿˜æ˜¯URLé‡å†™ï¼Œå…¶æ ¸å¿ƒéƒ½æ˜¯å°†sessionIDä¿å­˜åˆ°å®¢æˆ·ç«¯ï¼Œç„¶åå‘è¯·æ±‚çš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸ªidå€¼ä¼ ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é€šè¿‡è¿™ä¸ªidå€¼ï¼Œæ‰¾åˆ°æœåŠ¡å™¨å†…å­˜ä¸­å“ªä¸€ä¸ªsessionå¯¹è±¡å’Œå½“å‰è¯·æ±‚ç›¸å¯¹åº”ã€‚</p>
</blockquote>
<h2 id="cookieå’Œsessonçš„æ€è€ƒ"><a href="#cookieå’Œsessonçš„æ€è€ƒ" class="headerlink" title="cookieå’Œsessonçš„æ€è€ƒ"></a>cookieå’Œsessonçš„æ€è€ƒ</h2><p><code>cookieçš„å®‰å…¨é—®é¢˜</code></p>
<p>é—®: å¦‚æœç™»å½•äº†ç½‘ç«™A,å†ç™»å½•ç½‘ç«™B,Bä¼šè·å–åˆ°Açš„cookieä¿¡æ¯å—?</p>
<ul>
<li>ç”±äºåŒæºç­–ç•¥,Bæ— æ³•è·å–</li>
</ul>
<p>ä½†æ˜¯</p>
<ul>
<li>XSSï¼Œè·¨ç«™è„šæœ¬æ”»å‡»ã€‚æ”»å‡»è€…è·å¾—é¡µé¢çš„jsæƒé™ï¼Œèƒ½æ“ä½œé¡µé¢çš„ä¸€åˆ‡ï¼ŒåŒ…æ‹¬Session Storageå’Œæœªè®¾ç½®HTTP Onlyå±æ€§çš„Cookie</li>
<li>CSRFï¼Œè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œå°±æ˜¯é’“é±¼ç½‘ç«™</li>
</ul>
<h1 id="servletï¼ˆå››ï¼‰"><a href="#servletï¼ˆå››ï¼‰" class="headerlink" title="servletï¼ˆå››ï¼‰"></a>servletï¼ˆå››ï¼‰</h1><h2 id="1-filter"><a href="#1-filter" class="headerlink" title="==1 filter=="></a>==1 filter==</h2><h3 id="1-1-æ¦‚è¿°-2"><a href="#1-1-æ¦‚è¿°-2" class="headerlink" title="1.1 æ¦‚è¿°"></a>1.1 æ¦‚è¿°</h3><p>åœ¨ä¸€ä¸ªè¯·æ±‚å»è®¿é—®æŸä¸ªèµ„æºçš„æ—¶å€™ï¼Œfilterï¼ˆè¿‡æ»¤å™¨ï¼‰å¯ä»¥åœ¨è¿™ä¸ªè¯·æ±‚ï¼Œè®¿é—®åˆ°è¿™ä¸ªèµ„æºä¹‹å‰ï¼ŒæŠŠè¯·æ±‚æ‹¦ä¸‹ï¼Œç„¶ååšå‡ºä¸€ç³»åˆ—çš„å¤„ç†ï¼Œä¾‹å¦‚ç¼–ç è½¬æ¢ã€ä¿¡æ¯è¿‡æ»¤ã€ç™»å½•éªŒè¯ã€æƒé™åˆ¤æ–­ç­‰ç­‰ï¼Œæœ€åfilterå†å†³å®šï¼Œæ˜¯å¦è¦è®©è¿™ä¸ªè¯·æ±‚å»è®¿é—®é‚£ä¸ªç›®æ ‡èµ„æºã€‚</p>
<h3 id="1-2-ç¼–å†™"><a href="#1-2-ç¼–å†™" class="headerlink" title="1.2 ç¼–å†™"></a>1.2 ç¼–å†™</h3><p><code>javax.Servlet.Filter</code>æ˜¯ServletæŠ€æœ¯ä¸­ï¼Œæä¾›çš„ä¸€ä¸ªæ¥å£ï¼Œå®ç°è¯¥æ¥å£çš„ç±»ï¼Œå¹¶ä¸”å®Œæˆå¯¹åº”çš„é…ç½®ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±æ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿‡æ»¤å™¨å¯¹è±¡åˆå§‹åŒ–æ—¶è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å½“è¿‡æ»¤å™¨æ‹¦æˆªåˆ°è¯·æ±‚çš„æ—¶å€™,ä¼šè°ƒç”¨è¿™ä¸ªdoFilteræ–¹æ³•è¿›è¡Œå¤„ç†</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response,</span></span></span><br><span class="line"><span class="params"><span class="function">            FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿‡æ»¤å™¨å¯¹è±¡é”€æ¯æ—¶è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><code>doFilter</code>æ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œå‰ä¸¤ä¸ªåˆ†åˆ«æ˜¯è¯·æ±‚å’Œå“åº”å¯¹è±¡ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªå‚æ•°</p>
<p><code>javax.servlet.FilterChain</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FilterChain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   	<span class="comment">//FilterChainæ˜¯ä¸€ä¸ªæ¥å£,è¡¨ç¤ºè¿‡æ»¤å™¨é“¾,è¿™ä¸ªæ¥å£ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•doFilter</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> IOException, ServletException</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>åŒä¸€ä¸ªè¯·æ±‚æœ‰å¯èƒ½è¦ä¾æ¬¡çš„é€šè¿‡ä¸¤ä¸ªæˆ–è€…å¤šä¸ªè¿‡æ»¤å™¨ï¼Œåœ¨servletä¸­ï¼ŒæŠŠè¿™æ ·å¤šä¸ªè¿‡æ»¤å™¨çœ‹åšä¸€ä¸ªè¿‡æ»¤å™¨é“¾ï¼Œè¿™ä¸ªè¿‡æ»¤å™¨é“¾å°±ç”¨<code>FilterChain</code>æ¥å£ç±»å‹æ¥è¡¨ç¤ºã€‚</p>
<p><code>chain.doFilter(req,res)</code>ï¼Œè¡¨ç¤ºæŠŠå½“å‰çš„reqå’Œresä¼ ç»™è¿™ä¸ªè¿‡æ»¤å™¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨å¯¹è±¡ï¼Œç„¶åå¯¹è¯¥è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œå¦‚æœè¯´é“¾ä¸­å·²ç»æ²¡æœ‰ä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨äº†ï¼Œé‚£ä¹ˆå°±æŠŠè¿™æ¬¡è®¿é—®æ”¾è¡Œï¼Œå»è®¿é—®å®ƒçœŸæ­£è¦è®¿é—®çš„ç›®æ ‡èµ„æºã€‚</p>
<p>ä¾‹å¦‚ï¼Œç¼–å†™ä¸€ä¸ªç¼–ç è¿‡æ»¤å™¨ï¼Œè®¾ç½®è¯·æ±‚å’Œå“åº”çš„ç¼–ç ä¸ºUTF-8</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EncodingFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		<span class="comment">//è¿‡æ»¤å™¨åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨è¯¥æ–¹æ³•</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//è®¾ç½®ç¼–ç </span></span><br><span class="line">		request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		response.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//å°†è¯·æ±‚æ”¾è¡Œ</span></span><br><span class="line">		chain.doFilter(request, response);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//è¿‡æ»¤å™¨é”€æ¯æ—¶å€™è°ƒç”¨è¯¥æ–¹æ³•</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œå½“è¯·æ±‚ä¸­æ²¡æœ‰æŒ‡å®šå‚æ•°çš„æ—¶å€™ï¼Œå°±ä¸è®©å…¶è®¿é—®ç›®æ ‡èµ„æºï¼Œå¹¶ä¸”è¿”å›æç¤ºé¡µé¢</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String username = request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(username == <span class="keyword">null</span>) &#123;</span><br><span class="line">			response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">			PrintWriter out = response.getWriter();</span><br><span class="line">			</span><br><span class="line">			out.println(<span class="string">&quot;&lt;html&gt;&quot;</span>);</span><br><span class="line">			out.println(<span class="string">&quot;&lt;body&gt;&quot;</span>);</span><br><span class="line">			out.println(<span class="string">&quot;&lt;h1&gt;è¯·åœ¨è¯·æ±‚ä¸­æºå¸¦usernameå‚æ•°&lt;/h1&gt;&quot;</span>);</span><br><span class="line">			out.println(<span class="string">&quot;&lt;/body&gt;&quot;</span>);</span><br><span class="line">			out.println(<span class="string">&quot;&lt;/html&gt;&quot;</span>);</span><br><span class="line">			</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">//å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œé‚£ä¹ˆå°±æ”¾è¡Œ</span></span><br><span class="line">			chain.doFilter(request, response);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="1-3-é…ç½®"><a href="#1-3-é…ç½®" class="headerlink" title="1.3  é…ç½®"></a>1.3  é…ç½®</h3><p>å’Œservletç¨‹åºä¸€æ ·ï¼Œfilterè¿‡æ»¤å™¨ç¼–å†™å®Œæˆåï¼Œå¹¶ä¸èƒ½ç«‹åˆ»å·¥ä½œï¼Œè¿˜éœ€è¦è¿›è¡Œé…ç½®ï¼ŒæŒ‡å®šè¿™ä¸ªè¿‡æ»¤å™¨ä¼šå¯¹å“ªäº›è·¯å¾„çš„è®¿é—®ç”Ÿæ•ˆã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨web.xmlä¸­é…ç½®ç¼–ç è¿‡æ»¤çš„filterå¯¹æ‰€æœ‰è·¯å¾„éƒ½ç”Ÿæ•ˆ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.briup.filter.EncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>å…¶ä¸­<code>&lt;url-pattern&gt;&lt;/url-pattern&gt;</code>æœ‰å››ç§é…ç½®æ–¹å¼</p>
<ul>
<li><p>ç²¾ç¡®åŒ¹é…</p>
<p>ä¾‹å¦‚ï¼Œ<code>&lt;url-pattern&gt;/test_servlet&lt;/url-pattern&gt;</code></p>
<p>è¡¨ç¤ºæ­¤æ‹¦æˆªå™¨åªä¼šæ‹¦æˆª/test_servletè¿™ä¸€ä¸ªè·¯å¾„</p>
</li>
<li><p>æ‰©å±•ååŒ¹é…</p>
<p>ä¾‹å¦‚ï¼Œ<code>&lt;url-pattern&gt;*.html&lt;/url-pattern&gt;</code></p>
<p>è¡¨ç¤ºæ­¤æ‹¦æˆªå™¨åªä¼šæ‹¦æˆªåç¼€åæ˜¯.htmlçš„è·¯å¾„</p>
</li>
<li><p>è·¯å¾„åŒ¹é…</p>
<p>ä¾‹å¦‚ï¼Œ<code>&lt;url-pattern&gt;/test/*&lt;/url-pattern&gt;</code></p>
<p>è¡¨ç¤ºæ­¤æ‹¦æˆªå™¨æ‹¦æˆª/testè·¯å¾„ä¸‹çš„æ‰€æœ‰èµ„æº</p>
</li>
<li><p>åŒ¹é…ä»»æ„è·¯å¾„</p>
<p>ä¾‹å¦‚ï¼Œ<code>&lt;url-pattern&gt;/*&lt;/url-pattern&gt;</code></p>
<p>è¡¨ç¤ºæ­¤æ‹¦æˆªå™¨æ‹¦æˆªé¡¹ç›®ä¸‹æ‰€æœ‰èµ„æº</p>
</li>
</ul>
<h3 id="1-4-é¡ºåº"><a href="#1-4-é¡ºåº" class="headerlink" title="1.4 é¡ºåº"></a>1.4 é¡ºåº</h3><p>å¦‚æœæœ‰å¤šä¸ªè¿‡æ»¤å™¨ï¼Œå¹¶ä¸”å¤šä¸ªè¿‡æ»¤å™¨æ‹¦æˆªçš„è·¯å¾„æœ‰ç›¸åŒçš„éƒ¨åˆ†ï¼Œå°±æœ‰ä¸€äº›è·¯å¾„è¢«    è¿™å¤šä¸ªè¿‡æ»¤å™¨å…±åŒæ‹¦æˆªï¼Œé‚£ä¹ˆè¿‡æ»¤å™¨çš„é¡ºåºæ˜¯æŒ‰ç…§web.xmlä¸­é…ç½®çš„é¡ºåºä»ä¸Šåˆ°ä¸‹æ‰§è¡Œçš„</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.briup.filter.EncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span><span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>checkFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.briup.filter.CheckFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>checkFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/test<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å½“è¯·æ±‚æ–¹æ³•/testçš„æ—¶å€™ï¼ŒencodingFilterä¼šå…ˆæ‹¦æˆªï¼Œç„¶åæ˜¯checkFilterå†æ‹¦æˆª</p>
</blockquote>
<h3 id="1-5-å…¶ä»–"><a href="#1-5-å…¶ä»–" class="headerlink" title="1.5 å…¶ä»–"></a>1.5 å…¶ä»–</h3><h4 id="1-5-1-ç”Ÿå‘½å‘¨æœŸ"><a href="#1-5-1-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="1.5.1 ç”Ÿå‘½å‘¨æœŸ"></a>1.5.1 ç”Ÿå‘½å‘¨æœŸ</h4><p>å½“å‰æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™ï¼ŒFilterä¼šè¢«åˆ›å»ºå¹¶è°ƒç”¨initæ–¹æ³•åˆå§‹åŒ–ï¼ŒæœåŠ¡å™¨å…³é—­çš„æ—¶å€™ä¼šè¢«é”€æ¯å¹¶è°ƒç”¨destoryæ–¹æ³•ã€‚</p>
<p>é‡å†™initå’Œdestoryæ–¹æ³•ï¼Œå¯åŠ¨æœåŠ¡å™¨ã€è®¿é—®èµ„æºè¢«æ‹¦æˆªã€å†å…³é—­æœåŠ¡å™¨ï¼Œå³å¯çœ‹åˆ°ç”Ÿå‘½å‘¨æœŸä¸­çš„åˆ›å»ºã€åˆå§‹åŒ–ã€è®¿é—®ã€é”€æ¯çš„è¿‡ç¨‹</p>
<h4 id="1-5-2-åˆå§‹åŒ–"><a href="#1-5-2-åˆå§‹åŒ–" class="headerlink" title="1.5.2 åˆå§‹åŒ–"></a>1.5.2 åˆå§‹åŒ–</h4><p>å’Œservletä¸€æ ·ï¼Œfilteråˆå§‹åŒ–çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥å‚æ•°</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.briup.filter.EncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">	    	<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">	    	<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EncodingFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String encoding;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		<span class="comment">//è¿‡æ»¤å™¨åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨è¯¥æ–¹æ³•</span></span><br><span class="line">		encoding = filterConfig.getInitParameter(<span class="string">&quot;encoding&quot;</span>);</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//é»˜è®¤å€¼æ˜¯UTF-8</span></span><br><span class="line">		<span class="keyword">if</span>(encoding==<span class="keyword">null</span>) &#123;</span><br><span class="line">			encoding = <span class="string">&quot;UTF-8&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span><span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        </span><br><span class="line">		HttpServletRequest req = (HttpServletRequest) request;</span><br><span class="line">		System.out.println(<span class="string">&quot;encodingFilter : &quot;</span>+req.getRequestURI());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//è®¾ç½®ç¼–ç </span></span><br><span class="line">		request.setCharacterEncoding(encoding);</span><br><span class="line">		response.setCharacterEncoding(encoding);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//å°†è¯·æ±‚æ”¾è¡Œ</span></span><br><span class="line">		chain.doFilter(request, response);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//è¿‡æ»¤å™¨é”€æ¯æ—¶å€™è°ƒç”¨è¯¥æ–¹æ³•</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="1-5-3-æ‹¦æˆªç±»å‹"><a href="#1-5-3-æ‹¦æˆªç±»å‹" class="headerlink" title="1.5.3 æ‹¦æˆªç±»å‹"></a>1.5.3 æ‹¦æˆªç±»å‹</h4><p>åœ¨web.xmlä¸­è¿›è¡Œé…ç½®çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥é…ç½®æ‹¦æˆªå™¨æ‹¦æˆªçš„è¯·æ±‚ç±»å‹ï¼Œé»˜è®¤æ˜¯REQUESTï¼Œä¹Ÿå°±æ˜¯åªè¦æ˜¯æµè§ˆå™¨å‘é€çš„è¯·æ±‚ï¼Œä¸”æ»¡è¶³è·¯å¾„è¦æ±‚ï¼Œå°±ä¼šè¢«æ‹¦æˆªå™¨æ‹¦æˆªã€‚</p>
<p>ä¾‹å¦‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å†…éƒ¨è·³è½¬çš„è¯·æ±‚ï¼Œå°±æ— æ³•è¢«æ‹¦æˆªï¼Œé™¤éè¿›è¡Œé…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>checkFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.briup.filter.CheckFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>checkFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/test<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>FORWARD<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>REQUEST<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é‡Œé»˜è®¤çš„é…ç½®æ˜¯REQUESTç±»å‹çš„è¯·æ±‚æ‹¦æˆªï¼Œä¹Ÿå°±æ˜¯æµè§ˆå™¨ç›´æ¥å‘é€è¯·æ±‚</p>
</blockquote>
<blockquote>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–çš„æ‹¦æˆªç±»å‹ï¼Œäº†è§£çŸ¥é“å³å¯ã€‚é‡ç‚¹å…³æ³¨çš„æ—¶å€™REQUESTå’ŒFORWARDä¿©ç§</p>
</blockquote>
<blockquote>
<p>é…ç½®ååœ¨æ‹¦æˆªå™¨ä¸­æµ‹è¯•,çœ‹æ˜¯å¦æ‹¦æˆªåˆ°è·¯å¾„ æ­¤å¤„åº”è¯¥åªæ‹¦æˆªè½¬å‘è·¯å¾„,è¯·æ±‚è·¯å¾„ä¸ä¼šæ‹¦æˆª</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">System.out.println(<span class="string">&quot;éªŒè¯è¿‡æ»¤å™¨æ‰§è¡Œ: &quot;</span>);</span><br><span class="line">HttpServletRequest req = (HttpServletRequest) request;</span><br><span class="line">System.out.println(req.getRequestURI());</span><br></pre></td></tr></table></figure>



<h3 id="1-6-æ³¨è§£"><a href="#1-6-æ³¨è§£" class="headerlink" title="1.6 æ³¨è§£"></a>1.6 æ³¨è§£</h3><p>åŒæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£æ¥å®Œæˆè¿‡æ»¤å™¨çš„é…ç½®å·¥ä½œã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.DispatcherType;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebInitParam;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebFilter(value = &quot;/*&quot;,initParams = &#123;@WebInitParam(name = &quot;encoding&quot;,value = &quot;UTF-8&quot;)&#125;,dispatcherTypes = &#123;DispatcherType.REQUEST&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EncodingFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String encoding;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		<span class="comment">//è¿‡æ»¤å™¨åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨è¯¥æ–¹æ³•</span></span><br><span class="line">		encoding = filterConfig.getInitParameter(<span class="string">&quot;encoding&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;encoding = &quot;</span>+encoding);</span><br><span class="line">		<span class="keyword">if</span>(encoding==<span class="keyword">null</span>) &#123;</span><br><span class="line">			encoding = <span class="string">&quot;UTF-8&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">		HttpServletRequest req = (HttpServletRequest) request;</span><br><span class="line">		System.out.println(<span class="string">&quot;encodingFilter:&quot;</span>+req.getRequestURI());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//è®¾ç½®ç¼–ç </span></span><br><span class="line">		request.setCharacterEncoding(encoding);</span><br><span class="line">		response.setCharacterEncoding(encoding);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//å°†è¯·æ±‚æ”¾è¡Œ</span></span><br><span class="line">		chain.doFilter(request, response);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//è¿‡æ»¤å™¨é”€æ¯æ—¶å€™è°ƒç”¨è¯¥æ–¹æ³•</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨æ³¨è§£<code>@WebFilter</code>çš„å½¢å¼æ¥é…ç½®çš„è¿‡æ»¤çš„è¯ï¼Œé‚£ä¹ˆå¤šä¸ªè¿‡æ»¤å™¨æ‹¦æˆªåŒä¸€ä¸ªè·¯å¾„ï¼Œè¿‡æ»¤å™¨çš„æ‰§è¡Œé¡ºåºæ˜¯<strong>è¿‡æ»¤å™¨ç±»åçš„é¦–å­—æ¯</strong>çš„é¡ºåºæ¥æ‰§è¡Œçš„</p>
<h2 id="2-listener"><a href="#2-listener" class="headerlink" title="2 listener"></a>2 listener</h2><h3 id="2-1-æ¦‚è¿°-2"><a href="#2-1-æ¦‚è¿°-2" class="headerlink" title="2.1 æ¦‚è¿°"></a>2.1 æ¦‚è¿°</h3><p>ç›‘å¬å™¨ï¼ˆlistenerï¼‰ç”¨äºç›‘å¬webç¨‹åºä¸­çš„äº‹ä»¶ï¼Œç›‘å¬å™¨ä¸»è¦ç”¨äºå¯¹ Sessionã€requestã€applicationè¿›è¡Œç›‘æ§ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤Sessionã€requestã€applicationç­‰ï¼Œå¹¶è§¦å‘å“åº”çš„äº‹ä»¶ã€‚</p>
<h3 id="2-2-åˆ†ç±»"><a href="#2-2-åˆ†ç±»" class="headerlink" title="2.2 åˆ†ç±»"></a>2.2 åˆ†ç±»</h3><p>ä¸åŒåŠŸèƒ½çš„ç›‘å¬å™¨ï¼Œéœ€è¦å®ç°ä¸åŒçš„æ¥å£ï¼Œå¯ä»¥å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ç§ç›‘å¬å™¨ç±»å‹ï¼š</p>
<p>1ã€ç›‘å¬ requestã€Sessionã€application çš„åˆ›å»ºå’Œé”€æ¯ï¼Œè¿™äº›æ¥å£åˆ†åˆ«ä¸º</p>
<ul>
<li>ServletRequestListener</li>
<li>HttpSessionListener</li>
<li>ServletContextListener</li>
</ul>
<p>2ã€ç›‘å¬requestã€sessionã€applicationä¸‰ä¸ªå¯¹è±¡ä¸­å±æ€§å˜åŒ–ï¼Œè¿™äº›æ¥å£åˆ†åˆ«ä¸º</p>
<ul>
<li>ServletRequestAttributeListener</li>
<li>HttpSessionAttributeListener</li>
<li>ServletContextAttributeListener</li>
</ul>
<p>3ã€ç›‘å¬Sessionå¯¹è±¡é‡Œé¢å­˜æ”¾ç€çš„å…¶ä»–å¯¹è±¡ï¼Œè¿™äº›æ¥å£åˆ†åˆ«ä¸º</p>
<ul>
<li>HttpSessionBindingListener    </li>
<li>HttpSessionActivationListener</li>
</ul>
<h3 id="2-3-ä½¿ç”¨"><a href="#2-3-ä½¿ç”¨" class="headerlink" title="2.3 ä½¿ç”¨"></a>2.3 ä½¿ç”¨</h3><p><strong>1ã€ç›‘å¬ requestã€Sessionã€application çš„åˆ›å»ºå’Œé”€æ¯</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextEvent;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequestEvent;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequestListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionEvent;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionListener;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListenerTest</span> <span class="keyword">implements</span> <span class="title">HttpSessionListener</span>, <span class="title">ServletContextListener</span>, <span class="title">ServletRequestListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// åˆ›å»º session</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionCreated</span><span class="params">(HttpSessionEvent se)</span> </span>&#123;</span><br><span class="line">		HttpSession session = se.getSession();</span><br><span class="line">		System.out.println(<span class="string">&quot;æ–°åˆ›å»ºä¸€ä¸ªsession, IDä¸º: &quot;</span> + session.getId());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// é”€æ¯ session</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionDestroyed</span><span class="params">(HttpSessionEvent se)</span> </span>&#123;</span><br><span class="line">		HttpSession session = se.getSession();</span><br><span class="line">		System.out.println(<span class="string">&quot;é”€æ¯ä¸€ä¸ªsession, IDä¸º: &quot;</span> + session.getId());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// åŠ è½½ application</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">		ServletContext servletContext = sce.getServletContext();</span><br><span class="line">		System.out.println(<span class="string">&quot;å³å°†å¯åŠ¨&quot;</span> + servletContext.getContextPath());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å¸è½½ application</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">		ServletContext servletContext = sce.getServletContext();</span><br><span class="line">		System.out.println(<span class="string">&quot;å³å°†å…³é—­&quot;</span> + servletContext.getContextPath());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// åˆ›å»º request</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestInitialized</span><span class="params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		HttpServletRequest request = (HttpServletRequest) sre.getServletRequest();</span><br><span class="line"></span><br><span class="line">		String uri = request.getRequestURI(); <span class="comment">// /helloSerlvet?name=lucy</span></span><br><span class="line">       <span class="comment">// name=lucy</span></span><br><span class="line">		uri = request.getQueryString() == <span class="keyword">null</span> ? uri : (uri + <span class="string">&quot;?&quot;</span> + request.getQueryString());</span><br><span class="line"></span><br><span class="line">		request.setAttribute(<span class="string">&quot;dateCreated&quot;</span>, System.currentTimeMillis());</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">&quot;IP &quot;</span> + request.getRemoteAddr() + <span class="string">&quot; è¯·æ±‚ &quot;</span> + uri);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// é”€æ¯ request</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestDestroyed</span><span class="params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		HttpServletRequest request = (HttpServletRequest) sre.getServletRequest();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">long</span> time = System.currentTimeMillis() - (Long) request.getAttribute(<span class="string">&quot;dateCreated&quot;</span>);</span><br><span class="line"></span><br><span class="line">		System.out.println(request.getRemoteAddr() + <span class="string">&quot;è¯·æ±‚å¤„ç†ç»“æŸ, ç”¨æ—¶&quot;</span> + time + <span class="string">&quot;æ¯«ç§’. &quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œçš„ç›‘å¬å™¨ä½¿ç”¨äº†æ³¨è§£é…ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨xmlé…ç½®ï¼Œåœ¨web.xmlä¸­</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.briup.listener.TestListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>





<p><strong>2ã€ç›‘å¬requestã€sessionã€applicationä¸‰ä¸ªå¯¹è±¡ä¸­å±æ€§å˜åŒ–</strong></p>
<p>ä¸‰ç§ç›‘å¬å™¨ä¸­çš„æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œä»¥sessionä¸ºä¾‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionAttributeListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionBindingEvent;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SessionAttributeListenerTest</span> <span class="keyword">implements</span> <span class="title">HttpSessionAttributeListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ·»åŠ å±æ€§</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeAdded</span><span class="params">(HttpSessionBindingEvent se)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//HttpSession session = se.getSession();</span></span><br><span class="line">		String name  = se.getName();</span><br><span class="line">		Object value = se.getValue();</span><br><span class="line">		System.out.println(<span class="string">&quot;æ–°å»ºsessionå±æ€§ï¼š&quot;</span> + name + <span class="string">&quot;, å€¼ä¸ºï¼š&quot;</span> + value);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// åˆ é™¤å±æ€§</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span><span class="params">(HttpSessionBindingEvent se)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//HttpSession session = se.getSession();</span></span><br><span class="line">		String name = se.getName();</span><br><span class="line">		Object value = se.getValue();</span><br><span class="line">		System.out.println(<span class="string">&quot;åˆ é™¤sessionå±æ€§ï¼š&quot;</span> + name + <span class="string">&quot;, å€¼ä¸ºï¼š&quot;</span> + value);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä¿®æ”¹å±æ€§</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span><span class="params">(HttpSessionBindingEvent se)</span> </span>&#123;</span><br><span class="line">		HttpSession session = se.getSession();</span><br><span class="line">		String name = se.getName();</span><br><span class="line">		Object oldValue = se.getValue();</span><br><span class="line">		Object newValue = session.getAttribute(name);</span><br><span class="line">		System.out.println(<span class="string">&quot;ä¿®æ”¹sessionå±æ€§ï¼š&quot;</span> + name + <span class="string">&quot;, åŸå€¼ï¼š&quot;</span> + oldValue + <span class="string">&quot;, æ–°å€¼ï¼š&quot;</span> + newValue);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>3ã€ç›‘å¬Sessionå¯¹è±¡é‡Œé¢å­˜æ”¾ç€çš„å…¶ä»–å¯¹è±¡</strong></p>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™ç§è¯·æ±‚æ˜¯éœ€è¦è®©è¢«ç›‘æµ‹çš„å¯¹è±¡ï¼ˆä¸€èˆ¬æ˜¯å®ä½“ç±»ï¼‰æ¥å®ç°æŒ‡å®šæ¥å£</p>
<p>æ³¨æ„ï¼Œè¿™ç§æƒ…å†µä½¿ç”¨è¾ƒå°‘ï¼Œäº†è§£å³å¯</p>
</blockquote>
<p><code>javax.servlet.http.HttpSessionBindingListener</code>æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.EventListener;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HttpSessionBindingListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹è±¡è¢«æ”¾è¿›sessionå‰è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">valueBound</span><span class="params">(HttpSessionBindingEvent event)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹è±¡ä»sessionä¸­ç§»é™¤åè°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">valueUnbound</span><span class="params">(HttpSessionBindingEvent event)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><code>javax.servlet.http.HttpSessionActivationListener</code>æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.EventListener;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HttpSessionActivationListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//sessionå³å°†è¢«æŒä¹…åŒ–åˆ°ç¡¬ç›˜æ—¶</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionWillPassivate</span><span class="params">(HttpSessionEvent se)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//sessionä»ç¡¬ç›˜åŠ è½½åè°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionDidActivate</span><span class="params">(HttpSessionEvent se)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionActivationListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionBindingEvent;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionBindingListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionEvent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">HttpSessionBindingListener</span>,<span class="title">HttpSessionActivationListener</span>,<span class="title">Serializable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(<span class="keyword">long</span> id, String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;User [id=&quot;</span> + id + <span class="string">&quot;, name=&quot;</span> + name + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// sessionä»ç¡¬ç›˜åŠ è½½å  </span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionDidActivate</span><span class="params">(HttpSessionEvent se)</span> </span>&#123;  </span><br><span class="line">		HttpSession session = se.getSession();  </span><br><span class="line">		System.out.println(<span class="keyword">this</span> + <span class="string">&quot;å·²ç»æˆåŠŸä»ç¡¬ç›˜ä¸­åŠ è½½ã€‚sessionId: &quot;</span> + session.getId());  </span><br><span class="line">	&#125;  </span><br><span class="line">  </span><br><span class="line">	<span class="comment">// sessionå³å°†è¢«æŒä¹…åŒ–åˆ°ç¡¬ç›˜æ—¶  </span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionWillPassivate</span><span class="params">(HttpSessionEvent se)</span> </span>&#123;  </span><br><span class="line">		HttpSession session = se.getSession();  </span><br><span class="line">		System.out.println(<span class="keyword">this</span> + <span class="string">&quot;å³å°†ä¿å­˜åˆ°ç¡¬ç›˜ã€‚sessionId: &quot;</span> + session.getId());  </span><br><span class="line">	&#125;  </span><br><span class="line">  </span><br><span class="line">	<span class="comment">// å½“å‰å¯¹è±¡è¢«æ”¾è¿›sessionå‰  </span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">valueBound</span><span class="params">(HttpSessionBindingEvent event)</span> </span>&#123;  </span><br><span class="line">		HttpSession session = event.getSession();  </span><br><span class="line">		String name = event.getName();  </span><br><span class="line">		System.out.println(<span class="keyword">this</span> + <span class="string">&quot;è¢«ç»‘å®šåˆ°session \&quot;&quot;</span> + session.getId() + <span class="string">&quot;\&quot;çš„&quot;</span> + name + <span class="string">&quot;å±æ€§ä¸Š&quot;</span>);  </span><br><span class="line">	&#125;  </span><br><span class="line">  </span><br><span class="line">	<span class="comment">// å½“å‰å¯¹è±¡ä»sessionä¸­ç§»é™¤å  </span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">valueUnbound</span><span class="params">(HttpSessionBindingEvent event)</span> </span>&#123;  </span><br><span class="line">		HttpSession session = event.getSession();  </span><br><span class="line">		String name = event.getName();  </span><br><span class="line">		System.out.println(<span class="keyword">this</span> + <span class="string">&quot;è¢«ä»session \&quot;&quot;</span> + session.getId() + <span class="string">&quot;\&quot;çš„&quot;</span> + name + <span class="string">&quot;å±æ€§ä¸Šç§»é™¤&quot;</span>);  </span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;	</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>é…åˆæµ‹è¯•çš„Servletä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		String flag = request.getParameter(<span class="string">&quot;flag&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(flag==<span class="keyword">null</span>) &#123;</span><br><span class="line">			request.getSession().setAttribute(<span class="string">&quot;user&quot;</span>, <span class="keyword">new</span> User(<span class="number">1L</span>,<span class="string">&quot;tom&quot;</span>));</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			request.getSession().removeAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„: å¦‚æœuserä»sessionç§»é™¤,åºåˆ—åŒ–ä¸æˆåŠŸ</p>
</blockquote>
<h2 id="3-error-page"><a href="#3-error-page" class="headerlink" title="3 error-page"></a>3 error-page</h2><p>åœ¨web.xmlä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>&lt;error-page&gt;</code>æ¥å®šåˆ¶é”™è¯¯çš„è¿”å›é¡µé¢</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœå‡ºç°404æƒ…å†µï¼Œåˆ™è·³è½¬åˆ°/404.htmlé¡µé¢ä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">error-code</span>&gt;</span>404<span class="tag">&lt;/<span class="name">error-code</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">location</span>&gt;</span>/404.html<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>ä¹Ÿå¯ä»¥æŒ‡å®šservletä¸­å‡ºç°çš„å¼‚å¸¸æƒ…å†µï¼š</p>
<p>ä¾‹å¦‚ï¼Œå½“servletç¨‹åºçš„æ—¶å€™ï¼Œå¦‚æœå‡ºç°äº†ä»¥ä¸‹ç±»å‹å¼‚å¸¸ï¼Œåˆ™è·³è½¬åˆ°not_found.htmlé¡µé¢</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">exception-type</span>&gt;</span>java.io.FileNotFoundException<span class="tag">&lt;/<span class="name">exception-type</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">location</span>&gt;</span>/404.html<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h2 id="4-WEB-INF"><a href="#4-WEB-INF" class="headerlink" title="4 WEB-INF"></a>4 WEB-INF</h2><p>WEB-INFæ˜¯Javaçš„WEBåº”ç”¨ä¸­çš„å®‰å…¨ç›®å½•ã€‚</p>
<p>å®‰å…¨ç›®å½•æŒ‡çš„æ˜¯å®¢æˆ·ç«¯æ— æ³•è®¿é—®ï¼Œåªæœ‰æœåŠ¡ç«¯å¯ä»¥è®¿é—®çš„ç›®å½•ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœå°†hello.htmlé¡µé¢å­˜æ”¾åœ¨WEB-INFä¸‹ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¸­æ˜¯æ— æ³•é€šè¿‡ä»¥ä¸‹åœ°å€ã€ç›´æ¥ã€‘è®¿é—®åˆ°è¯¥é¡µé¢çš„ï¼š</p>
<p><a href="http://127.0.0.1:8989/servlet-test/WEB-INF/hello.html">http://127.0.0.1:8989/servlet-test/WEB-INF/hello.html</a></p>
<p>ä½†æ˜¯ï¼Œåœ¨servletä¸­æ˜¯å¯ä»¥é€šè¿‡æœåŠ¡å™¨å†…éƒ¨è·³è½¬ï¼Œæ¥è®¿é—®åˆ°WEB-INFç›®å½•ä¸‹çš„èµ„æºçš„ã€‚</p>
<p>æ‰€ä»¥ï¼Œæµè§ˆå™¨å¯ä»¥è®¿é—®servletï¼Œè®©servletå†é€šè¿‡æœåŠ¡å™¨å†…éƒ¨è·³è½¬çš„æ–¹å¼ï¼Œæ¥è®¿é—®WEB-INFä¸‹çš„hello.htmlï¼Œä»è€Œæé«˜é¡µé¢çš„å®‰å…¨æ€§ï¼Œå› ä¸ºåœ¨servletä¸­å¯ä»¥å¯¹æœ¬æ¬¡è¯·æ±‚è¿›è¡ŒéªŒè¯ï¼Œé€šè¿‡åè·³è½¬åˆ°WEB-INFä¸‹çš„é¡µé¢ï¼Œå¦åˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p>
<h2 id="5-ä¸Šä¼ "><a href="#5-ä¸Šä¼ " class="headerlink" title="5 ä¸Šä¼ "></a>5 ä¸Šä¼ </h2><h3 id="5-1-æ¦‚è¿°-1"><a href="#5-1-æ¦‚è¿°-1" class="headerlink" title="5.1 æ¦‚è¿°"></a>5.1 æ¦‚è¿°</h3><p>åœ¨ä¸åŒç‰ˆæœ¬çš„servletä¸­ï¼Œå®Œæˆä¸Šä¼ çš„æ–¹å¼ä¸åŒï¼Œservlet3.0åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå®Œæˆä¸Šä¼ è¾ƒä¸ºéº»çƒ¦ï¼ˆäº†è§£å³å¯ï¼‰ï¼Œservlet3.1ç‰ˆæœ¬å®Œæˆä¸Šä¼ è¾ƒä¸ºç®€å•ã€‚</p>
<p>servlet3.0ä¹‹å‰ä¸Šä¼ éœ€è¦æ³¨æ„äº‹é¡¹ï¼š </p>
<ol>
<li>éœ€è¦å¯¼å…¥ä¸¤ä¸ªåŒ…ï¼šcommons-fileupload-1.4.jar,commons-io-2.8.0.jar</li>
<li>é¡µé¢è¡¨å•ä¸€å®šè¦æ˜¯postæ–¹å¼æäº¤</li>
<li>è¡¨å•ç¼–ç ç±»å‹è®¾ç½®ä¸ºï¼šenctype=â€multipart/form-dataâ€ï¼Œé»˜è®¤æ˜¯ application/x-www-form-urlencoded</li>
<li>ä¸Šä¼ æˆåŠŸçš„æ—¶å€™ï¼Œä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥åœ¨é¡¹ç›®ä¸­çš„ç›®å½•ï¼Œä¹Ÿå¯ä»¥åœ¨ç³»ç»Ÿç›®å½•</li>
<li>è®¾ç½®äº†è¡¨å•çš„enctype=â€multipart/form-dataâ€ å°±ã€æ— æ³•ã€‘é€šè¿‡HttpServletRequestå¯¹è±¡çš„getParameteræ–¹æ³•è·å–è¯·æ±‚å‚æ•°å€¼ã€‚</li>
</ol>
<p>servlet3.1ä¸Šä¼ éœ€è¦æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>ä¸éœ€è¦å¯¼å…¥é¢å¤–çš„jaråŒ…ï¼Œä½¿ç”¨servletæä¾›çš„@MultipartConfigæ³¨è§£å’Œjavax.servlet.http.Partæ¥å£ç±»å‹å¯¹è±¡å³å¯</li>
<li>é¡µé¢è¡¨å•ä¸€å®šè¦æ˜¯postæ–¹å¼æäº¤</li>
<li>è¡¨å•ç¼–ç ç±»å‹è®¾ç½®ä¸ºï¼šenctype=â€multipart/form-dataâ€ï¼Œé»˜è®¤æ˜¯ application/x-www-form-urlencoded</li>
<li>ä¸Šä¼ æˆåŠŸçš„æ—¶å€™ï¼Œä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥åœ¨é¡¹ç›®ä¸­çš„ç›®å½•ï¼Œä¹Ÿå¯ä»¥åœ¨ç³»ç»Ÿç›®å½•</li>
<li>è®¾ç½®äº†è¡¨å•çš„enctype=â€multipart/form-dataâ€ ã€ä¹Ÿå¯ä»¥ã€‘é€šè¿‡HttpServletRequestå¯¹è±¡çš„getParameteræ–¹æ³•è·å–è¯·æ±‚å‚æ•°å€¼ã€‚</li>
</ol>
<blockquote>
<p>æ³¨æ„ï¼ŒMultipartConfigå’ŒPartåœ¨Servlet3.0å°±åŠ å…¥äº†ï¼Œä½†æ˜¯é‡Œé¢çš„ä¸€äº›æ–¹æ³•ä½¿ç”¨Servlet3.1åœ¨æ–°å¢çš„</p>
</blockquote>
<h3 id="5-2-å®ç°"><a href="#5-2-å®ç°" class="headerlink" title="5.2 å®ç°"></a>5.2 å®ç°</h3><h4 id="5-2-1-servlet3-0"><a href="#5-2-1-servlet3-0" class="headerlink" title="5.2.1 servlet3.0"></a>5.2.1 servlet3.0</h4><p>1ã€å¼•å…¥jar</p>
<p>å¦‚æœæ˜¯åŠ¨æ€çš„webé¡¹ç›®ï¼Œå°†éœ€è¦çš„jaråŒ…ï¼Œç›´æ¥å¤åˆ¶ç²˜è´´åˆ°é¡¹ç›®ä¸­WEB-INFé‡Œé¢çš„libç›®å½•ä¸­å³å¯</p>
<p>å¦‚æœæ˜¯mavené¡¹ç›®ï¼Œç›´æ¥å¼•å…¥ä¾èµ–åæ ‡å³å¯ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">maven.compiler.soruce</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.soruce</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>2ã€ç¼–å†™é¡µé¢upload.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>ä¸Šä¼ <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	 </span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>ä¸Šä¼ <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/upload1&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¸Šä¼ &quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>3ã€ç¼–å†™servlet</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.FileItem;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.disk.DiskFileItemFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.servlet.ServletFileUpload;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * servlet3.0ä¹‹å‰çš„ä¸Šä¼ æ“ä½œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/upload1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpLoadServlet1</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	<span class="keyword">private</span> String path = <span class="string">&quot;D:\\briup\\upload&quot;</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">       <span class="comment">// é˜²æ­¢ä¸Šä¼ æ–‡ä»¶åä¹±æ‹¿å—</span></span><br><span class="line">		req.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">		resp.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">		String username = request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		<span class="comment">//é¡µé¢è¡¨å•ä¸­è®¾ç½®äº†enctype=&quot;multipart/form-data&quot;å</span></span><br><span class="line">		<span class="comment">//æ— æ³•ç›´æ¥é€šè¿‡getParameteræ–¹æ³•è·å–æ™®é€šç»„ä»¶çš„å‚æ•°å€¼</span></span><br><span class="line">		System.out.println(<span class="string">&quot;getParameter username = &quot;</span>+username);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//å¦‚æœæ˜¯ä¸Šä¼ çš„ç›®å½•åœ¨é¡¹ç›®ä¸­ï¼Œå¯ä»¥é€šè¿‡è¯¥æ–¹æ³•è·å¾—è¯¥ä¸Šä¼ ç›®å½•çš„ç»å¯¹è·¯å¾„</span></span><br><span class="line"><span class="comment">//		String realpath = getServletContext().getRealPath(path);</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//æ„é€ ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ å¤„ç†å¯¹è±¡</span></span><br><span class="line">			DiskFileItemFactory factory = <span class="keyword">new</span> DiskFileItemFactory();</span><br><span class="line">			ServletFileUpload upLoad = <span class="keyword">new</span> ServletFileUpload(factory);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//è·å¾—è¡¨å•ä¸­æäº¤å†…å®¹</span></span><br><span class="line">			List&lt;FileItem&gt; list = upLoad.parseRequest(request);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span> (FileItem fileItem : list) &#123;</span><br><span class="line">				<span class="comment">//fileItem.isFormField()è¿”å›trueè¡¨ç¤ºæ˜¯æ™®é€šçš„è¡¨å•ç»„ä»¶</span></span><br><span class="line">				<span class="comment">//fileItem.isFormField()è¿”å›falseè¡¨ç¤ºæ˜¯ä¸Šä¼ è¾“å…¥æ¡†</span></span><br><span class="line">				<span class="keyword">if</span> (fileItem.isFormField()) &#123;</span><br><span class="line">					<span class="comment">//getFieldName()æ–¹æ³•è·å¾—æ™®é€šè¡¨å•ç»„ä»¶çš„å‚æ•°å</span></span><br><span class="line">					String FieldName = fileItem.getFieldName();</span><br><span class="line">					<span class="comment">//è·å¾—è¯¥å‚æ•°æ‰€å¯¹åº”çš„å€¼å¹¶æŒ‡å®šç¼–ç </span></span><br><span class="line">					String Content = fileItem.getString(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">					<span class="comment">//ä¸ºäº†åé¢å¯ä»¥æŠŠæ™®é€šå‚æ•°ä»requestä¸­æ‹¿å‡ºæ¥</span></span><br><span class="line">					request.setAttribute(FieldName, Content);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="comment">//getName()å–å¾—ä¸Šä¼ æ–‡ä»¶çš„åå­—</span></span><br><span class="line">					String fileName = fileItem.getName();</span><br><span class="line">					<span class="comment">//é¿å…æ–‡ä»¶åå­—é‡å¤</span></span><br><span class="line">					fileName = System.currentTimeMillis()+<span class="string">&quot;-&quot;</span>+fileName;</span><br><span class="line">					File dir = <span class="keyword">new</span> File(path);</span><br><span class="line">					<span class="keyword">if</span>(!dir.exists()) &#123;</span><br><span class="line">						dir.mkdirs();</span><br><span class="line">					&#125;</span><br><span class="line">					File file = <span class="keyword">new</span> File(dir, fileName);</span><br><span class="line">					<span class="comment">//æŠŠä¸Šä¼ æ–‡ä»¶è¿›è¡ŒæŒ‡å®šç›®å½•</span></span><br><span class="line">					fileItem.write(file);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//å› ä¸ºä¸Šé¢è§£ærequestä¸­æ˜¯æ•°æ®å,æŠŠæ™®é€šè¡¨å•ç»„ä»¶ä¸­çš„keyå’Œvalueæ”¾åˆ°äº†requestä¸­,æ‰€ä»¥è¿™é‡Œå¯ä»¥æ‹¿å‡ºæ¥</span></span><br><span class="line">			System.out.println(<span class="string">&quot;request.getAttribute(\&quot;username\&quot;) = &quot;</span>+request.getAttribute(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h4 id="5-2-2-servlet3-1"><a href="#5-2-2-servlet3-1" class="headerlink" title="5.2.2 servlet3.1"></a>5.2.2 servlet3.1</h4><p>1ã€ç¼–å†™é¡µé¢upload.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>ä¸Šä¼ <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	 </span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>ä¸Šä¼ <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/upload2&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¸Šä¼ &quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>2ã€ç¼–å†™servlet</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.MultipartConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Part;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * servlet3.1çš„ä¸Šä¼ æ“ä½œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/upload2&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@MultipartConfig(location = &quot;D:\\briup\\upload&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpLoadServlet2</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//å¯ä»¥ä½¿ç”¨filteræ¥è¿›è¡Œç¼–ç è®¾ç½®</span></span><br><span class="line">		<span class="comment">//request.setCharacterEncoding(&quot;UTF-8&quot;);</span></span><br><span class="line">		<span class="comment">//response.setCharacterEncoding(&quot;UTF-8&quot;);</span></span><br><span class="line">		</span><br><span class="line">		String username = request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//è·å–ä¸Šä¼ çš„æ–‡ä»¶</span></span><br><span class="line">		Part part = request.getPart(<span class="string">&quot;file&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//è·å–ä¸Šä¼ æ–‡ä»¶çš„åå­—</span></span><br><span class="line">		<span class="comment">//servlet3.1çš„æ–¹æ³•</span></span><br><span class="line">		String fileName = part.getSubmittedFileName();</span><br><span class="line">		</span><br><span class="line">		System.out.println(username+<span class="string">&quot; ä¸Šä¼ äº†æ–‡ä»¶ï¼š&quot;</span>+fileName);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//é¿å…ä¸Šä¼ çš„æ–‡ä»¶é‡å¤ï¼Œæ–‡ä»¶åå‰é¢åŠ ä¸Šæ—¶é—´æˆ³</span></span><br><span class="line">		part.write(System.currentTimeMillis()+<span class="string">&quot;-&quot;</span>+fileName);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">       <span class="comment">//		String realPath = getServletContext().getRealPath(&quot;/upload&quot;);</span></span><br><span class="line">		<span class="comment">//		File file = new File(realPath);</span></span><br><span class="line">        <span class="comment">//		if(!file.exists()) &#123;</span></span><br><span class="line">        <span class="comment">//			file.mkdirs();</span></span><br><span class="line">        <span class="comment">//		&#125;</span></span><br><span class="line">        <span class="comment">//		part.write(realPath+&quot;/&quot;+fileName);</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// String realPath = &quot;D:/upload&quot;;</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„:@MultipartConfig(location = â€œD:\briup\uploadâ€)  è¯¥æ–¹å¼D:\briup\uploadå¿…é¡»å­˜åœ¨</p>
<p>å¯ä»¥æœ‰å¤šç§è·¯å¾„å†™æ³•</p>
</blockquote>
<p><code>@MutipartConfig</code>æ³¨è§£å‚æ•°ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132226274.png" alt="image-20201006010856560"></p>
<p><code>Part</code>æ¥å£çš„æ–¹æ³•ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/servlet/202205132226705.png" alt="image-20201006011014051"></p>
<h2 id="6-ä¸‹è½½"><a href="#6-ä¸‹è½½" class="headerlink" title="6 ä¸‹è½½"></a>6 ä¸‹è½½</h2><p>servletä¸‹è½½éœ€è¦æ³¨æ„äº‹é¡¹:</p>
<ol>
<li>servletå…¶å®å°±æ˜¯ç”¨ioæµä¸åœçš„å»è¯»é‚£ä¸ªæ–‡ä»¶ï¼Œç„¶åå†ç”¨è¾“å‡ºæµä¸åœçš„å†™ç»™å®¢æˆ·ç«¯æµè§ˆå™¨</li>
<li>ä¸‹è½½ç»“æŸï¼Œä¹Ÿå°±æ˜¯è¯´è¾“å‡ºæµç»“æŸä¹‹åï¼Œä¸‹é¢æ˜¯ä¸èƒ½å†å†™è·³è½¬çš„ä»£ç çš„ï¼Œè¦ä¸ç„¶ä¼šæŠ¥é”™</li>
<li>æŒ‰ç…§httpåè®®çš„è¦æ±‚ï¼Œè®¾ç½®ä¸‹è½½çš„å“åº”ç±»å‹ContentTypeï¼Œä»¥åŠè®¾ç½®å“åº”å¤´Content-Dispositionæ¥æŒ‡å®šä¸‹è½½æ–‡ä»¶çš„åå­—</li>
</ol>
<p>1ã€ç¼–å†™é¡µé¢download.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>ä¸‹è½½<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>servletä¸‹è½½<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;download?fileName=ä¸‹è½½.png&quot;</span>&gt;</span>æˆ‘çš„æ–‡æ¡£<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>2ã€ç¼–å†™servlet</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletOutputStream;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/download&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DownLoadServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	<span class="keyword">private</span> String path = <span class="string">&quot;D:\\briup\\upload&quot;</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request,</span></span></span><br><span class="line"><span class="params"><span class="function">			HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// è·å¾—ç”¨æˆ·éœ€è¦ä¸‹è½½æ–‡ä»¶çš„åå­—</span></span><br><span class="line">		String fileName = request.getParameter(<span class="string">&quot;fileName&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// å¦‚æœæ˜¯ä¸‹è½½æ–‡ä»¶çš„ç›®å½•åœ¨é¡¹ç›®ä¸­ï¼Œå¯ä»¥é€šè¿‡è¯¥æ–¹æ³•è·å¾—è¯¥ä¸‹è½½æ–‡ä»¶ç›®å½•çš„ç»å¯¹è·¯å¾„</span></span><br><span class="line"><span class="comment">//		String realPath = getServletContext().getRealPath(path);</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// å“åº”ç±»å‹è®¾ç½®ä¸ºä¸‹è½½:application/x-download</span></span><br><span class="line">		response.setContentType(<span class="string">&quot;application/x-download&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// ä¸‹è½½æ–‡ä»¶æ—¶æ˜¾ç¤ºæ–‡ä»¶çš„ä¿å­˜åç§°</span></span><br><span class="line">		String fileDisplay = <span class="string">&quot;briup_&quot;</span>+fileName;</span><br><span class="line">		<span class="comment">// ä¸‹è½½æ–‡ä»¶åçš„ä¸­æ–‡ç¼–ç è½¬æ¢ å› ä¸ºå†™å›å»çš„æ—¶å€™æ˜¯å­—èŠ‚æµ</span></span><br><span class="line">		<span class="comment">// ä¸è®¾ç½®ä¼šå‡ºç°ä¸‹è½½æ–‡ä»¶çš„ä¸­æ–‡åå­—ä¹±ç </span></span><br><span class="line">		fileDisplay = <span class="keyword">new</span> String(fileDisplay.getBytes(<span class="string">&quot;utf-8&quot;</span>),<span class="string">&quot;ISO-8859-1&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// è®¾ç½®å“åº”å¤´éƒ¨ä¿¡æ¯(httpåè®®ä¸­çš„å›ºå®šè®¾ç½®æ–¹å¼)</span></span><br><span class="line">		response.addHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename=&quot;</span>+fileDisplay);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		FileInputStream in = <span class="keyword">null</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">// è·å–servletä¸­æ˜¯è¾“å‡ºæµ</span></span><br><span class="line">			ServletOutputStream out = response.getOutputStream();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// ä½¿ç”¨IOæµè¯»å–éœ€è¦ä¸‹è½½çš„æ–‡ä»¶</span></span><br><span class="line">			File file = <span class="keyword">new</span> File(path,fileName);</span><br><span class="line">			in = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// è¯»å–æ–‡ä»¶åå†å†™å›ç»™æµè§ˆå™¨</span></span><br><span class="line">			<span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">			<span class="keyword">int</span> len = -<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">while</span> ((len = in.read(b)) != -<span class="number">1</span>) &#123;</span><br><span class="line">				out.write(b, <span class="number">0</span>, len);</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="comment">// ImageIoUtil.copy(in,out); </span></span><br><span class="line">			in.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(in!=<span class="keyword">null</span>) &#123;</span><br><span class="line">				in.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//æ³¨æ„ä¸‹è½½ä¹‹åå°±ä¸èƒ½ä½¿ç”¨requestè·³è½¬äº†,å› ä¸ºresponseå·²ç»è¿”å›äº†</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œè®¾ç½®å¥½å“åº”å¤´å­—æ®µåï¼Œå…¶ä»–çš„å°±æ˜¯ä½¿ç”¨IOæµè¯»å–æ•°æ®åå†å†™å›ç»™æµè§ˆå™¨</p>
</blockquote>
<blockquote>
<p>http headerå¤´è¦æ±‚å…¶å†…å®¹å¿…é¡»ä¸ºiso-8859-1ç¼–ç </p>
</blockquote>
<h2 id="7-ä¸‰å±‚æ¶æ„"><a href="#7-ä¸‰å±‚æ¶æ„" class="headerlink" title="7 ä¸‰å±‚æ¶æ„"></a>7 ä¸‰å±‚æ¶æ„</h2><p>åœ¨webé¡¹ç›®çš„ä»£ç ç»“æ„ä¸­ï¼Œç»å¸¸ä¼šä½¿ç”¨åˆ°ä¸‰å±‚æ¶æ„ï¼š</p>
<ul>
<li>webå±‚  servlet/filter/listener</li>
<li>serviceå±‚ </li>
<li>daoå±‚</li>
</ul>
<p>webå±‚ä¸­ä»£ç çš„ä¸»è¦ä»»åŠ¡ï¼š</p>
<ul>
<li>æ¥æ”¶å®¢æˆ·ç«¯ä¼ æ¥çš„å‚æ•°</li>
<li>æŠŠå‚æ•°å°è£…æˆå¯¹è±¡   saveUser(user)</li>
<li>æŠŠå°è£…å¥½çš„å¯¹è±¡/æ•°æ®ä¼ ç»™service</li>
<li>æ ¹æ®serviceå±‚çš„å¤„ç†ç»“æœå†³å®šæŠŠé‚£ä¸ªé¡µé¢/æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯</li>
</ul>
<p>serviceå±‚ä¸­ä»£ç çš„ä¸»è¦ä»»åŠ¡ï¼š</p>
<ul>
<li>æ¥æ”¶webå±‚ä¼ è¿‡æ¥çš„å¯¹è±¡/æ•°æ®(å¦‚æœæœ‰çš„è¯)</li>
<li>æ ¹æ®è¿™äº›ä¿¡æ¯è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†</li>
</ul>
<p>ä¾‹å¦‚ï¼Œå®Œæˆä¸€ä¸ªç™»å½•åŠŸèƒ½ï¼Œwebå±‚æ¥æ”¶åˆ°ç”¨æˆ·åå’Œå¯†ç ä¹‹åï¼ŒæŠŠæ•°æ®ä¼ ç»™serviceå±‚ï¼Œserviceå±‚å°±è¦æ ¹æ®è¿™äº›ä¿¡æ¯æ¥åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ã€å¯†ç æ˜¯å¦æ­£ç¡®ã€ç”¨æˆ·æ˜¯å¦æœ‰æƒé™ã€ç”¨æˆ·çŠ¶æ€å½“å‰æ˜¯å¦å¯ç”¨ã€ç”¨æˆ·æ˜¯å¦æ¨é€ä¿¡æ¯ã€æ˜¯å¦ç»™ç”¨æˆ·ç›¸å…³æç¤ºç­‰ï¼Œè¿™äº›éƒ½å±äºç™»å½•çš„ä¸šåŠ¡é€»è¾‘å¤„ç†</p>
<p>daoå±‚ä¸­ä»£ç çš„ä¸»è¦ä»»åŠ¡ï¼š</p>
<ul>
<li>æ¥å—serviceä¼ çš„å‚æ•°(å¦‚æœæœ‰çš„è¯)</li>
<li>å’Œæ•°æ®åº“è¿›è¡Œäº¤äº’</li>
<li>æŠŠäº¤äº’ç»“æœè¿”å›ç»™serviceå±‚</li>
</ul>
<p>==æ€è€ƒï¼Œé¡¹ç›®çš„ä»£ç ä¸ºä½•è¦åˆ†å±‚ç¼–å†™ï¼Œå…¨éƒ¨ä»£ç å†™åˆ°ä¸€ä¸ªç±»ä¸­è¿›è¡Œå®ç°ï¼Œæ˜¯å¦å¯ä»¥ï¼Ÿ==</p>
]]></content>
      <tags>
        <tag>briup_java</tag>
      </tags>
  </entry>
  <entry>
    <title>out_cms</title>
    <url>/archives/project/out_cms.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><ul>
<li>æ•™æ¡ˆ: çœ‹ç‚¹å’¨è¯¢ç³»ç»Ÿ</li>
<li>æ—¶é—´: 2021/12/12</li>
<li>æ•´ç†äºº: vanse(åˆ˜èª)</li>
<li>æˆè¯¾å¯¹è±¡: å®¿å·å­¦é™¢2019çº§</li>
<li>åœ°ç‚¹: å®‰å¾½å®¿å·å­¦é™¢(é’‰é’‰æˆè¯¾)</li>
</ul>
<h1 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h1><h2 id="è½¯ä»¶å®‰è£…"><a href="#è½¯ä»¶å®‰è£…" class="headerlink" title="è½¯ä»¶å®‰è£…"></a>è½¯ä»¶å®‰è£…</h2><p><strong>å¿…è£…</strong></p>
<ul>
<li>jdk</li>
<li>idea</li>
<li>maven</li>
<li>mysql(sqlyog)</li>
</ul>
<p><strong>é€‰è£…</strong></p>
<p>firefoxæµè§ˆå™¨ä»¥åŠRestClientæ’ä»¶</p>
<p>nginx</p>
<p>redis</p>
<p>node(vue-element-template)</p>
<h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><p>maven</p>
<p>springboot</p>
<p>mysql</p>
<p>mybatis</p>
<h1 id="é¡¹ç›®ä»‹ç»"><a href="#é¡¹ç›®ä»‹ç»" class="headerlink" title="é¡¹ç›®ä»‹ç»"></a>é¡¹ç›®ä»‹ç»</h1><h2 id="1-èƒŒæ™¯"><a href="#1-èƒŒæ™¯" class="headerlink" title="1.èƒŒæ™¯"></a>1.èƒŒæ™¯</h2><p>â€‹    åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œå†…å®¹ç®¡ç†ç³»ç»Ÿå åˆ°æ‰€æœ‰ç³»ç»Ÿçš„80%ä»¥ä¸Šï¼Œæ¯”å¦‚ä¸ªäººåšå®¢ï¼Œè…¾è®¯æ–°é—»ï¼Œä»Šæ—¥å¤´æ¡ï¼Œæœç‹æ–° é—»ç­‰ã€‚ è¿™äº›éƒ½æ˜¯æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ç»å¸¸ä½¿ç”¨åˆ°çš„ç³»ç»Ÿï¼Œå®ƒçš„æ ¸å¿ƒå°±æ˜¯å¯ä»¥æ¦‚æ‹¬ä¸ºå†…å®¹ï¼ˆèµ„è®¯ï¼‰ï¼Œä¸€ç¯‡æ–‡ç« å°±æ˜¯ä¸€ä¸ªèµ„è®¯ï¼Œå¤§å®¶è¶Šæ¥è¶Šå–œæ¬¢å°†ç”Ÿæ´»ä¸­çš„æ‰€è§æ‰€é—»ç®€è¿°å‡ºæ¥ã€‚</p>
<p>å¦‚å›¾ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210317215643452.png" alt="image-20210317215643452"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210317215652686.png" alt="image-20210317215652686"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œç›®å‰æ¥è®²å¯¹äºèµ„è®¯ç³»ç»Ÿçš„éœ€æ±‚é‡æ˜¯éå¸¸å¤§çš„</p>
</blockquote>
<p>â€‹    é€šç”¨çš„çœ‹ç‚¹èµ„è®¯ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨å‰åå°åˆ†ç¦»å¼€å‘çš„æŠ€æœ¯ï¼Œå°†ç³»ç»Ÿåˆ†ä¸ºå‰å°é¡µé¢å±•ç¤ºä»¥åŠåå°èµ„è®¯ç®¡ç†ç³»ç»Ÿã€‚å¯¹äºåå°ç³»ç»Ÿæ˜¯åŸºæœ¬ä¸Šæ˜¯é€šç”¨çš„ï¼Œè€Œå‰å°å¯æ ¹æ®ä¸åŒå®¢æˆ·çš„éœ€æ±‚å»ä¿®æ”¹å®šåˆ¶ã€‚</p>
<p>  (ä¸æ¶‰åŠé¡µé¢  ä½¿ç”¨æŸäº›å‰ç«¯æ¨¡æ¿)</p>
<h2 id="2-ç®€ä»‹"><a href="#2-ç®€ä»‹" class="headerlink" title="2.ç®€ä»‹"></a>2.ç®€ä»‹</h2><p>çœ‹ç‚¹èµ„è®¯ç³»ç»Ÿæœ€æ ¸å¿ƒçš„æ•°æ®æ˜¯å†…å®¹ï¼Œä¾‹å¦‚æ–‡ç« ã€æ–°é—»ç­‰ï¼Œæ‰€ä»¥åå°ä¸»è¦åŠŸèƒ½æ˜¯å®ç°è¿™äº›å†…å®¹çš„ç®¡ç†ï¼Œä¾‹å¦‚æ ç›®ç®¡ç†ã€è¯„è®ºç®¡ç†ã€ç”¨æˆ·ç®¡ç†ä»¥åŠè§’è‰²ç®¡ç†ç­‰ï¼Œå¯¹äºå‰å°å¯ä»¥çµæ´»å¾—å±•ç¤ºåå°çš„æ•°æ®ã€‚<br>ä¾‹å¦‚ï¼Œ</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210317215829625.png" alt="image-20210317215829625"></p>
<h2 id="3-æŠ€æœ¯"><a href="#3-æŠ€æœ¯" class="headerlink" title="3.æŠ€æœ¯"></a>3.æŠ€æœ¯</h2><p>åå°é‡‡ç”¨çš„æŠ€æœ¯ï¼š</p>
<ul>
<li>springboot</li>
<li>spring</li>
<li>springmvc</li>
<li>mybatis</li>
<li>jwt</li>
</ul>
<p>æ•°æ®åº“ï¼š</p>
<ul>
<li>mysql    </li>
</ul>
<p>æ–‡æ¡£ç®¡ç†ï¼š</p>
<ul>
<li>swagger</li>
</ul>
<p>æ¶æ„é€‰å–ï¼š</p>
<ul>
<li>ä¸‰å±‚æ¶æ„<ul>
<li>controller   springmvc(servlet) å¯¹å¤–æš´éœ²apiæ¥å£</li>
<li>service  å¤„ç†ä¸šåŠ¡é€»è¾‘  å‚æ•°/è¿”å›/äº‹åŠ¡/æ—¥å¿—/åˆ†é¡µâ€¦</li>
<li>dao æ•°æ®è®¿é—®å±‚</li>
</ul>
</li>
</ul>
<h2 id="4-åŠŸèƒ½"><a href="#4-åŠŸèƒ½" class="headerlink" title="4.åŠŸèƒ½"></a>4.åŠŸèƒ½</h2><h3 id="4-1-ç”¨æˆ·æ¨¡å—"><a href="#4-1-ç”¨æˆ·æ¨¡å—" class="headerlink" title="4.1 ç”¨æˆ·æ¨¡å—"></a>4.1 ç”¨æˆ·æ¨¡å—</h3><blockquote>
<p>å¯¹åº”çš„å®ä½“ç±»ä¸ºUser</p>
</blockquote>
<p>1ã€æ–°å¢ç”¨æˆ·</p>
<ul>
<li>å‚æ•°1ï¼šUser</li>
</ul>
<p>2ã€ç¼–è¾‘ç”¨æˆ·</p>
<ul>
<li>å‚æ•°1ï¼šUser</li>
</ul>
<p>3ã€æŸ¥è¯¢ç”¨æˆ·ï¼ˆåˆ†é¡µï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<p>4ã€åˆ é™¤ç”¨æˆ·ï¼ˆæ‰¹é‡ï¼Œæ³¨é”€ç”¨æˆ·ï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šList<Long> ids</li>
</ul>
<p>5ã€ç¦ç”¨æˆ–è§£å°ç”¨æˆ·ä¿¡æ¯ï¼ˆæ›´æ–°ç”¨æˆ·çŠ¶æ€ï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šInteger id</li>
<li>å‚æ•°2ï¼šInteger status</li>
</ul>
<p>6ã€æ ¹æ®ç”¨æˆ·åè·å–ç”¨æˆ·ä¿¡æ¯</p>
<ul>
<li>å‚æ•°1ï¼šString username</li>
</ul>
<p>7ã€ç™»å½•</p>
<ul>
<li>å‚æ•°1ï¼šString username</li>
<li>å‚æ•°2ï¼šString password</li>
</ul>
<h3 id="4-2-è§’è‰²æ¨¡å—"><a href="#4-2-è§’è‰²æ¨¡å—" class="headerlink" title="4.2 è§’è‰²æ¨¡å—"></a>4.2 è§’è‰²æ¨¡å—</h3><blockquote>
<p>å¯¹åº”çš„å®ä½“ç±»ä¸ºRole</p>
</blockquote>
<p>1ã€æ–°å¢è§’è‰²</p>
<ul>
<li>å‚æ•°1ï¼šRole r</li>
</ul>
<p>2ã€ç¼–è¾‘è§’è‰²</p>
<ul>
<li>å‚æ•°1ï¼šRole r</li>
</ul>
<p>3ã€æŸ¥è¯¢è§’è‰²ï¼ˆåˆ†é¡µï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<p>4ã€æ‰¹é‡åˆ é™¤è§’è‰²</p>
<ul>
<li>å‚æ•°1ï¼šList<Long> ids</li>
</ul>
<h3 id="4-3-èµ„è®¯æ¨¡å—"><a href="#4-3-èµ„è®¯æ¨¡å—" class="headerlink" title="4.3 èµ„è®¯æ¨¡å—"></a>4.3 èµ„è®¯æ¨¡å—</h3><blockquote>
<p>èµ„è®¯åœ¨è¿™é‡Œä¸»è¦æŒ‡çš„çš„æ˜¯æ–‡ç« ï¼Œå¯¹åº”çš„å®ä½“ç±»ä¸ºArticle</p>
</blockquote>
<p>1ã€æ–°å¢èµ„è®¯</p>
<ul>
<li>å‚æ•°1ï¼šArticle article</li>
</ul>
<p>2ã€ç¼–è¾‘èµ„è®¯</p>
<ul>
<li>å‚æ•°1ï¼šArticle article</li>
</ul>
<p>3ã€æŸ¥è¯¢èµ„è®¯ï¼ˆåˆ†é¡µï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<p>4ã€æ‰¹é‡åˆ é™¤èµ„è®¯</p>
<ul>
<li>å‚æ•°1ï¼šList<Integer > ids</li>
</ul>
<p>5ã€å®¡æ ¸èµ„è®¯</p>
<ul>
<li>å‚æ•°1ï¼šInteger id</li>
<li>å‚æ•°2ï¼šInteger status</li>
</ul>
<p>6ã€æ ¹æ®ç±»åˆ«IDæŸ¥è¯¢ï¼Œåˆ†é¡µè·å–èµ„è®¯ä¿¡æ¯ï¼Œå¹¶ä¸”æŒ‰ç…§é˜…è¯»é‡é™åºæ’</p>
<ul>
<li>å‚æ•°1ï¼šInteger categoryId</li>
<li>å‚æ•°2ï¼šInteger pageNum</li>
<li>å‚æ•°3ï¼šInteger pageSize</li>
</ul>
<p>7ã€æ ¹æ®ç”¨æˆ·åˆ†é¡µè·å–èµ„è®¯ä¿¡æ¯</p>
<ul>
<li>å‚æ•°1ï¼šInteger userId</li>
<li>å‚æ•°2ï¼šInteger pageNum</li>
<li>å‚æ•°3ï¼šInteger pageSize</li>
</ul>
<h3 id="4-4-ç±»åˆ«æ¨¡å—"><a href="#4-4-ç±»åˆ«æ¨¡å—" class="headerlink" title="4.4 ç±»åˆ«æ¨¡å—"></a>4.4 ç±»åˆ«æ¨¡å—</h3><blockquote>
<p>ç±»åˆ«ä¹Ÿå°±æ˜¯æ ç›®ï¼š Category</p>
</blockquote>
<p>1ã€æ–°å¢ç±»åˆ«</p>
<ul>
<li>å‚æ•°1ï¼šCategory category</li>
</ul>
<p>2ã€ç¼–è¾‘ç±»åˆ«</p>
<ul>
<li>å‚æ•°1ï¼šCategory category</li>
</ul>
<p>3ã€æŸ¥è¯¢ç±»åˆ«ï¼ˆåˆ†é¡µï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<p>4ã€æ‰¹é‡åˆ é™¤ç±»åˆ«</p>
<ul>
<li>å‚æ•°1ï¼šList<Integer > ids</li>
</ul>
<p>5ã€æ›´æ–°ç±»åˆ«åºå·</p>
<ul>
<li>å‚æ•°1ï¼šInteger id</li>
<li>å‚æ•°2ï¼šInteger no</li>
</ul>
<p>6ã€æŒ‰ç…§åºå·å‡åºåˆ†é¡µè·å–ç±»åˆ«ä¿¡æ¯</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<h3 id="4-5-è¯„è®ºæ¨¡å—"><a href="#4-5-è¯„è®ºæ¨¡å—" class="headerlink" title="4.5 è¯„è®ºæ¨¡å—"></a>4.5 è¯„è®ºæ¨¡å—</h3><blockquote>
<p>å¯¹åº”çš„å®ä½“ç±»ä¸ºComment</p>
</blockquote>
<p>1ã€æ–°å¢è¯„è®º</p>
<ul>
<li>å‚æ•°1ï¼šComment comment</li>
</ul>
<p>2ã€ç¼–è¾‘è¯„è®º</p>
<ul>
<li>å‚æ•°1ï¼šComment comment</li>
</ul>
<p>3ã€æ‰¹é‡åˆ é™¤è¯„è®º</p>
<ul>
<li>å‚æ•°1ï¼šList<Integer > ids</li>
</ul>
<p>4ã€æŸ¥è¯¢è¯„è®ºï¼ˆåˆ†é¡µï¼‰</p>
<ul>
<li>å‚æ•°1ï¼šInteger num(é¡µæ•°)</li>
<li>å‚æ•°2ï¼šInteger sizeï¼ˆæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®ï¼‰</li>
</ul>
<p>5ã€åˆ†é¡µè·å–æŒ‡å®šæ–‡ç« ä¸‹æ‰€æœ‰çš„è¯„è®º</p>
<ul>
<li>å‚æ•°1ï¼šInteger articleId</li>
<li>å‚æ•°2ï¼šInteger num</li>
<li>å‚æ•°3ï¼šInteger size</li>
</ul>
<h2 id="5-å­—å…¸"><a href="#5-å­—å…¸" class="headerlink" title="5.å­—å…¸"></a>5.å­—å…¸</h2><p>1ã€ç”¨æˆ·è¡¨ï¼Œcms_user</p>
<ul>
<li>ä¸€ä¸ªç”¨æˆ·æœ‰ä¸€ä¸ªè§’è‰²</li>
<li>ä¸€ä¸ªè§’è‰²æœ‰å¤šä¸ªç”¨æˆ·</li>
</ul>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210317221131577.png" alt="image-20210317221131577"></p>
<p>2ã€è§’è‰²è¡¨ï¼Œcms_role</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210317221149140.png" alt="image-20210317221149140"></p>
<p>3ã€æ–‡ç« ç±»åˆ«è¡¨ï¼Œcms_category</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210317221204520.png" alt="image-20210317221204520"></p>
<p>4ã€æ–‡ç« è¡¨ï¼Œcms_article</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210317221220121.png" alt="image-20210317221220121"></p>
<p>5ã€è¯„è®ºè¡¨ï¼Œcms_comment</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210317221235341.png" alt="image-20210317221235341"></p>
<p>å¿«é€ŸåŸå‹  å‰ç«¯ç”»å‡ºæ¥  </p>
<h2 id="6-åŸå‹å›¾"><a href="#6-åŸå‹å›¾" class="headerlink" title="6.åŸå‹å›¾"></a>6.åŸå‹å›¾</h2><p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210317230950797.png" alt="image-20210317230950797"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210317231012612.png" alt="image-20210317231012612"></p>
<h1 id="é¡¹ç›®æ­å»º"><a href="#é¡¹ç›®æ­å»º" class="headerlink" title="é¡¹ç›®æ­å»º"></a>é¡¹ç›®æ­å»º</h1><h2 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h2><p>åˆ›å»ºé¡¹ç›®å‰ç¡®ä¿ç¯å¢ƒ</p>
<ul>
<li>mavenæ­£ç¡®é…ç½®</li>
<li>å®‰è£…lombokæ’ä»¶(å¯é€‰)  ç®€åŒ–get/set/toString </li>
<li>mybatisxæ’ä»¶(å¯é€‰)  ç®€åŒ–Mybatisæ“ä½œ</li>
</ul>
<p>maven</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212125329906.png" alt="image-20211212125329906"></p>
<p>æ’ä»¶</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212125253757.png" alt="image-20211212125253757"></p>
<p><strong>æ‰“å¼€idea,ç‚¹å‡»create new project</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212120353767.png" alt="image-20211212120353767"></p>
<p><strong>æœ¬æ¬¡ä»¥Spring Initializerçš„æ–¹å¼åˆ›å»ºspringbooté¡¹ç›®</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212120543562.png" alt="image-20211212120543562"></p>
<p><strong>é€‰æ‹©é¡¹ç›®é…ç½®</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212121736620.png" alt="image-20211212121736620"></p>
<p><strong>æŒ‘é€‰ä¾èµ–</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212122105673.png" alt="image-20211212122105673"></p>
<p><strong>è‡ªå®šä¹‰é¡¹ç›®å­˜æ”¾è·¯å¾„</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212122303953.png" alt="image-20211212122303953"></p>
<p><strong>åˆ›å»ºæˆåŠŸåçš„é¡µé¢</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212122743250.png" alt="image-20211212122743250"></p>
<h3 id="pom"><a href="#pom" class="headerlink" title="pom"></a>pom</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.briup<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cms<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>cms<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--webé›†æˆäº†springmvc jsonç­‰é…ç½®--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mybatisé›†æˆ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!--åˆ†é¡µæ’ä»¶--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--çƒ­éƒ¨ç½² ctrl+F9--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!--mysqlé©±åŠ¨--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.39<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombock éœ€è¦é¢å¤–å®‰è£…æ’ä»¶</span></span><br><span class="line"><span class="comment">				&lt;dependency&gt;</span></span><br><span class="line"><span class="comment">            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span></span><br><span class="line"><span class="comment">            &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span></span><br><span class="line"><span class="comment">            &lt;optional&gt;true&lt;/optional&gt;</span></span><br><span class="line"><span class="comment">        &lt;/dependency&gt;</span></span><br><span class="line"><span class="comment">			--&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!--æµ‹è¯•å•å…ƒ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">exclude</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="properties"><a href="#properties" class="headerlink" title="properties"></a>properties</h3><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8989</span></span><br><span class="line"><span class="comment">#é…ç½®æ•°æ®æº</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/cms_jd2017?characterEncoding=utf8&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=GMT%2B8</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>



<h3 id="main"><a href="#main" class="headerlink" title="main"></a>main</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CmsApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(CmsApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212123536298.png" alt="image-20211212123536298"></p>
<p>è®¿é—®<a href="http://localhost:8989/">ç½‘å€</a>  ä»¥ä¸‹ç•Œé¢ä»£è¡¨å¯åŠ¨æˆåŠŸ</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212124022919.png" alt="image-20211212124022919"></p>
<h2 id="é€†å‘å·¥ç¨‹"><a href="#é€†å‘å·¥ç¨‹" class="headerlink" title="é€†å‘å·¥ç¨‹"></a>é€†å‘å·¥ç¨‹</h2><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p><a href="http://mybatis.org/generator/">Mybatis-Generator</a></p>
<p>MyBatis Generator (MBG) æ˜¯ MyBatis <a href="http://mybatis.org/">MyBatis</a>çš„ä»£ç ç”Ÿæˆå™¨ã€‚å®ƒå°†ä¸ºæ‰€æœ‰ç‰ˆæœ¬çš„ MyBatis ç”Ÿæˆä»£ç ã€‚å®ƒå°†å†…çœä¸€ä¸ªæ•°æ®åº“è¡¨ï¼ˆæˆ–å¤šä¸ªè¡¨ï¼‰å¹¶ç”Ÿæˆå¯ç”¨äºè®¿é—®è¡¨çš„å·¥ä»¶ã€‚è¿™å‡å°‘äº†è®¾ç½®å¯¹è±¡å’Œé…ç½®æ–‡ä»¶ä»¥ä¸æ•°æ®åº“è¡¨äº¤äº’çš„åˆå§‹éº»çƒ¦ã€‚MBG è¯•å›¾å¯¹å¤§é‡ç®€å•çš„ CRUDï¼ˆåˆ›å»ºã€æ£€ç´¢ã€æ›´æ–°ã€åˆ é™¤ï¼‰çš„æ•°æ®åº“æ“ä½œäº§ç”Ÿé‡å¤§å½±å“ã€‚æ‚¨ä»ç„¶éœ€è¦ä¸ºè¿æ¥æŸ¥è¯¢æˆ–å­˜å‚¨è¿‡ç¨‹ç¼–å†™ SQL å’Œå¯¹è±¡ä»£ç ã€‚</p>
<p>MBG ç”Ÿæˆä¸åŒé£æ ¼å’Œä¸åŒè¯­è¨€çš„ä»£ç ï¼Œè¿™å–å†³äºå®ƒçš„é…ç½®æ–¹å¼ã€‚ä¾‹å¦‚ï¼ŒMBG å¯ä»¥ç”Ÿæˆ Java æˆ– Kotlin ä»£ç ã€‚MBG å¯ä»¥ç”Ÿæˆä¸ MyBatis3 å…¼å®¹çš„ XML - å°½ç®¡ç°åœ¨è¢«è®¤ä¸ºæ˜¯ MBG çš„é—ç•™ç”¨é€”ã€‚ç”Ÿæˆä»£ç çš„è¾ƒæ–°æ ·å¼ä¸éœ€è¦ XMLã€‚</p>
<p>æ ¹æ®å®ƒçš„é…ç½®æ–¹å¼ï¼ŒMyBatis Generator å¯èƒ½ä¼šç”Ÿæˆï¼š</p>
<ul>
<li><p>ä¸è¡¨ç»“æ„åŒ¹é…çš„ Java æˆ– Kotlin ç±»ã€‚è¿™å¯èƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>åŒ¹é…è¡¨ä¸»é”®çš„ç±»ï¼ˆå¦‚æœæœ‰ä¸»é”®ï¼‰</li>
<li>åŒ¹é…è¡¨çš„éä¸»é”®å­—æ®µçš„ç±»ï¼ˆBLOB å­—æ®µé™¤å¤–ï¼‰</li>
<li>ä¸€ä¸ªåŒ…å«è¡¨çš„ BLOB å­—æ®µçš„ç±»ï¼ˆå¦‚æœè¡¨æœ‰ BLOB å­—æ®µï¼‰</li>
<li>å¯ç”¨åŠ¨æ€é€‰æ‹©ã€æ›´æ–°å’Œåˆ é™¤çš„ç±»</li>
</ul>
<p>è¿™äº›ç±»ä¹‹é—´æœ‰é€‚å½“çš„ç»§æ‰¿å…³ç³»ã€‚è¯·æ³¨æ„ï¼Œç”Ÿæˆå™¨å¯ä»¥é…ç½®ä¸ºç”Ÿæˆä¸åŒç±»å‹çš„ POJO å±‚æ¬¡ç»“æ„ - ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æ„¿æ„ï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä¸ºæ¯ä¸ªè¡¨ç”Ÿæˆå•ä¸ªåŸŸå¯¹è±¡ã€‚</p>
</li>
<li><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒMBG ä¼šç”Ÿæˆ MyBatis3 Compatible SQL Map XML Filesã€‚MBG ä¸ºé…ç½®ä¸­çš„æ¯ä¸ªè¡¨ä¸Šçš„ç®€å• CRUD å‡½æ•°ç”Ÿæˆ SQLã€‚ç”Ÿæˆçš„ SQL è¯­å¥åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ’å…¥</li>
<li>æŒ‰ä¸»é”®æ›´æ–°</li>
<li>ç¤ºä¾‹æ›´æ–°ï¼ˆä½¿ç”¨åŠ¨æ€ where å­å¥ï¼‰</li>
<li>æŒ‰ä¸»é”®åˆ é™¤</li>
<li>åˆ é™¤ç¤ºä¾‹ï¼ˆä½¿ç”¨åŠ¨æ€ where å­å¥ï¼‰</li>
<li>æŒ‰ä¸»é”®é€‰æ‹©</li>
<li>æŒ‰ç¤ºä¾‹é€‰æ‹©ï¼ˆä½¿ç”¨åŠ¨æ€ where å­å¥ï¼‰</li>
<li>ä¸¾ä¾‹æ•°</li>
</ul>
<p>æ ¹æ®è¡¨çš„ç»“æ„ï¼Œè¿™äº›è¯­å¥æœ‰ä¸åŒçš„å˜ä½“ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœè¡¨æ²¡æœ‰ä¸»é”®ï¼Œåˆ™ MBG ä¸ä¼šé€šè¿‡ä¸»é”®å‡½æ•°ç”Ÿæˆæ›´æ–°ï¼‰ã€‚</p>
</li>
<li><p>é€‚å½“ä½¿ç”¨ä¸Šè¿°å¯¹è±¡çš„ Java æˆ– Kotlin å®¢æˆ·ç«¯ç±»ã€æ¥å£å’Œ Kotlin æ‰©å±•æ–¹æ³•ã€‚å®¢æˆ·ç«¯ç±»çš„ç”Ÿæˆæ˜¯å¯é€‰çš„ã€‚MBG å°†ç”Ÿæˆä¸€ä¸ªä¸ MyBatis 3.x æ˜ å°„å™¨åŸºç¡€è®¾æ–½é…åˆä½¿ç”¨çš„æ˜ å°„å™¨æ¥å£</p>
</li>
</ul>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><blockquote>
<p>pom.xml å¼•å…¥é€†å‘å·¥ç¨‹æ’ä»¶ </p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="comment">&lt;!--é€†å‘å·¥ç¨‹ä¾èµ–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--é€†å‘å·¥ç¨‹æ’ä»¶é…ç½®--&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--é€†å‘å·¥ç¨‹æ’ä»¶é…ç½®--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--é€†å‘å·¥ç¨‹çš„æ–‡ä»¶æ¨¡æ¿--&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configurationFile</span>&gt;</span>src/main/resources/generatorConfig.xml<span class="tag">&lt;/<span class="name">configurationFile</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">verbose</span>&gt;</span>true<span class="tag">&lt;/<span class="name">verbose</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">overwrite</span>&gt;</span>true<span class="tag">&lt;/<span class="name">overwrite</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.39<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>å‡†å¤‡é€†å‘å·¥ç¨‹é…ç½®æ–‡ä»¶ src/main/resources/generatorConfig.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">generatorConfiguration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">&quot;MyBatis3&quot;</span> <span class="attr">targetRuntime</span>=<span class="string">&quot;MyBatis3&quot;</span> <span class="attr">defaultModelType</span>=<span class="string">&quot;flat&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é˜²æ­¢xmlè¿½åŠ  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">type</span>=<span class="string">&quot;org.mybatis.generator.plugins.UnmergeableXmlMappersPlugin&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å–æ¶ˆæ‰€æœ‰æ³¨é‡Š --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suppressAllComments&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suppressDate&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span></span></span><br><span class="line"><span class="tag">                <span class="attr">driverClass</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">connectionURL</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/cms_jd2017?characterEncoding=utf8<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=GMT%2B8&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">userId</span>=<span class="string">&quot;root&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">password</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- æŒ‡å®šç”Ÿæˆçš„ç±»å‹ä¸ºjavaç±»å‹ï¼Œé¿å…æ•°æ®åº“ä¸­numberç­‰ç±»å‹å­—æ®µ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;forceBigDecimals&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¹åº”çš„å®ä½“ç±» --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.briup.cms.entity&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;../cms/src/main/java&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--å¯¹åº”çš„XXXMapper.xmlæ–‡ä»¶ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;mapper&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;../cms/src/main/resources&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¹åº”çš„XXXMapper.javaæ–‡ä»¶ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">&quot;XMLMAPPER&quot;</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.briup.cms.mapper&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;../cms/src/main/java&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;cms_%&quot;</span> <span class="attr">enableCountByExample</span>=<span class="string">&quot;false&quot;</span> <span class="attr">enableDeleteByExample</span>=<span class="string">&quot;false&quot;</span> <span class="attr">enableSelectByExample</span>=<span class="string">&quot;false&quot;</span> <span class="attr">enableUpdateByExample</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">domainObjectRenamingRule</span> <span class="attr">searchString</span>=<span class="string">&quot;^Cms&quot;</span> <span class="attr">replaceString</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--&lt;table tableName=&quot;logging&quot; domainObjectName=&quot;LoggingAccessInfo&quot; enableCountByExample=&quot;false&quot; enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;&gt;&lt;/table&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<blockquote>
<p>æ‰§è¡Œé€†å‘å·¥ç¨‹æ’ä»¶</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212134345813.png" alt="image-20211212134345813"></p>
<h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212134504358.png" alt="image-20211212134504358"></p>
<h2 id="æ’å…¥æµ‹è¯•"><a href="#æ’å…¥æµ‹è¯•" class="headerlink" title="æ’å…¥æµ‹è¯•"></a>æ’å…¥æµ‹è¯•</h2><h3 id="main-1"><a href="#main-1" class="headerlink" title="main"></a>main</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.briup.cms.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CmsApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(CmsApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="properties-1"><a href="#properties-1" class="headerlink" title="properties"></a>properties</h3><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è®¾ç½®mybatisæ˜ å°„æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="meta">mybatis.mapper-locations</span>=<span class="string">classpath:/mapper/**/*.xml</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸‰å±‚ç»“æ„è§„èŒƒ  </p>
</blockquote>
<ul>
<li>controller  apiæ¥å£å±‚ å’Œé¡µé¢äº¤äº’</li>
<li>service ä¸šåŠ¡é€»è¾‘å±‚</li>
<li>dao æ•°æ®è®¿é—®å±‚</li>
</ul>
<h3 id="service"><a href="#service" class="headerlink" title="service"></a>service</h3><p>æ¥å£  com.briup.cms.service.UserService</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ’å…¥ç”¨æˆ·</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(User user)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ç°ç±»  com.briup.cms.service.UserServiceImpl</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        userMapper.insert(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;insert&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(User user)</span></span>&#123;</span><br><span class="line">        userService.insert(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h3><p>è®¿é—® <a href="http://localhost:8989/user/insert?username=jack&amp;status=0">http://localhost:8989/user/insert?username=jack&amp;status=0</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212155551100.png" alt="image-20211212155551100"></p>
<h2 id="æŸ¥æ‰¾æµ‹è¯•"><a href="#æŸ¥æ‰¾æµ‹è¯•" class="headerlink" title="æŸ¥æ‰¾æµ‹è¯•"></a>æŸ¥æ‰¾æµ‹è¯•</h2><h3 id="service-1"><a href="#service-1" class="headerlink" title="service"></a>service</h3><p>æ¥å£  com.briup.cms.service.UserService</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ’å…¥ç”¨æˆ·</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="comment">// æŸ¥æ‰¾ç”¨æˆ·è¯¦æƒ…</span></span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ç°ç±»  com.briup.cms.service.UserServiceImpl</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        userMapper.insert(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">findById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.selectByPrimaryKey(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-1"><a href="#controller-1" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="comment">// æ’å…¥ç”¨æˆ·</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;insert&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(User user)</span></span>&#123;</span><br><span class="line">        <span class="comment">// å°†æ¥å‰ç«¯ä¼ ç”¨æˆ·æ•°æ®</span></span><br><span class="line">        userService.insert(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æŸ¥æ‰¾ç”¨æˆ·è¯¦æƒ…</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;info&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">info</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        User user = userService.findById(id);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ•ˆæœ-1"><a href="#æ•ˆæœ-1" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h3><p>è®¿é—® <a href="http://localhost:8989/user/info?id=4">http://localhost:8989/user/info?id=4</a></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;id&quot;</span>: <span class="number">4</span>,</span><br><span class="line">  <span class="attr">&quot;birthday&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;gender&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;image&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;password&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;phone&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;realName&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;registerTime&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;status&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;tom&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;roleId&quot;</span>: <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>é—®é¢˜</code></p>
<ul>
<li>å‚æ•°éƒ½æ˜¯é€šè¿‡?æŸ¥è¯¢å­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥</li>
<li>éƒ½æ˜¯@RequestMappingæ–¹å¼çš„è¯·æ±‚</li>
</ul>
<h2 id="resté£æ ¼"><a href="#resté£æ ¼" class="headerlink" title="resté£æ ¼"></a>resté£æ ¼</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><blockquote>
<p>å¯¹äºå‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼Œå‰åç«¯ä¹‹é—´çš„äº¤äº’å¤§å¤šæ•°æ˜¯é‡‡ç”¨jsonçš„å½¢å¼æ¥ä¼ é€’æ•°æ®ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®çš„å±•ç°å®Œå…¨ç”±å‰ç«¯è´Ÿè´£ï¼Œåç«¯åªéœ€è¦æŠŠæ•°æ®ç›¸å…³çš„æ¥å£æš´éœ²å‡ºæ¥è®©å‰ç«¯å»è¿›è¡Œè¯·æ±‚è°ƒç”¨å³å¯ã€‚</p>
</blockquote>
<p>åœ¨ä¸è€ƒè™‘è§†å›¾å±‚çš„æ•°æ®å±•ç°é—®é¢˜çš„æƒ…å†µä¸‹ï¼Œåç«¯å¯ä»¥åˆ›å»ºå‡ºRSETFulé£æ ¼çš„æ¥å£ï¼Œä¾›å‰ç«¯è¿›è¡Œè°ƒç”¨è®¿é—®ã€‚</p>
<p>RESTï¼ˆRepresentational State Transferï¼‰ï¼Œæ˜¯2000å¹´Roy Fieldingåšå£«åœ¨ä»–çš„åšå£«è®ºæ–‡ä¸­æ‰€æå‡ºçš„ä¸€ç§è½¯ä»¶æ¶æ„æ¨¡å¼ã€‚</p>
<p>RESTå°±æ˜¯ä¸€ç§è®¾è®¡APIçš„æ¨¡å¼ã€‚æœ€å¸¸ç”¨çš„æ•°æ®æ ¼å¼æ˜¯JSONã€‚ç”±äºJSONèƒ½ç›´æ¥è¢«JavaScriptè¯»å–ï¼Œæ‰€ä»¥ï¼Œä»¥JSONæ ¼å¼ç¼–å†™çš„RESTé£æ ¼çš„APIå…·æœ‰ç®€å•ã€æ˜“è¯»ã€æ˜“ç”¨çš„ç‰¹ç‚¹ã€‚</p>
<p><strong>Restæ¶æ„çš„ä¸»è¦åŸåˆ™</strong></p>
<ol>
<li><p>ç³»ç»Ÿä¸­æ‰€æœ‰äº‹ç‰©éƒ½è¢«æŠ½è±¡ä¸ºèµ„æº</p>
</li>
<li><p>æ¯ä¸ªèµ„æºæœ‰å”¯ä¸€çš„èµ„æºæ ‡è¯†ç¬¦</p>
</li>
<li><p>åŒä¸€ä¸ªèµ„æºå…·æœ‰å¤šç§è¡¨ç°å½¢å¼(xml,jsonç­‰)</p>
</li>
<li><p>å¯¹èµ„æºçš„å„ç§æ“ä½œä¸ä¼šæ”¹å˜èµ„æºæ ‡è¯†ç¬¦</p>
</li>
<li><p>æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æ— çŠ¶æ€çš„</p>
</li>
<li><p>ç¬¦åˆRESTåŸåˆ™çš„æ¶æ„æ–¹å¼å³å¯ç§°ä¸ºRESTful</p>
</li>
</ol>
<p><strong>RESTfulçš„webæœåŠ¡æ˜¯ä¸€ç§é¢å‘èµ„æºçš„æ¶æ„è®¾è®¡ï¼ŒROA(The Resource-Oriented Architecture)ã€‚</strong></p>
<p><strong>ä¼ ç»Ÿé£æ ¼æ¥å£ï¼š</strong></p>
<table>
<thead>
<tr>
<th align="center">æ“ä½œ</th>
<th align="center">httpè¯·æ±‚æ–¹æ³•</th>
<th align="center">ä¼ ç»Ÿæ¥å£</th>
</tr>
</thead>
<tbody><tr>
<td align="center">æŸ¥è¯¢</td>
<td align="center">get</td>
<td align="center">/user/getinfo?id=1</td>
</tr>
<tr>
<td align="center">åˆ›å»º</td>
<td align="center">post</td>
<td align="center">/user/create</td>
</tr>
<tr>
<td align="center">ä¿®æ”¹</td>
<td align="center">post</td>
<td align="center">/user/update</td>
</tr>
<tr>
<td align="center">åˆ é™¤</td>
<td align="center">get</td>
<td align="center">/user/delete?id=1</td>
</tr>
</tbody></table>
<p><strong>RESTFulé£æ ¼æ¥å£ï¼š</strong></p>
<table>
<thead>
<tr>
<th align="center">æ“ä½œ</th>
<th align="center">httpè¯·æ±‚æ–¹æ³•</th>
<th align="center">ä¼ ç»Ÿæ¥å£</th>
</tr>
</thead>
<tbody><tr>
<td align="center">æŸ¥è¯¢</td>
<td align="center">get</td>
<td align="center">/user/1</td>
</tr>
<tr>
<td align="center">åˆ›å»º</td>
<td align="center">post</td>
<td align="center">/user</td>
</tr>
<tr>
<td align="center">ä¿®æ”¹</td>
<td align="center">put</td>
<td align="center">/user</td>
</tr>
<tr>
<td align="center">åˆ é™¤</td>
<td align="center">delete</td>
<td align="center">/user/1</td>
</tr>
</tbody></table>
<h3 id="æ”¹é€ "><a href="#æ”¹é€ " class="headerlink" title="æ”¹é€ "></a>æ”¹é€ </h3><blockquote>
<p>ä½¿ç”¨Resté£æ ¼æ”¹é€ UserController</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  æ’å…¥ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     *  ä½¿ç”¨resté£æ ¼ä¼ å‚</span></span><br><span class="line"><span class="comment">     *  å‰ç«¯å‘åç«¯ä¼ é€’jsonæ ¼å¼æ•°æ®,åç«¯å‘å‰ç«¯è¿”å›jsonæ ¼å¼æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;insert&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span></span>&#123;</span><br><span class="line">        <span class="comment">// å°†æ¥å‰ç«¯ä¼ ç”¨æˆ·æ•°æ®</span></span><br><span class="line">        userService.insert(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥æ‰¾ç”¨æˆ·è¯¦æƒ…</span></span><br><span class="line"><span class="comment">     * è®¿é—®è§„åˆ™: http://localhost:8989/user/info/4</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;info/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">info</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        User user = userService.findById(id);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ­¤æ—¶æ³¨æ„æµ‹è¯•æ–¹æ³•</p>
</blockquote>
<p><strong>æµ‹è¯•æŸ¥è¯¢ç”¨æˆ·</strong></p>
<p><a href="http://localhost:8989/user/info/4">http://localhost:8989/user/info/4</a></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;id&quot;</span>: <span class="number">4</span>,</span><br><span class="line">  <span class="attr">&quot;birthday&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;gender&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;image&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;password&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;phone&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;realName&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;registerTime&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;status&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;tom&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;roleId&quot;</span>: <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•æ’å…¥ç”¨æˆ·</strong></p>
<ul>
<li>postè¯·æ±‚</li>
<li>å‚æ•°ä¸ºjson</li>
<li>ä½¿ç”¨RestClientæ’ä»¶/postman</li>
</ul>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212162533779.png" alt="image-20211212162533779"></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ³¨æ„ æœ€æœ‰ä¸€ä¸ªå‚æ•°ä¸è¦å†™,</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;gender&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;vanse&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;phone&quot;</span>: <span class="string">&quot;13500000000&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;realName&quot;</span>: <span class="string">&quot;è€åˆ˜&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;status&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;vanse&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>é—®é¢˜</code></p>
<ul>
<li>å“åº”æ•°æ®æ ¼å¼ä¸è§„èŒƒ<ul>
<li>æ·»åŠ æ²¡æœ‰è¿”å›æ•°æ®</li>
<li>æŸ¥è¯¢è¿”å›äº†ç”¨æˆ·æ•°æ®</li>
</ul>
</li>
</ul>
<h2 id="ç»Ÿä¸€å“åº”"><a href="#ç»Ÿä¸€å“åº”" class="headerlink" title="ç»Ÿä¸€å“åº”"></a>ç»Ÿä¸€å“åº”</h2><h3 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><blockquote>
<p>å‰åç«¯åˆ†ç¦»è§„å®šäº†å“åº”æ ¼å¼æ•°æ®</p>
</blockquote>
<p>æ ¼å¼å¦‚ä¸‹:</p>
<ul>
<li>code çŠ¶æ€ç  200 401 403 415 </li>
<li>msg  æç¤ºæ¶ˆæ¯ â€œæ“ä½œæˆåŠŸâ€ åˆ é™¤æˆåŠŸ  æ·»åŠ æˆåŠŸ</li>
<li>data  æ•°æ®  æŸ¥è¯¢</li>
</ul>
<p><strong>å¯¼å…¥å·¥å…·ç±»</strong></p>
<ul>
<li>Result  å°è£…äº†ç»Ÿä¸€å“åº”ç»“æœ<ul>
<li>code</li>
<li>msg</li>
<li>data</li>
</ul>
</li>
<li>ResultCode ä¸€èˆ¬æ¥è¯´ codeå’Œmsgéƒ½æ˜¯å›ºå®šæ­é… æ‰€ä»¥å°è£…æšä¸¾ç±»<ul>
<li>404 è·¯å¾„é”™è¯¯</li>
<li>401 æœªè®¤è¯</li>
<li>403 æ— æƒé™</li>
<li>500 æœåŠ¡å™¨å¼‚å¸¸</li>
</ul>
</li>
</ul>
<p><strong>com.briup.cms.utils.ResultCode</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»Ÿä¸€å¹¶è‡ªå®šä¹‰è¿”å›çŠ¶æ€ç ï¼Œå¦‚æœ‰éœ€æ±‚å¯ä»¥å¦å¤–å¢åŠ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">ResultCode</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* æˆåŠŸçŠ¶æ€ç  */</span></span><br><span class="line">	SUCCESS(<span class="number">1</span>, <span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* å‚æ•°é”™è¯¯ï¼š10001-19999 */</span></span><br><span class="line">	PARAM_IS_INVALID(<span class="number">10001</span>, <span class="string">&quot;å‚æ•°æ— æ•ˆ&quot;</span>),</span><br><span class="line">	PARAM_IS_BLANK(<span class="number">10002</span>, <span class="string">&quot;å‚æ•°ä¸ºç©º&quot;</span>),</span><br><span class="line">	PARAM_TYPE_BIND_ERROR(<span class="number">10003</span>, <span class="string">&quot;å‚æ•°ç±»å‹é”™è¯¯&quot;</span>),</span><br><span class="line">	PARAM_NOT_COMPLETE(<span class="number">10004</span>, <span class="string">&quot;å‚æ•°ç¼ºå¤±&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* ç”¨æˆ·é”™è¯¯ï¼š20001-29999*/</span></span><br><span class="line">	USER_NOT_LOGIN(<span class="number">20001</span>, <span class="string">&quot;ç”¨æˆ·æœªç™»å½•&quot;</span>),</span><br><span class="line">	USER_LOGIN_ERROR(<span class="number">20002</span>, <span class="string">&quot;è´¦å·ä¸å­˜åœ¨æˆ–å¯†ç é”™è¯¯&quot;</span>),</span><br><span class="line">	USER_ACCOUNT_FORBIDDEN(<span class="number">20003</span>, <span class="string">&quot;è´¦å·å·²è¢«ç¦ç”¨&quot;</span>),</span><br><span class="line">	USER_NOT_EXIST(<span class="number">20004</span>, <span class="string">&quot;ç”¨æˆ·ä¸å­˜åœ¨&quot;</span>),</span><br><span class="line">	USER_HAS_EXISTED(<span class="number">20005</span>, <span class="string">&quot;ç”¨æˆ·å·²å­˜åœ¨&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* ä¸šåŠ¡é”™è¯¯ï¼š30001-39999 */</span></span><br><span class="line">	SPECIFIED_QUESTIONED_USER_NOT_EXIST(<span class="number">30001</span>, <span class="string">&quot;ä¸šåŠ¡é€»è¾‘å‡ºç°é—®é¢˜&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* ç³»ç»Ÿé”™è¯¯ï¼š40001-49999 */</span></span><br><span class="line">	SYSTEM_INNER_ERROR(<span class="number">40001</span>, <span class="string">&quot;ç³»ç»Ÿå†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* æ•°æ®é”™è¯¯ï¼š50001-599999 */</span></span><br><span class="line">	DATA_NONE(<span class="number">50001</span>, <span class="string">&quot;æ•°æ®æœªæ‰¾åˆ°&quot;</span>),</span><br><span class="line">	DATA_WRONG(<span class="number">50002</span>, <span class="string">&quot;æ•°æ®é”™è¯¯&quot;</span>),</span><br><span class="line">	DATA_EXISTED(<span class="number">50003</span>, <span class="string">&quot;æ•°æ®å·²å­˜åœ¨&quot;</span>),</span><br><span class="line">	DATA_USEING(<span class="number">50004</span>,<span class="string">&quot;è¯¥æ•°æ®æ­£åœ¨è¢«å¼•ç”¨&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* æ¥å£é”™è¯¯ï¼š60001-69999 */</span></span><br><span class="line">	INTERFACE_INNER_INVOKE_ERROR(<span class="number">60001</span>, <span class="string">&quot;å†…éƒ¨ç³»ç»Ÿæ¥å£è°ƒç”¨å¼‚å¸¸&quot;</span>),</span><br><span class="line">	INTERFACE_OUTTER_INVOKE_ERROR(<span class="number">60002</span>, <span class="string">&quot;å¤–éƒ¨ç³»ç»Ÿæ¥å£è°ƒç”¨å¼‚å¸¸&quot;</span>),</span><br><span class="line">	INTERFACE_FORBID_VISIT(<span class="number">60003</span>, <span class="string">&quot;è¯¥æ¥å£ç¦æ­¢è®¿é—®&quot;</span>),</span><br><span class="line">	INTERFACE_ADDRESS_INVALID(<span class="number">60004</span>, <span class="string">&quot;æ¥å£åœ°å€æ— æ•ˆ&quot;</span>),</span><br><span class="line">	INTERFACE_REQUEST_TIMEOUT(<span class="number">60005</span>, <span class="string">&quot;æ¥å£è¯·æ±‚è¶…æ—¶&quot;</span>),</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* æƒé™é”™è¯¯ï¼š70001-79999 */</span></span><br><span class="line">	PERMISSION_NO_ACCESS(<span class="number">70001</span>, <span class="string">&quot;æ— è®¿é—®æƒé™&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Integer code;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">	ResultCode(Integer code, String message) &#123;</span><br><span class="line">		<span class="keyword">this</span>.code = code;</span><br><span class="line">		<span class="keyword">this</span>.message = message;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">code</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.code;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">message</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.message;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>com.briup.cms.utils.Result</strong>  </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»Ÿä¸€Controllerä¸­RESTFulé£æ ¼æ¥å£è¿”å›çš„ç»“æœ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Result</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Integer code;</span><br><span class="line">	<span class="keyword">private</span> String msg;</span><br><span class="line">	<span class="keyword">private</span> Object data;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">Result</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">Result</span><span class="params">(Integer code, String msg)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.code = code;</span><br><span class="line">		<span class="keyword">this</span>.msg = msg;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setResultCode</span><span class="params">(ResultCode code)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.code = code.code();</span><br><span class="line">		<span class="keyword">this</span>.msg = code.message();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æ“ä½œå¤±è´¥ï¼Œè‡ªå®šä¹‰codeå’Œmsg</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">failure</span><span class="params">(Integer code, String msg)</span> </span>&#123;</span><br><span class="line">		Result result = <span class="keyword">new</span> Result(code,msg);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æ“ä½œæˆåŠŸï¼Œæ²¡æœ‰è¿”å›çš„æ•°æ®</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">success</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Result result = <span class="keyword">new</span> Result();</span><br><span class="line">		result.setResultCode(ResultCode.SUCCESS); <span class="comment">// 1 s</span></span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æ“ä½œæˆåŠŸï¼Œæœ‰è¿”å›çš„æ•°æ®</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">success</span><span class="params">(Object data)</span> </span>&#123;</span><br><span class="line">		Result result = <span class="keyword">new</span> Result();</span><br><span class="line">		result.setResultCode(ResultCode.SUCCESS);</span><br><span class="line">		result.setData(data);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æ“ä½œå¤±è´¥ï¼Œæ²¡æœ‰è¿”å›çš„æ•°æ®</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">failure</span><span class="params">(ResultCode resultCode)</span> </span>&#123;</span><br><span class="line">		Result result = <span class="keyword">new</span> Result();</span><br><span class="line">		result.setResultCode(resultCode);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æ“ä½œå¤±è´¥ï¼Œæœ‰è¿”å›çš„æ•°æ®</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">failure</span><span class="params">(ResultCode resultCode, Object data)</span> </span>&#123;</span><br><span class="line">		Result result = <span class="keyword">new</span> Result();</span><br><span class="line">		result.setResultCode(resultCode);</span><br><span class="line">		result.setData(data);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æ”¹é€ -1"><a href="#æ”¹é€ -1" class="headerlink" title="æ”¹é€ "></a>æ”¹é€ </h3><blockquote>
<p>ä½¿ç”¨ç»Ÿä¸€å“åº” æ”¹é€ UserController</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  æ’å…¥ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     *  ä½¿ç”¨resté£æ ¼ä¼ å‚</span></span><br><span class="line"><span class="comment">     *  å‰ç«¯å‘åç«¯ä¼ é€’jsonæ ¼å¼æ•°æ®,åç«¯å‘å‰ç«¯è¿”å›jsonæ ¼å¼æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;insert&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">insert</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span></span>&#123;</span><br><span class="line">        <span class="comment">// å°†æ¥å‰ç«¯ä¼ ç”¨æˆ·æ•°æ®</span></span><br><span class="line">        userService.insert(user);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥æ‰¾ç”¨æˆ·è¯¦æƒ…</span></span><br><span class="line"><span class="comment">     * è®¿é—®è§„åˆ™: http://localhost:8989/user/info/4</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;info/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">info</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        User user = userService.findById(id);</span><br><span class="line">        <span class="keyword">return</span> Result.success(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>æµ‹è¯•æŸ¥è¯¢ <a href="http://localhost:8989/user/info/4">http://localhost:8989/user/info/4</a></strong></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;code&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;msg&quot;</span>: <span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;data&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;id&quot;</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="attr">&quot;birthday&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;gender&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;image&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;password&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;phone&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;realName&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;registerTime&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;status&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;tom&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;roleId&quot;</span>: <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•æ’å…¥</strong></p>
<ul>
<li><a href="http://localhost:8989/user/insert">http://localhost:8989/user/insert</a></li>
<li>post</li>
<li>Content-Type: application/json</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>:<span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;msg&quot;</span>:<span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>:<span class="keyword">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code> é—®é¢˜</code></p>
<ul>
<li>å¦‚æœå‡ºç°äº†å¼‚å¸¸,ç»Ÿä¸€å“åº”æ ¼å¼å°†å¤±æ•ˆ</li>
<li>å¹¶ä¸”é¡µé¢å‡ºç°å †ç Œé”™è¯¯æ•°æ®</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="meta">@GetMapping(&quot;info/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="comment">// æ‰‹åŠ¨æ¨¡æ‹Ÿå¼‚å¸¸ æ¨¡æ¿åªèƒ½æ˜ å°„ids</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Result <span class="title">info</span><span class="params">(<span class="meta">@PathVariable(&quot;ids&quot;)</span> <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        User user = userService.findById(id);</span><br><span class="line">       <span class="keyword">return</span> Result.success(user);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212172552207.png" alt="image-20211212172552207"></p>
<h2 id="å…¨å±€å¼‚å¸¸å¤„ç†"><a href="#å…¨å±€å¼‚å¸¸å¤„ç†" class="headerlink" title="å…¨å±€å¼‚å¸¸å¤„ç†"></a>å…¨å±€å¼‚å¸¸å¤„ç†</h2><blockquote>
<p>ä½¿ç”¨aop å°†å¼‚å¸¸å…¨å±€å¤„ç† å¹¶åŒæ ·è¿”å›ç»Ÿä¸€å“åº”(å“åº”é”™è¯¯æ•°æ®)</p>
</blockquote>
<p><strong>com.briup.cms.exception.GlobelException</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobelExceptionHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">handlerException</span><span class="params">(Exception e)</span></span>&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">         <span class="keyword">return</span> Result.failure(<span class="number">500</span>,<span class="string">&quot;åå°æ¥å£å¼‚å¸¸: &quot;</span>+e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç»§ç»­æµ‹è¯• <a href="http://localhost:8989/user/info/-1">http://localhost:8989/user/info/-1</a></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;code&quot;</span>: <span class="number">500</span>,</span><br><span class="line">  <span class="attr">&quot;msg&quot;</span>: <span class="string">&quot;åå°æ¥å£å¼‚å¸¸&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;data&quot;</span>: <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>åˆšåˆšæ¨¡æ‹Ÿçš„æ˜¯ç³»ç»Ÿå¼‚å¸¸,å±äºéå¯æ§æƒ…å†µ,å¯ä»¥è‡ªå®šä¹‰å¼‚å¸¸,å¹¶è¿”å›å‹å¥½æç¤º</strong></p>
<p><strong>com.briup.cms.exception.CustomerException</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="keyword">private</span> ResultCode resultCode;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomerException</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomerException</span><span class="params">(ResultCode resultCode)</span> </span>&#123;</span><br><span class="line">        message = resultCode.message();</span><br><span class="line">        <span class="keyword">this</span>.resultCode = resultCode;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åœ¨UsreServiceImplä¸­æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> User <span class="title">findById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span>(id &lt;= <span class="number">0</span>)&#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.PARAM_IS_INVALID);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> userMapper.selectByPrimaryKey(id);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<p>ç»§ç»­æµ‹è¯• <a href="http://localhost:8989/user/info/-1">http://localhost:8989/user/info/-1</a></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;code&quot;</span>: <span class="number">10001</span>,</span><br><span class="line">  <span class="attr">&quot;msg&quot;</span>: <span class="string">&quot;å‚æ•°æ— æ•ˆ&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;data&quot;</span>: <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212173448522.png" alt="image-20211212173448522"></p>
<p><code>é—®é¢˜</code></p>
<ul>
<li><p>åç«¯æµ‹è¯•è¾ƒéº»çƒ¦ å°¤å…¶æ˜¯postè¯·æ±‚,jsonç­‰æ ¼å¼</p>
</li>
<li><p>å‰åç«¯åˆ†ç¦»çš„æƒ…å†µä¸‹ å‰ç«¯å¦‚ä½•çŸ¥é“åå°çš„æ¥å£è·¯å¾„å»æµ‹è¯•å¹¶å¯¹æ¥é¡µé¢å‘¢?</p>
</li>
</ul>
<h2 id="swagger"><a href="#swagger" class="headerlink" title="swagger"></a>swagger</h2><h3 id="æ¦‚è¿°-2"><a href="#æ¦‚è¿°-2" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><blockquote>
<p>é¡¹ç›®é‡‡ç”¨å‰åå°åˆ†ç¦»çš„æ¶æ„è¿›è¡Œå¼€å‘ï¼Œåå°å¯ä»¥ä½¿ç”¨Swaggerï¼Œç”Ÿæˆåœ¨çº¿APIæ–‡æ¡£ï¼Œæ–¹ä¾¿å‰ç«¯äººå‘˜å¯¹æ¥ä½¿ç”¨</p>
</blockquote>
<p><code>Swagger </code>æ˜¯ä¸€ä¸ªè§„èŒƒå’Œå®Œæ•´çš„æ¡†æ¶ï¼Œç”¨äºç”Ÿæˆã€æè¿°ã€è°ƒç”¨å’Œå¯è§†åŒ– RESTful é£æ ¼çš„ Web æœåŠ¡ã€‚</p>
<p><a href="https://swagger.io/">Swaggerå®˜ç½‘</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211110235217141.png" alt="image-20211110235217141"></p>
<p><a href="https://petstore.swagger.io/?_ga=2.236238660.419502645.1636559508-49422942.1636559508">é…ç½®ç”Ÿæˆçš„åœ¨çº¿APIæ–‡æ¡£æ ·ä¾‹ï¼š</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211110235430680.png" alt="image-20211110235430680"></p>
<p><code>springfox </code>ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„API Docçš„æ¡†æ¶ï¼Œ å®ƒçš„å‰èº«æ˜¯swagger-springmvcï¼Œå¯ä»¥å°†æˆ‘ä»¬çš„Controllerä¸­<br>çš„æ–¹æ³•ä»¥æ–‡æ¡£çš„å½¢å¼å±•ç°ã€‚</p>
<p><a href="http://springfox.github.io/springfox/">springfoxå®˜ç½‘</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211110235736768.png" alt="image-20211110235736768"></p>
<p><code>springfox-swagger2 </code>ï¼Œå®ƒæ˜¯æ•´åˆspringmvcå’Œswagger2çš„ä¸€ä¸ªé¡¹ç›®ï¼Œé¡¹ç›®ä¸­ä½¿ç”¨swaggeræ—¶ï¼Œè¦å¼•å…¥å®ƒ<br>çš„<a href="https://mvnrepository.com/artifact/io.springfox/springfox-swagger2">ä¾èµ–</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211110235947547.png" alt="image-20211110235947547"></p>
<h3 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p><strong>å¼•å…¥swaggerä¾èµ–</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- swagger-uiä¾èµ–--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--swaggerä¾èµ– --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.swagger<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-models<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.swagger<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-models<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>é…ç½®swagger</strong></p>
<p>com.briup.cms.config.Swagger2Config</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Swagger2Config</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212174208946.png" alt="image-20211212174208946"></p>
<p><code>é—®é¢˜</code></p>
<ul>
<li>é™¤UserController,è¿˜æ˜¾ç¤ºäº†é»˜è®¤æ¥å£</li>
<li>é¡µé¢è‡ªå®šä¹‰ä¿¡æ¯</li>
</ul>
<p><strong>æ”¹é€ Swagger2Config</strong></p>
<p> è‡ªå®šä¹‰æ‰«ææ¥å£è·¯å¾„</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Swagger2Config</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// é…ç½®swagger2ç±»å‹ è·å–apiæ„å»ºå™¨</span></span><br><span class="line">        <span class="comment">// æ‰«æçš„åŒ… åŒ…ä¸‹çš„è·¯å¾„</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.briup.cms.controller&quot;</span>)) <span class="comment">// é‚£äº›åŒ…éœ€è¦æ‰«æ</span></span><br><span class="line">                .paths(PathSelectors.any())  <span class="comment">// åŒ…ä¸‹çš„é‚£äº›è·¯å¾„éœ€è¦æ‰«æ</span></span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶é¡µé¢åªä¼šæ‰«æcontrolleræ¥å£</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212205921161.png" alt="image-20211212205921161"></p>
<p>é¡µé¢æ˜¾ç¤ºè‡ªå®šä¹‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Swagger2Config</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// é…ç½®swagger2ç±»å‹ è·å–apiæ„å»ºå™¨</span></span><br><span class="line">        <span class="comment">// æ‰«æçš„åŒ… åŒ…ä¸‹çš„è·¯å¾„</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo()) <span class="comment">// å¼•ç”¨è‡ªå®šä¹‰æ–¹æ³•apiInfo()</span></span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.briup.cms.controller&quot;</span>)) <span class="comment">// é‚£äº›åŒ…éœ€è¦æ‰«æ</span></span><br><span class="line">                .paths(PathSelectors.any())  <span class="comment">// åŒ…ä¸‹çš„é‚£äº›è·¯å¾„éœ€è¦æ‰«æ</span></span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// public static final ApiInfo DEFAULT = new ApiInfo(&quot;Api Documentation&quot;, &quot;Api Documentation&quot;, &quot;1.0&quot;, &quot;urn:tos&quot;,</span></span><br><span class="line"><span class="comment">//          DEFAULT_CONTACT, &quot;Apache 2.0&quot;, &quot;http://www.apache.org/licenses/LICENSE-2.0&quot;, new ArrayList&lt;VendorExtension&gt;());</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">                .title(<span class="string">&quot;cms&quot;</span>)</span><br><span class="line">                .description(<span class="string">&quot;çœ‹ç‚¹å’¨è¯¢ç³»ç»Ÿ(å®¿å·å­¦é™¢)&quot;</span>)</span><br><span class="line">                .version(<span class="string">&quot;1.0&quot;</span>)</span><br><span class="line">                .contact(<span class="keyword">new</span> Contact(<span class="string">&quot;briup&quot;</span>,<span class="string">&quot;http://www.briup.com&quot;</span>,<span class="string">&quot;wangsidandan@gmail.com&quot;</span>))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212210135861.png" alt="image-20211212210135861"></p>
<p><code>é—®é¢˜</code></p>
<p>å‰ç«¯èƒ½å¦çœ‹æ‡‚swaggerçš„é…ç½®ä»¥åŠå¦‚ä½•ä¼ å‚</p>
<h3 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h3><p><code>@Api</code> ï¼Œç”¨æ¥æŒ‡å®šå½“å‰APIæ¨¡å—çš„åç§°<br><code>@ApiOperation </code>ï¼Œç”¨æ¥è®¾ç½®APIæ–¹æ³•çš„ç®€ä»‹è¯´æ˜<br><code>@ApiImplicitParams</code> ï¼Œç”¨æ¥è®¾ç½®APIæ–¹æ³•çš„å‚æ•°ï¼Œå¯ä»¥æœ‰å¤šä¸ªå‚æ•°<br><code>@ApiImplicitParam </code>ï¼Œç”¨æ¥è®¾ç½®ä¸€ä¸ªå‚æ•°çš„è¯¦ç»†ä¿¡æ¯</p>
<ul>
<li>nameï¼Œå‚æ•°çš„åç§°</li>
<li>valueï¼Œå‚æ•°çš„ä»‹ç»</li>
<li>dataTypeï¼Œå‚æ•°çš„æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚String</li>
<li>requiredï¼Œæ˜¯å¦ä¸ºå¿…é¡»å‚æ•°</li>
<li>defaultValueï¼Œé»˜è®¤å¡«å…¥è¾“å…¥æ¡†çš„å€¼</li>
<li>paramTypeï¼Œå‚æ•°çš„ç±»å‹ï¼š<ul>
<li>path    /user/{id} </li>
<li>query /user?id=</li>
<li>body æ­£æ–‡</li>
<li>header è¯·æ±‚å¤´</li>
<li>form è¯·æ±‚è¡¨å•</li>
</ul>
</li>
</ul>
<p><code>@ApiModel</code></p>
<ul>
<li>æ”¾åœ¨Beanä¸Š</li>
<li>è¯¥æ³¨è§£è¦é…åˆpostè¯·æ±‚,@RequestBodyæ‰èƒ½ç”Ÿæ•ˆ</li>
<li>ä½œç”¨ä¸ºç»™modelè§£é‡Š</li>
<li>æ­é… @ApiModelPropertyä¸€èµ·ä½¿ç”¨</li>
</ul>
<p><code>ApiModelProperty</code></p>
<ul>
<li>æ”¾åœ¨å±æ€§ä¸Š</li>
</ul>
<h3 id="æ”¹é€ -2"><a href="#æ”¹é€ -2" class="headerlink" title="æ”¹é€ "></a>æ”¹é€ </h3><p><strong>UserController</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;user&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;ç”¨æˆ·æ¨¡å—&quot;)</span> <span class="comment">//åŒºåˆ†æ¨¡å—</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  æ’å…¥ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     *  ä½¿ç”¨resté£æ ¼ä¼ å‚</span></span><br><span class="line"><span class="comment">     *  å‰ç«¯å‘åç«¯ä¼ é€’jsonæ ¼å¼æ•°æ®,åç«¯å‘å‰ç«¯è¿”å›jsonæ ¼å¼æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;æ·»åŠ ç”¨æˆ·&quot;,notes = &quot;jsonä¼ å‚&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;insert&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">insert</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span></span>&#123;</span><br><span class="line">        <span class="comment">// å°†æ¥å‰ç«¯ä¼ ç”¨æˆ·æ•°æ®</span></span><br><span class="line">        userService.insert(user);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥æ‰¾ç”¨æˆ·è¯¦æƒ…</span></span><br><span class="line"><span class="comment">     * è®¿é—®è§„åˆ™: http://localhost:8989/user/info/4</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;æŸ¥çœ‹ç”¨æˆ·è¯¦æƒ…&quot;,notes = &quot;restä¼ å‚ ç”¨æˆ·id&quot;)</span></span><br><span class="line">    <span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">            @ApiImplicitParam(name = &quot;id&quot;,value = &quot;ç”¨æˆ·id&quot;,required = true,dataType = &quot;int&quot;,paramType = &quot;path&quot;)</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;info/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">info</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        User user = userService.findById(id);</span><br><span class="line">        <span class="keyword">return</span> Result.success(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>User</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiModel(&quot;ç”¨æˆ·æ¨¡å‹&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;id&quot;,value = &quot;ç”¨æˆ·id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">  <span class="meta">@ApiModelProperty(name = &quot;birthday&quot;,value = &quot;ç”¨æˆ·ç”Ÿæ—¥&quot;,example = &quot;2000-01-01 00:00:00&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;gender&quot;,value = &quot;ç”¨æˆ·æ€§åˆ«&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;image&quot;,value = &quot;ç”¨æˆ·å¤´åƒ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String image;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;password&quot;,value = &quot;ç”¨æˆ·å¯†ç &quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;phone&quot;,value = &quot;ç”¨æˆ·ç”µè¯&quot;,example = &quot;13500000000&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;realName&quot;,value = &quot;çœŸå®å§“å&quot;,example = &quot;tom&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String realName;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;registerTime&quot;,value = &quot;ç”¨æˆ·id&quot;,hidden = true)</span></span><br><span class="line">    <span class="keyword">private</span> Date registerTime;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;status&quot;,value = &quot;ç”¨æˆ·çŠ¶æ€ æœ‰é»˜è®¤å€¼&quot;,example = &quot;0&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;username&quot;,value = &quot;ç”¨æˆ·å§“å&quot;,example = &quot;è¿½é£å°‘å¹´&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;roleId&quot;,value = &quot;è§’è‰²id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer roleId;</span><br><span class="line">     <span class="comment">//,,, çœç•¥get/set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨å†Œæ—¶æœ‰äº›æ•°æ®ä¸èƒ½è®©ç”¨æˆ·å¡«å†™,å¦‚ç”¨æˆ·çŠ¶æ€(é»˜è®¤å¯ç”¨),æ³¨å†Œæ—¶é—´ç­‰</p>
</blockquote>
<p><strong>æ”¹é€ UserServiceImpl</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">       user.setStatus(<span class="number">0</span>);</span><br><span class="line">       user.setRegisterTime(<span class="keyword">new</span> Date());</span><br><span class="line">       userMapper.insert(user);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212212819571.png" alt="image-20211212212819571"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212212849088.png" alt="image-20211212212849088"></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;birthday&quot;</span>: <span class="string">&quot;2000-01-01 08:00:00&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;gender&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;phone&quot;</span>: <span class="number">13500000000</span>,</span><br><span class="line">  <span class="attr">&quot;realName&quot;</span>: <span class="string">&quot;tom&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;è¿½é£å°‘å¹´&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>è‡³æ­¤,æ¶æ„æ­å»ºå®Œæˆ  å¯ä»¥ä¸“æ³¨è‡ªå·±çš„ä¸šåŠ¡æ¨¡å— ä»controller åˆ° service åˆ°dao</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211212213127484.png" alt="image-20211212213127484"></p>
<h1 id="ç”¨æˆ·æ¨¡å—"><a href="#ç”¨æˆ·æ¨¡å—" class="headerlink" title="ç”¨æˆ·æ¨¡å—"></a>ç”¨æˆ·æ¨¡å—</h1><h2 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="==æ¥å£=="></a>==æ¥å£==</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ’å…¥ç”¨æˆ·</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="comment">// æŸ¥æ‰¾ç”¨æˆ·è¯¦æƒ…(å›æ˜¾æ•°æ®)</span></span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="comment">//åˆ†é¡µè·å–æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="function">PageUtil&lt;User&gt; <span class="title">getAll</span><span class="params">(PageUtil&lt;User&gt; page)</span></span>;</span><br><span class="line">    <span class="comment">//æ›´æ–°å­¦ç”Ÿä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="comment">// åˆ é™¤å•ä¸ªç”¨æˆ·</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">    <span class="comment">//æ‰¹é‡åˆ é™¤ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteUserInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span></span>;</span><br><span class="line">    <span class="comment">//ä¿®æ”¹ç”¨æˆ·çš„çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateUserStatus</span><span class="params">(Integer id,Integer status)</span></span>;</span><br><span class="line">    <span class="comment">//ç™»å½•</span></span><br><span class="line">    <span class="function">User <span class="title">login</span><span class="params">(String username,String password)</span></span>;</span><br><span class="line">    <span class="comment">//æ ¹æ®ç”¨æˆ·åè·å–ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="function">User <span class="title">findUserByUsername</span><span class="params">(String username)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ–°å¢"><a href="#æ–°å¢" class="headerlink" title="æ–°å¢"></a>æ–°å¢</h2><p><a href="#%E6%8F%92%E5%85%A5%E6%B5%8B%E8%AF%95">æ’å…¥æµ‹è¯•</a>å·²å®Œæˆ è¡¥å……æ’å…¥çš„ç»†èŠ‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ç”¨æˆ·åå’Œå¯†ç ä¸èƒ½ä¸ºç©º</span></span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.hasText(user.getUsername()) || !StringUtils.hasText(user.getPassword()))&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.PARAM_IS_BLANK);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç”¨æˆ·åä¸èƒ½é‡å¤</span></span><br><span class="line">        User userFromDB = findUserByUsername(user.getUsername());</span><br><span class="line">        <span class="keyword">if</span>(userFromDB != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_EXISTED);</span><br><span class="line">        &#125;</span><br><span class="line">        user.setStatus(<span class="number">0</span>);</span><br><span class="line">        user.setRegisterTime(<span class="keyword">new</span> Date());</span><br><span class="line">        userMapper.insert(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">findUserByUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userExtendMapper.findUserByUsername(username);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p><strong>com.briup.cms.mapper.extend.UserExtendMapper</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserExtendMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">User <span class="title">findUserByUsername</span><span class="params">(String username)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>src/mapper/extend/UserExtendMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.cms.mapper.extend.UserExtendMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findUserByUsername&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.briup.cms.entity.User&quot;</span>&gt;</span></span><br><span class="line">        select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.UserMapper.Base_Column_List&quot;</span>/&gt;</span> from cms_user</span><br><span class="line">        where username = #&#123;username&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;birthday&quot;</span>: <span class="string">&quot;2000-01-01 00:00:00&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;gender&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;phone&quot;</span>: <span class="number">13500000000</span>,</span><br><span class="line">  <span class="attr">&quot;realName&quot;</span>: <span class="string">&quot;tom&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;è¿½é£å°‘å¹´8&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ†é¡µæŸ¥è¯¢"><a href="#åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h2><h3 id="utils"><a href="#utils" class="headerlink" title="utils"></a>utils</h3><p>com.briup.cms.utils.PageUtil</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(&quot;åˆ†é¡µæ¨¡å‹&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageUtil</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰é¡µ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;pageNumber&quot;,value = &quot;å½“å‰é¡µ&quot;,example = &quot;1&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer pageNumber;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯é¡µæ¡æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;pageSize&quot;,value = &quot;æ¯é¡µæ•°é‡&quot;,example = &quot;5&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer pageSize;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€»æ¡æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(hidden = true)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> total;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(hidden = true)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; list;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœç´¢æ¡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;params&quot;,value = &quot;æŸ¥è¯¢æ¡ä»¶&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;(<span class="number">8</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="mapper"><a href="#mapper" class="headerlink" title="mapper"></a>mapper</h3><p>com.briup.cms.mapper.extend.UserExtendMapper</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserExtendMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">User <span class="title">findUserByUsername</span><span class="params">(String username)</span></span>;</span><br><span class="line">    <span class="function">Page&lt;User&gt; <span class="title">getAll</span><span class="params">()</span></span>; <span class="comment">// è¿”å›PageHelperå¸¦çš„åˆ†é¡µPage</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>src/mapper/extend/UserExtendMapper.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;com.briup.cms.mapper.UserMapper.BaseResultMap&quot;</span>&gt;</span></span><br><span class="line">        select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.UserMapper.Base_Column_List&quot;</span>/&gt;</span> from cms_user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="service-2"><a href="#service-2" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PageUtil&lt;User&gt; <span class="title">getAll</span><span class="params">(PageUtil&lt;User&gt; pageUtil)</span> </span>&#123;</span><br><span class="line">        PageHelper.startPage(pageUtil.getPageNumber(),pageUtil.getPageSize());</span><br><span class="line">        Page all = userExtendMapper.getAll();</span><br><span class="line">        pageUtil.setList(all.getResult());</span><br><span class="line">        pageUtil.setTotal(all.getTotal());</span><br><span class="line">        <span class="keyword">return</span> pageUtil;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-2"><a href="#controller-2" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;åˆ†é¡µæŸ¥æ‰¾ç”¨æˆ·&quot;, notes = &quot;æä¾›åˆ†é¡µæ¡ä»¶&quot;)</span></span><br><span class="line">   <span class="meta">@PostMapping(&quot;findByPage&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Result <span class="title">findByPage</span><span class="params">(<span class="meta">@RequestBody</span> PageUtil&lt;User&gt; pageUtil)</span> </span>&#123;</span><br><span class="line">       pageUtil= userService.getAll(pageUtil);</span><br><span class="line">       <span class="keyword">return</span> Result.success(pageUtil);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ•ˆæœ-2"><a href="#æ•ˆæœ-2" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h3><p><strong>è¯·æ±‚</strong></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;pageNumber&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;pageSize&quot;</span>: <span class="number">5</span>,</span><br><span class="line">  <span class="attr">&quot;params&quot;</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>PageHelplerä»ç¬¬1é¡µå¼€å§‹åˆ†é¡µ</code></p>
<p><strong>ç»“æœ</strong></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;code&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;msg&quot;</span>: <span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;data&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;pageNumber&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;pageSize&quot;</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="attr">&quot;total&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">&quot;list&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">&quot;birthday&quot;</span>: <span class="string">&quot;2000-01-01T00:00:00.000+00:00&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;gender&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;phone&quot;</span>: <span class="string">&quot;13500000000&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;realName&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;registerTime&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;status&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;è¿½é£å°‘å¹´&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;roleId&quot;</span>: <span class="literal">null</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">&quot;birthday&quot;</span>: <span class="string">&quot;2000-01-01T00:00:00.000+00:00&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;gender&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;phone&quot;</span>: <span class="string">&quot;13500000000&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;realName&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;registerTime&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;status&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;è¿½é£å°‘å¹´2&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;roleId&quot;</span>: <span class="literal">null</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;params&quot;</span>: &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>æ—¶é—´æ ¼å¼æœ‰é—®é¢˜</code></p>
<p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">spring.jackson.date-format</span>=<span class="string">yyyy-MM-dd HH:mm:ss</span></span><br><span class="line"><span class="meta">spring.jackson.time-zone</span>=<span class="string">GMT+8</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">       <span class="attr">&quot;id&quot;</span>: <span class="number">12</span>,</span><br><span class="line">       <span class="attr">&quot;birthday&quot;</span>: <span class="string">&quot;2000-01-01 08:00:00&quot;</span>,</span><br><span class="line">       <span class="attr">&quot;gender&quot;</span>: <span class="number">0</span>,</span><br><span class="line">       <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">       <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">       <span class="attr">&quot;phone&quot;</span>: <span class="string">&quot;13500000000&quot;</span>,</span><br><span class="line">       <span class="attr">&quot;realName&quot;</span>: <span class="string">&quot;tom&quot;</span>,</span><br><span class="line">       <span class="attr">&quot;registerTime&quot;</span>: <span class="string">&quot;2021-12-13 12:18:55&quot;</span>,</span><br><span class="line">       <span class="attr">&quot;status&quot;</span>: <span class="number">0</span>,</span><br><span class="line">       <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;è¿½é£å°‘å¹´3&quot;</span>,</span><br><span class="line">       <span class="attr">&quot;roleId&quot;</span>: <span class="literal">null</span></span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>



<h2 id="å›æ˜¾"><a href="#å›æ˜¾" class="headerlink" title="å›æ˜¾"></a>å›æ˜¾</h2><p><a href="#%E6%9F%A5%E6%89%BE%E6%B5%8B%E8%AF%95">æŸ¥æ‰¾æµ‹è¯•</a>å·²å®Œæˆ å°†æ¥å¯çº§è”æ‰€å±è§’è‰²</p>
<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><h3 id="service-3"><a href="#service-3" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// çº¦å®šåå­—ä¸å¯ä»¥ä¿®æ”¹ é¡µé¢ç›´æ¥ç¦ç”¨ç»„ä»¶å³å¯,å¦åˆ™ä¼šå‡ºç°å’Œæ•°æ®åº“åŒå</span></span><br><span class="line">        <span class="comment">// æˆ–è€…åšæ•°æ®åŒ¹é…åˆ¤æ–­</span></span><br><span class="line">        userMapper.updateByPrimaryKeySelective(user);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-3"><a href="#controller-3" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;ä¿®æ”¹ç”¨æˆ·&quot;, notes = &quot;jsonä¼ å‚&quot;)</span></span><br><span class="line">    <span class="meta">@PutMapping(&quot;update&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">update</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å°†æ¥å‰ç«¯ä¼ ç”¨æˆ·æ•°æ®</span></span><br><span class="line">        userService.update(user);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;birthday&quot;</span>: <span class="string">&quot;2000-01-01 00:00:00&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;gender&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;id&quot;</span>: <span class="number">17</span>,</span><br><span class="line">  <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;000&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;phone&quot;</span>: <span class="number">13500000000</span>,</span><br><span class="line">  <span class="attr">&quot;realName&quot;</span>: <span class="string">&quot;è€åˆ˜&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;status&quot;</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ›´æ–°ç”¨æˆ·çŠ¶æ€"><a href="#æ›´æ–°ç”¨æˆ·çŠ¶æ€" class="headerlink" title="æ›´æ–°ç”¨æˆ·çŠ¶æ€"></a>æ›´æ–°ç”¨æˆ·çŠ¶æ€</h2><h3 id="service-4"><a href="#service-4" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUserStatus</span><span class="params">(Integer id, Integer status)</span> </span>&#123;</span><br><span class="line">        User temp = <span class="keyword">new</span> User();</span><br><span class="line">        temp.setId(id);</span><br><span class="line">        temp.setStatus(status);</span><br><span class="line">        userMapper.updateByPrimaryKeySelective(temp);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-4"><a href="#controller-4" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;å°†ç”¨æˆ·ç¦ç”¨&quot;, notes = &quot;restä¼ å‚&quot;)</span></span><br><span class="line">    <span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">            @ApiImplicitParam(name = &quot;id&quot;, value = &quot;ç”¨æˆ·id&quot;, required = true, dataType = &quot;int&quot;, paramType = &quot;path&quot;),</span></span><br><span class="line"><span class="meta">            @ApiImplicitParam(name = &quot;status&quot;, value = &quot;ç”¨æˆ·çŠ¶æ€&quot;, required = true, dataType = &quot;int&quot;, paramType = &quot;path&quot;)</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    <span class="meta">@PutMapping(&quot;updateStatus/&#123;id&#125;/&#123;status&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">updateStatus</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id,<span class="meta">@PathVariable(&quot;status&quot;)</span> <span class="keyword">int</span> status)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å°†æ¥å‰ç«¯ä¼ ç”¨æˆ·æ•°æ®</span></span><br><span class="line">        userService.updateUserStatus(id,status);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211213151028757.png" alt="image-20211213151028757"></p>
<h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><h3 id="service-5"><a href="#service-5" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">       userMapper.deleteByPrimaryKey(id);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-5"><a href="#controller-5" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;åˆ é™¤å•ä¸ªç”¨æˆ·&quot;,notes = &quot;resté£æ ¼&quot;)</span></span><br><span class="line">    <span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">            @ApiImplicitParam(name = &quot;id&quot;, value = &quot;ç”¨æˆ·id&quot;, required = true, dataType = &quot;int&quot;, paramType = &quot;path&quot;)</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/delete/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">deleteBatch</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        userService.deleteById(id);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ‰¹é‡åˆ é™¤"><a href="#æ‰¹é‡åˆ é™¤" class="headerlink" title="æ‰¹é‡åˆ é™¤"></a>æ‰¹é‡åˆ é™¤</h2><h3 id="mapper-1"><a href="#mapper-1" class="headerlink" title="mapper"></a>mapper</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUserInBatch&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">        delete from cms_user</span><br><span class="line">        where id in</span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">item</span>=<span class="string">&quot;id&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> &gt;</span></span><br><span class="line">            #&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="service-6"><a href="#service-6" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUserInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å¾ªç¯è°ƒç”¨sql</span></span><br><span class="line">        <span class="comment">//ids.forEach(id -&gt; userMapper.deleteByPrimaryKey(id));</span></span><br><span class="line">        <span class="comment">// æ‰¹é‡è°ƒç”¨sql</span></span><br><span class="line">       userExtendMapper.deleteUserInBatch(ids);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-6"><a href="#controller-6" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ‰¹é‡åˆ é™¤&quot;,notes = &quot;éœ€è¦ä¼ é€’å¤šä¸ªid&quot;)</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/deleteBatch&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">deleteBatch</span><span class="params">(<span class="meta">@ApiParam(value = &quot;æ‰¹é‡id&quot;)</span><span class="meta">@RequestBody</span> List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// @ApiParam é»˜è®¤æ˜¯jsonæ ¼å¼</span></span><br><span class="line">        userService.deleteUserInBatch(ids);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">  <span class="number">18</span>,<span class="number">19</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>



<h2 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h2><h3 id="vo"><a href="#vo" class="headerlink" title="vo"></a>vo</h3><p>com.briup.cms.vo.UserVo</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserVo</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;username&quot;,value = &quot;ç”¨æˆ·å&quot;,example = &quot;vanse&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="meta">@ApiModelProperty(name = &quot;password&quot;,value = &quot;å¯†ç &quot;,example = &quot;vanse&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="service-7"><a href="#service-7" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">        User userFromDB = findUserByUsername(username);</span><br><span class="line">        <span class="keyword">if</span>(userFromDB == <span class="keyword">null</span> || !password.equals(userFromDB.getPassword()))&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.USER_LOGIN_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> userFromDB;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-7"><a href="#controller-7" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;è®¤è¯æ¨¡å—&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;ç™»å½•&quot;,notes = &quot;ä¼ json&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">login</span><span class="params">(<span class="meta">@RequestBody</span> UserVo userVo)</span></span>&#123;</span><br><span class="line">       User user = userService.login(userVo.getUsername(),userVo.getPassword());</span><br><span class="line">       <span class="keyword">return</span> Result.success();  </span><br><span class="line"><span class="comment">//       String token = UUID.randomUUID().toString() + &quot;-&quot; + user.getId();</span></span><br><span class="line"><span class="comment">//       return Result.success(token);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;vanse&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;vanse&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>æ€è€ƒ: ç™»å½•æˆåŠŸåæ˜¯å¦éœ€è¦å°†ç”¨æˆ·å­˜session</code></p>
<h2 id="å½“å‰ç”¨æˆ·ä¿¡æ¯"><a href="#å½“å‰ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="å½“å‰ç”¨æˆ·ä¿¡æ¯"></a>å½“å‰ç”¨æˆ·ä¿¡æ¯</h2><blockquote>
<p>æš‚æ—¶ä¸ç”¨ å°†æ¥å¯¹æ¥å‰å°ä½¿ç”¨</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/resource/info&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Result <span class="title">info</span><span class="params">(HttpServletRequest request)</span></span>&#123;</span><br><span class="line">       String token = request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">       <span class="comment">// å–å‡ºtokenä¸­çš„ä¿¡æ¯</span></span><br><span class="line">       Map&lt;String, Object&gt; map = JwtUtil.getInfo(token);</span><br><span class="line">       <span class="keyword">return</span> Result.success(map);</span><br><span class="line">   &#125;</span><br><span class="line"><span class="meta">@PostMapping(&quot;/resource/logout&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Result <span class="title">login</span><span class="params">()</span></span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;å»é™¤token&quot;</span>);</span><br><span class="line">       <span class="keyword">return</span> Result.success(<span class="string">&quot;é€€å‡ºæˆåŠŸ&quot;</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h1 id="jwt"><a href="#jwt" class="headerlink" title="jwt"></a>jwt</h1><h2 id="æ¦‚è¿°-3"><a href="#æ¦‚è¿°-3" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ä¼ ç»Ÿçš„Webåº”ç”¨ä¸­ï¼Œä½¿ç”¨sessionæ¥å­˜åœ¨ç”¨æˆ·çš„ä¿¡æ¯ï¼Œæ¯æ¬¡ç”¨æˆ·è®¤è¯é€šè¿‡ä»¥åï¼ŒæœåŠ¡å™¨éœ€è¦åˆ›å»ºä¸€æ¡è®°å½•<br>ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œé€šå¸¸æ˜¯åœ¨å†…å­˜ä¸­ã€‚</p>
<ul>
<li>éšç€è®¤è¯é€šè¿‡çš„ç”¨æˆ·è¶Šæ¥è¶Šå¤šï¼ŒæœåŠ¡å™¨çš„åœ¨è¿™é‡Œçš„å¼€é”€å°±ä¼šè¶Šæ¥è¶Šå¤§,</li>
<li>ç”±äºSessionæ˜¯åœ¨å†…å­˜ä¸­çš„ï¼Œè¿™å°±å¸¦æ¥ä¸€äº›æ‰©å±•æ€§çš„é—®é¢˜<ul>
<li>servletä¾èµ–äºwebå®¹å™¨    </li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210318005044861.png" alt="image-20210318005044861"></p>
<blockquote>
<p>JSON Web Token (JWT,tokençš„ä¸€ç§)ï¼Œæ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†(RFC 7519)ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘çš„ã€è‡ªåŒ…å«çš„æ–¹å¼ï¼Œç”¨äºä½œä¸ºJSONå¯¹è±¡åœ¨å„æ–¹ä¹‹é—´å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯å¯ä»¥è¢«éªŒè¯å’Œä¿¡ä»»ï¼Œå› ä¸ºå®ƒæ˜¯æ•°å­—ç­¾åçš„ã€‚</p>
</blockquote>
<ul>
<li>JWTå­˜æ”¾åœ¨å®¢æˆ·ç«¯ï¼ˆå‰ç«¯ï¼‰ï¼Œæ¯æ¬¡è¯·æ±‚çš„è¯·æ±‚å¤´ä¸­ï¼Œæºå¸¦æ­¤JWTå‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ç«¯è´Ÿè´£æ¥æ”¶<br>å’ŒéªŒè¯</li>
<li>æœåŠ¡å™¨ç«¯å¯ä»¥ä¸ç”¨å­˜å‚¨JWTï¼Œè¿™æ ·å¯ä»¥é™ä½æœåŠ¡å™¨çš„å†…å­˜çš„å¼€é”€</li>
<li>JWTå’Œè¯­è¨€æ— å…³ï¼Œæ‰©å±•èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œæ— è®ºæ˜¯PCç«¯è¿˜æ˜¯ç§»åŠ¨ç«¯ï¼Œéƒ½å¯ä»¥å¾ˆå®¹æ˜“çš„ä½¿ç”¨</li>
<li>ä¸å—cookieçš„é™åˆ¶</li>
</ul>
<p>å¦‚å›¾ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210318005232445.png" alt="image-20210318005232445"></p>
<blockquote>
<p>æ³¨æ„ï¼Œsessionå’ŒJWTçš„ä¸»è¦åŒºåˆ«å°±æ˜¯ä¿å­˜çš„ä½ç½®ï¼Œsessionæ˜¯ä¿å­˜åœ¨æœåŠ¡ç«¯çš„ï¼Œè€ŒJWTæ˜¯ä¿å­˜åœ¨å®¢æˆ·<br>ç«¯çš„</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼ŒJWTå°±æ˜¯ä¸€ä¸ªå›ºå®šæ ¼å¼çš„å­—ç¬¦ä¸²</p>
</blockquote>
<p><a href="https://jwt.io/">JWTå®˜ç½‘</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210318005358285.png" alt="image-20210318005358285"></p>
<h2 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h2><p>JWTå›ºå®šå„ç§çš„å­—ç¬¦ä¸²ï¼Œç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li>Headerï¼Œå¤´éƒ¨</li>
<li>Payloadï¼Œè½½è·</li>
<li>Signatureï¼Œç­¾å</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼ŒæŠŠè¿™ä¸‰éƒ¨åˆ†ä½¿ç”¨ç‚¹ï¼ˆ.ï¼‰è¿æ¥èµ·æ¥ï¼Œå°±æ˜¯ä¸€ä¸ªJWTå­—ç¬¦ä¸²</p>
</blockquote>
<p>å¦‚å›¾ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210319084618060.png" alt="image-20210319084618060"></p>
<h3 id="å¤´éƒ¨"><a href="#å¤´éƒ¨" class="headerlink" title="å¤´éƒ¨"></a>å¤´éƒ¨</h3><blockquote>
<p>headerä¸€èˆ¬çš„ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼štokençš„ç±»å‹ï¼ˆâ€œJWTâ€ï¼‰å’Œç®—æ³•åç§°ï¼ˆæ¯”å¦‚ï¼šHMAC SHA256æˆ–è€…RSAç­‰ç­‰ï¼‰ã€‚</p>
</blockquote>
<p>JWTé‡ŒéªŒè¯å’Œç­¾åä½¿ç”¨çš„ç®—æ³•åˆ—è¡¨å¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210319084933149.png" alt="image-20210319084933149"></p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;alg&quot;</span>: <span class="string">&quot;HS256&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;typ&quot;</span>: <span class="string">&quot;JWT&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è½½è·"><a href="#è½½è·" class="headerlink" title="è½½è·"></a>è½½è·</h3><blockquote>
<p>payloadä¸»è¦ç”¨æ¥åŒ…å«å£°æ˜ï¼ˆclaims ï¼‰ï¼Œè¿™ä¸ªå£°æ˜ä¸€èˆ¬æ˜¯å…³äºå®ä½“(é€šå¸¸æ˜¯ç”¨æˆ·)å’Œå…¶ä»–æ•°æ®çš„å£°æ˜ã€‚</p>
</blockquote>
<p>å£°æ˜æœ‰ä¸‰ç§ç±»å‹:</p>
<ul>
<li>registered</li>
<li>public</li>
<li>private</li>
</ul>
<p>å…·ä½“å¦‚ä¸‹ï¼š</p>
<p>Registered claims : è¿™é‡Œæœ‰ä¸€ç»„é¢„å®šä¹‰çš„å£°æ˜ï¼Œå®ƒä»¬ä¸æ˜¯å¼ºåˆ¶çš„ï¼Œä½†æ˜¯æ¨èã€‚</p>
<ul>
<li>iss: jwtç­¾å‘è€…</li>
<li>sub: jwtæ‰€é¢å‘çš„ç”¨æˆ·</li>
<li>aud: æ¥æ”¶jwtçš„ä¸€æ–¹</li>
<li>exp: jwtçš„è¿‡æœŸæ—¶é—´ï¼Œè¿™ä¸ªè¿‡æœŸæ—¶é—´å¿…é¡»è¦å¤§äºç­¾å‘æ—¶é—´ </li>
<li>nbf: å®šä¹‰åœ¨ä»€ä¹ˆæ—¶é—´ä¹‹å‰ï¼Œè¯¥jwtéƒ½æ˜¯ä¸å¯ç”¨çš„</li>
<li>iat: jwtçš„ç­¾å‘æ—¶é—´</li>
<li>jti: jwtçš„å”¯ä¸€èº«ä»½æ ‡è¯†ï¼Œä¸»è¦ç”¨æ¥ä½œä¸ºä¸€æ¬¡æ€§tokenï¼Œä»è€Œå›é¿é‡æ”¾æ”»å‡»</li>
</ul>
<p>Public claims : å¯ä»¥éšæ„å®šä¹‰</p>
<ul>
<li>è‡ªå®šä¹‰æ•°æ®:å­˜æ”¾åœ¨tokenä¸­å­˜æ”¾çš„key-valueå€¼</li>
</ul>
<p>Private claims : ç”¨äºåœ¨åŒæ„ä½¿ç”¨å®ƒä»¬çš„å„æ–¹ä¹‹é—´å…±äº«ä¿¡æ¯ï¼Œå¹¶ä¸”ä¸æ˜¯æ³¨å†Œçš„æˆ–å…¬å¼€çš„å£°æ˜</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;iss&quot;</span>: <span class="string">&quot;briup&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;iat&quot;</span>: <span class="number">1446593502</span>,</span><br><span class="line">    <span class="attr">&quot;exp&quot;</span>: <span class="number">1446594722</span>,</span><br><span class="line">    <span class="attr">&quot;aud&quot;</span>: <span class="string">&quot;www.briup.com&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;sub&quot;</span>: <span class="string">&quot;briup@briup.com&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;tom&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œä¸è¦åœ¨JWTçš„payloadæˆ–headerä¸­æ”¾ç½®æ•æ„Ÿä¿¡æ¯ï¼Œé™¤éå®ƒä»¬æ˜¯åŠ å¯†çš„</p>
</blockquote>
<p>æŠŠå¤´éƒ¨å’Œè½½è·åˆ†åˆ«è¿›è¡ŒBase64ç¼–ç ä¹‹åå¾—åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åå†å°†è¿™ä¸¤ä¸ªç¼–ç åçš„å­—ç¬¦ä¸²ç”¨è‹±æ–‡å¥å·.<br>è¿æ¥åœ¨ä¸€èµ·ï¼ˆå¤´éƒ¨åœ¨å‰ï¼‰ï¼Œå½¢æˆæ–°çš„å­—ç¬¦ä¸²ï¼š</p>
<p><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI2MmI2OWNlZC02YWNlLTRmYzAtOTk5MS00YWUwMjIxODQ0OTciLCJleHAiOjE2MDYwNTQzNjl9</code></p>
<p><a href="http://tool.chinaz.com/tools/base64.aspx">æµ‹è¯•ç¼–ç </a></p>
<p>###ç­¾å</p>
<p>æœ€åï¼Œå°†ä¸Šé¢æ‹¼æ¥å®Œçš„å­—ç¬¦ä¸²ç”¨HS256ç®—æ³•è¿›è¡ŒåŠ å¯†ï¼Œåœ¨åŠ å¯†çš„æ—¶å€™ï¼Œè¿˜éœ€è¦æä¾›ä¸€ä¸ªå¯†é’¥ï¼ˆsecretï¼‰ã€‚åŠ å¯†åçš„å†…å®¹ä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°±æ˜¯ç­¾åã€‚</p>
<p>æŠŠè¿™ä¸ªç­¾åæ‹¼æ¥åœ¨åˆšæ‰çš„å­—ç¬¦ä¸²åé¢å°±èƒ½å¾—åˆ°å®Œæ•´çš„JWTå­—ç¬¦ä¸²ã€‚<br>headeréƒ¨åˆ†å’Œpayloadéƒ¨åˆ†å¦‚æœè¢«ç¯¡æ”¹ï¼Œç”±äºç¯¡æ”¹è€…ä¸çŸ¥é“å¯†é’¥æ˜¯ä»€ä¹ˆï¼Œä¹Ÿæ— æ³•ç”Ÿæˆæ–°çš„signatureéƒ¨åˆ†ï¼Œ<br>æœåŠ¡ç«¯ä¹Ÿå°±æ— æ³•é€šè¿‡ã€‚</p>
<blockquote>
<p>åœ¨JWTä¸­ï¼Œæ¶ˆæ¯ä½“æ˜¯é€æ˜çš„ï¼Œä½¿ç”¨ç­¾åå¯ä»¥ä¿è¯æ¶ˆæ¯ä¸è¢«ç¯¡æ”¹ã€‚</p>
</blockquote>
<blockquote>
<p>ç¡®ä¿å¯†é’¥ä¸ä¼šæ³„éœ²,å¦åˆ™ä¼šè¢«ç¯¡æ”¹</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œä½¿ç”¨HMACSHA256åŠ å¯†ç®—æ³•ï¼Œé…åˆç§˜é’¥ï¼Œå°†å‰ä¿©éƒ¨è¿›è¡ŒåŠ å¯†ï¼Œç”Ÿæˆç­¾å</p>
<p><code>HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload), secret)</code></p>
<p>ä¾‹å¦‚ï¼Œå°†Headerã€Payloadã€Signatureä¸‰éƒ¨åˆ†ä½¿ç”¨ç‚¹ï¼ˆ.ï¼‰è¿æ¥èµ·æ¥</p>
<p><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI2MmI2OWNlZC02YWNlLTRmYzAtOTk5MS00Y WUwMjIxODQ0OTciLCJleHAiOjE2MDYwNTQzNjl9.DNVhr36j66JpQBfcYoo64IRp84dKiQeaq7axHTBcP9 E</code></p>
<p>ä¾‹å¦‚ï¼Œä½¿ç”¨å®˜ç½‘æä¾›çš„å·¥å…·ï¼Œå¯ä»¥å¯¹è¯¥JWTè¿›è¡ŒéªŒè¯å’Œè§£æï¼ˆä¸è¦æ”¾æ•æ„Ÿä¿¡æ¯ï¼‰</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210319085334765.png" alt="image-20210319085334765"></p>
<blockquote>
<p>æ³¨æ„ï¼Œåœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨JWTå°è£…çš„å·¥å…·ç±»ï¼Œä¹Ÿå¯ä»¥å®Œæˆæ­¤æ“ä½œ sso</p>
</blockquote>
<h2 id="æ•´åˆ"><a href="#æ•´åˆ" class="headerlink" title="æ•´åˆ"></a>æ•´åˆ</h2><h3 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.auth0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>java-jwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.11.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="å·¥å…·ç±»"><a href="#å·¥å…·ç±»" class="headerlink" title="å·¥å…·ç±»"></a>å·¥å…·ç±»</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.auth0.jwt.JWT;</span><br><span class="line"><span class="keyword">import</span> com.auth0.jwt.JWTVerifier;</span><br><span class="line"><span class="keyword">import</span> com.auth0.jwt.algorithms.Algorithm;</span><br><span class="line"><span class="keyword">import</span> com.auth0.jwt.exceptions.JWTDecodeException;</span><br><span class="line"><span class="keyword">import</span> com.auth0.jwt.exceptions.JWTVerificationException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtUtil</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿‡æœŸæ—¶é—´5åˆ†é’Ÿ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> EXPIRE_TIME = <span class="number">5</span> * <span class="number">60</span> * <span class="number">1000</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * jwt å¯†é’¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String SECRET = <span class="string">&quot;jwt_secret&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆç­¾åï¼Œäº”åˆ†é’Ÿåè¿‡æœŸ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> infoï¼ŒMapçš„valueåªèƒ½å­˜æ”¾çš„å€¼çš„ç±»å‹ä¸ºï¼šMap, List, Boolean, Integer, Long, Double, String and Date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">sign</span><span class="params">(String userId,Map&lt;String,Object&gt; info)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Date date = <span class="keyword">new</span> Date(System.currentTimeMillis() + EXPIRE_TIME);</span><br><span class="line">            Algorithm algorithm = Algorithm.HMAC256(SECRET);</span><br><span class="line">            <span class="keyword">return</span> JWT.create()</span><br><span class="line">                    <span class="comment">// å°† user id ä¿å­˜åˆ° token é‡Œé¢</span></span><br><span class="line">                    .withAudience(userId)</span><br><span class="line">                    <span class="comment">// å­˜æ”¾è‡ªå®šä¹‰æ•°æ®</span></span><br><span class="line">                    .withClaim(<span class="string">&quot;info&quot;</span>, info)</span><br><span class="line">                    <span class="comment">// äº”åˆ†é’Ÿåtokenè¿‡æœŸ</span></span><br><span class="line">                    .withExpiresAt(date)</span><br><span class="line">                    <span class="comment">// token çš„å¯†é’¥</span></span><br><span class="line">                    .sign(algorithm);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        	e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®tokenè·å–userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getUserId</span><span class="params">(String token)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String userId = JWT.decode(token).getAudience().get(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> userId;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JWTDecodeException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®tokenè·å–è‡ªå®šä¹‰æ•°æ®info</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,Object&gt; <span class="title">getInfo</span><span class="params">(String token)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> JWT.decode(token).getClaim(<span class="string">&quot;info&quot;</span>).asMap();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JWTDecodeException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¡éªŒtoken</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkSign</span><span class="params">(String token)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Algorithm algorithm = Algorithm.HMAC256(SECRET);</span><br><span class="line">            JWTVerifier verifier = JWT.require(algorithm)</span><br><span class="line">                    <span class="comment">// .withClaim(&quot;username&quot;, username)</span></span><br><span class="line">                    .build();</span><br><span class="line">            verifier.verify(token);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JWTVerificationException exception) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;token æ— æ•ˆï¼Œè¯·é‡æ–°è·å–&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æ”¹é€ ç™»å½•"><a href="#æ”¹é€ ç™»å½•" class="headerlink" title="æ”¹é€ ç™»å½•"></a>æ”¹é€ ç™»å½•</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;è®¤è¯æ¨¡å—&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;ç™»å½•&quot;,notes = &quot;ä¼ json&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">login</span><span class="params">(<span class="meta">@RequestBody</span> UserVo userVo)</span></span>&#123;</span><br><span class="line">       User user = userService.login(userVo.getUsername(),userVo.getPassword());</span><br><span class="line">       Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">       map.put(<span class="string">&quot;username&quot;</span>,user.getUsername());</span><br><span class="line">       map.put(<span class="string">&quot;image&quot;</span>,user.getImage());</span><br><span class="line">       String token = JwtUtil.sign(String.valueOf(user.getId()), map);</span><br><span class="line">       <span class="keyword">return</span> Result.success(token);</span><br><span class="line"><span class="comment">//       String token = UUID.randomUUID().toString() + &quot;-&quot; + user.getId();</span></span><br><span class="line"><span class="comment">//       return Result.success(token);</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h3><p>com.briup.cms.interceptors.JwtInteceptors</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ‹¦æˆªè®¤è¯èµ„æº</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtInteceptors</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">       		 <span class="comment">// å¯ä»¥æ”¾è¡Œé¢„æ£€è¯·æ±‚</span></span><br><span class="line">		<span class="keyword">if</span>(!(handler <span class="keyword">instanceof</span> HandlerMethod))&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// ä»è¯·æ±‚å¤´ä¸­è·å–token</span></span><br><span class="line">		String token = request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">		<span class="comment">// åˆ¤æ–­tokenæ˜¯å¦ä¸ºç©º ç©ºç›´æ¥æŠ›å¼‚å¸¸ </span></span><br><span class="line">		<span class="keyword">if</span>(token == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;æ— token,è¯·ç™»å½•&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// æ ¡éªŒtoken</span></span><br><span class="line">		JwtUtil.checkSign(token);</span><br><span class="line">		<span class="comment">// å–å‡ºtokenä¸­çš„ä¿¡æ¯</span></span><br><span class="line">		String userId = JwtUtil.getUserId(token);</span><br><span class="line">		System.out.println(userId);</span><br><span class="line">		Map&lt;String, Object&gt; info = JwtUtil.getInfo(token);</span><br><span class="line">		info.forEach((k,v)-&gt;&#123;</span><br><span class="line">			System.out.println(k+<span class="string">&quot;=&quot;</span>+v);</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="comment">// æ”¾è¡Œ</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="mvcé…ç½®"><a href="#mvcé…ç½®" class="headerlink" title="mvcé…ç½®"></a>mvcé…ç½®</h3><p>com.briup.cms.config.MvcConfig</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">		registry.addInterceptor(<span class="keyword">new</span> JwtInteceptors())</span><br><span class="line">		.addPathPatterns(<span class="string">&quot;/resource/**&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="èµ„æº"><a href="#èµ„æº" class="headerlink" title="èµ„æº"></a>èµ„æº</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;resource&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;æµ‹è¯•æ¨¡å—&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResourceController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@GetMapping(&quot;hello&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p><strong>ç›´æ¥è®¿é—®</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211112093343903.png" alt="image-20211112093343903"></p>
<p><strong>è·å–token</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211112093718429.png" alt="image-20211112093718429"></p>
<p><strong>æºå¸¦è¯·æ±‚å¤´</strong></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211112093811250.png" alt="image-20211112093811250"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">3</span><br><span class="line">gender=0</span><br><span class="line">username=wangsidandan</span><br></pre></td></tr></table></figure>



<p><strong>ä¿®æ”¹tokenï¼Œæ•…æ„å†™é”™åï¼Œå†è®¿é—®æµ‹è¯•</strong></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;code&quot;</span>:<span class="number">500</span>,<span class="attr">&quot;msg&quot;</span>:<span class="string">&quot;æœåŠ¡å™¨å¼‚å¸¸: token æ— æ•ˆï¼Œè¯·é‡æ–°è·å–&quot;</span>,<span class="attr">&quot;data&quot;</span>:<span class="literal">null</span>&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è·å–æ–°çš„tokenæµ‹è¯•é€šè¿‡åï¼Œç­‰å¾…5åˆ†é’Ÿåï¼Œå†æ¬¡è®¿é—®</strong></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;code&quot;</span>:<span class="number">500</span>,<span class="attr">&quot;msg&quot;</span>:<span class="string">&quot;æœåŠ¡å™¨å¼‚å¸¸: token æ— æ•ˆï¼Œè¯·é‡æ–°è·å–&quot;</span>,<span class="attr">&quot;data&quot;</span>:<span class="literal">null</span>&#125;</span><br></pre></td></tr></table></figure>



<h3 id="swagger-1"><a href="#swagger-1" class="headerlink" title="swagger"></a>swagger</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/auth&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;æµ‹è¯•æ¨¡å—&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;æµ‹è¯•&quot;,notes = &quot;tokenæ”¾è¯·æ±‚å¤´&quot;)</span></span><br><span class="line">	<span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">		@ApiImplicitParam(name = &quot;token&quot;,value = &quot;tokenå€¼&quot;,dataType = &quot;string&quot;,paramType = &quot;header&quot;,required = true)</span></span><br><span class="line"><span class="meta">	&#125;)</span></span><br><span class="line">	<span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>é—®é¢˜</code></p>
<p>æ¯ä¸ªéœ€è¦æ‹¦æˆªçš„èµ„æºéƒ½è¦æ‰‹åŠ¨é…ç½®token</p>
<h2 id="å…¨å±€é…ç½®"><a href="#å…¨å±€é…ç½®" class="headerlink" title="å…¨å±€é…ç½®"></a>å…¨å±€é…ç½®</h2><h3 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h3><blockquote>
<p>å¾ˆå¤šè¯·æ±‚ä¸­ï¼Œä¼šæºå¸¦tokenåˆ°æœåŠ¡å™¨ç«¯è¿›è¡Œè®¤è¯ï¼Œtokenæœ‰æ•ˆæ—¶æ‰å¯ä»¥è¿›è¡Œæœ¬æ¬¡è®¿é—®ï¼Œè°ƒç”¨ç›¸åº”çš„æ¥å£</p>
</blockquote>
<p>ä½¿ç”¨swaggerè¿›è¡Œæ¥å£æµ‹è¯•åï¼Œå¯ä»¥ç»™swaggerä¸­æµ‹è¯•çš„æ¥å£ï¼Œæ·»åŠ å…¨å±€çš„å‚æ•°ï¼Œè®©æ¯ä¸€ä¸ªæ¥å£éƒ½å«ä¹‰æŒ‡å®šçš„å‚æ•°ï¼Œè¿™æ ·å°±ä¸éœ€è¦æ¯ä¸€ä¸ªæ¥ä¸Šæ·»åŠ swaggerçš„æ³¨è§£äº†ã€‚</p>
<h3 id="2-ä½¿ç”¨"><a href="#2-ä½¿ç”¨" class="headerlink" title="2.ä½¿ç”¨"></a>2.ä½¿ç”¨</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.common.base.Predicate;</span><br><span class="line"><span class="keyword">import</span> com.google.common.base.Predicates;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.PathSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiKey;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.AuthorizationScope;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Contact;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.SecurityReference;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.service.contexts.SecurityContext;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: vanse</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/12/12-12-12-17:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>ï¼šcom.briup.cms.config</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>ï¼š1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Swagger2Config</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// é…ç½®swagger2ç±»å‹ è·å–apiæ„å»ºå™¨</span></span><br><span class="line">        <span class="comment">// æ‰«æçš„åŒ… åŒ…ä¸‹çš„è·¯å¾„</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo()) <span class="comment">// å¼•ç”¨è‡ªå®šä¹‰æ–¹æ³•apiInfo()</span></span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.briup.cms.controller&quot;</span>)) <span class="comment">// é‚£äº›åŒ…éœ€è¦æ‰«æ</span></span><br><span class="line">                .paths(PathSelectors.any())  <span class="comment">// åŒ…ä¸‹çš„é‚£äº›è·¯å¾„éœ€è¦æ‰«æ</span></span><br><span class="line">                .build()</span><br><span class="line">                .securitySchemes(security()).securityContexts(securityContexts())</span><br><span class="line">                .ignoredParameterTypes(HttpServletRequest.class, HttpServletResponse.class);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// public static final ApiInfo DEFAULT = new ApiInfo(&quot;Api Documentation&quot;, &quot;Api Documentation&quot;, &quot;1.0&quot;, &quot;urn:tos&quot;,</span></span><br><span class="line"><span class="comment">//          DEFAULT_CONTACT, &quot;Apache 2.0&quot;, &quot;http://www.apache.org/licenses/LICENSE-2.0&quot;, new ArrayList&lt;VendorExtension&gt;());</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">                .title(<span class="string">&quot;cms&quot;</span>)</span><br><span class="line">                .description(<span class="string">&quot;çœ‹ç‚¹å’¨è¯¢ç³»ç»Ÿ(å®¿å·å­¦é™¢)&quot;</span>)</span><br><span class="line">                .version(<span class="string">&quot;1.0&quot;</span>)</span><br><span class="line">                .contact(<span class="keyword">new</span> Contact(<span class="string">&quot;briup&quot;</span>,<span class="string">&quot;http://www.briup.com&quot;</span>,<span class="string">&quot;wangsidandan@gmail.com&quot;</span>))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è®¤è¯ä¸­æ˜¾ç¤ºçš„æ˜¾ç¤ºçš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;ApiKey&gt; <span class="title">security</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Collections.singletonList(<span class="keyword">new</span> ApiKey(<span class="string">&quot;Authorization&quot;</span>, <span class="string">&quot;token&quot;</span>, <span class="string">&quot;header&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è®¤è¯è§„åˆ™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;SecurityContext&gt; <span class="title">securityContexts</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; antPaths = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        antPaths.add(<span class="string">&quot;/resource/**&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Collections.singletonList(SecurityContext.builder().securityReferences(defaultAuth())</span><br><span class="line">                .forPaths(antPathsCondition(antPaths)).build());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›è®¤è¯è·¯å¾„çš„æ¡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Predicate&lt;String&gt; <span class="title">antPathsCondition</span><span class="params">(List&lt;String&gt; antPaths)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Predicate&lt;String&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        antPaths.forEach(path -&gt; list.add(PathSelectors.ant(path)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Predicates.or(list);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è®¤è¯çš„èŒƒå›´ï¼Œä»¥åŠè®¤è¯çš„ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;SecurityReference&gt; <span class="title">defaultAuth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        AuthorizationScope authorizationScope = <span class="keyword">new</span> AuthorizationScope(<span class="string">&quot;global&quot;</span>, <span class="string">&quot;accessEverything&quot;</span>);</span><br><span class="line">        AuthorizationScope[] authorizationScopes = <span class="keyword">new</span> AuthorizationScope[<span class="number">1</span>];</span><br><span class="line">        authorizationScopes[<span class="number">0</span>] = authorizationScope;</span><br><span class="line">        <span class="keyword">return</span> Collections.singletonList(<span class="keyword">new</span> SecurityReference(<span class="string">&quot;Authorization&quot;</span>, authorizationScopes));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ¯”ä¹‹å‰æ–°å¢çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321171405316.png" alt="image-20210321171405316"></p>
<blockquote>
<p>æ³¨æ„ï¼Œæ–°å¢ä»£ç å¦‚å›¾æ‰€ç¤ºï¼Œä»¥åŠä¸‹é¢æ–°å¢çš„å‡ ä¸ªæ–¹æ³•</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321171428922.png" alt="image-20210321171428922"></p>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºä¸€ä¸ªâ€œé”â€çš„å›¾æ ‡ï¼Œè¡¨ç¤ºè¿™é‡Œæœ‰äº›æ¥å£æ˜¯éœ€è¦è®¤è¯çš„</p>
</blockquote>
<p>å±•å¼€æ¨¡å—åï¼Œè®¿é—®è·¯å¾„ç¬¦åˆè¦æ±‚æ¥å£ï¼Œä¹Ÿä¼šæ˜¾ç¤ºâ€œé”â€çš„å›¾æ ‡</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321171450952.png" alt="image-20210321171450952"></p>
<p>ç‚¹å‡»é”çš„å›¾æ ‡ï¼Œæ·»åŠ è¯·æ±‚å¤´ä¸­çš„ç»Ÿä¸€è®¤è¯ä¿¡æ¯ï¼ˆtokenï¼‰ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321171509563.png" alt="image-20210321171509563"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321171519876.png" alt="image-20210321171519876"></p>
<p>ç‚¹å‡»è®¤è¯æŒ‰é’®åï¼Œè¿›è¡Œè®¿é—®æµ‹è¯•ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321171537958.png" alt="image-20210321171537958"></p>
<p>æ³¨æ„ï¼Œè¿™æ—¶å€™ï¼Œæœ‰â€œé”â€å›¾æ ‡çš„æ¥å£ï¼Œåœ¨è®¿é—®çš„æ—¶å€™ï¼Œéƒ½ä¼šæºå¸¦åˆšåˆšè®¾ç½®çš„è¯·æ±‚å¤´ä¸­çš„è®¤è¯ä¿¡æ¯tokenå€¼</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321171609118.png" alt="image-20210321171609118"></p>
<p>æ³¨æ„ï¼Œè¿™æ—¶å€™ï¼Œæ— â€œé”â€å›¾æ ‡çš„æ¥å£ï¼Œåœ¨è®¿é—®çš„æ—¶å€™ï¼Œé»˜è®¤æ˜¯ä¸ä¼šæºå¸¦è®¾ç½®çš„è¯·æ±‚å¤´ä¿¡æ¯çš„</p>
<h1 id="cors"><a href="#cors" class="headerlink" title="cors"></a>cors</h1><h2 id="æ¦‚è¿°-4"><a href="#æ¦‚è¿°-4" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>è·¨åŸŸè®¿é—®ï¼Œæ˜¯æŒ‡ä»ä¸€ä¸ªåŸŸåçš„ç½‘é¡µå»è¯·æ±‚å¦ä¸€ä¸ªåŸŸåçš„èµ„æºã€‚æ¯”å¦‚ä»<a href="http://www.baidu.com/">www.baidu.com</a> é¡µé¢å»è¯·æ±‚ <a href="http://www.google.com/">www.google.com</a> çš„èµ„æºã€‚ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ä¸èƒ½è¿™ä¹ˆåšè·¨åŸŸè®¿é—®ï¼Œå› ä¸ºæœ‰æµè§ˆå™¨çš„â€œ<strong>åŒæºç­–ç•¥</strong>â€å­˜åœ¨ï¼Œè¿™æ˜¯æµè§ˆå™¨å¯¹JavaScriptæ–½åŠ çš„å®‰å…¨é™åˆ¶ã€‚</p>
<blockquote>
<p>è·¨åŸŸï¼ŒæŒ‡çš„æ˜¯æµè§ˆå™¨ä¸èƒ½æ‰§è¡Œå…¶ä»–ç½‘ç«™çš„è„šæœ¬ã€‚å®ƒæ˜¯ç”±æµè§ˆå™¨çš„åŒæºç­–ç•¥é€ æˆçš„ï¼Œæ˜¯æµè§ˆå™¨å¯¹JavaScriptæ–½åŠ çš„å®‰å…¨é™åˆ¶ã€‚</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321224558036.png" alt="image-20210321224558036"></p>
<p><strong>â€œåŒæºç­–ç•¥â€</strong>ç®€å•çš„è¯´ï¼Œå°±æ˜¯Aç½‘ç«™é¡µé¢è®¿é—®Bç½‘ç«™çš„èµ„æºå—é™ï¼ˆè·¨åŸŸè®¿é—®ï¼‰ï¼Œé™¤éAå’ŒBæ˜¯â€œåŒæºâ€ã€‚<br><strong>â€œåŒæºâ€</strong>æ˜¯æŒ‡ä¸‰ä¸ªç›¸åŒï¼Œåè®®ç›¸åŒã€åŸŸåç›¸åŒã€ç«¯å£ç›¸åŒï¼Œåªæœ‰æœ‰ä»»ä½•ä¸€ä¸ªåœ°æ–¹ä¸åŒï¼Œå°±è®¤ä¸ºæ˜¯è·¨åŸŸã€‚</p>
<p>ä¾‹å¦‚ï¼Œ<br>ç½‘é¡µAçš„åœ°å€ä¸ºï¼Œ <a href="http://www.example.com/dir/page.html">http://www.example.com/dir/page.html</a><br>å‡è®¾ï¼Œç½‘é¡µAè¦è®¿é—®çš„ç½‘é¡µBåœ°å€ä¸ºï¼š</p>
<ul>
<li><a href="http://www.example.com/dir2/other.html">http://www.example.com/dir2/other.html</a> ï¼š åŒæºï¼ˆæ­£å¸¸è®¿é—®ï¼‰</li>
<li><a href="https://www.example.com/dir/other.html">https://www.example.com/dir/other.html</a> ï¼šä¸åŒæºï¼ˆåè®®ä¸åŒï¼Œè·¨åŸŸï¼‰</li>
<li><a href="http://vip.www.example.com/dir/other.html">http://vip.www.example.com/dir/other.html</a> ï¼šä¸åŒæºï¼ˆåŸŸåä¸åŒï¼Œè·¨åŸŸï¼‰</li>
<li><a href="http://www.example.com:81/dir/other.html">http://www.example.com:81/dir/other.html</a> ï¼šä¸åŒæºï¼ˆç«¯å£ä¸åŒï¼Œè·¨åŸŸï¼‰</li>
</ul>
<p>éšç€äº’è”ç½‘çš„å‘å±•ï¼Œâ€œåŒæºæ”¿ç­–â€è¶Šæ¥è¶Šä¸¥æ ¼ï¼Œç›®å‰ï¼Œå¦‚æœéåŒæºï¼ˆè·¨åŸŸï¼‰ï¼Œå…±æœ‰ä¸‰ç§è¡Œä¸ºå—åˆ°é™åˆ¶ï¼š</p>
<ul>
<li>Cookie ã€LocalStorageã€IndexDB æ— æ³•è®¿é—®</li>
<li>DOM æ— æ³•è·å–</li>
<li>AJAXè¯·æ±‚ä¸èƒ½å‘é€</li>
</ul>
<p>æµè§ˆå™¨çš„ç”¨â€œåŒæºç­–ç•¥â€æ¥é™åˆ¶è·¨åŸŸè®¿é—®çš„ç›®çš„æ˜¯ä¸ºäº†å®‰å…¨ï¼Œä¾‹å¦‚ï¼Œå‡è®¾æ²¡æœ‰è·¨åŸŸè®¿é—®çš„é™åˆ¶</p>
<ul>
<li><p>ç”¨æˆ·è®¿é—®<a href="http://www.mybank.com/">www.mybank.com</a> ï¼Œç™»é™†å¹¶è¿›è¡Œç½‘é“¶æ“ä½œï¼Œè¿™æ—¶cookieã€tokenç­‰æ•°æ®ä¿¡æ¯å­˜æ”¾åœ¨æµè§ˆå™¨ä¸­</p>
</li>
<li><p>ç”¨æˆ·è®¿é—®<a href="http://www.abc.com/">www.abc.com</a></p>
</li>
<li><p>è¿™æ—¶<a href="http://www.abc.com/">www.abc.com</a> ç½‘ç«™å°±å¯ä»¥åœ¨æ‹¿åˆ°é“¶è¡Œçš„cookieæˆ–tokenç­‰ï¼Œç„¶åå‘èµ·å¯¹<a href="http://www.mybank.com/">www.mybank.com</a> çš„æ“ä½œ</p>
</li>
</ul>
<p>æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­ï¼Œéœ€è¦è®¾ç½®å¯¹è·¨åŸŸè®¿é—®çš„æ”¯æŒï¼Œæ˜¯å› ä¸ºé¡¹ç›®çš„æ¶æ„éœ€è¦ï¼Œä¾‹å¦‚</p>
<ul>
<li>å…¬å¸å†…éƒ¨æœ‰å¤šä¸ªä¸åŒçš„å­ç³»ç»Ÿï¼Œä¾‹å¦‚Aå’ŒBï¼Œåˆ†åˆ«éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œå…¶åŸŸåä¹Ÿä¸ç›¸åŒ</li>
<li>ç”±äºå…¬å¸å†…éƒ¨çš„æ•°æ®éœ€è¦ï¼Œç°åœ¨Aç³»ç»Ÿä¸­ï¼Œè·¨åŸŸè®¿é—®Bç³»ç»Ÿï¼Œä»è€Œè·å–å†…éƒ¨çš„ä¸€äº›ä¿¡æ¯èµ„æº</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼Œåœ¨å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ä¸­ï¼Œå‰ç«¯é¡µé¢éƒ¨ç½²åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œåç«¯é¡¹ç›®éƒ¨ç½²åœ¨å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œä»å‰ç«¯é¡µé¢ä¸Šå‘é€ajaxè¯·æ±‚åˆ°åç«¯ç³»ç»Ÿä¸­ï¼Œè¿™ç§æƒ…å†µï¼Œå°±å±äºè·¨åŸŸè®¿é—®</p>
</blockquote>
<h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><p>1ã€æ–°å»ºé¡¹ç›®ï¼Œspringboot-html</p>
<img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321230538847.png" alt="image-20210321230538847" style="zoom:50%;" />



<p>2ã€é¡µé¢ä»£ç ï¼šajax.html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;script src=&quot;https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js&quot;&gt;&lt;/script&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ä¸éœ€è¦å†™static--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;.btn1&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">console</span>.log(msg);</span></span><br><span class="line"><span class="javascript">                    &#125;,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        alert(<span class="string">&#x27;error&#x27;</span>);</span></span><br><span class="line"><span class="javascript">                    &#125;</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        &#125;);</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn1&quot;</span>&gt;</span>test1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€pomæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>4ã€é…ç½®æ–‡ä»¶application.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">9999</span></span><br></pre></td></tr></table></figure>

<p>5ã€Controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.web.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@GetMapping(&quot;/ajax&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ajax&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>6ã€è¿è¡Œè®¿é—®</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321231102544.png" alt="image-20210321231102544"></p>
<p><strong>å†æ„å»ºæä¾›æ¥å£è®¿é—®çš„åç«¯é¡¹ç›®</strong></p>
<p>1ã€æ–°å»ºé¡¹ç›®ï¼Œspringboot-cors</p>
<img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321231146093.png" alt="image-20210321231146093" style="zoom:67%;" />

<p>2ã€pomæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>3ã€é…ç½®æ–‡ä»¶ï¼Œapplication.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8989</span></span><br></pre></td></tr></table></figure>

<p>4ã€Controller</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.web.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@GetMapping(&quot;/hi&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5ã€å¯åŠ¨ï¼Œè®¿é—®</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321231321782.png" alt="image-20210321231321782"></p>
<p>æœ€åï¼Œè®¿é—®springboot-htmlé¡¹ç›®ä¸­çš„ajax.htmlé¡µé¢ï¼Œç‚¹å‡»é¡µé¢ä¸­çš„æŒ‰é’®ï¼Œå‘é€ajaxè¯·æ±‚ï¼Œè®¿é—®springbootcors<br>é¡¹ç›®ä¸­çš„æ¥å£ï¼š</p>
<p>å½“å‰é¡µé¢çš„è®¿é—®åœ°å€ï¼š <a href="http://localhost:9999/ajax">http://localhost:9999/ajax</a><br>ç‚¹å‡»æŒ‰é’®åè¯·æ±‚åœ°å€ï¼š <a href="http://localhost:8989/hi">http://localhost:8989/hi</a><br>å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶è¿™ä¿©ä¸ªåœ°å€ï¼Œå±äºâ€œéåŒæºâ€ï¼Œæœ¬æ¬¡è®¿é—®å±äºè·¨åŸŸè®¿é—®ã€‚</p>
<p>ç‚¹å‡»åï¼Œæ§åˆ¶å°ä¸Šè¾“å‡ºçš„é”™è¯¯ä¿¡æ¯ï¼š<br>å·²æ‹¦æˆªè·¨æºè¯·æ±‚ï¼šåŒæºç­–ç•¥ç¦æ­¢è¯»å–ä½äº <a href="http://localhost:8989/hi">http://localhost:8989/hi</a> çš„è¿œç¨‹èµ„æºã€‚<br>ï¼ˆåŸå› ï¼šCORS å¤´ç¼ºå°‘ â€˜Access-Control-Allow-Originâ€™ï¼‰ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321232022681.png" alt="image-20210321232022681"></p>
<p>ç‚¹å¼€ç½‘ç»œæ¨¡å—ï¼ŒæŸ¥çœ‹å…·ä½“çš„è¯·æ±‚ä¿¡æ¯ï¼š<br>è¯·æ±‚å¤´ä¸­ï¼Œè‡ªåŠ¨æ·»åŠ äº†ä¿¡æ¯ Origin: <a href="http://localhost:9999/">http://localhost:9999</a> ï¼Œé€šçŸ¥æœåŠ¡å™¨æœ¬æ¬¡æ˜¯è·¨åŸŸè®¿é—®</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321232136576.png" alt="image-20210321232136576"></p>
<p>ä»æœ¬æ¬¡å“åº”çš„å†…å®¹ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå…¶å®å“åº”çš„å†…å®¹å·²ç»æˆåŠŸè¿”å›äº†ï¼Œä½†æ˜¯ç”±äºæµè§ˆå™¨çš„åŒæºæ”¿ç­–ï¼ŒæŠŠè¿™äº›ç»“æœéƒ½ç»™èˆå¼ƒäº†ã€‚å¹¶ä¸”æ‰§è¡Œäº†Ajaxä¸­çš„å›è°ƒå‡½æ•°error</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210321232221184.png" alt="image-20210321232221184"></p>
<h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>é¿å¼€åŒæºæ”¿ç­–ç»™è·¨åŸŸè®¿é—®å¸¦æ¥çš„é™åˆ¶ï¼Œæ–¹å¼æœ‰å¾ˆå¤šï¼š</p>
<ol>
<li>nginx</li>
<li>CORSï¼ˆä¸»è¦ï¼‰</li>
<li>JSONP</li>
<li>WebSocket</li>
<li>Node.js</li>
<li>document.domain+iframe</li>
<li>other</li>
</ol>
<p>è¿™é‡Œä¸»è¦è¯´ä¸‹nginxåå‘ä»£ç†å’ŒCORSè·¨åŸŸèµ„æºå…±äº«ï¼Œè¿™ä¿©ç§è·¨åŸŸè§£å†³æ–¹æ¡ˆ</p>
<h3 id="3-1-nginx"><a href="#3-1-nginx" class="headerlink" title="3.1 nginx"></a>3.1 nginx</h3><p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322064446018.png" alt="image-20210322064446018"></p>
<p>Nginxæ˜¯ä¸€æ¬¾å¼€æºçš„ã€é«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†æœåŠ¡å™¨</p>
<ul>
<li>ä¹Ÿæ˜¯ä¸€ä¸ªIMAP/POP3/SMTPä»£ç†æœåŠ¡å™¨</li>
<li>ç”±Cè¯­è¨€ç¼–å†™ï¼Œå…¶ç³»ç»Ÿå¼€é”€ã€CPUä½¿ç”¨æ•ˆç‡éƒ½å¾ˆä¼˜ç§€</li>
<li>æ€§èƒ½ç¨³å®šã€åŠŸèƒ½ä¸°å¯Œã€é…ç½®ç®€æ´</li>
<li>æœåŠ¡å™¨ä¸­æ²¡æœ‰webå®¹å™¨</li>
</ul>
<p>æ­£å‘ä»£ç†ï¼Œä¸€èˆ¬éœ€è¦è‡ªå·±æ‰‹åŠ¨è¿›è¡Œé…ç½®ï¼š(<strong>å·²çŸ¥ä»£ç†æœåŠ¡å™¨</strong>)<br>ä»£ç†æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯åœ¨åŒä¸€ä¸ªç½‘ç»œä¸­ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬è®¿é—®ä¸äº†æŸä¸ªç½‘ç«™Bï¼Œä½†æ˜¯èƒ½è®¿é—®æŸä¸ªä»£ç†æœåŠ¡å™¨Pï¼Œè¿™ä¸ªä»£ç†æœåŠ¡å™¨På´å¯ä»¥è®¿é—®åˆ°ç½‘ç»œBï¼Œ<br>é‚£ä¹ˆæˆ‘å°±å…ˆè‡ªå·±æ‰‹åŠ¨é…ç½®è¿ä¸Šä»£ç†æœåŠ¡å™¨Pï¼Œç„¶åè®©ä»£ç†æœåŠ¡å™¨På¸®æˆ‘è®¿é—®ç½‘ç«™Bï¼Œå¹¶æŠŠç»“æœè¿”å›ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211005101017166.png" alt="image-20211005101017166"></p>
<p>åå‘ä»£ç†ï¼Œä¸€èˆ¬æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥æ”¶ç½‘ç»œä¸Šçš„è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚å†è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„å…¶ä»–æœåŠ¡<br>å™¨ï¼š<br>ä»£ç†æœåŠ¡å™¨å’ŒWebæœåŠ¡å™¨åœ¨åŒä¸€ä¸ªç½‘ç»œä¸­ã€‚ä¸€èˆ¬ä¸éœ€è¦ç”¨æˆ·è‡ªå·±è®¾ç½®æœåŠ¡å™¨ï¼Œç”¨æˆ·ç”šè‡³æ„Ÿå—ä¸åˆ°è‡ªå·±è®¿é—®çš„æ˜¯åå‘ä»£ç†æœåŠ¡å™¨ã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322064703065.png" alt="image-20210322064703065"></p>
<p>ä¾‹å¦‚ï¼ŒNginxçš„åå‘ä»£ç†åŠŸèƒ½ï¼Œè§£å†³è®¿é—®è·¨åŸŸé—®é¢˜ï¼Œæˆ–è€…å®ç°å¤šä¸ªæœåŠ¡å™¨è´Ÿè½½å‡è¡¡çš„æ•ˆæœã€‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322064734300.png" alt="image-20210322064734300"></p>
<p>1ã€ä¿®æ”¹nginxçš„é…ç½®æ–‡ä»¶nginx.conf</p>
<p>ä¿®æ”¹å‰çš„é…ç½®æ–‡ä»¶ä¸ºï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322064805891.png" alt="image-20210322064805891"></p>
<p>ä¿®æ”¹åçš„é…ç½®æ–‡ä»¶ä¸ºï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322064827250.png" alt="image-20210322064827250"></p>
<blockquote>
<p>ç‰¹åˆ«æ³¨æ„ï¼Œnginxå¯åŠ¨çš„æ—¶å€™ï¼Œä¸€å®šä¸è¦å­˜æ”¾åœ¨æœ‰ä¸­æ–‡çš„è·¯å¾„ä¸­ï¼Œå¦‚æœå¯åŠ¨å¤±è´¥ï¼ŒæŸ¥çœ‹é”™è¯¯çš„æ—¥å¿—è®°å½•</p>
</blockquote>
<p>conf.config</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#user  nobody;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">#error_log  logs/error.log;</span><br><span class="line">#error_log  logs/error.log  notice;</span><br><span class="line">#error_log  logs/error.log  info;</span><br><span class="line"></span><br><span class="line">#pid        logs/nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    #log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">    #                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">    #                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page /50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    proxy_pass   http://127.0.0.1;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    root           html;</span><br><span class="line">        #    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">        #    fastcgi_index  index.php;</span><br><span class="line">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">        #    include        fastcgi_params;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class="line">        # concurs with nginx&#x27;s one</span><br><span class="line">        #</span><br><span class="line">        #location ~ /\.ht &#123;</span><br><span class="line">        #    deny  all;</span><br><span class="line">        #&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       8000;</span><br><span class="line">    #    listen       somename:8080;</span><br><span class="line">    #    server_name  somename  alias  another.alias;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # HTTPS server</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       443 ssl;</span><br><span class="line">    #    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #    ssl_certificate      cert.pem;</span><br><span class="line">    #    ssl_certificate_key  cert.key;</span><br><span class="line"></span><br><span class="line">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    #    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    #    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">location /html &#123;</span><br><span class="line">    rewrite ^/html/(.*)$ /$1 break;</span><br><span class="line">    proxy_pass http://localhost:9999/;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å½“è®¿é—®æŒ‡å®šåœ°å€ <a href="http://localhost/html">http://localhost/html</a> çš„æ—¶å€™ï¼Œä¼šå…ˆé‡å†™URIåœ°å€</li>
<li>URIç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼^/api/(.*)$ çš„åœ°å€ä¼šè¢«é‡å†™ä¸º /$1</li>
<li>$1è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼ä¸­ç¬¬ä¸€ä¸ª()ä¸­çš„å­—ç¬¦ä¸²</li>
<li>æœ€åæŠŠé‡å†™åçš„æ–°åœ°å€ï¼Œè½¬å‘ç»™<a href="http://localhost:9999/">http://localhost:9999/</a></li>
</ul>
<p>ä¾‹å¦‚ï¼Œ<br>æµè§ˆå™¨ä¸­è®¿é—®<a href="http://localhost/html/ajax">http://localhost/html/ajax</a><br>nginxä»£ç†åï¼Œå…ˆé‡å†™åœ°å€ï¼Œå°†/html/ajaxï¼Œé‡å†™ä¸º/ajax<br>ç„¶åè½¬å‘ç»™<a href="http://localhost:9999/">http://localhost:9999/</a> ï¼Œæœ€ç»ˆè®¿é—®çš„æ˜¯<a href="http://localhost:9999/ajax">http://localhost:9999/ajax</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">location /api &#123;</span><br><span class="line">    rewrite ^/api/(.*)$ /$1 break;</span><br><span class="line">    proxy_pass http://localhost:8989/;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œå’Œä¸Šé¢çš„æè¿°çš„å«ä¹‰ç›¸åŒ</p>
</blockquote>
<p>2ã€ajaxé¡µé¢ä¸­ï¼Œæ–°å¢æŒ‰é’®å’Œajaxè¯·æ±‚</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">  $(&quot;.btn2&quot;).on(&quot;click&quot;,function()&#123;</span><br><span class="line">                $.ajax(&#123;</span><br><span class="line">                    type: &quot;GET&quot;,</span><br><span class="line">                    url : &quot;/api/hi&quot;,</span><br><span class="line">                    success: function(msg)&#123;</span><br><span class="line">                        console.log(msg);</span><br><span class="line">                    &#125;,</span><br><span class="line">                    error: function()&#123;</span><br><span class="line">                        alert(&#x27;error&#x27;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn2&quot;</span>&gt;</span>test2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>3ã€å¯åŠ¨nginxæœåŠ¡å™¨ï¼Œè®¿é—®åœ°å€</p>
<p><a href="http://localhost/html/ajax">http://localhost/html/ajax</a></p>
<blockquote>
<p>æ³¨æ„ï¼Œæ­¤æ—¶è®¿é—®springboot-htmlé¡¹ç›®ä¸­çš„é¡µé¢åœ°å€ï¼Œå’Œä¹‹å‰æ˜¯ä¸ä¸€æ ·çš„</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322074942961.png" alt="image-20210322074942961"></p>
<p>æ²¡æœ‰ä½¿ç”¨nginxä¹‹å‰ï¼Œè®¿é—®springboot-htmlä¸­é¡µé¢çš„åœ°å€ï¼š <a href="http://localhost:9999/ajax">http://localhost:9999/ajax</a></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322070308045.png" alt="image-20210322070308045"></p>
<p>ä½¿ç”¨nginxä¹‹åï¼Œè®¿é—®springboot-htmlä¸­é¡µé¢çš„åœ°å€ï¼š <a href="http://localhost/html/ajax">http://localhost/html/ajax</a></p>
<p>4ã€ç‚¹å‡»æŒ‰é’®2ï¼Œå‘é€ajaxè¯·æ±‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322075035934.png" alt="image-20210322075035934"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶ajaxè¯·æ±‚å·²ç»æˆåŠŸäº†</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322075121167.png" alt="image-20210322075121167"></p>
<blockquote>
<p>æ³¨æ„ï¼Œæ­¤æ—¶ajaxè¯·æ±‚çš„åœ°å€ä¸ºï¼š <a href="http://localhost/api/hi">http://localhost/api/hi</a></p>
</blockquote>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œå·²å®Œæˆè·¨åŸŸè®¿é—®ï¼Œä½†å…¶å®æ˜¯ä½¿ç”¨nginxä»£ç†æœåŠ¡å™¨æ¥â€œæ¬ºéª—â€æµè§ˆå™¨ï¼Œè®©æµè§ˆå™¨è®¤ä¸ºæ˜¯ â€œåŒæºè®¿é—®â€</p>
</blockquote>
<p>å¦‚å›¾ï¼š</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322070521188.png" alt="image-20210322070521188"></p>
<blockquote>
<p>æµè§ˆå™¨ä¸­ï¼Œä»å§‹è‡³ç»ˆéƒ½æ˜¯è®¿é—®<a href="http://localhost/">http://localhost/</a> ä¸‹é¢çš„èµ„æºï¼Œæ‰€ä»¥æµè§ˆå™¨è®¤ä¸ºä¸€ç›´æ˜¯â€œåŒæºè®¿é—®â€</p>
</blockquote>
<blockquote>
<p>æµè§ˆå™¨ä¸çŸ¥é“çš„æ˜¯ï¼Œå®ƒè®¿é—®çš„æœåŠ¡å™¨æ˜¯ä¸€ä¸ªnginxä»£ç†æœåŠ¡å™¨ï¼Œå®ƒä¼šæ¥æ”¶æµè§ˆå™¨è¯·æ±‚ï¼Œé‡å†™URIåœ°å€<br>åï¼Œè½¬å‘ç»™çœŸæ­£çš„æœåŠ¡å™¨ã€‚</p>
</blockquote>
<h3 id="3-2-cors"><a href="#3-2-cors" class="headerlink" title="3.2 cors"></a>3.2 cors</h3><h4 id="1ã€æ¦‚å¿µ"><a href="#1ã€æ¦‚å¿µ" class="headerlink" title="1ã€æ¦‚å¿µ"></a>1ã€æ¦‚å¿µ</h4><p>CORS(Cross-origin resource sharing)ï¼Œæ˜¯ä¸€ä¸ªW3Cæ ‡å‡†ï¼Œå…¨ç§°æ˜¯â€è·¨åŸŸèµ„æºå…±äº«â€ã€‚</p>
<ul>
<li>æ•´ä¸ªCORSé€šä¿¡è¿‡ç¨‹ï¼Œéƒ½æ˜¯æµè§ˆå™¨è‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·å‚ä¸ã€‚</li>
<li>å¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒCORSé€šä¿¡ä¸åŒæºçš„AJAXé€šä¿¡æ²¡æœ‰å·®åˆ«ï¼Œä»£ç å®Œå…¨ä¸€æ ·ã€‚</li>
<li>æµè§ˆå™¨ä¸€æ—¦å‘ç°AJAXè¯·æ±‚è·¨æºï¼Œå°±ä¼šè‡ªåŠ¨æ·»åŠ ä¸€äº›é™„åŠ çš„å¤´ä¿¡æ¯ã€‚ï¼ˆOriginï¼‰</li>
<li>æœ‰æ—¶è¿˜ä¼šå¤šå‡ºä¸€æ¬¡é™„åŠ çš„è¯·æ±‚ï¼Œä½†ç”¨æˆ·ä¸ä¼šæœ‰æ„Ÿè§‰ã€‚ï¼ˆoptionsæ–¹å¼çš„è¯·æ±‚ï¼‰</li>
</ul>
<h4 id="2ã€åˆ†ç±»"><a href="#2ã€åˆ†ç±»" class="headerlink" title="2ã€åˆ†ç±»"></a>2ã€åˆ†ç±»</h4><p>æµè§ˆå™¨å°†CORSè¯·æ±‚åˆ†æˆä¸¤ç±»ï¼š</p>
<ul>
<li>ç®€å•è¯·æ±‚ï¼ˆsimple requestï¼‰</li>
<li>éç®€å•è¯·æ±‚ï¼ˆnot-so-simple requestï¼‰</li>
</ul>
<p>åªè¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤å¤§æ¡ä»¶ï¼Œå°±å±äºç®€å•è¯·æ±‚ï¼š</p>
<p>è¯·æ±‚æ–¹æ³•æ˜¯ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ä¹‹ä¸€<br>    GET<br>    POST<br>    HEAD<br>HTTPçš„å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µ<br>    Accept<br>    Accept-Language</p>
<p>â€‹    Content-Language<br>â€‹    Last-Event-ID<br>â€‹    Content-Typeï¼Œè¯¥å­—æ®µçš„å€¼åªèƒ½æ˜¯ä»¥ä¸‹ä¸‰ç§</p>
<p>â€‹        application/x-www-form-urlencoded</p>
<p>â€‹        multipart/form-data<br>â€‹        text/plain</p>
<blockquote>
<p>æ³¨æ„ï¼Œåªè¦ä¸èƒ½åŒæ—¶æ»¡è¶³ä¸Šé¢ä¸¤ä¸ªæ¡ä»¶ï¼Œå°±å±äºéç®€å•è¯·æ±‚ã€‚</p>
</blockquote>
<h4 id="3ã€ç®€å•è¯·æ±‚"><a href="#3ã€ç®€å•è¯·æ±‚" class="headerlink" title="3ã€ç®€å•è¯·æ±‚"></a>3ã€ç®€å•è¯·æ±‚</h4><p>å¯¹äºç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ç›´æ¥å‘å‡ºCORSè¯·æ±‚ï¼ŒåŒæ—¶åœ¨è¯·æ±‚å¤´ä¸­å¢åŠ ä¸€ä¸ªOriginå­—æ®µã€‚<br>è¯¥å­—æ®µè¡¨ç¤ºï¼Œæœ¬æ¬¡è¯·æ±‚æ¥è‡ªå“ªä¸ªæºï¼ˆåè®® + åŸŸå + ç«¯å£ï¼‰ï¼ŒæœåŠ¡å™¨æ ¹æ®è¿™ä¸ªå€¼ï¼Œå†³å®šæ˜¯å¦åŒæ„è¿™æ¬¡è¯·<br>æ±‚ã€‚</p>
<p>OriginæŒ‡å®šçš„æºï¼Œå³ä½¿ä¸åœ¨æœåŠ¡å™¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨è¿˜æ˜¯ä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„HTTPå“åº”ï¼Œä½†æ˜¯å“åº”å¤´ä¸­<br>ä¸å«æŒ‡å®šAccess-Control-Allow-Originå­—æ®µï¼Œæµè§ˆå™¨è¿™æ—¶å€™å°±çŸ¥é“æœ¬æ¬¡è·¨åŸŸè®¿é—®å¤±è´¥ã€‚<br>ä½†æ˜¯è¿™ä¸ªæ—¶å€™ï¼Œå“åº”çŠ¶æ€å¯èƒ½æ˜¯200ï¼ŒåŒæ—¶åœ¨ä¸€äº›å·¥å…·ä¸­è¿˜èƒ½çœ‹åˆ°æ­£ç¡®çš„è¿”å›å€¼ã€‚<br>ä¾‹å¦‚ï¼Œ</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322070848847.png" alt="image-20210322070848847"></p>
<p>å…¶ä¸­ï¼Œ</p>
<ol>
<li>æµè§ˆå™¨åœ¨è¯·æ±‚å¤´ä¸­è‡ªåŠ¨æ·»åŠ äº†Origin å­—æ®µ</li>
<li>æœåŠ¡å™¨åœ¨å“åº”ä¸­æ²¡æœ‰æ·»åŠ Access-Control-Allow-Origin å­—æ®µï¼ˆè¯´æ˜æœåŠ¡å™¨ä¸æ”¯æŒæ­¤è¯·æ±‚è·¨åŸŸè®¿<br>é—®ï¼‰</li>
<li>å“åº”çš„çŠ¶æ€ç æ˜¯200ï¼Œå¹¶ä¸”ä»å“åº”å†…å®¹ä¸­å¯ä»¥çœ‹åˆ°æ­£ç¡®çš„è¿”å›å†…å®¹</li>
<li>åŒæ—¶ï¼Œæµè§ˆå™¨ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¢«ajaxçš„æ ¸å¿ƒå¯¹è±¡XMLHttpRequestçš„onerror å›è°ƒå‡½æ•°æ•è·</li>
</ol>
<p>å¦‚æœOriginæŒ‡å®šçš„åŸŸååœ¨æœåŠ¡å™¨çš„è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨è¿”å›çš„å“åº”ï¼Œä¼šå¤šå‡ºå‡ ä¸ªå¤´ä¿¡æ¯å­—æ®µï¼š</p>
<ol>
<li><p>Access-Control-Allow-Origin<br>è¯¥å­—æ®µæ˜¯å¿…é¡»çš„ã€‚<br>å®ƒçš„å€¼è¦ä¹ˆæ˜¯è¯·æ±‚æ—¶Originå­—æ®µçš„å€¼ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ª*ï¼Œè¡¨ç¤ºæ¥å—ä»»æ„åŸŸåçš„è·¨åŸŸè¯·æ±‚ã€‚</p>
</li>
<li><p>Access-Control-Allow-Credentials</p>
<p>è¯¥å­—æ®µå¯é€‰<br>è¡¨ç¤ºæ˜¯å¦å…è®¸å‘é€Cookieã€‚<br>è®¾ä¸ºtrueï¼Œå³è¡¨ç¤ºæœåŠ¡å™¨å·²ç»å…è®¸äº†ï¼Œè·¨åŸŸè¯·æ±‚ä¸­å¯ä»¥æºå¸¦Cookieã€‚<br>ä½†æ˜¯è¿™éœ€è¦AJAXä¸­è®¾ç½®withCredentials=trueè¿›è¡Œé…åˆã€‚<br>å¦‚æœæœåŠ¡å™¨ä¸è¦æµè§ˆå™¨å‘é€Cookieï¼Œåˆ é™¤è¯¥å­—æ®µå³å¯ã€‚</p>
</li>
</ol>
<p><code>3. Access-Control-Expose-Headers</code></p>
<p>â€‹    è¯¥å­—æ®µå¯é€‰<br>â€‹    åˆ—å‡ºäº†å“ªäº›é¦–éƒ¨å¯ä»¥ä½œä¸ºå“åº”çš„ä¸€éƒ¨åˆ†æš´éœ²ç»™å¤–éƒ¨ã€‚<br>â€‹    é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸ƒç§å¯ä»¥æš´éœ²ç»™å¤–éƒ¨<br>â€‹    Cache-Control<br>â€‹    Content-Language<br>â€‹    Content-Length<br>â€‹    Content-Type<br>â€‹    Expires<br>â€‹    Last-Modified<br>â€‹    Pragma</p>
<p>â€‹    å¦‚æœæƒ³è¦è®©å®¢æˆ·ç«¯å¯ä»¥è®¿é—®åˆ°å…¶ä»–çš„é¦–éƒ¨ä¿¡æ¯ï¼Œå¯ä»¥å°†å®ƒä»¬åœ¨Access-Control-Expose-Headersé‡Œé¢æŒ‡å®š</p>
<h4 id="4ã€éç®€å•è¯·æ±‚"><a href="#4ã€éç®€å•è¯·æ±‚" class="headerlink" title="4ã€éç®€å•è¯·æ±‚"></a>4ã€éç®€å•è¯·æ±‚</h4><p>éç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯PUTæˆ–DELETEï¼Œæˆ–è€…Content-Typeå­—æ®µçš„ç±»å‹æ˜¯application/jsonã€‚<br>éç®€å•è¯·æ±‚çš„CORSè¯·æ±‚ï¼Œä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œå¢åŠ ä¸€æ¬¡HTTPæŸ¥è¯¢è¯·æ±‚ï¼Œç§°ä¸ºâ€é¢„æ£€â€è¯·æ±‚ï¼ˆpreflightï¼‰ã€‚<br>æµè§ˆå™¨å…ˆè¯¢é—®æœåŠ¡å™¨ï¼Œå½“å‰ç½‘é¡µæ‰€åœ¨çš„åŸŸåæ˜¯å¦åœ¨æœåŠ¡å™¨çš„è®¸å¯åå•ä¹‹ä¸­ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº›HTTPåŠ¨è¯<br>å’Œå¤´ä¿¡æ¯å­—æ®µã€‚åªæœ‰å¾—åˆ°è‚¯å®šç­”å¤ï¼Œæµè§ˆå™¨æ‰ä¼šå‘å‡ºæ­£å¼çš„XMLHttpRequestè¯·æ±‚ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="string">&quot;.btn1&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">        <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span><br><span class="line">        <span class="attr">contentType</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">        <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(msg);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œåœ¨è¯·æ±‚å¤´ä¸­ï¼ŒæŒ‡å®šcontentTypeä¸ºapplication/json</p>
</blockquote>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322071208502.png" alt="image-20210322071208502"></p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œè¯·æ±‚å¤´ä¸­æœ‰Content-Type:application/json å­—æ®µï¼Œå±äºéç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šæå‰å‘é€ä¸€ä¸ªoptionæ–¹å¼çš„â€œé¢„æ£€è¯·æ±‚â€(é¢„æ£€è¯·æ±‚ä¼šç¼“å­˜)</p>
</blockquote>
<p>åœ¨è¿™ä¸ªâ€œé¢„æ£€è¯·æ±‚â€çš„å“åº”ä¸­ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€äº›æ•°æ®æ¥é€šçŸ¥æµè§ˆå™¨ï¼ŒæœåŠ¡å™¨å¯¹è·¨åŸŸè¯·æ±‚çš„è¦æ±‚</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20210322071259213.png" alt="image-20210322071259213"></p>
<p>å¦‚æœæµè§ˆå™¨å¦å®šäº†â€œé¢„æ£€â€è¯·æ±‚ï¼Œä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„HTTPå›åº”ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•CORSç›¸å…³çš„å¤´ä¿¡æ¯å­—æ®µã€‚<br>è¿™æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šè®¤å®šï¼ŒæœåŠ¡å™¨ä¸åŒæ„é¢„æ£€è¯·æ±‚ï¼Œå› æ­¤è§¦å‘ä¸€ä¸ªé”™è¯¯ï¼Œè¢«XMLHttpRequestå¯¹è±¡çš„onerror<br>å›è°ƒå‡½æ•°æ•è·ã€‚</p>
<blockquote>
<p>æµ‹è¯•ç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚</p>
</blockquote>
<p>==â€œé¢„æ£€â€æˆåŠŸçš„å¸¸è§å“åº”å¤´éƒ¨å­—æ®µæœ‰ï¼š==</p>
<ul>
<li>Access-Control-Allow-Origin é…ç½®ip</li>
<li>Access-Control-Allow-Methods é…ç½®è¯·æ±‚æ–¹å¼</li>
<li>Access-Control-Allow-Headers é…ç½®è¯·æ±‚å¤´</li>
<li>Access-Control-Allow-Credentials é…ç½®æ˜¯å¦ä¿¡ä»»cookie<br>æ ‡ç­¾å…è®¸å®¢æˆ·ç«¯æºå¸¦éªŒè¯ä¿¡æ¯ï¼Œä¾‹å¦‚ cookie<pre><code>Access-Control-Max-Age
è¡¨ç¤ºé¢„æ£€è¯·æ±‚çš„è¿”å›ç»“æœï¼ˆå³Access-Control-Allow-Methods å’ŒAccess-Control-Allow-Headersæä¾›çš„ä¿¡æ¯ï¼‰ å¯ä»¥è¢«ç¼“å­˜å¤šä¹…ã€‚
</code></pre>
</li>
</ul>
<p>æ³¨æ„ï¼Œajaxè·¨åŸŸè®¿é—®çš„æ—¶å€™ï¼Œå¦‚æœéœ€è¦åœ¨è¯·æ±‚ä¸­æºå¸¦cookieï¼Œéœ€è¦æœ‰ä»¥ä¸‹è®¾ç½®</p>
<ol>
<li><p>å‰ç«¯ajaxè¯·æ±‚ä¸­ï¼ŒæŒ‡å®šwithCredentialså±æ€§ä¸ºture</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">    <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span><br><span class="line">    <span class="attr">xhrFields</span>:&#123;</span><br><span class="line">   		 <span class="attr">withCredentials</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(msg);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>åç«¯å“åº”å¤´ä¸­ï¼Œè®¾ç½®Access-Control-Allow-Credentialså±æ€§ä¸ºtrue</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å…è®¸è·¨åŸŸæºå¸¦cookie</span></span><br><span class="line">response.setHeader(<span class="string">&quot;Access-Control-Allow-Credentials&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ol>
<ol start="3">
<li>åç«¯å“åº”å¤´ä¸­ï¼Œè®¾ç½®Access-Control-Allow-Originå±æ€§ä¸ºå…·ä½“çš„å€¼ï¼Œè€Œä¸æ˜¯èƒ½é€šé…ç¬¦*</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);</span></span><br><span class="line">response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;http://127.0.0.1:9999&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">	<span class="comment">// å…è®¸cookieçš„æƒ…å†µä¸‹ å‰ç«¯é…ç½® åå°é…ç½®</span></span><br><span class="line">	<span class="meta">@GetMapping(&quot;/hi&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">		response.setHeader(<span class="string">&quot;Access-Control-Allow-Credentials&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">		response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;http://localhost:9999&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">   <span class="comment">// ä¸å…è®¸cookieçš„æƒ…å†µä¸‹</span></span><br><span class="line">   <span class="meta">@GetMapping(&quot;/hi&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">		response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å‰ç«¯è®¿é—® <a href="http://localhost:9999/ajax">http://localhost:9999/ajax</a> åå°å°±é… localhost</p>
<p>æ­¤æ—¶æ— æ³•å¤„ç†é¢„æ£€æŸ¥è¯·æ±‚</p>
</blockquote>
<h4 id="5ã€ä½¿ç”¨"><a href="#5ã€ä½¿ç”¨" class="headerlink" title="5ã€ä½¿ç”¨"></a>5ã€ä½¿ç”¨</h4><p>springboot-htmlé¡¹ç›®ä¸­çš„ajax.htmlé¡µé¢ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;script src=&quot;https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js&quot;&gt;&lt;/script&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;.btn1&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">console</span>.log(msg);</span></span><br><span class="line"><span class="javascript">                    &#125;,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        alert(<span class="string">&#x27;error&#x27;</span>);</span></span><br><span class="line"><span class="javascript">                    &#125;</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;.btn2&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">url</span> : <span class="string">&quot;/api/hi&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">console</span>.log(msg);</span></span><br><span class="line"><span class="javascript">                    &#125;,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        alert(<span class="string">&#x27;error&#x27;</span>);</span></span><br><span class="line"><span class="javascript">                    &#125;</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript">            </span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;.btn3&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">console</span>.log(msg);</span></span><br><span class="line"><span class="javascript">                    &#125;,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        alert(<span class="string">&#x27;error&#x27;</span>);</span></span><br><span class="line"><span class="javascript">                    &#125;</span></span><br><span class="line"><span class="javascript">                &#125;);</span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        &#125;);</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn1&quot;</span>&gt;</span>test1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn2&quot;</span>&gt;</span>test2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn3&quot;</span>&gt;</span>test3<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¸»è¦æµ‹è¯•çš„æ˜¯test3æŒ‰é’®</p>
</blockquote>
<p>springboot-corsé¡¹ç›®ä¸­çš„Controllerï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.web.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@GetMapping(&quot;/hi&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>springboot-corsé¡¹ç›®ä¸­çš„é…ç½®ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.CorsRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)<span class="comment">//æ˜ å°„æ‰€æœ‰è·¯å¾„</span></span><br><span class="line">        .allowedOrigins(<span class="string">&quot;*&quot;</span>)<span class="comment">//è¿è¡Œæ‰€æœ‰å®¢æˆ·ç«¯è®¿é—®</span></span><br><span class="line">        .allowCredentials(<span class="keyword">false</span>)<span class="comment">//ä¸å…è®¸æºå¸¦cookie</span></span><br><span class="line">        .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)<span class="comment">//</span></span><br><span class="line">        æ”¯æŒçš„æ–¹æ³•</span><br><span class="line">        .allowedHeaders(<span class="string">&quot;*&quot;</span>)<span class="comment">//è¿è¡Œæ‰€æœ‰è¯·æ±‚å¤´å­—æ®µ</span></span><br><span class="line">        .maxAge(<span class="number">3600</span>);<span class="comment">//å…è®¸å®¢æˆ·ç«¯ç¼“å­˜â€œé¢„æ£€è¯·æ±‚â€ä¸­è·å–çš„ä¿¡æ¯ï¼Œ3600ç§’</span></span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¸»è¦é…ç½®äº†è·¨åŸŸè®¿é—®çš„å±æ€§</p>
</blockquote>
<p>å¯åŠ¨ä¿©ä¸ªé¡¹ç›®ï¼Œè®¿é—®é¡µé¢ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œæµ‹è¯•ajaxè·¨åŸŸè®¿é—®ï¼š</p>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶ajaxè¯·æ±‚è¿›è¡Œè·¨åŸŸè®¿é—®ï¼Œå·²ç»æˆåŠŸ</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œæ­¤æ—¶å¯ä»¥å°è¯•åœ¨ajaxè¯·æ±‚ä¸­ï¼Œè®¾ç½®contentType: application/json ,è§‚å¯Ÿæ˜¯å¦ä¼šå‘å‡ºâ€œé¢„æ£€â€è¯·æ±‚</p>
</blockquote>
<p>åŒæ—¶ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹ajaxè¯·æ±‚ï¼Œè®©å…¶å†™çš„cookieå’ŒæŒ‡å®šå­—æ®µçš„å¤´éƒ¨ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="string">&quot;.btn3&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">        <span class="attr">url</span> : <span class="string">&quot;http://localhost:8989/hi&quot;</span>,</span><br><span class="line">        <span class="attr">xhrFields</span>:&#123;</span><br><span class="line">        <span class="attr">withCredentials</span>: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">headers</span>:&#123;</span><br><span class="line">        <span class="attr">token</span>:<span class="string">&quot;aaa.bbb.ccc&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">contentType</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">        <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(msg);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">        alert(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œå¯¹åº”çš„åç«¯è·¨åŸŸè®¾ç½®ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">        .allowedOrigins(<span class="string">&quot;http://localhost:9999&quot;</span>)</span><br><span class="line">        .allowCredentials(<span class="keyword">true</span>)</span><br><span class="line">        .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)</span><br><span class="line">        .allowedHeaders(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">        .maxAge(<span class="number">3600</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="6ã€å…¶ä»–"><a href="#6ã€å…¶ä»–" class="headerlink" title="6ã€å…¶ä»–"></a>6ã€å…¶ä»–</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">    registry.addMapping(<span class="string">&quot;/**&quot;</span>)<span class="comment">//æ˜ å°„æ‰€æœ‰è·¯å¾„</span></span><br><span class="line">    .allowedOrigins(<span class="string">&quot;*&quot;</span>)<span class="comment">//è¿è¡Œæ‰€æœ‰å®¢æˆ·ç«¯è®¿é—®</span></span><br><span class="line">    .allowCredentials(<span class="keyword">false</span>)<span class="comment">//ä¸å…è®¸æºå¸¦cookie</span></span><br><span class="line">    .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)<span class="comment">//æ”¯æŒçš„æ–¹æ³•</span></span><br><span class="line">    .allowedHeaders(<span class="string">&quot;*&quot;</span>)<span class="comment">//è¿è¡Œæ‰€æœ‰è¯·æ±‚å¤´å­—æ®µ</span></span><br><span class="line">    .maxAge(<span class="number">3600</span>);<span class="comment">//å…è®¸å®¢æˆ·ç«¯ç¼“å­˜â€œé¢„æ£€è¯·æ±‚â€ä¸­è·å–çš„ä¿¡æ¯ï¼Œ3600ç§’</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨æ­¤é…ç½®ä¸­ï¼Œå¦‚æœè®¾ç½®allowCredentials(true) ï¼Œé‚£ä¹ˆallowedOrigins(â€œ*â€) è¿™é‡Œå°±ä¸èƒ½ä½¿ç”¨é€š<br>é…ç¬¦äº†ï¼Œå¿…é¡»è¦å†™ä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼ˆå¯å˜å‚æ•°ï¼‰å®¢æˆ·ç«¯çš„åœ°å€<br>ä¾‹å¦‚ï¼Œ allowedOrigins(â€œ<a href="http://127.0.0.1:9999&quot;">http://127.0.0.1:9999&quot;</a>)</p>
<p>å¦å¤–ï¼Œå¦‚æœåªæ˜¯æƒ³è®©Controllerä¸­çš„æŸä¸€ä¸ªæ–¹æ³•æˆ–è€…å‡ ä¸ªæ–¹æ³•è¢«è·¨åŸŸè®¿é—®ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨æ–¹æ³•ä¸Šä½¿ç”¨<br>@CrossOrigin æ³¨è§£ï¼Œä¾‹å¦‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@CrossOrigin(origins = &#123;&quot;http://127.0.0.1:9999&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hi&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œæ­¤æ—¶å°±ä¸éœ€è¦åœ¨é…ç½®ç±»ä¸­åšå…¶ä»–é…ç½®äº†ï¼Œç›´æ¥ä¸€ä¸ªæ³¨è§£å°±å¯ä»¥è®©è¯¥æ–¹æ³•è¢«è·¨åŸŸè®¿é—®äº†</p>
</blockquote>
<h1 id="è§’è‰²æ¨¡å—"><a href="#è§’è‰²æ¨¡å—" class="headerlink" title="è§’è‰²æ¨¡å—"></a>è§’è‰²æ¨¡å—</h1><h2 id="æ¥å£-1"><a href="#æ¥å£-1" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RoleService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è·å–æ‰€æœ‰è§’è‰²ä¿¡æ¯</span></span><br><span class="line">    <span class="function">List&lt;Role&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//æ–°å¢è§’è‰²ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">(Role role)</span></span>;</span><br><span class="line">    <span class="comment">// åˆ é™¤è§’è‰²ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ·»åŠ "><a href="#æ·»åŠ " class="headerlink" title="æ·»åŠ "></a>æ·»åŠ </h2><h3 id="mapper-2"><a href="#mapper-2" class="headerlink" title="mapper"></a>mapper</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByName&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.briup.cms.entity.Role&quot;</span>&gt;</span></span><br><span class="line">    select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.RoleMapper.Base_Column_List&quot;</span>/&gt;</span></span><br><span class="line">    from cms_role</span><br><span class="line">    where name = #&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="service-8"><a href="#service-8" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Role role)</span> </span>&#123;</span><br><span class="line">       String name = role.getName();</span><br><span class="line">       <span class="keyword">if</span> (!StringUtils.hasText(name)) &#123;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.PARAM_IS_BLANK);</span><br><span class="line">       &#125;</span><br><span class="line">	Role roleFromDB = roleExtendMapper.findByName(name);</span><br><span class="line">       <span class="keyword">if</span>(roleFromDB != <span class="keyword">null</span>)&#123;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_EXISTED);</span><br><span class="line">	&#125;</span><br><span class="line">       roleMapper.insertSelective(role);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-8"><a href="#controller-8" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;æ·»åŠ è§’è‰²&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">save</span><span class="params">(<span class="meta">@RequestBody</span> Role role)</span> </span>&#123;</span><br><span class="line">		roleService.save(role);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><h3 id="mapper-3"><a href="#mapper-3" class="headerlink" title="mapper"></a>mapper</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.briup.cms.entity.Role&quot;</span>&gt;</span></span><br><span class="line">        select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.RoleMapper.Base_Column_List&quot;</span>/&gt;</span></span><br><span class="line">        from cms_role</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="service-9"><a href="#service-9" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> List&lt;Role&gt; <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> roleExtendMapper.findAll();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-9"><a href="#controller-9" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;findAll&quot;)</span></span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;æŸ¥è¯¢æ‰€æœ‰&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> Result.success(roleService.findAll());</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ é™¤-1"><a href="#åˆ é™¤-1" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><h3 id="service-10"><a href="#service-10" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        roleMapper.deleteByPrimaryKey(id);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-10"><a href="#controller-10" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping(&quot;delete/&#123;id&#125;&quot;)</span></span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;åˆ é™¤è§’è‰²&quot;)</span></span><br><span class="line">	<span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">			@ApiImplicitParam(name = &quot;id&quot;, value = &quot;è§’è‰²id&quot;, required = true, dataType = &quot;int&quot;, paramType = &quot;path&quot;)</span></span><br><span class="line"><span class="meta">	&#125;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">delete</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> </span>&#123;</span><br><span class="line">		roleService.delete(id);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;	</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ é™¤çœ‹ä¸Šå»æ²¡æœ‰ä»»ä½•é—®é¢˜ æ­¤æ—¶æœ‰è§’è‰²äº†,å›å¤´æ¥çœ‹ç”¨æˆ·æ¨¡å—</p>
</blockquote>
<h2 id="ç”¨æˆ·æ–°å¢"><a href="#ç”¨æˆ·æ–°å¢" class="headerlink" title="==ç”¨æˆ·æ–°å¢=="></a>==ç”¨æˆ·æ–°å¢==</h2><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;birthday&quot;</span>: <span class="string">&quot;2000-01-01 00:00:00&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;gender&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;briup&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;phone&quot;</span>: <span class="number">13500000000</span>,</span><br><span class="line">  <span class="attr">&quot;realName&quot;</span>: <span class="string">&quot;briup&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;roleId&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;briup&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ç”¨æˆ·æŸ¥è¯¢"><a href="#ç”¨æˆ·æŸ¥è¯¢" class="headerlink" title="==ç”¨æˆ·æŸ¥è¯¢=="></a>==ç”¨æˆ·æŸ¥è¯¢==</h2><h3 id="entity"><a href="#entity" class="headerlink" title="entity"></a>entity</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserExtend</span> <span class="keyword">extends</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Role role;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="mapper-4"><a href="#mapper-4" class="headerlink" title="mapper"></a>mapper</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userWithRole&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">extends</span>=<span class="string">&quot;com.briup.cms.mapper.UserMapper.BaseResultMap&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">type</span>=<span class="string">&quot;com.briup.cms.entity.extend.UserExtend&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;role&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.briup.cms.entity.Role&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">select</span>=<span class="string">&quot;com.briup.cms.mapper.RoleMapper.selectByPrimaryKey&quot;</span> <span class="attr">column</span>=<span class="string">&quot;role_id&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userWithRole&quot;</span>&gt;</span></span><br><span class="line">        select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.UserMapper.Base_Column_List&quot;</span>/&gt;</span></span><br><span class="line">        from cms_user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="service-11"><a href="#service-11" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> PageUtil&lt;UserExtend&gt; <span class="title">getAll</span><span class="params">(PageUtil&lt;UserExtend&gt; pageUtil)</span> </span>&#123;</span><br><span class="line">       PageHelper.startPage(pageUtil.getPageNumber(),pageUtil.getPageSize());</span><br><span class="line">       Map&lt;String, Object&gt; params = pageUtil.getParams();</span><br><span class="line">       <span class="comment">//params.put(&quot;gender&quot;,0);</span></span><br><span class="line">       Page all = userExtendMapper.getAll(params);</span><br><span class="line">       pageUtil.setList(all.getResult());</span><br><span class="line">       pageUtil.setTotal(all.getTotal());</span><br><span class="line">       <span class="keyword">return</span> pageUtil;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>é‡æ–°æµ‹è¯•</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;code&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;msg&quot;</span>: <span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;data&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;pageNumber&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">&quot;pageSize&quot;</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="attr">&quot;total&quot;</span>: <span class="number">6</span>,</span><br><span class="line">    <span class="attr">&quot;list&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>: <span class="number">21</span>,</span><br><span class="line">        <span class="attr">&quot;birthday&quot;</span>: <span class="string">&quot;2000-01-01 00:00:00&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;gender&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;briup&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;phone&quot;</span>: <span class="string">&quot;13500000000&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;realName&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;registerTime&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;status&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;briup&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;roleId&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;role&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;ç®¡ç†å‘˜&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;admin&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;params&quot;</span>: &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="çº§è”åˆ é™¤"><a href="#çº§è”åˆ é™¤" class="headerlink" title="==çº§è”åˆ é™¤=="></a>==çº§è”åˆ é™¤==</h2><blockquote>
<p>å¦‚æœç”¨æˆ·æœ‰è§’è‰²å¤–é”®å…³è”çš„æƒ…å†µä¸‹,è§’è‰²æ— æ³•åˆ é™¤  (å¤–é”®çº¦æŸ)</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Cannot delete or update a parent row: a foreign key constraint fails (`cms_jd2017`.`cms_user`, CONSTRAINT `FKpgvo8dl2imh6ags819okkslx9` FOREIGN KEY (`role_id`) REFERENCES `cms_role` (`id`))</span><br><span class="line">	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)</span><br><span class="line">	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)</span><br><span class="line">	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)</span><br><span class="line">	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)</span><br></pre></td></tr></table></figure>



<ul>
<li>çº§è”åˆ é™¤ç”¨æˆ·(æ…ç”¨)</li>
<li>åˆ é™¤å¤–é”®ç½®ç©º (å°†æ¥å¯ä»¥ç»™ç”¨æˆ·é‡æ–°åˆ†é…è§’è‰²)</li>
</ul>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211213223030967.png" alt="image-20211213223030967"></p>
<h1 id="åˆ†ç±»æ¨¡å—"><a href="#åˆ†ç±»æ¨¡å—" class="headerlink" title="åˆ†ç±»æ¨¡å—"></a>åˆ†ç±»æ¨¡å—</h1><h2 id="æ¥å£-2"><a href="#æ¥å£-2" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.cms.entity.Category;</span><br><span class="line"><span class="keyword">import</span> com.briup.cms.utils.PageUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//åˆ†é¡µè·å–æ‰€æœ‰åˆ†ç±» å¹¶æŒ‰åºå·å‡åº</span></span><br><span class="line">	<span class="function">PageUtil&lt;Category&gt; <span class="title">findAll</span><span class="params">(PageUtil&lt;Category&gt; pageUtil)</span></span>;</span><br><span class="line">	<span class="comment">//æ–°å¢åˆ†ç±»æˆ–è€…æ›´æ–°åˆ†ç±»</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">saveCategory</span><span class="params">(Category category)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">updateCategory</span><span class="params">(Category category)</span></span>;</span><br><span class="line">	<span class="comment">//æ‰¹é‡åˆ é™¤åˆ†ç±»</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">deleteCategoryInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span></span>;</span><br><span class="line">	<span class="comment">//æ›´æ–°åˆ†ç±»åºå·</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">updateCategoryNo</span><span class="params">(Integer id, Integer no)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æŸ¥è¯¢æ‰€æœ‰"><a href="#æŸ¥è¯¢æ‰€æœ‰" class="headerlink" title="æŸ¥è¯¢æ‰€æœ‰"></a>æŸ¥è¯¢æ‰€æœ‰</h2><blockquote>
<p>å«æ’åº åˆ†é¡µ æ‰€åœ¨çˆ¶ç›®å½•</p>
</blockquote>
<h3 id="mapper-5"><a href="#mapper-5" class="headerlink" title="mapper"></a>mapper</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.cms.mapper.extend.CategoryExtendMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;categoryWithParent&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.briup.cms.entity.extend.CategoryExtend&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">extends</span>=<span class="string">&quot;com.briup.cms.mapper.CategoryMapper.BaseResultMap&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;category&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">javaType</span>=<span class="string">&quot;com.briup.cms.entity.Category&quot;</span> <span class="attr">column</span>=<span class="string">&quot;parent_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.briup.cms.mapper.CategoryMapper.selectByPrimaryKey&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;categoryWithParent&quot;</span>&gt;</span></span><br><span class="line">        select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.CategoryMapper.Base_Column_List&quot;</span>/&gt;</span></span><br><span class="line">        from cms_category</span><br><span class="line">        order by no desc</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="service-12"><a href="#service-12" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> PageUtil&lt;Category&gt; <span class="title">findAll</span><span class="params">(PageUtil&lt;Category&gt; pageUtil)</span> </span>&#123;</span><br><span class="line">		PageHelper.startPage(pageUtil.getPageNumber(),pageUtil.getPageSize());</span><br><span class="line">		Page&lt;Category&gt; all = categoryExtendMapper.findAll(pageUtil.getParams());</span><br><span class="line">		pageUtil.setList(all.getResult());</span><br><span class="line">		pageUtil.setTotal(all.getTotal());</span><br><span class="line">		<span class="keyword">return</span> pageUtil;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-11"><a href="#controller-11" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æŸ¥è¯¢ç›®å½•&quot;,notes = &quot;åˆ†é¡µå¹¶ä¸”é¡ºåºæŸ¥è¯¢&quot; )</span></span><br><span class="line">	<span class="meta">@PostMapping(&quot;/findAll&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">findAllSortbyno</span><span class="params">(<span class="meta">@RequestBody</span> PageUtil&lt;Category&gt; pageUtil)</span> </span>&#123;</span><br><span class="line">		PageUtil&lt;Category&gt; page = categoryService.findAll(pageUtil);</span><br><span class="line">		<span class="keyword">return</span> Result.success(page);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æŸ¥è¯¢çˆ¶ç›®å½•"><a href="#æŸ¥è¯¢çˆ¶ç›®å½•" class="headerlink" title="æŸ¥è¯¢çˆ¶ç›®å½•"></a>æŸ¥è¯¢çˆ¶ç›®å½•</h2><blockquote>
<p>è¡¥å……: æ·»åŠ åˆ†ç±»ä¹‹å‰è¦æŸ¥è¯¢ä¸€çº§ç›®å½•æä¾›é€‰æ‹©</p>
</blockquote>
<h3 id="mapper-6"><a href="#mapper-6" class="headerlink" title="mapper"></a>mapper</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;parentCategory&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;com.briup.cms.mapper.CategoryMapper.BaseResultMap&quot;</span>&gt;</span></span><br><span class="line">       select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.CategoryMapper.Base_Column_List&quot;</span>/&gt;</span></span><br><span class="line">       from cms_category</span><br><span class="line">       where parent_id = 0</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="service-13"><a href="#service-13" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">findParentCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> categoryExtendMapper.parentCategory();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-12"><a href="#controller-12" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æŸ¥è¯¢çˆ¶ç›®å½•&quot;)</span></span><br><span class="line">	<span class="meta">@GetMapping(&quot;/findParentCategory&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">findParentCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		List&lt;Category&gt; parentCategory= categoryService.findParentCategory();</span><br><span class="line">		<span class="keyword">return</span> Result.success(parentCategory);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ–°å¢ç›®å½•"><a href="#æ–°å¢ç›®å½•" class="headerlink" title="æ–°å¢ç›®å½•"></a>æ–°å¢ç›®å½•</h2><h3 id="mapper-7"><a href="#mapper-7" class="headerlink" title="mapper"></a>mapper</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByName&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.briup.cms.entity.Category&quot;</span>&gt;</span></span><br><span class="line">        select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.CategoryMapper.Base_Column_List&quot;</span>/&gt;</span></span><br><span class="line">        from cms_category</span><br><span class="line">        where name = #&#123;name&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="service-14"><a href="#service-14" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">		String name = category.getName();</span><br><span class="line">		<span class="keyword">if</span>(!StringUtils.hasText(name))&#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.PARAM_IS_BLANK);</span><br><span class="line">		&#125;</span><br><span class="line">		Category categoryFromDB = categoryExtendMapper.findByName(name);</span><br><span class="line">		<span class="keyword">if</span>(categoryFromDB != <span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_EXISTED);</span><br><span class="line">		&#125;</span><br><span class="line">		category.setNo(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">if</span>(category.getParentId() == <span class="keyword">null</span>)&#123;</span><br><span class="line">			category.setParentId(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		categoryMapper.insertSelective(category);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-13"><a href="#controller-13" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ–°å¢&quot;,notes = &quot;jsonæ ¼å¼&quot;)</span></span><br><span class="line">	<span class="meta">@PostMapping(&quot;/save&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">saveCategory</span><span class="params">(<span class="meta">@RequestBody</span> Category category)</span> </span>&#123;</span><br><span class="line">		categoryService.saveCategory(category);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>





<h2 id="æ›´æ–°ç›®å½•"><a href="#æ›´æ–°ç›®å½•" class="headerlink" title="æ›´æ–°ç›®å½•"></a>æ›´æ–°ç›®å½•</h2><h3 id="service-15"><a href="#service-15" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">		categoryMapper.updateByPrimaryKeySelective(category);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-14"><a href="#controller-14" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ›´æ–°&quot;,notes = &quot;jsonæ ¼å¼&quot;)</span></span><br><span class="line">	<span class="meta">@PutMapping(&quot;/update&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">updateCategory</span><span class="params">(<span class="meta">@RequestBody</span> Category category)</span> </span>&#123;</span><br><span class="line">		categoryService.updateCategory(category);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ›´æ–°åˆ†ç±»æ’åº"><a href="#æ›´æ–°åˆ†ç±»æ’åº" class="headerlink" title="æ›´æ–°åˆ†ç±»æ’åº"></a>æ›´æ–°åˆ†ç±»æ’åº</h2><h3 id="service-16"><a href="#service-16" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateCategoryNo</span><span class="params">(Integer id, Integer no)</span> </span>&#123;</span><br><span class="line">		Category category = <span class="keyword">new</span> Category();</span><br><span class="line">		category.setId(id);</span><br><span class="line">		category.setNo(no);</span><br><span class="line">		categoryMapper.updateByPrimaryKeySelective(category);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-15"><a href="#controller-15" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ›´æ–°åˆ†ç±»æ’åº&quot;,notes = &quot;æ”¹å˜æ’åºå­—æ®µ&quot;)</span></span><br><span class="line">	<span class="meta">@PutMapping(&quot;/update/&#123;id&#125;/&#123;no&#125;&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">updateCategoryNo</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;id&quot;,value = &quot;åˆ†ç±»id&quot;,required = true)</span> <span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id,</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(name = &quot;no&quot;,value = &quot;æ’åºå­—æ®µ&quot;,required = true)</span>  <span class="meta">@PathVariable(&quot;no&quot;)</span> <span class="keyword">int</span> no)</span> </span>&#123;</span><br><span class="line">		categoryService.updateCategoryNo(id, no);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ é™¤ç›®å½•"><a href="#åˆ é™¤ç›®å½•" class="headerlink" title="åˆ é™¤ç›®å½•"></a>åˆ é™¤ç›®å½•</h2><h3 id="mapper-8"><a href="#mapper-8" class="headerlink" title="mapper"></a>mapper</h3><p>CategoryExtendMapper</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByParentId&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.briup.cms.entity.Category&quot;</span>&gt;</span></span><br><span class="line">        select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.CategoryMapper.Base_Column_List&quot;</span>/&gt;</span></span><br><span class="line">        from cms_category</span><br><span class="line">        where parent_id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ArticleExtendMapper</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.briup.cms.mapper.extend.ArticleExtendMapper&quot;</span>&gt;</span><br><span class="line">    &lt;select id=<span class="string">&quot;findByCategoryId&quot;</span> resultType=<span class="string">&quot;com.briup.cms.entity.Article&quot;</span>&gt;</span><br><span class="line">        select &lt;include refid=<span class="string">&quot;com.briup.cms.mapper.ArticleMapper.Base_Column_List&quot;</span>/&gt;</span><br><span class="line">        from cms_article</span><br><span class="line">        where category_id = #&#123;id&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>



<h3 id="service-17"><a href="#service-17" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteCategoryInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (Integer id : ids)&#123;</span><br><span class="line">			<span class="comment">// çœ‹è¯¥ç›®å½•æ˜¯å¦è¢«å¼•ç”¨</span></span><br><span class="line">				<span class="comment">// select * from cms_category where parent_id = id</span></span><br><span class="line">			<span class="comment">// æ˜¯ä¸æ˜¯çˆ¶ç›®å½•</span></span><br><span class="line">			List&lt;Category&gt; categoryChildren = categoryExtendMapper.findByParentId(id);</span><br><span class="line">			<span class="keyword">if</span>(!CollectionUtils.isEmpty(categoryChildren))&#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_USEING);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// ç›®å½•ä¸‹æ˜¯ä¸æ˜¯æœ‰æ–‡ç« </span></span><br><span class="line">			List&lt;Article&gt; articleList = articleExtendMapper.findByCategoryId(id);</span><br><span class="line">			<span class="keyword">if</span>(!CollectionUtils.isEmpty(articleList))&#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_USEING);</span><br><span class="line">			&#125;</span><br><span class="line">			categoryMapper.deleteByPrimaryKey(id);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-16"><a href="#controller-16" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;åˆ é™¤ç›®å½•&quot;,notes = &quot;æä¾›å¤šä¸ªid,æ‰¹é‡åˆ é™¤&quot;)</span></span><br><span class="line">	<span class="meta">@DeleteMapping(&quot;/deleteBatch&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">deleteCategoryInBatch</span><span class="params">(<span class="meta">@ApiParam(&quot;idåˆ—è¡¨&quot;)</span><span class="meta">@RequestBody</span> List&lt;Integer&gt;ids)</span> </span>&#123;</span><br><span class="line">		categoryService.deleteCategoryInBatch(ids);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>





<h1 id="æ–‡ç« æ¨¡å—"><a href="#æ–‡ç« æ¨¡å—" class="headerlink" title="æ–‡ç« æ¨¡å—"></a>æ–‡ç« æ¨¡å—</h1><h2 id="æ¥å£-3"><a href="#æ¥å£-3" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//å‘å¸ƒèµ„è®¯æˆ–è€…ç¼–è¾‘èµ„è®¯</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">saveOrUpdateArticle</span><span class="params">(Article article)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//åˆ†é¡µè·å–æ‰€æœ‰èµ„è®¯</span></span><br><span class="line">	<span class="comment">//pageNum:é¡µç ï¼ŒpageSizeï¼šä¸€é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®</span></span><br><span class="line">	<span class="function">Page&lt;Article&gt; <span class="title">findAll</span><span class="params">(Integer pageNum,Integer pageSize)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//æ‰¹é‡åˆ é™¤èµ„è®¯</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">deleteArticleInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	<span class="comment">//ç®¡ç†å‘˜å®¡æ ¸èµ„è®¯</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">updateArticleStatus</span><span class="params">(Integer id,String status)</span><span class="keyword">throws</span> ServiceException</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// æŸ¥è¯¢åˆ†ç±»ä¸‹çš„æ–‡ç« </span></span><br><span class="line">	<span class="function">List&lt;Article&gt; <span class="title">findByCategoryId</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ·»åŠ æ–‡ç« "><a href="#æ·»åŠ æ–‡ç« " class="headerlink" title="æ·»åŠ æ–‡ç« "></a>æ·»åŠ æ–‡ç« </h2><h3 id="mapper-9"><a href="#mapper-9" class="headerlink" title="mapper"></a>mapper</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.cms.mapper.extend.ArticleExtendMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByTitle&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.briup.cms.entity.Article&quot;</span>&gt;</span></span><br><span class="line">        select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.ArticleMapper.Base_Column_List&quot;</span>/&gt;</span></span><br><span class="line">        from cms_article</span><br><span class="line">        where title = #&#123;title&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="service-18"><a href="#service-18" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Article article)</span> </span>&#123;</span><br><span class="line">       String title = article.getTitle();</span><br><span class="line">       <span class="keyword">if</span> (!StringUtils.hasText(title)) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.PARAM_IS_BLANK);</span><br><span class="line">       &#125;</span><br><span class="line">       Article articleFromDB = articleExtendMapper.findByTitle(title);</span><br><span class="line">       <span class="keyword">if</span> (articleFromDB != <span class="keyword">null</span>) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.DATA_USEING);</span><br><span class="line">       &#125;</span><br><span class="line">       article.setPublishTime(<span class="keyword">new</span> Date());</span><br><span class="line">       article.setReadTimes(<span class="number">0</span>);</span><br><span class="line">       article.setThumbDown(<span class="number">0</span>);</span><br><span class="line">       article.setThumbUp(<span class="number">0</span>);</span><br><span class="line">       article.setStatus(<span class="number">0</span>);</span><br><span class="line">       articleMapper.insertSelective(article);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-17"><a href="#controller-17" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@ApiOperation(value = &quot;æ–°å¢æ–‡ç« &quot;)</span></span><br><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">save</span><span class="params">(<span class="meta">@RequestBody</span> Article article)</span> </span>&#123;</span><br><span class="line">	articleService.save(article);</span><br><span class="line">	<span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ä¿®æ”¹æ–‡ç« "><a href="#ä¿®æ”¹æ–‡ç« " class="headerlink" title="ä¿®æ”¹æ–‡ç« "></a>ä¿®æ”¹æ–‡ç« </h2><h3 id="service-19"><a href="#service-19" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Article article)</span> </span>&#123;</span><br><span class="line">       articleMapper.updateByPrimaryKeySelective(article);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-18"><a href="#controller-18" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;ä¿®æ”¹æ–‡ç« &quot;)</span></span><br><span class="line">	<span class="meta">@PutMapping</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">update</span><span class="params">(<span class="meta">@RequestBody</span> Article article)</span> </span>&#123;</span><br><span class="line">		articleService.update(article);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ†é¡µæŸ¥è¯¢-1"><a href="#åˆ†é¡µæŸ¥è¯¢-1" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h2><h3 id="mapper-10"><a href="#mapper-10" class="headerlink" title="mapper"></a>mapper</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;resultWithCascade&quot;</span> <span class="attr">extends</span>=<span class="string">&quot;com.briup.cms.mapper.ArticleMapper.BaseResultMap&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">type</span>=<span class="string">&quot;com.briup.cms.entity.extend.ArticleExtend&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;user&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.briup.cms.entity.User&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.briup.cms.mapper.UserMapper.selectByPrimaryKey&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;category&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.briup.cms.entity.Category&quot;</span> <span class="attr">column</span>=<span class="string">&quot;category_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.briup.cms.mapper.CategoryMapper.selectByPrimaryKey&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;resultWithCascade&quot;</span>&gt;</span></span><br><span class="line">        select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.ArticleMapper.Base_Column_List&quot;</span>/&gt;</span></span><br><span class="line">        from cms_article</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="service-20"><a href="#service-20" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> PageUtil&lt;Article&gt; <span class="title">findAll</span><span class="params">(PageUtil pageUtil)</span> </span>&#123;</span><br><span class="line">       PageHelper.startPage(pageUtil.getPageNumber(), pageUtil.getPageSize());</span><br><span class="line">       Page all = articleExtendMapper.findAll(pageUtil.getParams());</span><br><span class="line">       pageUtil.setList(all.getResult());</span><br><span class="line">       pageUtil.setTotal(all.getTotal());</span><br><span class="line">       <span class="keyword">return</span> pageUtil;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-19"><a href="#controller-19" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;åˆ†é¡µæŸ¥è¯¢æ–‡ç« &quot;)</span></span><br><span class="line">	<span class="meta">@PostMapping(&quot;findAll&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">findAll</span><span class="params">(<span class="meta">@RequestBody</span> PageUtil pageUtil)</span> </span>&#123;</span><br><span class="line">		PageUtil&lt;Article&gt; page = articleService.findAll(pageUtil);</span><br><span class="line">		<span class="keyword">return</span> Result.success(page);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å®¡æ ¸å’¨è¯¢"><a href="#å®¡æ ¸å’¨è¯¢" class="headerlink" title="å®¡æ ¸å’¨è¯¢"></a>å®¡æ ¸å’¨è¯¢</h2><h3 id="service-21"><a href="#service-21" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateArticleStatus</span><span class="params">(Integer id, Integer status)</span> </span>&#123;</span><br><span class="line">	Article article = <span class="keyword">new</span> Article();</span><br><span class="line">	article.setId(id);</span><br><span class="line">	article.setStatus(status);</span><br><span class="line">	articleMapper.updateByPrimaryKeySelective(article);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-20"><a href="#controller-20" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;ä¿®æ”¹æ–‡ç« çŠ¶æ€&quot;, notes = &quot;æä¾›idå’Œstatus&quot;)</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;&#123;id&#125;/&#123;status&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">updateArticleStatus</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;id&quot;,value = &quot;æ–‡ç« id&quot;,required = true)</span>	<span class="meta">@PathVariable(&quot;id&quot;)</span>Integer id,</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="meta">@ApiParam(name = &quot;status&quot;,value = &quot;å®¡æ ¸çŠ¶æ€&quot;,required = true)</span> <span class="meta">@PathVariable(&quot;status&quot;)</span> Integer status)</span> </span>&#123;</span><br><span class="line">	articleService.updateArticleStatus(id, status);</span><br><span class="line">	<span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ é™¤æ–‡ç« "><a href="#åˆ é™¤æ–‡ç« " class="headerlink" title="åˆ é™¤æ–‡ç« "></a>åˆ é™¤æ–‡ç« </h2><h3 id="service-22"><a href="#service-22" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        articleMapper.deleteByPrimaryKey(id);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-21"><a href="#controller-21" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping(&quot;delete/&#123;id&#125;&quot;)</span></span><br><span class="line">	<span class="meta">@ApiOperation(value = &quot;åˆ é™¤æ–‡ç« &quot;)</span></span><br><span class="line">	<span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">			@ApiImplicitParam(name = &quot;id&quot;, value = &quot;æ–‡ç« id&quot;, required = true, dataType = &quot;int&quot;, paramType = &quot;path&quot;)</span></span><br><span class="line"><span class="meta">	&#125;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">deleteBatch</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> </span>&#123;</span><br><span class="line">		articleService.deleteById(id);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ‰¹é‡åˆ é™¤-1"><a href="#æ‰¹é‡åˆ é™¤-1" class="headerlink" title="æ‰¹é‡åˆ é™¤"></a>æ‰¹é‡åˆ é™¤</h2><h3 id="service-23"><a href="#service-23" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteArticleInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">for</span> (Integer id : ids) &#123;</span><br><span class="line">           deleteById(id);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="controller-22"><a href="#controller-22" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ‰¹é‡åˆ é™¤æ–‡ç« &quot;, notes = &quot;æä¾›idé›†åˆ&quot;)</span></span><br><span class="line">	<span class="meta">@DeleteMapping</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">deleteBatch</span><span class="params">(<span class="meta">@ApiParam(value = &quot;æ–‡ç« id&quot;)</span> <span class="meta">@RequestBody</span> List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">		articleService.deleteArticleInBatch(ids);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="è¯„è®º"><a href="#è¯„è®º" class="headerlink" title="è¯„è®º"></a>è¯„è®º</h1><h2 id="æ¥å£-4"><a href="#æ¥å£-4" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.cms.utils.PageUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.cms.entity.Comment;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CommentService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//åˆ†é¡µè·å–æ‰€æœ‰è¯„è®º</span></span><br><span class="line">	<span class="function">PageUtil&lt;Comment&gt; <span class="title">findAll</span><span class="params">(PageUtil pageUtil)</span></span>;</span><br><span class="line">	<span class="comment">//æ–°å¢è¯„è®ºæˆ–è€…æ›´æ–°è¯„è®º</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">saveComment</span><span class="params">(Comment comment)</span></span>;</span><br><span class="line">	<span class="comment">//æ‰¹é‡åˆ é™¤è¯„è®º</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">deleteCommentInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ–°å¢-1"><a href="#æ–°å¢-1" class="headerlink" title="æ–°å¢"></a>æ–°å¢</h2><h3 id="service-24"><a href="#service-24" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveComment</span><span class="params">(Comment comment)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(!StringUtils.hasText(comment.getContent()))&#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> CustomerException(ResultCode.PARAM_IS_BLANK);</span><br><span class="line">		&#125;</span><br><span class="line">		comment.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">		commentMapper.insertSelective(comment);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-23"><a href="#controller-23" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@ApiOperation(value = &quot;æ·»åŠ è¯„è®º&quot;,notes = &quot;å‚æ•°ä¸ºjsonæ ¼å¼&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">save</span><span class="params">(<span class="meta">@RequestBody</span> Comment comment)</span> </span>&#123;</span><br><span class="line">	commentService.saveComment(comment);</span><br><span class="line">	<span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ†é¡µ"><a href="#åˆ†é¡µ" class="headerlink" title="åˆ†é¡µ"></a>åˆ†é¡µ</h2><h3 id="mapper-11"><a href="#mapper-11" class="headerlink" title="mapper"></a>mapper</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.cms.mapper.extend.CommentExtendMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;resultWithCascade&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.briup.cms.entity.extend.CommentExtend&quot;</span> <span class="attr">extends</span>=<span class="string">&quot;com.briup.cms.mapper.CommentMapper.BaseResultMap&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;comment&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.briup.cms.entity.Comment&quot;</span> <span class="attr">column</span>=<span class="string">&quot;comment_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.briup.cms.mapper.CommentMapper.selectByPrimaryKey&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;article&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.briup.cms.entity.Article&quot;</span> <span class="attr">column</span>=<span class="string">&quot;article_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.briup.cms.mapper.ArticleMapper.selectByPrimaryKey&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;user&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.briup.cms.entity.User&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.briup.cms.mapper.UserMapper.selectByPrimaryKey&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;resultWithCascade&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">        select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;com.briup.cms.mapper.CommentMapper.Base_Column_List&quot;</span>/&gt;</span></span><br><span class="line">        from cms_comment</span><br><span class="line">         <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;articleId != null&quot;</span>&gt;</span></span><br><span class="line">                article_id = #&#123;articleId&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="service-25"><a href="#service-25" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> PageUtil&lt;Comment&gt; <span class="title">findAll</span><span class="params">(PageUtil pageUtil)</span> </span>&#123;</span><br><span class="line">		PageHelper.startPage(pageUtil.getPageNumber(),pageUtil.getPageSize());</span><br><span class="line">		Page&lt;Comment&gt; page = commentExtendMapper.findAll(pageUtil.getParams());</span><br><span class="line">		pageUtil.setTotal(page.getTotal());</span><br><span class="line">		pageUtil.setList(page.getResult());</span><br><span class="line">		<span class="keyword">return</span> pageUtil;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-24"><a href="#controller-24" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;åˆ†é¡µæŸ¥è¯¢è¯„è®º&quot;, notes = &quot;æä¾›å½“å‰é¡µç å’Œæ¯é¡µæ˜¾ç¤ºæ¡æ•°&quot;)</span></span><br><span class="line">	<span class="meta">@PostMapping(&quot;findAll&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">findAll</span><span class="params">(<span class="meta">@RequestBody</span> PageUtil pageUtil)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> Result.success(commentService.findAll(pageUtil));</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ é™¤-2"><a href="#åˆ é™¤-2" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><h3 id="service-26"><a href="#service-26" class="headerlink" title="service"></a>service</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteCommentInBatch</span><span class="params">(List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(Integer id : ids)&#123;</span><br><span class="line">			commentMapper.deleteByPrimaryKey(id);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="controller-25"><a href="#controller-25" class="headerlink" title="controller"></a>controller</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;æ‰¹é‡åˆ é™¤è¯„è®º&quot;, notes = &quot;æä¾›idé›†åˆ&quot;)</span></span><br><span class="line">	<span class="meta">@DeleteMapping</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Result <span class="title">deleteBatch</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="meta">@ApiParam(&quot;ids&quot;)</span><span class="meta">@RequestBody</span> List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">		commentService.deleteCommentInBatch(ids);</span><br><span class="line">		<span class="keyword">return</span> Result.success();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>





<h1 id="é¡µé¢"><a href="#é¡µé¢" class="headerlink" title="é¡µé¢"></a>é¡µé¢</h1><h2 id="è½¯ä»¶å®‰è£…-1"><a href="#è½¯ä»¶å®‰è£…-1" class="headerlink" title="è½¯ä»¶å®‰è£…"></a>è½¯ä»¶å®‰è£…</h2><ul>
<li>node14</li>
<li>vscode</li>
</ul>
<blockquote>
<p>npmä½¿ç”¨</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹npmç‰ˆæœ¬</span></span><br><span class="line">npm -v</span><br><span class="line"><span class="meta">#</span><span class="bash">ç»è¿‡ä¸‹é¢çš„é…ç½®ï¼Œä»¥åæ‰€æœ‰çš„ npm install éƒ½ä¼šç»è¿‡æ·˜å®çš„é•œåƒåœ°å€ä¸‹è½½</span></span><br><span class="line">npm config set registry https://registry.npm.taobao.org </span><br><span class="line"><span class="meta">#</span><span class="bash">æŸ¥çœ‹npmé…ç½®ä¿¡æ¯</span></span><br><span class="line">npm config list</span><br><span class="line">npm install #æ ¹æ®package.jsonä¸­çš„é…ç½®ä¸‹è½½ä¾èµ–ï¼Œåˆå§‹åŒ–é¡¹ç›®</span><br><span class="line">npm uninstall åŒ…å</span><br></pre></td></tr></table></figure>





<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><h3 id="å®‰è£…æ¨¡æ¿"><a href="#å®‰è£…æ¨¡æ¿" class="headerlink" title="å®‰è£…æ¨¡æ¿"></a>å®‰è£…æ¨¡æ¿</h3><blockquote>
<p>vueAdmin-templateæ˜¯åŸºäºvue-element-adminçš„ä¸€å¥—åå°ç®¡ç†ç³»ç»ŸåŸºç¡€æ¨¡æ¿ï¼ˆæœ€å°‘ç²¾ç®€ç‰ˆï¼‰ï¼Œå¯ä½œä¸ºæ¨¡æ¿è¿›è¡ŒäºŒæ¬¡å¼€å‘ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è§£å‹å‹ç¼©åŒ…</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿›å…¥ç›®å½•</span></span><br><span class="line">cd vue-admin-template-master</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…ä¾èµ–</span></span><br><span class="line">npm install</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯åŠ¨ã€‚æ‰§è¡Œåï¼Œæµè§ˆå™¨è‡ªåŠ¨å¼¹å‡ºå¹¶è®¿é—®http://localhost:9528/</span></span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211214160805909.png" alt="image-20211214160805909"></p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211214155752274.png" alt="image-20211214155752274"></p>
<h3 id="æ”¹é€ æ¨¡æ¿"><a href="#æ”¹é€ æ¨¡æ¿" class="headerlink" title="æ”¹é€ æ¨¡æ¿"></a>æ”¹é€ æ¨¡æ¿</h3><blockquote>
<p>ç™»å½•é¡µé¢ä¿®æ”¹ src/views/login/index.vue</p>
</blockquote>
<p>ç¬¬6è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;h3 class=&quot;title&quot;&gt;çœ‹ç‚¹å’¨è¯¢ç³»ç»Ÿ&lt;/h3&gt;</span><br></pre></td></tr></table></figure>

<p>ç¬¬44è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-button :loading=&quot;loading&quot; type=&quot;primary&quot; style=&quot;width:100%;margin-bottom:30px;&quot; @click.native.prevent=&quot;handleLogin&quot;&gt;ç™»å½•&lt;/el-button&gt;</span><br></pre></td></tr></table></figure>

<p>ç¬¬46-49</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- &lt;div class=&quot;tips&quot;&gt;</span><br><span class="line">        &lt;span style=&quot;margin-right:20px;&quot;&gt;username: admin&lt;/span&gt;</span><br><span class="line">        &lt;span&gt; password: any&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt; --&gt;</span><br></pre></td></tr></table></figure>

<p>ç¬¬68-74</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> validatePassword = <span class="function">(<span class="params">rule, value, callback</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (value.length === <span class="number">0</span>) &#123;</span><br><span class="line">        callback(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;Please enter the correct user password&#x27;</span>))</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        callback()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬144è¡Œ</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">&quot;../../../bg.jpg&quot;</span>) fixed;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211214163034847.png" alt="image-20211214163034847"></p>
<blockquote>
<p>å¯¼èˆªæ  src/layout/components/navbar.vue</p>
</blockquote>
<p>ç¬¬13è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;el-dropdown-menu slot=&quot;dropdown&quot; class=&quot;user-dropdown&quot;&gt;</span><br><span class="line">          &lt;router-link to=&quot;/&quot;&gt;</span><br><span class="line">            &lt;el-dropdown-item&gt;</span><br><span class="line">             é¦–é¡µ</span><br><span class="line">            &lt;/el-dropdown-item&gt;</span><br><span class="line">          &lt;/router-link&gt;</span><br><span class="line">          &lt;!-- &lt;a target=&quot;_blank&quot; href=&quot;https://github.com/PanJiaChen/vue-admin-template/&quot;&gt;</span><br><span class="line">            &lt;el-dropdown-item&gt;Github&lt;/el-dropdown-item&gt;</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">          &lt;a target=&quot;_blank&quot; href=&quot;https://panjiachen.github.io/vue-element-admin-site/#/&quot;&gt;</span><br><span class="line">            &lt;el-dropdown-item&gt;Docs&lt;/el-dropdown-item&gt;</span><br><span class="line">          &lt;/a&gt; --&gt;</span><br><span class="line">          &lt;el-dropdown-item divided @click.native=&quot;logout&quot;&gt;</span><br><span class="line">            &lt;span style=&quot;display:block;&quot;&gt;é€€å‡º&lt;/span&gt;</span><br><span class="line">          &lt;/el-dropdown-item&gt;</span><br><span class="line">        &lt;/el-dropdown-menu&gt;</span><br></pre></td></tr></table></figure>

<img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211214165713821.png" alt="image-20211214165713821" style="zoom:33%;" />

<blockquote>
<p>ä¾§è¾¹æ  </p>
</blockquote>
<p>src/componentsBreadcrumb/index.vue ç¬¬35-37 </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="built_in">this</span>.isDashboard(first)) &#123;</span><br><span class="line">        matched = [&#123; <span class="attr">path</span>: <span class="string">&#x27;/dashboard&#x27;</span>, <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;&#x27;</span> &#125;&#125;].concat(matched)</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>src/router/index.js ç¬¬46-56</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">   <span class="attr">component</span>: Layout,</span><br><span class="line">   <span class="attr">redirect</span>: <span class="string">&#x27;/dashboard&#x27;</span>,</span><br><span class="line">   <span class="attr">children</span>: [&#123;</span><br><span class="line">     <span class="attr">path</span>: <span class="string">&#x27;dashboard&#x27;</span>,</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;é¦–é¡µ&#x27;</span>,</span><br><span class="line">     <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/dashboard/index&#x27;</span>),</span><br><span class="line">     <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;é¦–é¡µ&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;dashboard&#x27;</span> &#125;</span><br><span class="line">   &#125;]</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211214170002256.png" alt="image-20211214170002256"></p>
<blockquote>
<p>é¡µé¢æ ‡é¢˜ src/settings.js</p>
</blockquote>
<p>ç¬¬3è¡Œ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">title: <span class="string">&#x27;çœ‹ç‚¹å’¨è¯¢ç³»ç»Ÿ&#x27;</span>,</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211214170538978.png" alt="image-20211214170538978"></p>
<blockquote>
<p>å›½é™…åŒ–ä½¿ç”¨ä¸­æ–‡ src/main.js</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> locale <span class="keyword">from</span> <span class="string">&#x27;element-ui/lib/locale/lang/zh-CN&#x27;</span> <span class="comment">// lang i18n</span></span><br></pre></td></tr></table></figure>



<h2 id="ç™»å½•-1"><a href="#ç™»å½•-1" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h2><blockquote>
<p>å»é™¤mockç¯å¢ƒ</p>
</blockquote>
<p>vue.config.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">ç¬¬<span class="number">39</span>è¡Œ</span><br><span class="line"><span class="comment">//before: require(&#x27;./mock/mock-server.js&#x27;)</span></span><br></pre></td></tr></table></figure>

<p>.env.development</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">VUE_APP_BASE_API = &#x27;http://localhost:8989&#x27;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>ä¿®æ”¹ç™»å½•ç›¸å…³apiè·¯å¾„ src/api/user.js</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/auth/login&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/resource/info&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">logout</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/resource/logout&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>ä¿®æ”¹storeä¸­çš„user.js   src/store/modules/user.js</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; login, logout, getInfo &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/user&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getToken, setToken, removeToken &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/auth&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; resetRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getDefaultState = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">token</span>: getToken(),</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">avatar</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = getDefaultState()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  <span class="attr">RESET_STATE</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">Object</span>.assign(state, getDefaultState())</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">SET_TOKEN</span>: <span class="function">(<span class="params">state, token</span>) =&gt;</span> &#123;</span><br><span class="line">    state.token = token</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">SET_NAME</span>: <span class="function">(<span class="params">state, name</span>) =&gt;</span> &#123;</span><br><span class="line">    state.name = name</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">SET_AVATAR</span>: <span class="function">(<span class="params">state, avatar</span>) =&gt;</span> &#123;</span><br><span class="line">    state.avatar = avatar</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="comment">// user login</span></span><br><span class="line">  <span class="function"><span class="title">login</span>(<span class="params">&#123; commit &#125;, userInfo</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; username, password &#125; = userInfo</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      login(&#123; <span class="attr">username</span>: username.trim(), <span class="attr">password</span>: password &#125;).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; data &#125; = response</span><br><span class="line">        commit(<span class="string">&#x27;SET_TOKEN&#x27;</span>, data.token)</span><br><span class="line">        setToken(data.token)</span><br><span class="line">        resolve()</span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        reject(error)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// get user info</span></span><br><span class="line">  <span class="function"><span class="title">getInfo</span>(<span class="params">&#123; commit, state &#125;</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      getInfo(state.token).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> data  = response.data;</span><br><span class="line">        <span class="keyword">if</span> (!data) &#123;</span><br><span class="line">          <span class="keyword">return</span> reject(<span class="string">&#x27;Verification failed, please Login again.&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> &#123; username, image &#125; = data</span><br><span class="line"></span><br><span class="line">        commit(<span class="string">&#x27;SET_NAME&#x27;</span>, username)</span><br><span class="line">        commit(<span class="string">&#x27;SET_AVATAR&#x27;</span>, image)</span><br><span class="line">        resolve(data)</span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        reject(error)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// user logout</span></span><br><span class="line">  <span class="function"><span class="title">logout</span>(<span class="params">&#123; commit, state &#125;</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      logout(state.token).then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        removeToken() <span class="comment">// must remove  token  first</span></span><br><span class="line">        resetRouter()</span><br><span class="line">        commit(<span class="string">&#x27;RESET_STATE&#x27;</span>)</span><br><span class="line">        resolve()</span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        reject(error)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// remove token</span></span><br><span class="line">  <span class="function"><span class="title">resetToken</span>(<span class="params">&#123; commit &#125;</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">      removeToken() <span class="comment">// must remove  token  first</span></span><br><span class="line">      commit(<span class="string">&#x27;RESET_STATE&#x27;</span>)</span><br><span class="line">      resolve()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  state,</span><br><span class="line">  mutations,</span><br><span class="line">  actions</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>ä¿®æ”¹è¯·æ±‚æ‹¦æˆªå™¨ src/utils/request.js</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; MessageBox, Message &#125; <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getToken &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/auth&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// create an axios instance</span></span><br><span class="line"><span class="keyword">const</span> service = axios.create(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: process.env.VUE_APP_BASE_API, <span class="comment">// url = base url + request url</span></span><br><span class="line">  <span class="comment">// withCredentials: true, // send cookies when cross-domain requests</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span> <span class="comment">// request timeout</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// request interceptor</span></span><br><span class="line">service.interceptors.request.use(</span><br><span class="line">  <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// do something before request is sent</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (store.getters.token) &#123;</span><br><span class="line">      <span class="comment">// let each request carry token</span></span><br><span class="line">      <span class="comment">// [&#x27;X-Token&#x27;] is a custom headers key</span></span><br><span class="line">      <span class="comment">// please modify it according to the actual situation</span></span><br><span class="line">      config.headers[<span class="string">&#x27;token&#x27;</span>] = getToken()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// do something with request error</span></span><br><span class="line">    <span class="built_in">console</span>.log(error) <span class="comment">// for debug</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// response interceptor</span></span><br><span class="line">service.interceptors.response.use(</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * If you want to get http information such as headers or status</span></span><br><span class="line"><span class="comment">   * Please return  response =&gt; response</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Determine the request status by custom code</span></span><br><span class="line"><span class="comment">   * Here is just an example</span></span><br><span class="line"><span class="comment">   * You can also judge the status by HTTP Status Code</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> res = response.data</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if the custom code is not 20000, it is judged as an error.</span></span><br><span class="line">    <span class="keyword">if</span> (res.code !== <span class="number">1</span>) &#123;</span><br><span class="line">      Message(&#123;</span><br><span class="line">        <span class="attr">message</span>: res.message || <span class="string">&#x27;Error&#x27;</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">5</span> * <span class="number">1000</span></span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 50008: Illegal token; 50012: Other clients logged in; 50014: Token expired;</span></span><br><span class="line">      <span class="comment">// if (res.code === 50008 || res.code === 50012 || res.code === 50014) &#123;</span></span><br><span class="line">      <span class="comment">//   // to re-login</span></span><br><span class="line">      <span class="comment">//   MessageBox.confirm(&#x27;You have been logged out, you can cancel to stay on this page, or log in again&#x27;, &#x27;Confirm logout&#x27;, &#123;</span></span><br><span class="line">      <span class="comment">//     confirmButtonText: &#x27;Re-Login&#x27;,</span></span><br><span class="line">      <span class="comment">//     cancelButtonText: &#x27;Cancel&#x27;,</span></span><br><span class="line">      <span class="comment">//     type: &#x27;warning&#x27;</span></span><br><span class="line">      <span class="comment">//   &#125;).then(() =&gt; &#123;</span></span><br><span class="line">      <span class="comment">//     store.dispatch(&#x27;user/resetToken&#x27;).then(() =&gt; &#123;</span></span><br><span class="line">      <span class="comment">//       location.reload()</span></span><br><span class="line">      <span class="comment">//     &#125;)</span></span><br><span class="line">      <span class="comment">//   &#125;)</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(res.message || <span class="string">&#x27;Error&#x27;</span>))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;err&#x27;</span> + error) <span class="comment">// for debug</span></span><br><span class="line">    Message(&#123;</span><br><span class="line">      <span class="attr">message</span>: error.message,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">      <span class="attr">duration</span>: <span class="number">5</span> * <span class="number">1000</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> service</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç™»å½•æˆåŠŸåæ˜¾ç¤º</p>
<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211214222946130.png" alt="image-20211214222946130"></p>
<blockquote>
<p>ä¿®æ”¹ç™»å½•é¦–é¡µé…ç½® </p>
</blockquote>
<p><strong>æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯ src/layout/components/Navbar.vue</strong></p>
<p>ç¬¬9-11è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div class=&quot;avatar-wrapper&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;avatar-name&quot;&gt;æ¬¢è¿æ‚¨ï¼š&#123;&#123; name &#125;&#125;&lt;/div&gt;</span><br><span class="line">          &lt;img :src=&quot;avatar+&#x27;?imageView2/1/w/80/h/80&#x27;&quot; class=&quot;user-avatar&quot;&gt;</span><br><span class="line">          &lt;i class=&quot;el-icon-caret-bottom&quot; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>ç¬¬122è¡Œ</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// æ–‡å­—å¸ƒå±€</span><br><span class="line">       <span class="selector-class">.avatar-name</span> &#123;</span><br><span class="line">         <span class="attribute">display</span>: inline-block;</span><br><span class="line">         <span class="attribute">line-height</span>: <span class="number">50px</span>;</span><br><span class="line">         <span class="attribute">position</span>: relative;</span><br><span class="line">         <span class="attribute">top</span>: -<span class="number">15px</span>;</span><br><span class="line">         <span class="attribute">right</span>: <span class="number">10px</span>;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211214223958085.png" alt="image-20211214223958085"></p>
<p><strong>é¦–é¡µè½®æ’­å›¾</strong>  src/views/dashboard/index.vue</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;dashboard-container&quot;&gt;</span><br><span class="line">    &lt;el-carousel</span><br><span class="line">      class=&quot;carou&quot;</span><br><span class="line">      autoplay</span><br><span class="line">      height=&quot;400px&quot;</span><br><span class="line">      :interval=&quot;5000&quot;</span><br><span class="line">      arrow=&quot;always&quot;</span><br><span class="line">      type=&quot;card&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;el-carousel-item v-for=&quot;item in images&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;el-image</span><br><span class="line">          style=&quot;width: 80%; height: 100%; border-radius: 50px&quot;</span><br><span class="line">          :src=&quot;item.url&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/el-carousel-item&gt;</span><br><span class="line">    &lt;/el-carousel&gt;</span><br><span class="line">   </span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;Dashboard&quot;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      images: [</span><br><span class="line">        &#123; id: 1, url: &quot;http://r3tsx6mgn.hn-bkt.clouddn.com/2.jpg&quot; &#125;,</span><br><span class="line">        &#123; id: 2, url: &quot;http://r3tsx6mgn.hn-bkt.clouddn.com/3.jpg&quot; &#125;,</span><br><span class="line">        &#123; id: 4, url: &quot;http://r3tsx6mgn.hn-bkt.clouddn.com/4.jpg&quot; &#125;,</span><br><span class="line">        &#123;id: 5,url: &quot;http://r3tsx6mgn.hn-bkt.clouddn.com/20210924_212052_06.jpg&quot;&#125;,</span><br><span class="line">        // æœ¬åœ°å›¾ç‰‡</span><br><span class="line">        &#123;id: 6,url: require(&#x27;./images/1.jpg&#x27;)&#125;</span><br><span class="line">      ],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">/* .dashboard &#123;</span><br><span class="line">  &amp;-container &#123;</span><br><span class="line">    margin: 30px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; */</span><br><span class="line"></span><br><span class="line">.images-parent &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: flex-start;</span><br><span class="line">  margin-top: 30px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.images &#123;</span><br><span class="line">  flex: 1;</span><br><span class="line">  &amp; img &#123;</span><br><span class="line">    width: 90%;</span><br><span class="line">    height: 100%;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-carousel__item &#123;</span><br><span class="line">  border-radius: 50px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211214230306767.png" alt="image-20211214230306767"></p>
<h2 id="è§’è‰²æ¨¡å—-1"><a href="#è§’è‰²æ¨¡å—-1" class="headerlink" title="è§’è‰²æ¨¡å—"></a>è§’è‰²æ¨¡å—</h2><h3 id="æŸ¥è¯¢æ‰€æœ‰-1"><a href="#æŸ¥è¯¢æ‰€æœ‰-1" class="headerlink" title="æŸ¥è¯¢æ‰€æœ‰"></a>æŸ¥è¯¢æ‰€æœ‰</h3><p>é¡µé¢ç¼–å†™ src/views/cms/role/list.vue</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;div&gt;hello&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>



<p>é¡µé¢è·¯ç”± src/router/index.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/role&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;è§’è‰²ç®¡ç†&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: Layout,</span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&#x27;/role/list&#x27;</span>,</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;è§’è‰²ç®¡ç†&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;table&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;list&#x27;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;è§’è‰²åˆ—è¡¨&#x27;</span>,</span><br><span class="line">      <span class="attr">hidden</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/cms/role/list&#x27;</span>),</span><br><span class="line">      <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;è§’è‰²åˆ—è¡¨&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;table&#x27;</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br></pre></td></tr></table></figure>



<p>axioså°è£…æ¥å£  src/api/role.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> group_name = <span class="string">&#x27;/role&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">findAll</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/findAll`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">save</span>(<span class="params">role</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/save`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: role</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">deleteById</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/delete/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;delete&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ src/views/cms/role/list.vue è°ƒç”¨æ¥å£ æ¸²æŸ“æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- éœ€è¦æ”¾åˆ°divå—ä¸­ --&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-button type=&quot;primary&quot; @click=&quot;save&quot;&gt;æ·»åŠ &lt;/el-button&gt;</span><br><span class="line">    &lt;!-- æ•°æ®è¡¨æ ¼ start --&gt;</span><br><span class="line">    &lt;el-table</span><br><span class="line">      :data=&quot;tableData&quot;</span><br><span class="line">      style=&quot;width: 100%&quot;</span><br><span class="line">      :row-class-name=&quot;tableRowClassName&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;name&quot; label=&quot;åç§°&quot; width=&quot;180&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;description&quot; label=&quot;æè¿°&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line"></span><br><span class="line">      &lt;el-table-column label=&quot;æ“ä½œ&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;el-button</span><br><span class="line">            size=&quot;mini&quot;</span><br><span class="line">            type=&quot;danger&quot;</span><br><span class="line">            @click=&quot;handleDelete(scope.row.id)&quot;</span><br><span class="line">            &gt;åˆ é™¤&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">    &lt;!-- æ•°æ®è¡¨æ ¼ end --&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;script&gt;</span><br><span class="line">import roleApi from &quot;@/api/role.js&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      tableData: [],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.findAll();</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    findAll() &#123;</span><br><span class="line">      roleApi</span><br><span class="line">        .findAll()</span><br><span class="line">        .then((resp) =&gt; &#123;</span><br><span class="line">          this.tableData = resp.data;</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) =&gt; &#123;</span><br><span class="line">          console.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    save() &#123;&#125;,</span><br><span class="line">    handleDelete(id) &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line"></span><br><span class="line">.el-table .warning-row &#123;</span><br><span class="line">  background: oldlace;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-table .success-row &#123;</span><br><span class="line">  background: #f0f9eb;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>



<p>è°ƒæ•´è¾¹è· src/layout/index.vue ç¬¬5è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div class=&quot;main-container&quot;&gt;</span><br><span class="line">     &lt;div :class=&quot;&#123;&#x27;fixed-header&#x27;:fixedHeader&#125;&quot;&gt;</span><br><span class="line">       &lt;navbar /&gt;</span><br><span class="line">     &lt;/div&gt;</span><br><span class="line">     &lt;!-- è¾¹è·è°ƒæ•´ --&gt;</span><br><span class="line">     &lt;div style=&quot;padding:2em&quot;&gt;</span><br><span class="line">         &lt;app-main /&gt;</span><br><span class="line">     &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">   &lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211215161229752.png" alt="image-20211215161229752"></p>
<h3 id="åˆ é™¤-3"><a href="#åˆ é™¤-3" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h3><p>ä¿®æ”¹ src/views/cms/role/list.vue è°ƒç”¨æ¥å£ æ¸²æŸ“æ•°æ®</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">handleDelete</span>(<span class="params">id</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.$confirm(<span class="string">&quot;æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤è¯¥æ–‡ä»¶, æ˜¯å¦ç»§ç»­?&quot;</span>, <span class="string">&quot;æç¤º&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">confirmButtonText</span>: <span class="string">&quot;ç¡®å®š&quot;</span>,</span><br><span class="line">        <span class="attr">cancelButtonText</span>: <span class="string">&quot;å–æ¶ˆ&quot;</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">        .then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// åˆ é™¤</span></span><br><span class="line">          roleApi.deleteById(id).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.$message.success(<span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>);</span><br><span class="line">            <span class="built_in">this</span>.findAll();</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;info&quot;</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&quot;å·²å–æ¶ˆåˆ é™¤&quot;</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211215212530385.png" alt="image-20211215212530385"></p>
<h3 id="æ·»åŠ -1"><a href="#æ·»åŠ -1" class="headerlink" title="æ·»åŠ "></a>æ·»åŠ </h3><p>ä¿®æ”¹ src/views/cms/role/list.vue è°ƒç”¨æ¥å£ æ¸²æŸ“æ•°æ®</p>
<blockquote>
<p>ä¸»è¦æ–°å¢äº† æ·»åŠ æŒ‰é’®  å’Œæ·»åŠ çš„å¯¹è¯æ¡† ä»¥åŠæ·»åŠ çš„ç›¸åº”æ–¹æ³•</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- éœ€è¦æ”¾åˆ°divå—ä¸­ --&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-button type=&quot;primary&quot; @click=&quot;toSave&quot;&gt;æ·»åŠ &lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- è¡¨æ ¼æ•°æ® start --&gt;</span><br><span class="line">    &lt;el-table</span><br><span class="line">      :data=&quot;tableData&quot;</span><br><span class="line">      style=&quot;width: 100%&quot;</span><br><span class="line">      :row-class-name=&quot;tableRowClassName&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;name&quot; label=&quot;åç§°&quot; width=&quot;180&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;description&quot; label=&quot;æè¿°&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line"></span><br><span class="line">      &lt;el-table-column label=&quot;æ“ä½œ&quot; width=&quot;100&quot;&gt; </span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;el-button</span><br><span class="line">            size=&quot;mini&quot;</span><br><span class="line">            type=&quot;danger&quot;</span><br><span class="line">            @click=&quot;handleDelete(scope.row.id)&quot;</span><br><span class="line">            &gt;åˆ é™¤&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">       &lt;!-- è¡¨æ ¼æ•°æ® end --&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!-- æ·»åŠ å¯¹è¯æ¡† start--&gt;</span><br><span class="line">    &lt;el-dialog title=&quot;æ·»åŠ è§’è‰²&quot; :visible.sync=&quot;dialogFormVisible&quot;&gt;</span><br><span class="line">      &lt;el-form :model=&quot;role&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;è§’è‰²åç§°&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;role.name&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;è§’è‰²æè¿°&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;role.description&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">        &lt;el-button @click=&quot;dialogFormVisible = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;saveRole&quot;&gt;ç¡® å®š&lt;/el-button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">    &lt;!-- æ·»åŠ å¯¹è¯æ¡† end --&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> &lt;script&gt;</span><br><span class="line">import roleApi from &quot;@/api/role.js&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      tableData: [],</span><br><span class="line">      dialogFormVisible: false,</span><br><span class="line">      role:&#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.findAll();</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    tableRowClassName(&#123; row, rowIndex &#125;) &#123;</span><br><span class="line">      if (rowIndex === 1) &#123;</span><br><span class="line">        return &quot;warning-row&quot;;</span><br><span class="line">      &#125; else if (rowIndex === 3) &#123;</span><br><span class="line">        return &quot;success-row&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">      return &quot;&quot;;</span><br><span class="line">    &#125;,</span><br><span class="line">    toSave() &#123;</span><br><span class="line">      this.dialogFormVisible = true;</span><br><span class="line">    &#125;,</span><br><span class="line">   saveRole()&#123;</span><br><span class="line">      roleApi</span><br><span class="line">        .save(this.role)</span><br><span class="line">        .then(res=&gt;&#123;</span><br><span class="line">            this.$message.success(res.msg);</span><br><span class="line">            this.dialogFormVisible=false;</span><br><span class="line">            this.findAll();</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(error=&gt;&#123;</span><br><span class="line">            console.log(error);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211215212743608.png" alt="image-20211215212743608"></p>
<p><code>é—®é¢˜</code></p>
<p>ç»§ç»­æ·»åŠ å¯¹è¯æ¡†,ä¸Šä¸€æ¬¡çš„æ•°æ®è¿˜åœ¨</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">this</span>.$message.success(res.msg);</span><br><span class="line"><span class="built_in">this</span>.dialogFormVisible=<span class="literal">false</span>;</span><br><span class="line"><span class="built_in">this</span>.findAll();</span><br><span class="line"><span class="comment">// æ¸…ç©ºè¡¨å•æ•°æ® å¦åˆ™ä¼šè‡ªåŠ¨ç»‘å®šæ•°æ®å›æ˜¾</span></span><br><span class="line"><span class="built_in">this</span>.role = &#123;&#125;;</span><br></pre></td></tr></table></figure>



<h2 id="ç”¨æˆ·æ¨¡å—-1"><a href="#ç”¨æˆ·æ¨¡å—-1" class="headerlink" title="ç”¨æˆ·æ¨¡å—"></a>ç”¨æˆ·æ¨¡å—</h2><h3 id="api"><a href="#api" class="headerlink" title="api"></a>api</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">findByPage</span>(<span class="params">page</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/user/findByPage&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: page</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">insert</span>(<span class="params">user</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/user/insert&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: user</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params">user</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/user/update&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;put&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: user</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">info</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/user/info/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">deleteById</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/user/delete/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;delete&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">deleteBatch</span>(<span class="params">ids</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/user/deleteBatch&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;delete&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: ids</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">updateStatus</span>(<span class="params">id,status</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/user/updateStatus/<span class="subst">$&#123;id&#125;</span>/<span class="subst">$&#123;status&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;put&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="router"><a href="#router" class="headerlink" title="router"></a>router</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/user&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;ç”¨æˆ·ç®¡ç†&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: Layout,</span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&#x27;/user/list&#x27;</span>,</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;ç”¨æˆ·ç®¡ç†&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;table&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;list&#x27;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;ç”¨æˆ·åˆ—è¡¨&#x27;</span>,</span><br><span class="line">        <span class="attr">hidden</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/cms/user/list&#x27;</span>),</span><br><span class="line">        <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;ç”¨æˆ·åˆ—è¡¨&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;table&#x27;</span> &#125;</span><br><span class="line">      &#125;]</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>



<h3 id="åˆ†é¡µç”¨æˆ·"><a href="#åˆ†é¡µç”¨æˆ·" class="headerlink" title="åˆ†é¡µç”¨æˆ·"></a>åˆ†é¡µç”¨æˆ·</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- è¡¨æ ¼æ•°æ® start --&gt;</span><br><span class="line">    &lt;el-table :data=&quot;dataPage.list&quot; stripe style=&quot;width: 100%&quot;&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;id&quot; label=&quot;ç¼–å·&quot; width=&quot;100&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;username&quot; label=&quot;å§“å&quot; width=&quot;100&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;phone&quot; label=&quot;æ‰‹æœº&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;realName&quot; label=&quot;æ˜µç§°&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;gender&quot; label=&quot;æ€§åˆ«&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &#123;&#123; scope.row.gender === 0 ? &quot;ç”·&quot; : &quot;å¥³&quot; &#125;&#125;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;birthday&quot; label=&quot;ç”Ÿæ—¥&quot; width=&quot;150&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;registerTime&quot; label=&quot;æ³¨å†Œæ—¶é—´&quot; width=&quot;150&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;status&quot; label=&quot;çŠ¶æ€&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &#123;&#123; scope.row.status === 0 ? &quot;æ­£å¸¸&quot; : &quot;ç¦ç”¨&quot; &#125;&#125;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;image&quot; label=&quot;å¤´åƒ&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;img :src=&quot;scope.row.image&quot; alt=&quot;&quot; width=&quot;40px&quot; height=&quot;40px&quot; /&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;role.name&quot; label=&quot;è§’è‰²&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® start --&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;æ“ä½œ&quot; width=&quot;150&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;el-button size=&quot;mini&quot; @click=&quot;toUpdate(scope.row.id)&quot;</span><br><span class="line">            &gt;ç¼–è¾‘&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;el-button size=&quot;mini&quot; type=&quot;danger&quot; @click=&quot;deleteById(scope.row.id)&quot;</span><br><span class="line">            &gt;åˆ é™¤&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® end --&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">    &lt;!-- è¡¨æ ¼æ•°æ® end--&gt;</span><br><span class="line">    &lt;!-- åˆ†é¡µ start --&gt;</span><br><span class="line">       &lt;el-pagination</span><br><span class="line">        @size-change=&quot;handleSizeChange&quot;</span><br><span class="line">        @current-change=&quot;handleCurrentChange&quot;</span><br><span class="line">        :current-page.sync=&quot;paramsPage.pageNumber&quot;</span><br><span class="line">        :page-sizes=&quot;[5, 10, 15, 25]&quot;</span><br><span class="line">        :page-size=&quot;paramsPage.pageSize&quot;</span><br><span class="line">        layout=&quot;sizes, prev, pager, next&quot;</span><br><span class="line">        :total=&quot;dataPage.total&quot;</span><br><span class="line">        &gt;</span><br><span class="line">        &lt;/el-pagination&gt;</span><br><span class="line">         &lt;!-- åˆ†é¡µ end --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// æ³¨æ„ user.jså¯¼å‡ºçš„éƒ½æ˜¯å•ä¸ªå‡½æ•°</span><br><span class="line">import &#123; findByPage &#125; from &quot;@/api/user.js&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      userList: [],</span><br><span class="line">      paramsPage: &#123;</span><br><span class="line">        // æŸ¥è¯¢ä¼ å‚pageå¯¹è±¡</span><br><span class="line">        pageNumber: 1,</span><br><span class="line">        pageSize: 5,</span><br><span class="line">        params: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      dataPage:&#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    findAll() &#123;</span><br><span class="line">      console.log(&quot;åˆ†é¡µæŸ¥è¯¢&quot;);</span><br><span class="line">      findByPage(this.paramsPage)</span><br><span class="line">        .then((res) =&gt; &#123;</span><br><span class="line">         this.dataPage = res.data;</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) =&gt; &#123;</span><br><span class="line">          console.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSizeChange(val) &#123;</span><br><span class="line">      this.paramsPage.pageSize = val;</span><br><span class="line">      this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    handleCurrentChange(val) &#123;</span><br><span class="line">      this.paramsPage.pageNumber = val;</span><br><span class="line">      this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    toSave()&#123;</span><br><span class="line">        this.dialogFormVisible = true;</span><br><span class="line">    &#125;,</span><br><span class="line">    saveUser()&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.findAll();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h3 id="æ·»åŠ ç”¨æˆ·"><a href="#æ·»åŠ ç”¨æˆ·" class="headerlink" title="æ·»åŠ ç”¨æˆ·"></a>æ·»åŠ ç”¨æˆ·</h3><blockquote>
<p>æ·»åŠ ç”¨æˆ·éœ€è¦é€‰æ‹©è§’è‰² </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    <span class="function"><span class="title">findRole</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        roleApi</span><br><span class="line">        .findAll()</span><br><span class="line">        .then(<span class="function">(<span class="params">resp</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">//this.$store.commit(&#x27;setRoleList&#x27;,resp.data);</span></span><br><span class="line">          <span class="built_in">this</span>.roleList = resp.data;</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.findRole();</span><br><span class="line">    <span class="built_in">this</span>.findAll();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ·»åŠ ç”¨æˆ·</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;toSave&quot;&gt;æ·»åŠ &lt;/el-button&gt;</span><br><span class="line">      &lt;!-- è¡¨æ ¼æ•°æ® start --&gt;</span><br><span class="line">    &lt;el-table :data=&quot;dataPage.list&quot; stripe style=&quot;width: 100%&quot;&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;id&quot; label=&quot;ç¼–å·&quot; width=&quot;100&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;username&quot; label=&quot;å§“å&quot; width=&quot;100&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;phone&quot; label=&quot;æ‰‹æœº&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;realName&quot; label=&quot;æ˜µç§°&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;gender&quot; label=&quot;æ€§åˆ«&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &#123;&#123; scope.row.gender === 0 ? &quot;ç”·&quot; : &quot;å¥³&quot; &#125;&#125;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;birthday&quot; label=&quot;ç”Ÿæ—¥&quot; width=&quot;150&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;registerTime&quot; label=&quot;æ³¨å†Œæ—¶é—´&quot; width=&quot;150&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;status&quot; label=&quot;çŠ¶æ€&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &#123;&#123; scope.row.status === 0 ? &quot;æ­£å¸¸&quot; : &quot;ç¦ç”¨&quot; &#125;&#125;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;image&quot; label=&quot;å¤´åƒ&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;img :src=&quot;scope.row.image&quot; alt=&quot;&quot; width=&quot;40px&quot; height=&quot;40px&quot; /&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;role.name&quot; label=&quot;è§’è‰²&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® start --&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;æ“ä½œ&quot; width=&quot;150&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;el-button size=&quot;mini&quot; @click=&quot;toUpdate(scope.row.id)&quot;</span><br><span class="line">            &gt;ç¼–è¾‘&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;el-button size=&quot;mini&quot; type=&quot;danger&quot; @click=&quot;deleteById(scope.row.id)&quot;</span><br><span class="line">            &gt;åˆ é™¤&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® end --&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">    &lt;!-- è¡¨æ ¼æ•°æ® end--&gt;</span><br><span class="line">    &lt;!-- åˆ†é¡µ start --&gt;</span><br><span class="line">        &lt;el-pagination</span><br><span class="line">        @size-change=&quot;handleSizeChange&quot;</span><br><span class="line">        @current-change=&quot;handleCurrentChange&quot;</span><br><span class="line">        :current-page.sync=&quot;paramsPage.pageNumber&quot;</span><br><span class="line">        :page-sizes=&quot;[5, 10, 15, 25]&quot;</span><br><span class="line">        :page-size=&quot;paramsPage.pageSize&quot;</span><br><span class="line">        layout=&quot;sizes, prev, pager, next&quot;</span><br><span class="line">        :total=&quot;dataPage.total&quot;</span><br><span class="line">        &gt;</span><br><span class="line">        &lt;/el-pagination&gt;</span><br><span class="line">         &lt;!-- åˆ†é¡µ end --&gt;</span><br><span class="line">    &lt;!-- æ·»åŠ å¯¹è¯æ¡† start--&gt;</span><br><span class="line">    &lt;el-dialog title=&quot;æ·»åŠ ç”¨æˆ·&quot; :visible.sync=&quot;dialogFormVisible&quot;&gt;</span><br><span class="line">      &lt;el-form :model=&quot;user&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;æ˜µç§°&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.username&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">         &lt;el-form-item label=&quot;çœŸå®å§“å&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.realName&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”¨æˆ·å¯†ç &quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.password&quot; autocomplete=&quot;off&quot; show-password&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">         &lt;el-form-item label=&quot;ç”µè¯&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.phone&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”Ÿæ—¥&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;user.birthday&quot;</span><br><span class="line">            type=&quot;datetime&quot;</span><br><span class="line">            placeholder=&quot;é€‰æ‹©æ—¥æœŸæ—¶é—´&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd HH:mm:ss&quot;</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;/el-date-picker&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”¨æˆ·æ€§åˆ«&quot;&gt;</span><br><span class="line">          &lt;el-radio v-model=&quot;user.gender&quot; :label=&quot;0&quot;&gt;ç”·&lt;/el-radio&gt;</span><br><span class="line">          &lt;el-radio v-model=&quot;user.gender&quot; :label=&quot;1&quot;&gt;å¥³&lt;/el-radio&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;è§’è‰²&quot;&gt;</span><br><span class="line">          &lt;el-select style=&quot;width: 100%&quot; v-model=&quot;user.roleId&quot; clearable placeholder=&quot;è¯·é€‰æ‹©&quot;&gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in roleList&quot;</span><br><span class="line">              :key=&quot;item.id&quot;</span><br><span class="line">              :label=&quot;item.name&quot;</span><br><span class="line">              :value=&quot;item.id&quot;</span><br><span class="line">            &gt;&lt;/el-option&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">        &lt;el-button @click=&quot;dialogFormVisible = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;saveUser&quot;&gt;ç¡® å®š&lt;/el-button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">    &lt;!-- æ·»åŠ å¯¹è¯æ¡† end --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// æ³¨æ„ user.jså¯¼å‡ºçš„éƒ½æ˜¯å•ä¸ªå‡½æ•°</span><br><span class="line">// import &#123; save, update, deleteById, query, updateStatus &#125; from &quot;@/api/user&quot;;</span><br><span class="line">import &#123; findByPage,insert &#125; from &quot;@/api/user.js&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line"> </span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      userList: [],</span><br><span class="line">      paramsPage: &#123;</span><br><span class="line">        // æŸ¥è¯¢ä¼ å‚pageå¯¹è±¡</span><br><span class="line">        pageNumber: 1,</span><br><span class="line">        pageSize: 5,</span><br><span class="line">        params: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      dataPage:&#123;&#125;,</span><br><span class="line">      dialogFormVisible: false,</span><br><span class="line">      user:&#123;&#125;,</span><br><span class="line">      roleList: &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">     findRole()&#123;</span><br><span class="line">        roleApi</span><br><span class="line">        .findAll()</span><br><span class="line">        .then((resp) =&gt; &#123;</span><br><span class="line">          //this.$store.commit(&#x27;setRoleList&#x27;,resp.data);</span><br><span class="line">          this.roleList = resp.data;</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) =&gt; &#123;</span><br><span class="line">          console.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    findAll() &#123;</span><br><span class="line">      findByPage(this.paramsPage)</span><br><span class="line">        .then((res) =&gt; &#123;</span><br><span class="line">         this.dataPage = res.data;</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) =&gt; &#123;</span><br><span class="line">          console.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSizeChange(val) &#123;</span><br><span class="line">      this.paramsPage.pageSize = val;</span><br><span class="line">      this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    handleCurrentChange(val) &#123;</span><br><span class="line">      this.paramsPage.pageNumber = val;</span><br><span class="line">      this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    toSave()&#123;</span><br><span class="line">        this.dialogFormVisible = true;</span><br><span class="line">    &#125;,</span><br><span class="line">    saveUser()&#123;</span><br><span class="line">        insert(this.user)</span><br><span class="line">            .then(res =&gt; &#123;</span><br><span class="line">                this.$message.success(res.msg);</span><br><span class="line">                this.dialogFormVisible = false;</span><br><span class="line">                // æ¸…ç©ºå€¼</span><br><span class="line">                this.user = &#123;&#125;;</span><br><span class="line">                this.findAll();</span><br><span class="line">            &#125;)</span><br><span class="line">            .catch(error=&gt;&#123;</span><br><span class="line">                console.log(error);</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.findRole();</span><br><span class="line">    this.findAll();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211216013916031.png" alt="image-20211216013916031"></p>
<h3 id="ä¿®æ”¹ç”¨æˆ·"><a href="#ä¿®æ”¹ç”¨æˆ·" class="headerlink" title="ä¿®æ”¹ç”¨æˆ·"></a>ä¿®æ”¹ç”¨æˆ·</h3><blockquote>
<p>çº¦å®š åå­—ä¸å¯ä¿®æ”¹</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-button type=&quot;primary&quot; @click=&quot;toSave&quot;&gt;æ·»åŠ &lt;/el-button&gt;</span><br><span class="line">    &lt;!-- è¡¨æ ¼æ•°æ® start --&gt;</span><br><span class="line">    &lt;el-table :data=&quot;dataPage.list&quot; stripe style=&quot;width: 100%&quot;&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;id&quot; label=&quot;ç¼–å·&quot; width=&quot;100&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;username&quot; label=&quot;å§“å&quot; width=&quot;100&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;phone&quot; label=&quot;æ‰‹æœº&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;realName&quot; label=&quot;æ˜µç§°&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;gender&quot; label=&quot;æ€§åˆ«&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &#123;&#123; scope.row.gender === 0 ? &quot;ç”·&quot; : &quot;å¥³&quot; &#125;&#125;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;birthday&quot; label=&quot;ç”Ÿæ—¥&quot; width=&quot;150&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;registerTime&quot; label=&quot;æ³¨å†Œæ—¶é—´&quot; width=&quot;150&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;status&quot; label=&quot;çŠ¶æ€&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &#123;&#123; scope.row.status === 0 ? &quot;æ­£å¸¸&quot; : &quot;ç¦ç”¨&quot; &#125;&#125;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;image&quot; label=&quot;å¤´åƒ&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;img :src=&quot;scope.row.image&quot; alt=&quot;&quot; width=&quot;40px&quot; height=&quot;40px&quot; /&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;role.name&quot; label=&quot;è§’è‰²&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® start --&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;æ“ä½œ&quot; width=&quot;150&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;el-button size=&quot;mini&quot; type=&quot;primary&quot; @click=&quot;toUpdate(scope.row)&quot;</span><br><span class="line">            &gt;ç¼–è¾‘&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;el-button size=&quot;mini&quot; type=&quot;danger&quot; @click=&quot;deleteById(scope.row.id)&quot;</span><br><span class="line">            &gt;åˆ é™¤&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® end --&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">    &lt;!-- è¡¨æ ¼æ•°æ® end--&gt;</span><br><span class="line">    &lt;!-- åˆ†é¡µ start --&gt;</span><br><span class="line">    &lt;el-pagination</span><br><span class="line">      @size-change=&quot;handleSizeChange&quot;</span><br><span class="line">      @current-change=&quot;handleCurrentChange&quot;</span><br><span class="line">      :current-page.sync=&quot;paramsPage.pageNumber&quot;</span><br><span class="line">      :page-sizes=&quot;[5, 10, 15, 25]&quot;</span><br><span class="line">      :page-size=&quot;paramsPage.pageSize&quot;</span><br><span class="line">      layout=&quot;sizes, prev, pager, next&quot;</span><br><span class="line">      :total=&quot;dataPage.total&quot;</span><br><span class="line">    &gt;</span><br><span class="line">    &lt;/el-pagination&gt;</span><br><span class="line">    &lt;!-- åˆ†é¡µ end --&gt;</span><br><span class="line">    &lt;!-- æ·»åŠ å¯¹è¯æ¡† start--&gt;</span><br><span class="line">    &lt;el-dialog title=&quot;æ·»åŠ ç”¨æˆ·&quot; :visible.sync=&quot;dialogFormVisible&quot;&gt;</span><br><span class="line">      &lt;el-form :model=&quot;user&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;æ˜µç§°&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.username&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;çœŸå®å§“å&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.realName&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”¨æˆ·å¯†ç &quot;&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">            v-model=&quot;user.password&quot;</span><br><span class="line">            autocomplete=&quot;off&quot;</span><br><span class="line">            show-password</span><br><span class="line">          &gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”µè¯&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.phone&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”Ÿæ—¥&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;user.birthday&quot;</span><br><span class="line">            type=&quot;datetime&quot;</span><br><span class="line">            placeholder=&quot;é€‰æ‹©æ—¥æœŸæ—¶é—´&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd HH:mm:ss&quot;</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;/el-date-picker&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”¨æˆ·æ€§åˆ«&quot;&gt;</span><br><span class="line">          &lt;el-radio v-model=&quot;user.gender&quot; :label=&quot;0&quot;&gt;ç”·&lt;/el-radio&gt;</span><br><span class="line">          &lt;el-radio v-model=&quot;user.gender&quot; :label=&quot;1&quot;&gt;å¥³&lt;/el-radio&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;è§’è‰²&quot;&gt;</span><br><span class="line">          &lt;el-select</span><br><span class="line">            style=&quot;width: 100%&quot;</span><br><span class="line">            v-model=&quot;user.roleId&quot;</span><br><span class="line">            clearable</span><br><span class="line">            placeholder=&quot;è¯·é€‰æ‹©&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in roleList&quot;</span><br><span class="line">              :key=&quot;item.id&quot;</span><br><span class="line">              :label=&quot;item.name&quot;</span><br><span class="line">              :value=&quot;item.id&quot;</span><br><span class="line">            &gt;&lt;/el-option&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">        &lt;el-button @click=&quot;dialogFormVisible = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;saveUser&quot;&gt;ç¡® å®š&lt;/el-button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">    &lt;!-- æ·»åŠ å¯¹è¯æ¡† end --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- ä¿®æ”¹æŠ½å±‰ start --&gt;</span><br><span class="line">    &lt;el-drawer title=&quot;ä¿®æ”¹ç”¨æˆ·&quot; :visible.sync=&quot;drawer&quot; :direction=&quot;direction&quot;&gt;</span><br><span class="line">      &lt;!-- å¤åˆ¶å¯¹è¯æ¡†ç”¨æˆ·è¡¨å•æ•°æ®å³å¯ --&gt;</span><br><span class="line">      &lt;el-form :model=&quot;user&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;æ˜µç§°&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.username&quot; autocomplete=&quot;off&quot; readonly&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;çœŸå®å§“å&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.realName&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”¨æˆ·å¯†ç &quot;&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">            v-model=&quot;user.password&quot;</span><br><span class="line">            autocomplete=&quot;off&quot;</span><br><span class="line">            show-password</span><br><span class="line">          &gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”µè¯&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.phone&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”Ÿæ—¥&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;user.birthday&quot;</span><br><span class="line">            type=&quot;datetime&quot;</span><br><span class="line">            placeholder=&quot;é€‰æ‹©æ—¥æœŸæ—¶é—´&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd HH:mm:ss&quot;</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;/el-date-picker&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”¨æˆ·æ€§åˆ«&quot;&gt;</span><br><span class="line">          &lt;el-radio v-model=&quot;user.gender&quot; :label=&quot;0&quot;&gt;ç”·&lt;/el-radio&gt;</span><br><span class="line">          &lt;el-radio v-model=&quot;user.gender&quot; :label=&quot;1&quot;&gt;å¥³&lt;/el-radio&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;è§’è‰²&quot;&gt;</span><br><span class="line">          &lt;el-select</span><br><span class="line">            style=&quot;width: 100%&quot;</span><br><span class="line">            v-model=&quot;user.roleId&quot;</span><br><span class="line">            clearable</span><br><span class="line">            placeholder=&quot;è¯·é€‰æ‹©&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in roleList&quot;</span><br><span class="line">              :key=&quot;item.id&quot;</span><br><span class="line">              :label=&quot;item.name&quot;</span><br><span class="line">              :value=&quot;item.id&quot;</span><br><span class="line">            &gt;&lt;/el-option&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">        &lt;el-button @click=&quot;drawer = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;updateUser&quot;&gt;ç¡® å®š&lt;/el-button&gt;</span><br><span class="line">    &lt;/el-drawer&gt;</span><br><span class="line">    &lt;!-- ä¿®æ”¹æŠ½å±‰ end --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// æ³¨æ„ user.jså¯¼å‡ºçš„éƒ½æ˜¯å•ä¸ªå‡½æ•°</span><br><span class="line">// import &#123; save, update, deleteById, query, updateStatus &#125; from &quot;@/api/user&quot;;</span><br><span class="line">import &#123; findByPage, insert,update &#125; from &quot;@/api/user.js&quot;;</span><br><span class="line">import roleApi from &quot;@/api/role.js&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      userList: [],</span><br><span class="line">      paramsPage: &#123;</span><br><span class="line">        // æŸ¥è¯¢ä¼ å‚pageå¯¹è±¡</span><br><span class="line">        pageNumber: 1,</span><br><span class="line">        pageSize: 5,</span><br><span class="line">        params: &#123;&#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      dataPage: &#123;&#125;,</span><br><span class="line">      dialogFormVisible: false,</span><br><span class="line">      user: &#123;&#125;,</span><br><span class="line">      roleList: &#123;&#125;,</span><br><span class="line">      drawer: false, // æ˜¯å¦å¼€å¯æŠ½å±‰</span><br><span class="line">      direction: &quot;rtl&quot;// æŠ½å±‰æ‰“å¼€æ–¹å‘</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  // watchå¿…é¡»æ”¾åœ¨dataåé¢</span><br><span class="line">  // watch: &#123;</span><br><span class="line">  //   &quot;$store.getters.roleList&quot;: function (newVal, oldVal) &#123;</span><br><span class="line">  //     console.log(&#x27;new Val&#x27;);</span><br><span class="line">  //     console.log(newVal);</span><br><span class="line">  //     this.roleList = newVal;</span><br><span class="line">  //   &#125;,</span><br><span class="line">  // &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    findRole()&#123;</span><br><span class="line">        roleApi</span><br><span class="line">        .findAll()</span><br><span class="line">        .then((resp) =&gt; &#123;</span><br><span class="line">          //this.$store.commit(&#x27;setRoleList&#x27;,resp.data);</span><br><span class="line">          this.roleList = resp.data;</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) =&gt; &#123;</span><br><span class="line">          console.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    findAll() &#123;</span><br><span class="line">      findByPage(this.paramsPage)</span><br><span class="line">        .then((res) =&gt; &#123;</span><br><span class="line">          this.dataPage = res.data;</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) =&gt; &#123;</span><br><span class="line">          console.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSizeChange(val) &#123;</span><br><span class="line">      this.paramsPage.pageSize = val;</span><br><span class="line">      this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    handleCurrentChange(val) &#123;</span><br><span class="line">      this.paramsPage.pageNumber = val;</span><br><span class="line">      this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    toSave() &#123;</span><br><span class="line">      this.dialogFormVisible = true;</span><br><span class="line">    &#125;,</span><br><span class="line">    saveUser() &#123;</span><br><span class="line">      insert(this.user)</span><br><span class="line">        .then((res) =&gt; &#123;</span><br><span class="line">          this.$message.success(res.msg);</span><br><span class="line">          this.dialogFormVisible = false;</span><br><span class="line">          // æ¸…ç©ºå€¼</span><br><span class="line">          this.user = &#123;&#125;;</span><br><span class="line">          this.findAll();</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) =&gt; &#123;</span><br><span class="line">          console.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    toUpdate(row) &#123;</span><br><span class="line">      this.user = row; // å›æ˜¾æ•°æ®</span><br><span class="line">      this.drawer = true;</span><br><span class="line">    &#125;,</span><br><span class="line">    updateUser()&#123;</span><br><span class="line">      update(this.user)</span><br><span class="line">        .then(res =&gt; &#123;</span><br><span class="line">          this.$message.success(res.msg);</span><br><span class="line">          this.drawer = false;</span><br><span class="line">          this.user = &#123;&#125;;</span><br><span class="line">          this.findAll();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.findRole();</span><br><span class="line">    this.findAll();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="åˆ é™¤ç”¨æˆ·"><a href="#åˆ é™¤ç”¨æˆ·" class="headerlink" title="åˆ é™¤ç”¨æˆ·"></a>åˆ é™¤ç”¨æˆ·</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">deleteById</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//deleteById(id)</span></span><br><span class="line">        <span class="built_in">this</span>.$confirm(<span class="string">&quot;æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤è¯¥æ–‡ä»¶, æ˜¯å¦ç»§ç»­?&quot;</span>, <span class="string">&quot;æç¤º&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">confirmButtonText</span>: <span class="string">&quot;ç¡®å®š&quot;</span>,</span><br><span class="line">        <span class="attr">cancelButtonText</span>: <span class="string">&quot;å–æ¶ˆ&quot;</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">        .then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// åˆ é™¤</span></span><br><span class="line">            deleteById(id).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.$message.success(<span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>);</span><br><span class="line">            <span class="built_in">this</span>.findAll();</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;info&quot;</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&quot;å·²å–æ¶ˆåˆ é™¤&quot;</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ‰¹é‡åˆ é™¤-2"><a href="#æ‰¹é‡åˆ é™¤-2" class="headerlink" title="æ‰¹é‡åˆ é™¤"></a>æ‰¹é‡åˆ é™¤</h3><blockquote>
<p>éœ€è¦æä¾›æ‰¹é‡é€‰æ‹©æ¡†</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;el-button type=<span class="string">&quot;danger&quot;</span> @click=<span class="string">&quot;deleteBatch&quot;</span>&gt;æ‰¹é‡åˆ é™¤&lt;/el-button&gt;</span><br><span class="line">    &lt;!-- @selection-changeç»‘å®šå¤šé€‰äº‹ä»¶ --&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;dataPage.list&quot;</span> <span class="attr">stripe</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>  @<span class="attr">selection-change</span>=<span class="string">&quot;handleSelectionChange&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="comment">&lt;!-- æ‰¹é‡é€‰æ‹©æ¡† --&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">&quot;selection&quot;</span> <span class="attr">width</span>=<span class="string">&quot;55&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·å–æ‰¹é‡æ“ä½œçš„å€¼</span></span><br><span class="line">    <span class="function"><span class="title">handleSelectionChange</span>(<span class="params">val</span>)</span>&#123;</span><br><span class="line">      <span class="comment">// é»˜è®¤valæ˜¯æ‰¹é‡çš„å€¼çš„é›†åˆ  æ­¤å¤„åªéœ€è¦æ‰¹é‡id éœ€è¦æ˜ å°„å¤„ç†</span></span><br><span class="line">      <span class="built_in">this</span>.ids = val.map(<span class="function"><span class="params">item</span> =&gt;</span> item.id);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">deleteBatch</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="built_in">this</span>.$confirm(<span class="string">&quot;æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤è¯¥æ–‡ä»¶, æ˜¯å¦ç»§ç»­?&quot;</span>, <span class="string">&quot;æç¤º&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">confirmButtonText</span>: <span class="string">&quot;ç¡®å®š&quot;</span>,</span><br><span class="line">        <span class="attr">cancelButtonText</span>: <span class="string">&quot;å–æ¶ˆ&quot;</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">        .then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// æ‰¹é‡åˆ é™¤</span></span><br><span class="line">            deleteBatch(<span class="built_in">this</span>.ids).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.$message.success(<span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>);</span><br><span class="line">            <span class="built_in">this</span>.findAll();</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;info&quot;</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&quot;å·²å–æ¶ˆåˆ é™¤&quot;</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211216110254387.png" alt="image-20211216110254387"></p>
<h3 id="ç¦ç”¨ç”¨æˆ·"><a href="#ç¦ç”¨ç”¨æˆ·" class="headerlink" title="ç¦ç”¨ç”¨æˆ·"></a>ç¦ç”¨ç”¨æˆ·</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® start --&gt;</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;æ“ä½œ&quot;</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;toUpdate(scope.row)&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">            &gt;</span>ç¼–è¾‘<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;deleteById(scope.row.id)&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">            &gt;</span>åˆ é™¤<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.status== &#x27;0&#x27;&quot;</span>  <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> <span class="attr">plain</span> @<span class="attr">click</span>=<span class="string">&quot;updateStatus(scope.row.id,1)&quot;</span>&gt;</span>ç¦ç”¨<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.status== &#x27;1&#x27;&quot;</span>  <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">plain</span> @<span class="attr">click</span>=<span class="string">&quot;updateStatus(scope.row.id,0)&quot;</span>&gt;</span>å¯ç”¨<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® end --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹ç”¨æˆ·çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="title">updateStatus</span>(<span class="params">id,status</span>)</span>&#123;</span><br><span class="line">        updateStatus(id,status)</span><br><span class="line">          .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.$message.success(res.msg);</span><br><span class="line">            <span class="built_in">this</span>.findAll();</span><br><span class="line">          &#125;)</span><br><span class="line">          .catch(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(error);</span><br><span class="line">          &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/vanse/images/raw/master/cms_mybatis/image-20211216111901944.png" alt="image-20211216111901944"></p>
<blockquote>
<p>é¡µé¢æ ¼å­å¤ªæ»¡ å…ˆå°†ç”Ÿæ—¥ æ³¨å†Œæ—¶é—´ç­‰è¯¦æƒ…éšè—  å°†æ¥éœ€è¦æŸ¥çœ‹è¯¦æƒ…æä¾›æ¥å£å³å¯</p>
</blockquote>
<h2 id="åˆ†ç±»æ¨¡å—-1"><a href="#åˆ†ç±»æ¨¡å—-1" class="headerlink" title="åˆ†ç±»æ¨¡å—"></a>åˆ†ç±»æ¨¡å—</h2><h3 id="api-1"><a href="#api-1" class="headerlink" title="api"></a>api</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> group_name = <span class="string">&#x27;/category&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">findAll</span>(<span class="params">data</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/findAll`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">            data</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">findParentCategory</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/findParentCategory`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>           </span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">save</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/save`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">            data</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">update</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/update`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;put&#x27;</span>,</span><br><span class="line">            data</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">deleteBatch</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/deleteBatch`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;delete&#x27;</span>,</span><br><span class="line">            data</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">updateNo</span>(<span class="params">id,no</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/updateNo/<span class="subst">$&#123;id&#125;</span>/<span class="subst">$&#123;no&#125;</span>`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;put&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="router-1"><a href="#router-1" class="headerlink" title="router"></a>router</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">path</span>: <span class="string">&#x27;/category&#x27;</span>,</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;åˆ†ç±»ç®¡ç†&#x27;</span>,</span><br><span class="line">   <span class="attr">component</span>: Layout,</span><br><span class="line">   <span class="attr">redirect</span>: <span class="string">&#x27;/category/list&#x27;</span>,</span><br><span class="line">   <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;åˆ†ç±»ç®¡ç†&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;table&#x27;</span> &#125;,</span><br><span class="line">   <span class="attr">children</span>: [</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="attr">path</span>: <span class="string">&#x27;list&#x27;</span>,</span><br><span class="line">       <span class="attr">name</span>: <span class="string">&#x27;åˆ†ç±»åˆ—è¡¨&#x27;</span>,</span><br><span class="line">       <span class="attr">hidden</span>: <span class="literal">true</span>,</span><br><span class="line">       <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/cms/category/list&#x27;</span>),</span><br><span class="line">       <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;åˆ†ç±»åˆ—è¡¨&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;table&#x27;</span> &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">   ]</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>



<h3 id="list-vue"><a href="#list-vue" class="headerlink" title="list.vue"></a>list.vue</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-button type=&quot;primary&quot; @click=&quot;toSave&quot;&gt;æ·»åŠ &lt;/el-button&gt;</span><br><span class="line">    &lt;el-button type=&quot;danger&quot; @click=&quot;deleteBatch&quot;&gt;æ‰¹é‡åˆ é™¤&lt;/el-button&gt;</span><br><span class="line">    &lt;!-- è¡¨æ ¼æ•°æ® start --&gt;</span><br><span class="line">    &lt;!-- @selection-changeç»‘å®šå¤šé€‰äº‹ä»¶ --&gt;</span><br><span class="line">    &lt;el-table</span><br><span class="line">      :data=&quot;dataPage.list&quot;</span><br><span class="line">      stripe</span><br><span class="line">      style=&quot;width: 100%&quot;</span><br><span class="line">      @selection-change=&quot;handleSelectionChange&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;!-- æ‰¹é‡é€‰æ‹©æ¡† --&gt;</span><br><span class="line">      &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot;&gt;&lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;id&quot; label=&quot;ç¼–å·&quot; width=&quot;50&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;name&quot; label=&quot;åç§°&quot; width=&quot;100&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;description&quot; label=&quot;æè¿°&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;no&quot; label=&quot;åºå·&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line"></span><br><span class="line">      &lt;el-table-column prop=&quot;category.name&quot; label=&quot;çˆ¶ç›®å½•&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® start --&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;æ“ä½œ&quot; width=&quot;300&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;el-button size=&quot;mini&quot; type=&quot;primary&quot; @click=&quot;toUpdate(scope.row)&quot;</span><br><span class="line">            &gt;ç¼–è¾‘&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;!-- &lt;el-button size=&quot;mini&quot; type=&quot;danger&quot;&gt;æ›´æ–°åºå·&lt;/el-button&gt; --&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® end --&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">    &lt;!-- è¡¨æ ¼æ•°æ® end--&gt;</span><br><span class="line">    &lt;!-- åˆ†é¡µ start --&gt;</span><br><span class="line">    &lt;el-pagination</span><br><span class="line">      @size-change=&quot;handleSizeChange&quot;</span><br><span class="line">      @current-change=&quot;handleCurrentChange&quot;</span><br><span class="line">      :current-page.sync=&quot;paramsPage.pageNumber&quot;</span><br><span class="line">      :page-sizes=&quot;[5, 10, 15, 25]&quot;</span><br><span class="line">      :page-size=&quot;paramsPage.pageSize&quot;</span><br><span class="line">      layout=&quot;sizes, prev, pager, next&quot;</span><br><span class="line">      :total=&quot;dataPage.total&quot;</span><br><span class="line">    &gt;</span><br><span class="line">    &lt;/el-pagination&gt;</span><br><span class="line">    &lt;!-- åˆ†é¡µ end --&gt;</span><br><span class="line">    &lt;!-- æ·»åŠ å¯¹è¯æ¡† start--&gt;</span><br><span class="line">    &lt;el-dialog title=&quot;æ·»åŠ åˆ†ç±»&quot; :visible.sync=&quot;dialogFormVisible&quot;&gt;</span><br><span class="line">      &lt;el-form :model=&quot;category&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;åˆ†ç±»åç§°&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;category.name&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;åˆ†ç±»æè¿°&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;category.description&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">         &lt;el-form-item label=&quot;çˆ¶ç›®å½•&quot;&gt;</span><br><span class="line">          &lt;el-select</span><br><span class="line">            style=&quot;width: 100%&quot;</span><br><span class="line">            v-model=&quot;category.parentId&quot;</span><br><span class="line">            clearable</span><br><span class="line">            placeholder=&quot;è¯·é€‰æ‹©&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in parentCategory&quot;</span><br><span class="line">              :key=&quot;item.id&quot;</span><br><span class="line">              :label=&quot;item.name&quot;</span><br><span class="line">              :value=&quot;item.id&quot;</span><br><span class="line">            &gt;&lt;/el-option&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">        &lt;el-button @click=&quot;dialogFormVisible = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;save&quot;&gt;ç¡® å®š&lt;/el-button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">    &lt;!-- æ·»åŠ å¯¹è¯æ¡† end --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- ä¿®æ”¹æŠ½å±‰ start --&gt;</span><br><span class="line">    &lt;!-- å¤åˆ¶å¯¹è¯æ¡†ç”¨æˆ·è¡¨å•æ•°æ®å³å¯ --&gt;</span><br><span class="line">    &lt;el-drawer title=&quot;ä¿®æ”¹ç”¨æˆ·&quot; :visible.sync=&quot;drawer&quot; :direction=&quot;direction&quot;&gt;</span><br><span class="line">      &lt;el-form :model=&quot;category&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;åç§°&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;category.name&quot; autocomplete=&quot;off&quot; readonly&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;æè¿°&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;category.description&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">         &lt;el-form-item label=&quot;åˆ†ç±»åºå·&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;category.no&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;çˆ¶ç›®å½•&quot;&gt;</span><br><span class="line">          &lt;el-select</span><br><span class="line">            style=&quot;width: 100%&quot;</span><br><span class="line">            v-model=&quot;category.parentId&quot;</span><br><span class="line">            clearable</span><br><span class="line">            placeholder=&quot;è¯·é€‰æ‹©&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in parentCategory&quot;</span><br><span class="line">              :key=&quot;item.id&quot;</span><br><span class="line">              :label=&quot;item.name&quot;</span><br><span class="line">              :value=&quot;item.id&quot;</span><br><span class="line">            &gt;&lt;/el-option&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">        &lt;el-button @click=&quot;drawer = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;update&quot;&gt;ç¡® å®š&lt;/el-button&gt;</span><br><span class="line">    &lt;/el-drawer&gt;</span><br><span class="line">    &lt;!-- ä¿®æ”¹æŠ½å±‰ end --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import categoryApi from &#x27;@/api/category&#x27;</span><br><span class="line">import category from &#x27;@/api/category&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      paramsPage: &#123;</span><br><span class="line">        // åˆ†é¡µä¼ å‚æ•°æ®</span><br><span class="line">        // æŸ¥è¯¢ä¼ å‚pageå¯¹è±¡</span><br><span class="line">        pageNumber: 1,</span><br><span class="line">        pageSize: 5,</span><br><span class="line">        params: &#123;&#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      dataPage: &#123;&#125;,</span><br><span class="line">      dialogFormVisible: false,</span><br><span class="line">      category: &#123;&#125;,</span><br><span class="line">      drawer: false,  // æŠ½å±‰</span><br><span class="line">      direction: &quot;rtl&quot;,// æŠ½å±‰æ‰“å¼€æ–¹å‘</span><br><span class="line">      ids: [],  // æ‰¹é‡åˆ é™¤idæ•°ç»„</span><br><span class="line">      parentCategory: []</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    findAll() &#123;</span><br><span class="line">        categoryApi.findAll(this.paramsPage)</span><br><span class="line">          .then(res =&gt; &#123;</span><br><span class="line">            this.dataPage = res.data;</span><br><span class="line">          &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSelectionChange(val)&#123;</span><br><span class="line">        this.ids = val.map(item =&gt; item.id);</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSizeChange(val)&#123;</span><br><span class="line">        this.paramsPage.pageSize = val;</span><br><span class="line">        this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    handleCurrentChange(val)&#123;</span><br><span class="line">        this.paramsPage.pageNumber = val;</span><br><span class="line">        this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    toSave() &#123;</span><br><span class="line">      this.findParentCategory();</span><br><span class="line">      this.dialogFormVisible = true;</span><br><span class="line">    &#125;,</span><br><span class="line">    findParentCategory()&#123;</span><br><span class="line">      categoryApi.findParentCategory()</span><br><span class="line">        .then(res=&gt;&#123;</span><br><span class="line">          this.parentCategory = res.data;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    save() &#123;</span><br><span class="line">      categoryApi.save(this.category)</span><br><span class="line">        .then(res=&gt;&#123;</span><br><span class="line">          this.$message.success(res.msg);</span><br><span class="line">          this.findAll();</span><br><span class="line">          this.dialogFormVisible = false;</span><br><span class="line">          this.category=&#123;&#125;;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    toUpdate(row)&#123;</span><br><span class="line">      categoryApi.findParentCategory()</span><br><span class="line">      this.category = row;</span><br><span class="line">      this.drawer = true;</span><br><span class="line">    &#125;,</span><br><span class="line">    update() &#123;</span><br><span class="line">      category.update(this.category)</span><br><span class="line">        .then(res=&gt;&#123;</span><br><span class="line">          this.$message.success(res.msg);</span><br><span class="line">          this.drawer = false;</span><br><span class="line">          this.findAll();</span><br><span class="line">          this.category = &#123;&#125;;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    updateNo() &#123;</span><br><span class="line">      categoryApi.updateNo(id,no)</span><br><span class="line">    &#125;,</span><br><span class="line">    deleteBatch() &#123;</span><br><span class="line">      categoryApi.deleteBatch(this.ids)</span><br><span class="line">        .then(res=&gt;&#123;</span><br><span class="line">          this.$message.success(res.msg);</span><br><span class="line">          this.findAll();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.findParentCategory(); // å¿…é¡»åŠ  å¦åˆ™æ›´æ–°æ— æ³•ä½¿ç”¨çˆ¶ç›®å½•</span><br><span class="line">    this.findAll();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="image/image-20211219183505648.png" alt="image-20211219183505648"></p>
<h2 id="æ–‡ç« æ¨¡å—-1"><a href="#æ–‡ç« æ¨¡å—-1" class="headerlink" title="æ–‡ç« æ¨¡å—"></a>æ–‡ç« æ¨¡å—</h2><blockquote>
<p>å¯¹äºç®¡ç†ç³»ç»Ÿæ¥è¯´ æ–‡ç« åªæœ‰æŸ¥è¯¢ å®¡æ ¸ åˆ é™¤ (æ–°å¢ ä¿®æ”¹æ˜¯é—¨æˆ·ç½‘ç«™çš„åŠŸèƒ½)</p>
</blockquote>
<h3 id="api-2"><a href="#api-2" class="headerlink" title="api"></a>api</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> group_name = <span class="string">&#x27;/article&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ†é¡µæŸ¥è¯¢æ–‡ç«  ä¹Ÿå¯æŸ¥è¯¢æŸåˆ†ç±»ä¸‹çš„æ–‡ç« </span></span><br><span class="line">    <span class="function"><span class="title">findAll</span>(<span class="params">data</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/findAll`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">            data</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">deleteById</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/delete/<span class="subst">$&#123;data&#125;</span>`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;delete&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">deleteBatch</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/deleteBatch`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;delete&#x27;</span>,</span><br><span class="line">            data</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">updateStatus</span>(<span class="params">id,status</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/updateStatus/<span class="subst">$&#123;id&#125;</span>/<span class="subst">$&#123;status&#125;</span>`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;put&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="router-2"><a href="#router-2" class="headerlink" title="router"></a>router</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/article&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;æ–‡ç« ç®¡ç†&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: Layout,</span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&#x27;/article/list&#x27;</span>,</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;æ–‡ç« ç®¡ç†&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;table&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;list&#x27;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;æ–‡ç« åˆ—è¡¨&#x27;</span>,</span><br><span class="line">        <span class="attr">hidden</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/cms/article/list&#x27;</span>),</span><br><span class="line">        <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;æ–‡ç« åˆ—è¡¨&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;table&#x27;</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>



<h3 id="list-vue-1"><a href="#list-vue-1" class="headerlink" title="list.vue"></a>list.vue</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-button size=&quot;mini&quot; type=&quot;danger&quot; @click=&quot;deleteBatch&quot;</span><br><span class="line">      &gt;æ‰¹é‡åˆ é™¤&lt;/el-button</span><br><span class="line">    &gt;</span><br><span class="line">    &lt;!-- è¡¨æ ¼æ•°æ® start --&gt;</span><br><span class="line">    &lt;!-- @selection-changeç»‘å®šå¤šé€‰äº‹ä»¶ --&gt;</span><br><span class="line">    &lt;el-table</span><br><span class="line">      :data=&quot;dataPage.list&quot;</span><br><span class="line">      stripe</span><br><span class="line">      style=&quot;width: 100%&quot;</span><br><span class="line">      @selection-change=&quot;handleSelectionChange&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;!-- æ‰¹é‡é€‰æ‹©æ¡† --&gt;</span><br><span class="line">      &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot;&gt;&lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;id&quot; label=&quot;ç¼–å·&quot; width=&quot;50&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;title&quot; label=&quot;æ ‡é¢˜&quot; width=&quot;100&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;readTimes&quot; label=&quot;é˜…è¯»é‡&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;thumbUp&quot; label=&quot;èµæ•°&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;thumbDown&quot; label=&quot;è¸©æ•°&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;publishTime&quot; label=&quot;å‘å¸ƒæ—¶é—´&quot; width=&quot;150&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;status&quot; label=&quot;çŠ¶æ€&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;span v-if=&quot;scope.row.status == 0&quot;&gt;æœªå®¡æ ¸&lt;/span&gt;</span><br><span class="line">          &lt;span v-if=&quot;scope.row.status == 1&quot;&gt;é€šè¿‡&lt;/span&gt;</span><br><span class="line">          &lt;span v-if=&quot;scope.row.status == 2&quot;&gt;é©³å›&lt;/span&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;category.name&quot; label=&quot;åˆ†ç±»&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;user.username&quot; label=&quot;ä½œè€…&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® start --&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;æ“ä½œ&quot; width=&quot;300&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;el-button size=&quot;mini&quot; type=&quot;danger&quot; @click=&quot;deleteById(scope.row.id)&quot;</span><br><span class="line">            &gt;åˆ é™¤&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;el-button</span><br><span class="line">            size=&quot;mini&quot;</span><br><span class="line">            type=&quot;primary&quot;</span><br><span class="line">            @click=&quot;toUpdateStatus(scope.row)&quot;</span><br><span class="line">            &gt;å®¡æ ¸&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® end --&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">    &lt;!-- è¡¨æ ¼æ•°æ® end--&gt;</span><br><span class="line">    &lt;!-- åˆ†é¡µ start --&gt;</span><br><span class="line">    &lt;el-pagination</span><br><span class="line">      @size-change=&quot;handleSizeChange&quot;</span><br><span class="line">      @current-change=&quot;handleCurrentChange&quot;</span><br><span class="line">      :current-page.sync=&quot;paramsPage.pageNumber&quot;</span><br><span class="line">      :page-sizes=&quot;[5, 10, 15, 25]&quot;</span><br><span class="line">      :page-size=&quot;paramsPage.pageSize&quot;</span><br><span class="line">      layout=&quot;sizes, prev, pager, next&quot;</span><br><span class="line">      :total=&quot;dataPage.total&quot;</span><br><span class="line">    &gt;</span><br><span class="line">    &lt;/el-pagination&gt;</span><br><span class="line">    &lt;!-- åˆ†é¡µ end --&gt;</span><br><span class="line">    &lt;!-- æ·»åŠ å¯¹è¯æ¡† start--&gt;</span><br><span class="line">    &lt;el-dialog title=&quot;å®¡æ ¸&quot; :visible.sync=&quot;dialogFormVisible&quot;&gt;</span><br><span class="line">      &lt;el-form :model=&quot;article&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;å†…å®¹&quot;&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">            type=&quot;textarea&quot;</span><br><span class="line">            :rows=&quot;20&quot;</span><br><span class="line">            v-model=&quot;article.content&quot;</span><br><span class="line">            autocomplete=&quot;off&quot;</span><br><span class="line">          &gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;pass(article.id,1)&quot;&gt;é€šè¿‡&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;warning&quot; @click=&quot;nopass(article.id,2)&quot;&gt;é©³å›&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button @click=&quot;dialogFormVisible = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">    &lt;!-- æ·»åŠ å¯¹è¯æ¡† end --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import articleApi from &quot;@/api/article&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      paramsPage: &#123;</span><br><span class="line">        pageNumber: 1,</span><br><span class="line">        pageSize: 5,</span><br><span class="line">        params: &#123;&#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      dataPage: &#123;&#125;,</span><br><span class="line">      ids: [],</span><br><span class="line">      dialogFormVisible: false,</span><br><span class="line">      article: &#123;&#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    findAll() &#123;</span><br><span class="line">      articleApi.findAll(this.paramsPage).then((res) =&gt; &#123;</span><br><span class="line">        this.dataPage = res.data;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSizeChange(val) &#123;</span><br><span class="line">      this.paramsPage.pageSize = val;</span><br><span class="line">      this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    handleCurrentChange(val) &#123;</span><br><span class="line">      this.paramsPage.pageNumber = val;</span><br><span class="line">      this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    toUpdateStatus(row) &#123;</span><br><span class="line">      this.dialogFormVisible = true;</span><br><span class="line">      this.article = row;</span><br><span class="line">    &#125;,</span><br><span class="line">    pass(id,status) &#123;</span><br><span class="line">      articleApi.updateStatus(id,status)</span><br><span class="line">        .then(res=&gt;&#123;</span><br><span class="line">            this.$message.success(res.msg);</span><br><span class="line">            this.findAll();</span><br><span class="line">        &#125;)</span><br><span class="line">      this.dialogFormVisible = false;</span><br><span class="line">    &#125;,</span><br><span class="line">    nopass(id,status) &#123;</span><br><span class="line">       articleApi.updateStatus(id,status)</span><br><span class="line">        .then(res=&gt;&#123;</span><br><span class="line">            this.$message.success(res.msg);</span><br><span class="line">            this.findAll();</span><br><span class="line">        &#125;)</span><br><span class="line">      this.dialogFormVisible = false;</span><br><span class="line">    &#125;,</span><br><span class="line">    deleteById(id) &#123;</span><br><span class="line">      articleApi.deleteById(id).then((res) =&gt; &#123;</span><br><span class="line">        this.$message.success(res.msg);</span><br><span class="line">        this.findAll();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSelectionChange(val) &#123;</span><br><span class="line">      this.ids = val.map((item) =&gt; item.id);</span><br><span class="line">    &#125;,</span><br><span class="line">    deleteBatch() &#123;</span><br><span class="line">      articleApi.deleteBatch(this.ids).then((res) =&gt; &#123;</span><br><span class="line">        this.$message.success(res.msg);</span><br><span class="line">        this.findAll();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.findAll();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="image/image-20211219233636832.png" alt="image-20211219233636832"></p>
<p><img src="image/image-20211219233646916.png" alt="image-20211219233646916"></p>
<h2 id="è¯„è®ºæ¨¡å—"><a href="#è¯„è®ºæ¨¡å—" class="headerlink" title="è¯„è®ºæ¨¡å—"></a>è¯„è®ºæ¨¡å—</h2><blockquote>
<p>æ·»åŠ è¯„è®ºæ˜¯é—¨æˆ·ç½‘ç«™çš„åŠŸèƒ½</p>
</blockquote>
<h3 id="api-3"><a href="#api-3" class="headerlink" title="api"></a>api</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> group_name = <span class="string">&#x27;/comment&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">findAll</span>(<span class="params">data</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/findAll`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">            data</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">deleteBatch</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;group_name&#125;</span>/deleteBatch`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;delete&#x27;</span>,</span><br><span class="line">            data</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="router-3"><a href="#router-3" class="headerlink" title="router"></a>router</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">path</span>: <span class="string">&#x27;/comment&#x27;</span>,</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;è¯„è®ºç®¡ç†&#x27;</span>,</span><br><span class="line">   <span class="attr">component</span>: Layout,</span><br><span class="line">   <span class="attr">redirect</span>: <span class="string">&#x27;/comment/list&#x27;</span>,</span><br><span class="line">   <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;è¯„è®ºç®¡ç†&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;table&#x27;</span> &#125;,</span><br><span class="line">   <span class="attr">children</span>: [</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="attr">path</span>: <span class="string">&#x27;list&#x27;</span>,</span><br><span class="line">       <span class="attr">name</span>: <span class="string">&#x27;è¯„è®ºåˆ—è¡¨&#x27;</span>,</span><br><span class="line">       <span class="attr">hidden</span>: <span class="literal">true</span>,</span><br><span class="line">       <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/cms/comment/list&#x27;</span>),</span><br><span class="line">       <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;è¯„è®ºåˆ—è¡¨&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;table&#x27;</span> &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">   ]</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>



<h3 id="vue"><a href="#vue" class="headerlink" title="vue"></a>vue</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;deleteBatch&quot;</span>&gt;</span>æ‰¹é‡åˆ é™¤<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- è¡¨æ ¼æ•°æ® start --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- @selection-changeç»‘å®šå¤šé€‰äº‹ä»¶ --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">el-table</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">:data</span>=<span class="string">&quot;dataPage.list&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">stripe</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      @<span class="attr">selection-change</span>=<span class="string">&quot;handleSelectionChange&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">    &gt;</span></span></span><br><span class="line"><span class="xml">      <span class="comment">&lt;!-- æ‰¹é‡é€‰æ‹©æ¡† --&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">&quot;selection&quot;</span> <span class="attr">width</span>=<span class="string">&quot;55&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;id&quot;</span> <span class="attr">label</span>=<span class="string">&quot;ç¼–å·&quot;</span> <span class="attr">width</span>=<span class="string">&quot;50&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;content&quot;</span> <span class="attr">label</span>=<span class="string">&quot;å†…å®¹&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;time&quot;</span> <span class="attr">label</span>=<span class="string">&quot;å‘å¸ƒæ—¶é—´&quot;</span> <span class="attr">width</span>=<span class="string">&quot;150&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;comment.content&quot;</span> <span class="attr">label</span>=<span class="string">&quot;çˆ¶è¯„è®º&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;article.title&quot;</span> <span class="attr">label</span>=<span class="string">&quot;æ–‡ç« &quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;user.username&quot;</span> <span class="attr">label</span>=<span class="string">&quot;ä½œè€…&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- è¡¨æ ¼æ•°æ® end--&gt;</span></span></span><br><span class="line"><span class="xml">     <span class="comment">&lt;!-- åˆ†é¡µ start --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">el-pagination</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      @<span class="attr">size-change</span>=<span class="string">&quot;handleSizeChange&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      @<span class="attr">current-change</span>=<span class="string">&quot;handleCurrentChange&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">:current-page.sync</span>=<span class="string">&quot;paramsPage.pageNumber&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">:page-sizes</span>=<span class="string">&quot;[5, 10, 15, 25]&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">:page-size</span>=<span class="string">&quot;paramsPage.pageSize&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">layout</span>=<span class="string">&quot;sizes, prev, pager, next&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">      <span class="attr">:total</span>=<span class="string">&quot;dataPage.total&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">    &gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- åˆ†é¡µ end --&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> commentApi <span class="keyword">from</span> <span class="string">&#x27;@/api/comment&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">paramsPage</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// åˆ†é¡µä¼ å‚æ•°æ®</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// æŸ¥è¯¢ä¼ å‚pageå¯¹è±¡</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">pageNumber</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">pageSize</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">params</span>: &#123;&#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">dataPage</span>: &#123;&#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">ids</span>: [], <span class="comment">// æ‰¹é‡åˆ é™¤idæ•°ç»„</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="function"><span class="title">findAll</span>(<span class="params"></span>)</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        commentApi.findAll(<span class="built_in">this</span>.paramsPage)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            .then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">this</span>.dataPage = res.data;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">     <span class="function"><span class="title">handleSizeChange</span>(<span class="params">val</span>)</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="built_in">this</span>.paramsPage.pageSize = val;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="built_in">this</span>.findAll();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="function"><span class="title">handleCurrentChange</span>(<span class="params">val</span>)</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="built_in">this</span>.paramsPage.pageNumber = val;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="built_in">this</span>.findAll();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="function"><span class="title">handleSelectionChange</span>(<span class="params">val</span>)</span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="built_in">this</span>.ids = val.map(<span class="function"><span class="params">item</span>=&gt;</span>item.id);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="function"><span class="title">deleteBatch</span>(<span class="params"></span>)</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        commentApi.deleteBatch(<span class="built_in">this</span>.ids)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">             .then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">this</span>.$message.success(res.msg);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">                <span class="built_in">this</span>.findAll();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">            &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="built_in">this</span>.findAll();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>





<h1 id="å¤´åƒä¸Šä¼ "><a href="#å¤´åƒä¸Šä¼ " class="headerlink" title="å¤´åƒä¸Šä¼ "></a>å¤´åƒä¸Šä¼ </h1><h2 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h2><p><strong>QiniuUtil</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.cms.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.gson.Gson;</span><br><span class="line"><span class="keyword">import</span> com.qiniu.common.QiniuException;</span><br><span class="line"><span class="keyword">import</span> com.qiniu.common.Zone;</span><br><span class="line"><span class="keyword">import</span> com.qiniu.http.Response;</span><br><span class="line"><span class="keyword">import</span> com.qiniu.storage.BucketManager;</span><br><span class="line"><span class="keyword">import</span> com.qiniu.storage.Configuration;</span><br><span class="line"><span class="keyword">import</span> com.qiniu.storage.UploadManager;</span><br><span class="line"><span class="keyword">import</span> com.qiniu.storage.model.DefaultPutRet;</span><br><span class="line"><span class="keyword">import</span> com.qiniu.util.Auth;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"><span class="keyword">import</span> okhttp3.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸ƒç‰›äº‘å·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> * http://r3tsx6mgn.hn-bkt.clouddn.com/ åŸŸå</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QiniuUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String accessKey = <span class="string">&quot;M1J6WgMIOisq7Bg8vyCii3SKe9GMGNOgtmUhVWWT&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String secretKey = <span class="string">&quot;gOCD2k-nsqnTqU3u-s-WmTd8YXXZGvRlnpaVt_iC&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String bucket = <span class="string">&quot;cms-briup1&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String BASE_URL = <span class="string">&quot;http://r4el9vwrh.hd-bkt.clouddn.com/&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String upToken;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> UploadManager uploadManager;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> BucketManager bucketManager;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="comment">// æ„é€ ä¸€ä¸ªå¸¦æŒ‡å®šZoneå¯¹è±¡çš„é…ç½®ç±»  ä¸œåŒº</span></span><br><span class="line">        Configuration cfg = <span class="keyword">new</span> Configuration(Zone.zone0());</span><br><span class="line">        <span class="comment">// è·å–ä¸Šä¼ ç®¡ç†å™¨</span></span><br><span class="line">        uploadManager = <span class="keyword">new</span> UploadManager(cfg);</span><br><span class="line">        <span class="comment">// é»˜è®¤ä¸æŒ‡å®škeyçš„æƒ…å†µä¸‹ï¼Œä»¥æ–‡ä»¶å†…å®¹çš„hashå€¼ä½œä¸ºæ–‡ä»¶å</span></span><br><span class="line">        Auth auth = Auth.create(accessKey, secretKey);</span><br><span class="line">        <span class="comment">// è·å–ç©ºé—´ï¼ˆbucketï¼‰ç®¡ç†å™¨</span></span><br><span class="line">        bucketManager = <span class="keyword">new</span> BucketManager(auth, cfg);</span><br><span class="line">        <span class="comment">// è·å–ä¸Šä¼ token</span></span><br><span class="line">        upToken = auth.uploadToken(bucket);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * @Description ä¸Šä¼ æ–‡ä»¶åˆ°ä¸ƒç‰›äº‘</span></span><br><span class="line"><span class="comment">     * @Date 2021/6/1 9:21</span></span><br><span class="line"><span class="comment">     * @Param [filePath: éœ€è¦ä¸Šä¼ æ–‡ä»¶çš„ä½ç½®, fileName: æŒ‡å®šå­˜åœ¨ä¸ƒç‰›äº‘çš„æ ‡è¯†,ä¸ä¼ æœ‰é»˜è®¤å€¼]</span></span><br><span class="line"><span class="comment">     * @return void</span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">upload2Qiniu</span><span class="params">(String filePath, String fileName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response response = uploadManager.put(filePath, fileName, upToken);</span><br><span class="line">            <span class="comment">//è§£æä¸Šä¼ æˆåŠŸçš„ç»“æœ</span></span><br><span class="line">            DefaultPutRet putRet = <span class="keyword">new</span> Gson().fromJson(response.bodyString(), DefaultPutRet.class);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (QiniuException ex) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;ä¸Šä¼ ä¸ƒç‰›äº‘å›¾ç‰‡å¤±è´¥ &#123;&#125;&quot;</span>,ex.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * @Description ä¸Šä¼ æ–‡ä»¶åˆ°ä¸ƒç‰›äº‘</span></span><br><span class="line"><span class="comment">     * @Date 2021/6/1 9:21</span></span><br><span class="line"><span class="comment">     * @Param [filePath: éœ€è¦ä¸Šä¼ æ–‡ä»¶çš„å­—èŠ‚æ•°ç»„: æŒ‡å®šå­˜åœ¨ä¸ƒç‰›äº‘çš„æ ‡è¯†,ä¸ä¼ æœ‰é»˜è®¤å€¼]</span></span><br><span class="line"><span class="comment">     * @return String  è¿”å›ä¸ƒç‰›äº‘çš„æ ‡è¯†  åç»­é€šè¿‡æ‹¼æ¥åŸŸå+æ ‡è¯†å³å¯è®¿é—®åˆ°å›¾ç‰‡</span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">upload2Qiniu</span><span class="params">(<span class="keyword">byte</span>[] bytes, String fileName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response response = uploadManager.put(bytes, fileName, upToken);</span><br><span class="line">            <span class="comment">//è§£æä¸Šä¼ æˆåŠŸçš„ç»“æœ</span></span><br><span class="line">            DefaultPutRet putRet = <span class="keyword">new</span> Gson().fromJson(response.bodyString(), DefaultPutRet.class);</span><br><span class="line">            <span class="keyword">return</span> putRet.key;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (QiniuException ex) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;ä¸Šä¼ ä¸ƒç‰›äº‘å›¾ç‰‡å¤±è´¥ &#123;&#125;&quot;</span>,ex.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡è½½æ–¹æ³•: ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘ ä¸ä¼ å”¯ä¸€æ ‡è¯†</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">upload2Qiniu</span><span class="params">(<span class="keyword">byte</span>[] bytes)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> upload2Qiniu(bytes,<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * @Description `åˆ é™¤ä¸ƒç‰›äº‘çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     * @Date 2021/6/1 9:22</span></span><br><span class="line"><span class="comment">     * @Param [fileName] ä¸ƒç‰›äº‘çš„å”¯ä¸€æ ‡è¯†</span></span><br><span class="line"><span class="comment">     * @return void</span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deleteFileFromQiniu</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            bucketManager.delete(bucket, fileName);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (QiniuException ex) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœé‡åˆ°å¼‚å¸¸ï¼Œè¯´æ˜åˆ é™¤å¤±è´¥</span></span><br><span class="line">            log.error(<span class="string">&quot;åˆ é™¤ä¸ƒç‰›äº‘å›¾ç‰‡å¤±è´¥ &#123;&#125; &#123;&#125;&quot;</span>,ex.code(),ex.response.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deleteFileFromQiniu</span><span class="params">(List&lt;String&gt; list)</span> </span>&#123;</span><br><span class="line">        list.forEach(QiniuUtil::deleteFileFromQiniu);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * @Description é€šè¿‡http getä¸‹è½½å›¾ç‰‡èµ„æº</span></span><br><span class="line"><span class="comment">    * @Date 2021/6/1 9:24</span></span><br><span class="line"><span class="comment">    * @Param [url: ä¸ƒç‰›äº‘åœ°å€, filepath: ä¸‹è½½ä½ç½®, picKey: å°†æ¥æ‹¼æ¥filepath+picKyeæ‹¼æ¥æœ¬åœ°ä¸‹è½½è·¯å¾„]</span></span><br><span class="line"><span class="comment">    * @return void</span></span><br><span class="line"><span class="comment">    **/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">download</span><span class="params">(String filepath, String picKey)</span> </span>&#123;</span><br><span class="line">        String url = BASE_URL + picKey;</span><br><span class="line">        OkHttpClient client = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">        Request req = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">        okhttp3.Response resp = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            resp = client.newCall(req).execute();</span><br><span class="line">            <span class="keyword">if</span> (resp.isSuccessful()) &#123;</span><br><span class="line">                ResponseBody body = resp.body();</span><br><span class="line">                InputStream is = body.byteStream();</span><br><span class="line">                <span class="keyword">byte</span>[] data = readInputStream(is);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//åˆ¤æ–­æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º</span></span><br><span class="line">                File file = <span class="keyword">new</span> File(filepath);</span><br><span class="line">                <span class="keyword">if</span> (!file.exists() &amp;&amp; !file.isDirectory()) &#123;</span><br><span class="line">                    file.mkdirs();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(!filepath.endsWith(<span class="string">&quot;/&quot;</span>))&#123;</span><br><span class="line">                    filepath = filepath+<span class="string">&quot;/&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                File imgFile = <span class="keyword">new</span> File(filepath + picKey + <span class="string">&quot;.jpg&quot;</span>);</span><br><span class="line">                FileOutputStream fops = <span class="keyword">new</span> FileOutputStream(imgFile);</span><br><span class="line">                fops.write(data);</span><br><span class="line">                fops.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            log.error(<span class="string">&quot;ä¸‹è½½ä¸ƒç‰›äº‘å›¾ç‰‡å¤±è´¥&#123;&#125;&quot;</span>,e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯»å–å­—èŠ‚è¾“å…¥æµå†…å®¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> is</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] readInputStream(InputStream is) &#123;</span><br><span class="line">        ByteArrayOutputStream writer = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        <span class="keyword">byte</span>[] buff = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">2</span>];</span><br><span class="line">        <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> ((len = is.read(buff)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                writer.write(buff, <span class="number">0</span>, len);</span><br><span class="line">            &#125;</span><br><span class="line">            is.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> writer.toByteArray();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//FileInputStream file = new FileInputStream();</span></span><br><span class="line">        upload2Qiniu(<span class="string">&quot;C:\\Users\\vanse\\Pictures\\bg.jpg&quot;</span>,<span class="string">&quot;bg&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/upload&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;æ–‡ä»¶ä¸Šä¼ &quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="meta">@PostMapping(&quot;/image&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">uploadImage</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">       String image = QiniuUtil.upload2Qiniu(file.getBytes(), file.getOriginalFilename());</span><br><span class="line">        <span class="keyword">return</span> Result.success( QiniuUtil.BASE_URL+image);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h2><p>user.vue</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-button type=&quot;primary&quot; @click=&quot;toSave&quot;&gt;æ·»åŠ &lt;/el-button&gt;</span><br><span class="line">    &lt;el-button type=&quot;danger&quot; @click=&quot;deleteBatch&quot;&gt;æ‰¹é‡åˆ é™¤&lt;/el-button&gt;</span><br><span class="line">    &lt;!-- è¡¨æ ¼æ•°æ® start --&gt;</span><br><span class="line">    &lt;!-- @selection-changeç»‘å®šå¤šé€‰äº‹ä»¶ --&gt;</span><br><span class="line">    &lt;el-table</span><br><span class="line">      :data=&quot;dataPage.list&quot;</span><br><span class="line">      stripe</span><br><span class="line">      style=&quot;width: 100%&quot;</span><br><span class="line">      @selection-change=&quot;handleSelectionChange&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;!-- æ‰¹é‡é€‰æ‹©æ¡† --&gt;</span><br><span class="line">      &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot;&gt;&lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;id&quot; label=&quot;ç¼–å·&quot; width=&quot;50&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;username&quot; label=&quot;å§“å&quot; width=&quot;100&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;phone&quot; label=&quot;æ‰‹æœº&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;realName&quot; label=&quot;æ˜µç§°&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;gender&quot; label=&quot;æ€§åˆ«&quot; width=&quot;50&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &#123;&#123; scope.row.gender === 0 ? &quot;ç”·&quot; : &quot;å¥³&quot; &#125;&#125;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- &lt;el-table-column prop=&quot;birthday&quot; label=&quot;ç”Ÿæ—¥&quot; width=&quot;150&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;registerTime&quot; label=&quot;æ³¨å†Œæ—¶é—´&quot; width=&quot;150&quot;&gt;</span><br><span class="line">      &lt;/el-table-column&gt; --&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;status&quot; label=&quot;çŠ¶æ€&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &#123;&#123; scope.row.status === 0 ? &quot;æ­£å¸¸&quot; : &quot;ç¦ç”¨&quot; &#125;&#125;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;image&quot; label=&quot;å¤´åƒ&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;img :src=&quot;scope.row.image&quot; alt=&quot;&quot; width=&quot;40px&quot; height=&quot;40px&quot; /&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;role.name&quot; label=&quot;è§’è‰²&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® start --&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;æ“ä½œ&quot; width=&quot;300&quot;&gt;</span><br><span class="line">        &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">          &lt;el-button size=&quot;mini&quot; type=&quot;primary&quot; @click=&quot;toUpdate(scope.row)&quot;</span><br><span class="line">            &gt;ç¼–è¾‘&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;el-button size=&quot;mini&quot; type=&quot;danger&quot; @click=&quot;deleteById(scope.row.id)&quot;</span><br><span class="line">            &gt;åˆ é™¤&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;el-button</span><br><span class="line">            v-if=&quot;scope.row.status == &#x27;0&#x27;&quot;</span><br><span class="line">            size=&quot;mini&quot;</span><br><span class="line">            type=&quot;danger&quot;</span><br><span class="line">            plain</span><br><span class="line">            @click=&quot;updateStatus(scope.row.id, 1)&quot;</span><br><span class="line">            &gt;ç¦ç”¨&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;el-button</span><br><span class="line">            v-if=&quot;scope.row.status == &#x27;1&#x27;&quot;</span><br><span class="line">            size=&quot;mini&quot;</span><br><span class="line">            type=&quot;primary&quot;</span><br><span class="line">            plain</span><br><span class="line">            @click=&quot;updateStatus(scope.row.id, 0)&quot;</span><br><span class="line">            &gt;å¯ç”¨&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;!-- ç”¨æˆ·æ“ä½œæŒ‰é’® end --&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">    &lt;!-- è¡¨æ ¼æ•°æ® end--&gt;</span><br><span class="line">    &lt;!-- åˆ†é¡µ start --&gt;</span><br><span class="line">    &lt;el-pagination</span><br><span class="line">      @size-change=&quot;handleSizeChange&quot;</span><br><span class="line">      @current-change=&quot;handleCurrentChange&quot;</span><br><span class="line">      :current-page.sync=&quot;paramsPage.pageNumber&quot;</span><br><span class="line">      :page-sizes=&quot;[5, 10, 15, 25]&quot;</span><br><span class="line">      :page-size=&quot;paramsPage.pageSize&quot;</span><br><span class="line">      layout=&quot;sizes, prev, pager, next&quot;</span><br><span class="line">      :total=&quot;dataPage.total&quot;</span><br><span class="line">    &gt;</span><br><span class="line">    &lt;/el-pagination&gt;</span><br><span class="line">    &lt;!-- åˆ†é¡µ end --&gt;</span><br><span class="line">    &lt;!-- æ·»åŠ å¯¹è¯æ¡† start--&gt;</span><br><span class="line">    &lt;el-dialog title=&quot;æ·»åŠ ç”¨æˆ·&quot; :visible.sync=&quot;dialogFormVisible&quot;&gt;</span><br><span class="line">      &lt;el-form :model=&quot;user&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;æ˜µç§°&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.username&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;çœŸå®å§“å&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.realName&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”¨æˆ·å¯†ç &quot;&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">            v-model=&quot;user.password&quot;</span><br><span class="line">            autocomplete=&quot;off&quot;</span><br><span class="line">            show-password</span><br><span class="line">          &gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”µè¯&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.phone&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”Ÿæ—¥&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;user.birthday&quot;</span><br><span class="line">            type=&quot;datetime&quot;</span><br><span class="line">            placeholder=&quot;é€‰æ‹©æ—¥æœŸæ—¶é—´&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd HH:mm:ss&quot;</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;/el-date-picker&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”¨æˆ·æ€§åˆ«&quot;&gt;</span><br><span class="line">          &lt;el-radio v-model=&quot;user.gender&quot; :label=&quot;0&quot;&gt;ç”·&lt;/el-radio&gt;</span><br><span class="line">          &lt;el-radio v-model=&quot;user.gender&quot; :label=&quot;1&quot;&gt;å¥³&lt;/el-radio&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;è§’è‰²&quot;&gt;</span><br><span class="line">          &lt;el-select</span><br><span class="line">            style=&quot;width: 100%&quot;</span><br><span class="line">            v-model=&quot;user.roleId&quot;</span><br><span class="line">            clearable</span><br><span class="line">            placeholder=&quot;è¯·é€‰æ‹©&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in roleList&quot;</span><br><span class="line">              :key=&quot;item.id&quot;</span><br><span class="line">              :label=&quot;item.name&quot;</span><br><span class="line">              :value=&quot;item.id&quot;</span><br><span class="line">            &gt;&lt;/el-option&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;å¤´åƒ&quot;&gt;</span><br><span class="line">          &lt;!-- &lt;el-input type=&quot;file&quot; v-model=&quot;user.image&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt; --&gt;</span><br><span class="line">          &lt;el-upload</span><br><span class="line">            class=&quot;avatar-uploader&quot;</span><br><span class="line">            action=&quot;http://localhost:8989/upload/image&quot;</span><br><span class="line">            :show-file-list=&quot;false&quot;</span><br><span class="line">            :on-success=&quot;handleAvatarSuccess&quot;</span><br><span class="line">            :before-upload=&quot;beforeAvatarUpload&quot;&gt;</span><br><span class="line">            &lt;img v-if=&quot;user.image&quot; :src=&quot;user.image&quot; class=&quot;avatar&quot; width=&quot;40px&quot; height=&quot;40px&quot; /&gt;</span><br><span class="line">            &lt;i v-else class=&quot;el-icon-plus avatar-uploader-icon&quot;&gt;&lt;/i&gt;</span><br><span class="line">          &lt;/el-upload&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">        &lt;el-button @click=&quot;dialogFormVisible = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;saveUser&quot;&gt;ç¡® å®š&lt;/el-button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">    &lt;!-- æ·»åŠ å¯¹è¯æ¡† end --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- ä¿®æ”¹æŠ½å±‰ start --&gt;</span><br><span class="line">    &lt;el-drawer title=&quot;ä¿®æ”¹ç”¨æˆ·&quot; :visible.sync=&quot;drawer&quot; :direction=&quot;direction&quot;&gt;</span><br><span class="line">      &lt;!-- å¤åˆ¶å¯¹è¯æ¡†ç”¨æˆ·è¡¨å•æ•°æ®å³å¯ --&gt;</span><br><span class="line">      &lt;el-form :model=&quot;user&quot; label-width=&quot;100px&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;æ˜µç§°&quot;&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">            v-model=&quot;user.username&quot;</span><br><span class="line">            autocomplete=&quot;off&quot;</span><br><span class="line">            readonly</span><br><span class="line">          &gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;çœŸå®å§“å&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.realName&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”¨æˆ·å¯†ç &quot;&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">            v-model=&quot;user.password&quot;</span><br><span class="line">            autocomplete=&quot;off&quot;</span><br><span class="line">            show-password</span><br><span class="line">          &gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”µè¯&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;user.phone&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”Ÿæ—¥&quot;&gt;</span><br><span class="line">          &lt;el-date-picker</span><br><span class="line">            v-model=&quot;user.birthday&quot;</span><br><span class="line">            type=&quot;datetime&quot;</span><br><span class="line">            placeholder=&quot;é€‰æ‹©æ—¥æœŸæ—¶é—´&quot;</span><br><span class="line">            value-format=&quot;yyyy-MM-dd HH:mm:ss&quot;</span><br><span class="line">          &gt;</span><br><span class="line">          &lt;/el-date-picker&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;ç”¨æˆ·æ€§åˆ«&quot;&gt;</span><br><span class="line">          &lt;el-radio v-model=&quot;user.gender&quot; :label=&quot;0&quot;&gt;ç”·&lt;/el-radio&gt;</span><br><span class="line">          &lt;el-radio v-model=&quot;user.gender&quot; :label=&quot;1&quot;&gt;å¥³&lt;/el-radio&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;è§’è‰²&quot;&gt;</span><br><span class="line">          &lt;el-select</span><br><span class="line">            style=&quot;width: 100%&quot;</span><br><span class="line">            v-model=&quot;user.roleId&quot;</span><br><span class="line">            clearable</span><br><span class="line">            placeholder=&quot;è¯·é€‰æ‹©&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;el-option</span><br><span class="line">              v-for=&quot;item in roleList&quot;</span><br><span class="line">              :key=&quot;item.id&quot;</span><br><span class="line">              :label=&quot;item.name&quot;</span><br><span class="line">              :value=&quot;item.id&quot;</span><br><span class="line">            &gt;&lt;/el-option&gt;</span><br><span class="line">          &lt;/el-select&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;el-button @click=&quot;drawer = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;updateUser&quot;&gt;ç¡® å®š&lt;/el-button&gt;</span><br><span class="line">    &lt;/el-drawer&gt;</span><br><span class="line">    &lt;!-- ä¿®æ”¹æŠ½å±‰ end --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// æ³¨æ„ user.jså¯¼å‡ºçš„éƒ½æ˜¯å•ä¸ªå‡½æ•°</span><br><span class="line">// import &#123; save, update, deleteById, query, updateStatus &#125; from &quot;@/api/user&quot;;</span><br><span class="line">import &#123;</span><br><span class="line">  findByPage,</span><br><span class="line">  insert,</span><br><span class="line">  update,</span><br><span class="line">  deleteById,</span><br><span class="line">  deleteBatch,</span><br><span class="line">  updateStatus,</span><br><span class="line">&#125; from &quot;@/api/user.js&quot;;</span><br><span class="line">import roleApi from &quot;@/api/role.js&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      userList: [], // ç”¨æˆ·è¡¨æ ¼æ•°æ®</span><br><span class="line">      paramsPage: &#123;</span><br><span class="line">        // åˆ†é¡µä¼ å‚æ•°æ®</span><br><span class="line">        // æŸ¥è¯¢ä¼ å‚pageå¯¹è±¡</span><br><span class="line">        pageNumber: 1,</span><br><span class="line">        pageSize: 5,</span><br><span class="line">        params: &#123;&#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      dataPage: &#123;&#125;, // åˆ†é¡µè¿”å›çš„æ•°æ®</span><br><span class="line">      dialogFormVisible: false, // å¼€å¯dialog</span><br><span class="line">      user: &#123;&#125;, // æ·»åŠ æˆ–æ›´æ–°æäº¤çš„è¡¨å•é¡¹</span><br><span class="line">      roleList: &#123;&#125;, // è§’è‰²ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©æ¡†</span><br><span class="line">      drawer: false, // æ˜¯å¦å¼€å¯æŠ½å±‰</span><br><span class="line">      direction: &quot;rtl&quot;, // æŠ½å±‰æ‰“å¼€æ–¹å‘</span><br><span class="line">      ids: [], // æ‰¹é‡åˆ é™¤idæ•°ç»„</span><br><span class="line">    </span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  // watchå¿…é¡»æ”¾åœ¨dataåé¢</span><br><span class="line">  // watch: &#123;</span><br><span class="line">  //   &quot;$store.getters.roleList&quot;: function (newVal, oldVal) &#123;</span><br><span class="line">  //     console.log(&#x27;new Val&#x27;);</span><br><span class="line">  //     console.log(newVal);</span><br><span class="line">  //     this.roleList = newVal;</span><br><span class="line">  //   &#125;,</span><br><span class="line">  // &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    findRole() &#123;</span><br><span class="line">      roleApi</span><br><span class="line">        .findAll()</span><br><span class="line">        .then((resp) =&gt; &#123;</span><br><span class="line">          //this.$store.commit(&#x27;setRoleList&#x27;,resp.data);</span><br><span class="line">          this.roleList = resp.data;</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) =&gt; &#123;</span><br><span class="line">          console.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    findAll() &#123;</span><br><span class="line">      findByPage(this.paramsPage)</span><br><span class="line">        .then((res) =&gt; &#123;</span><br><span class="line">          this.dataPage = res.data;</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) =&gt; &#123;</span><br><span class="line">          console.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSizeChange(val) &#123;</span><br><span class="line">      this.paramsPage.pageSize = val;</span><br><span class="line">      this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    handleCurrentChange(val) &#123;</span><br><span class="line">      this.paramsPage.pageNumber = val;</span><br><span class="line">      this.findAll();</span><br><span class="line">    &#125;,</span><br><span class="line">    toSave() &#123;</span><br><span class="line">      this.dialogFormVisible = true;</span><br><span class="line">    &#125;,</span><br><span class="line">    saveUser() &#123;</span><br><span class="line">      insert(this.user)</span><br><span class="line">        .then((res) =&gt; &#123;</span><br><span class="line">          this.$message.success(res.msg);</span><br><span class="line">          this.dialogFormVisible = false;</span><br><span class="line">          // æ¸…ç©ºå€¼</span><br><span class="line">          this.user = &#123;&#125;;</span><br><span class="line">          this.findAll();</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) =&gt; &#123;</span><br><span class="line">          console.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    toUpdate(row) &#123;</span><br><span class="line">      this.user = row; // å›æ˜¾æ•°æ®</span><br><span class="line">      this.drawer = true;</span><br><span class="line">    &#125;,</span><br><span class="line">    updateUser() &#123;</span><br><span class="line">      update(this.user).then((res) =&gt; &#123;</span><br><span class="line">        this.$message.success(res.msg);</span><br><span class="line">        this.drawer = false;</span><br><span class="line">        this.user = &#123;&#125;;</span><br><span class="line">        this.findAll();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    deleteById(id) &#123;</span><br><span class="line">      this.$confirm(&quot;æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤è¯¥æ–‡ä»¶, æ˜¯å¦ç»§ç»­?&quot;, &quot;æç¤º&quot;, &#123;</span><br><span class="line">        confirmButtonText: &quot;ç¡®å®š&quot;,</span><br><span class="line">        cancelButtonText: &quot;å–æ¶ˆ&quot;,</span><br><span class="line">        type: &quot;warning&quot;,</span><br><span class="line">      &#125;)</span><br><span class="line">        .then(() =&gt; &#123;</span><br><span class="line">          // åˆ é™¤</span><br><span class="line">          deleteById(id).then((res) =&gt; &#123;</span><br><span class="line">            this.$message.success(&quot;åˆ é™¤æˆåŠŸ&quot;);</span><br><span class="line">            this.findAll();</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(() =&gt; &#123;</span><br><span class="line">          this.$message(&#123;</span><br><span class="line">            type: &quot;info&quot;,</span><br><span class="line">            message: &quot;å·²å–æ¶ˆåˆ é™¤&quot;,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    // æ‰¹é‡æ“ä½œçš„å€¼</span><br><span class="line">    handleSelectionChange(val) &#123;</span><br><span class="line">      // é»˜è®¤valæ˜¯æ‰¹é‡çš„å€¼çš„é›†åˆ  æ­¤å¤„åªéœ€è¦æ‰¹é‡id éœ€è¦æ˜ å°„å¤„ç†</span><br><span class="line">      this.ids = val.map((item) =&gt; item.id);</span><br><span class="line">      console.log(this.ids);</span><br><span class="line">    &#125;,</span><br><span class="line">    deleteBatch() &#123;</span><br><span class="line">      this.$confirm(&quot;æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤è¯¥æ–‡ä»¶, æ˜¯å¦ç»§ç»­?&quot;, &quot;æç¤º&quot;, &#123;</span><br><span class="line">        confirmButtonText: &quot;ç¡®å®š&quot;,</span><br><span class="line">        cancelButtonText: &quot;å–æ¶ˆ&quot;,</span><br><span class="line">        type: &quot;warning&quot;,</span><br><span class="line">      &#125;)</span><br><span class="line">        .then(() =&gt; &#123;</span><br><span class="line">          // æ‰¹é‡åˆ é™¤</span><br><span class="line">          deleteBatch(this.ids).then((res) =&gt; &#123;</span><br><span class="line">            this.$message.success(&quot;åˆ é™¤æˆåŠŸ&quot;);</span><br><span class="line">            this.findAll();</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(() =&gt; &#123;</span><br><span class="line">          this.$message(&#123;</span><br><span class="line">            type: &quot;info&quot;,</span><br><span class="line">            message: &quot;å·²å–æ¶ˆåˆ é™¤&quot;,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    // ä¿®æ”¹ç”¨æˆ·çŠ¶æ€</span><br><span class="line">    updateStatus(id, status) &#123;</span><br><span class="line">      updateStatus(id, status)</span><br><span class="line">        .then((res) =&gt; &#123;</span><br><span class="line">          this.$message.success(res.msg);</span><br><span class="line">          this.findAll();</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) =&gt; &#123;</span><br><span class="line">          console.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    // æ–‡ä»¶ä¸Šä¼ </span><br><span class="line">    handleAvatarSuccess(res, file) &#123;</span><br><span class="line">     // this.user.image = URL.createObjectURL(file.raw);</span><br><span class="line">     URL.createObjectURL(file.raw);</span><br><span class="line">     this.user.image = res.data;</span><br><span class="line">    &#125;,</span><br><span class="line">    beforeAvatarUpload(file) &#123;</span><br><span class="line">      const isJPG = file.type === &quot;image/jpeg&quot;;</span><br><span class="line">      const isLt2M = file.size / 1024 / 1024 &lt; 2;</span><br><span class="line"></span><br><span class="line">      if (!isJPG) &#123;</span><br><span class="line">        this.$message.error(&quot;ä¸Šä¼ å¤´åƒå›¾ç‰‡åªèƒ½æ˜¯ JPG æ ¼å¼!&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      if (!isLt2M) &#123;</span><br><span class="line">        this.$message.error(&quot;ä¸Šä¼ å¤´åƒå›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 2MB!&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      return isJPG &amp;&amp; isLt2M;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.findRole();</span><br><span class="line">    this.findAll();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="image/image-20211220163849887.png" alt="image-20211220163849887"></p>
<h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">onSubmit()&#123;</span><br><span class="line">            request.request(&#123;</span><br><span class="line">                url:<span class="string">&quot;http://localhost:8888/cms/article/save&quot;</span>,</span><br><span class="line">                method:<span class="string">&quot;post&quot;</span>,</span><br><span class="line">                headers:&#123;</span><br><span class="line">                    <span class="string">&quot;Content-Type&quot;</span>:<span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                data:qs.stringify(<span class="keyword">this</span>.form)</span><br><span class="line">            &#125;).then(response=&gt;&#123;</span><br><span class="line">               <span class="comment">// æç¤ºæˆåŠŸ</span></span><br><span class="line">                <span class="keyword">this</span>.$message(&#123;</span><br><span class="line">                message: response.message,</span><br><span class="line">                type: <span class="string">&#x27;success&#x27;</span></span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="comment">//è¿”å›åˆ—è¡¨é¡µ</span></span><br><span class="line">                <span class="keyword">this</span>.back();</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">                </span><br><span class="line">    toEditArticle()&#123;</span><br><span class="line">      <span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">        path:<span class="string">&#x27;/article/editor&#x27;</span>,</span><br><span class="line">        query:row</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">è·³è½¬æ¥å—å‚æ•°</span><br><span class="line">  created()&#123;</span><br><span class="line">        <span class="keyword">this</span>.form=<span class="keyword">this</span>.$route.query;</span><br><span class="line">    &#125;,</span><br><span class="line">            </span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>project</category>
      </categories>
      <tags>
        <tag>vanse_public</tag>
        <tag>out</tag>
      </tags>
  </entry>
  <entry>
    <title>briup-jsp</title>
    <url>/archives/briup/briup-jsp.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="jsp"><a href="#jsp" class="headerlink" title="jsp"></a>jsp</h1><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1 æ¦‚è¿°"></a>1 æ¦‚è¿°</h2><blockquote>
<p>jspå…¨ç§°Java Server Pagesï¼Œæ˜¯ä¸€ç§åŠ¨æ€ç½‘é¡µå¼€å‘æŠ€æœ¯</p>
</blockquote>
<p>.htmlæ–‡ä»¶æ˜¯é™æ€é¡µé¢<br>.jsp æ–‡ä»¶æ˜¯åŠ¨æ€é¡µé¢</p>
<p>jspé¡µé¢å…è®¸æˆ‘ä»¬åœ¨htmlä»£ç ä¸­åµŒå…¥javaä»£ç ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨htmlä¸­ä½¿ç”¨javaä»£ç æ¥å®Œæˆçš„åŠŸèƒ½äº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œç®€å•çš„ç†è§£ï¼šjspå°±æ˜¯htmlé¡µé¢+javaä»£ç </p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;index.html&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;% String name = <span class="string">&quot;tom&quot;</span>; %&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;h1&gt;&lt;%=<span class="string">&quot;hello!&quot;</span>+name %&gt;&lt;/h1&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>





<h2 id="2-è¿è¡Œ"><a href="#2-è¿è¡Œ" class="headerlink" title="2 è¿è¡Œ"></a>2 è¿è¡Œ</h2><p>æµè§ˆå™¨å¯ä»¥ç›´æ¥è¿è¡Œhtmlé¡µé¢ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è¿è¡Œjspé¡µé¢ã€‚</p>
<p>jspæ˜¯éœ€è¦åœ¨webå®¹å™¨ä¸­è¿è¡Œï¼ˆä¾‹å¦‚tomcatä¸­ï¼‰ï¼Œå› ä¸ºwebå®¹å™¨ä¸­æœ‰JSPçš„è¿è¡Œç¯å¢ƒã€‚</p>
<p>å…¶ä¸­æœ€æ ¸å¿ƒçš„æ˜¯æœ‰JSPçš„å¼•æ“ï¼ˆjasper.jarï¼‰,å®ƒå¯ä»¥å°†jspé¡µé¢ç¿»è¯‘æˆjavaç¨‹åºï¼Œå¹¶ç¼–è¯‘æˆclassæ–‡ä»¶ï¼Œç„¶ååœ¨è¿è¡Œã€‚</p>
<p>æ‰€ä»¥jspæ˜¯è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„ï¼Œè¿è¡Œå®Œä¹‹åï¼ŒæŠŠåŠ¨æ€ç”Ÿæˆçš„htmlé¡µé¢å†ä½¿ç”¨ioæµå†™å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ¥æ”¶å¹¶ä¸”è§£æåå†å‘ˆç°å‡ºæ¥æ•ˆæœã€‚</p>
<h2 id="3-å…³ç³»"><a href="#3-å…³ç³»" class="headerlink" title="3 å…³ç³»"></a>3 å…³ç³»</h2><p>JSPå’ŒServletçš„å…³ç³»ï¼šJSPæœ¬è´¨ä¸Šä¹Ÿæ˜¯Servletã€‚</p>
<p>å› ä¸ºJSPé¡µé¢ç¬¬ä¸€æ¬¡è¢«è®¿é—®çš„æ—¶ï¼Œä¼šè¢«tomcatæœåŠ¡å™¨ç¼–è¯‘æˆä¸€ä¸ªjavaç±»ï¼Œè¿™ä¸ªjavaç±»é»˜è®¤ç»§æ‰¿<code>HttpJspBase</code>ç±»ï¼Œè€Œ<code>HttpJspBase</code>ç±»æ˜¯<code>HttpServlet</code>çš„å­ç±»ï¼Œæ‰€ä»¥JSPå…¶å®å°±æ˜¯ä¸€ä¸ªServletç¨‹åºã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆJSPç¨‹åºå’ŒServletä¸€æ ·ï¼Œéƒ½éœ€è¦è¿è¡Œåœ¨Webå®¹å™¨ä¸­ã€‚</p>
<p>jspé¡µé¢è¢«tomcatæœåŠ¡å™¨ç¼–è¯‘æˆçš„javaæ–‡ä»¶åŠå…¶classæ–‡ä»¶ï¼Œä¿å­˜åœ¨tomcatæœåŠ¡å™¨é‡Œé¢çš„workç›®å½•ä¸­ï¼Œåœ¨è¿™é‡Œçš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çœ‹è§å®ƒæ˜¯å¦‚ä½•ä½¿ç”¨ioæµæŠŠç”Ÿæˆçš„htmlé¡µé¢ä»£ç ä¸€è¡Œä¸€è¡Œå†™å›ç»™æµè§ˆå™¨çš„ã€‚</p>
<blockquote>
<p>æ³¨æ„: é¡¹ç›®è·¯å¾„ä¸è¦/ å¦åˆ™ç”Ÿæˆclassæ–‡ä»¶ä½ç½®ä¸å¯¹</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œindex.jspå°†ä¼šç¿»è¯‘æˆä¸‹é¢çš„javaä»£ç ï¼Œç„¶åå†å˜æˆclassæ–‡ä»¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Generated by the Jasper component of Apache Tomcat</span></span><br><span class="line"><span class="comment"> * Version: Apache Tomcat/8.5.58</span></span><br><span class="line"><span class="comment"> * Generated at: 2020-10-07 01:50:21 UTC</span></span><br><span class="line"><span class="comment"> * Note: The last modified time of this file was set to</span></span><br><span class="line"><span class="comment"> *       the last modified time of the source file after</span></span><br><span class="line"><span class="comment"> *       generation to assist with modification tracking.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">package</span> org.apache.jsp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.jsp.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">index_jsp</span> <span class="keyword">extends</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">HttpJspBase</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">JspSourceDependent</span>,</span></span><br><span class="line"><span class="class">                 <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">JspSourceImports</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> javax.servlet.jsp.JspFactory _jspxFactory =</span><br><span class="line">          javax.servlet.jsp.JspFactory.getDefaultFactory();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> java.util.Map&lt;java.lang.String,java.lang.Long&gt; _jspx_dependants;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> java.util.Set&lt;java.lang.String&gt; _jspx_imports_packages;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> java.util.Set&lt;java.lang.String&gt; _jspx_imports_classes;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">    _jspx_imports_packages = <span class="keyword">new</span> java.util.HashSet&lt;&gt;();</span><br><span class="line">    _jspx_imports_packages.add(<span class="string">&quot;javax.servlet&quot;</span>);</span><br><span class="line">    _jspx_imports_packages.add(<span class="string">&quot;javax.servlet.http&quot;</span>);</span><br><span class="line">    _jspx_imports_packages.add(<span class="string">&quot;javax.servlet.jsp&quot;</span>);</span><br><span class="line">    _jspx_imports_classes = <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">volatile</span> javax.el.ExpressionFactory _el_expressionfactory;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">volatile</span> org.apache.tomcat.InstanceManager _jsp_instancemanager;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> java.util.Map&lt;java.lang.String,java.lang.Long&gt; getDependants() &#123;</span><br><span class="line">    <span class="keyword">return</span> _jspx_dependants;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> java.util.Set&lt;java.lang.String&gt; getPackageImports() &#123;</span><br><span class="line">    <span class="keyword">return</span> _jspx_imports_packages;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> java.util.Set&lt;java.lang.String&gt; getClassImports() &#123;</span><br><span class="line">    <span class="keyword">return</span> _jspx_imports_classes;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> javax.el.<span class="function">ExpressionFactory <span class="title">_jsp_getExpressionFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (_el_expressionfactory == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (_el_expressionfactory == <span class="keyword">null</span>) &#123;</span><br><span class="line">          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _el_expressionfactory;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> org.apache.tomcat.<span class="function">InstanceManager <span class="title">_jsp_getInstanceManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (_jsp_instancemanager == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (_jsp_instancemanager == <span class="keyword">null</span>) &#123;</span><br><span class="line">          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _jsp_instancemanager;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">_jspInit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">_jspDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">_jspService</span><span class="params">(<span class="keyword">final</span> javax.servlet.http.HttpServletRequest request, <span class="keyword">final</span> javax.servlet.http.HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> java.io.IOException, javax.servlet.ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> java.lang.String _jspx_method = request.getMethod();</span><br><span class="line">    <span class="keyword">if</span> (!<span class="string">&quot;GET&quot;</span>.equals(_jspx_method) &amp;&amp; !<span class="string">&quot;POST&quot;</span>.equals(_jspx_method) &amp;&amp; !<span class="string">&quot;HEAD&quot;</span>.equals(_jspx_method) &amp;&amp; !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) &#123;</span><br><span class="line">      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, <span class="string">&quot;JSP åªå…è®¸ GETã€POST æˆ– HEADã€‚Jasper è¿˜å…è®¸ OPTIONS&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> javax.servlet.jsp.PageContext pageContext;</span><br><span class="line">    javax.servlet.http.HttpSession session = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">final</span> javax.servlet.ServletContext application;</span><br><span class="line">    <span class="keyword">final</span> javax.servlet.ServletConfig config;</span><br><span class="line">    javax.servlet.jsp.JspWriter out = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">final</span> java.lang.Object page = <span class="keyword">this</span>;</span><br><span class="line">    javax.servlet.jsp.JspWriter _jspx_out = <span class="keyword">null</span>;</span><br><span class="line">    javax.servlet.jsp.PageContext _jspx_page_context = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      response.setContentType(<span class="string">&quot;text/html; charset=UTF-8&quot;</span>);</span><br><span class="line">      pageContext = _jspxFactory.getPageContext(<span class="keyword">this</span>, request, response,</span><br><span class="line">      			<span class="keyword">null</span>, <span class="keyword">true</span>, <span class="number">8192</span>, <span class="keyword">true</span>);</span><br><span class="line">      _jspx_page_context = pageContext;</span><br><span class="line">      application = pageContext.getServletContext();</span><br><span class="line">      config = pageContext.getServletConfig();</span><br><span class="line">      session = pageContext.getSession();</span><br><span class="line">      out = pageContext.getOut();</span><br><span class="line">      _jspx_out = out;</span><br><span class="line"></span><br><span class="line">      out.write(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;&lt;!DOCTYPE html&gt;\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;&lt;html&gt;\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;&lt;head&gt;\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;&lt;meta charset=\&quot;UTF-8\&quot;&gt;\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;&lt;title&gt;index.html&lt;/title&gt;\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;&lt;/head&gt;\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;&lt;body&gt;\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line"> String name = <span class="string">&quot;tom&quot;</span>; </span><br><span class="line">      out.write(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;\t\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;\t&lt;h1&gt;&quot;</span>);</span><br><span class="line">      out.print(<span class="string">&quot;hello!&quot;</span>+name );</span><br><span class="line">      out.write(<span class="string">&quot;&lt;/h1&gt;\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;\t\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;&lt;/body&gt;\r\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;&lt;/html&gt;&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (java.lang.Throwable t) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!(t <span class="keyword">instanceof</span> javax.servlet.jsp.SkipPageException))&#123;</span><br><span class="line">        out = _jspx_out;</span><br><span class="line">        <span class="keyword">if</span> (out != <span class="keyword">null</span> &amp;&amp; out.getBufferSize() != <span class="number">0</span>)</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (response.isCommitted()) &#123;</span><br><span class="line">              out.flush();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              out.clearBuffer();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125; <span class="keyword">catch</span> (java.io.IOException e) &#123;&#125;</span><br><span class="line">        <span class="keyword">if</span> (_jspx_page_context != <span class="keyword">null</span>) _jspx_page_context.handlePageException(t);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">throw</span> <span class="keyword">new</span> ServletException(t);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      _jspxFactory.releasePageContext(_jspx_page_context);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œçš„<code>_jspService</code>æ–¹æ³•ï¼Œå°±ç›¸å½“äºservletä¸­çš„<code>service</code>æ–¹æ³•ï¼Œjspè¢«è®¿é—®çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•</p>
</blockquote>
<h2 id="4-ä»£ç "><a href="#4-ä»£ç " class="headerlink" title="4 ä»£ç "></a>4 ä»£ç </h2><p>jspé¡µé¢ä¸­åµŒå…¥javaä»£ç ï¼Œä¸€å…±æœ‰ä¸‰ç§æ–¹å¼ï¼š</p>
<ul>
<li>è¡¨è¾¾å¼(expression)</li>
<li>è„šæœ¬(scriptlet)</li>
<li>å£°æ˜(declaration)</li>
</ul>
<h3 id="4-1-è¡¨è¾¾å¼"><a href="#4-1-è¡¨è¾¾å¼" class="headerlink" title="4.1 è¡¨è¾¾å¼"></a>4.1 è¡¨è¾¾å¼</h3><p>å½¢å¼ï¼š</p>
<p><code>&lt;%= %&gt;</code></p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%=<span class="string">&quot;hello&quot;</span> %&gt;</span><br><span class="line">&lt;%=<span class="number">1</span>+<span class="number">1</span> %&gt;</span><br><span class="line">&lt;%=s.getName() %&gt;</span><br></pre></td></tr></table></figure>



<p>å°†æ¥ç¿»è¯‘åˆ°javaæ–‡ä»¶ä¸­çš„ä½ç½®ï¼š</p>
<p>_jspServiceæ–¹æ³•ä¸­ï¼Œout.print(..)ä»£ç çš„å‚æ•°</p>
<p>ä¾‹å¦‚ï¼Œä¸Šé¢é‚£å‡ ä¸ªä¾‹å­ä¼šç¿»è¯‘æˆ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">out.print(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">out.print(<span class="number">1</span>+<span class="number">1</span>);</span><br><span class="line">out.print(s.getName());</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ‰€ä»¥out.prntln()è¿™ä¸ªæ–¹æ³•çš„å‚æ•°å¯ä»¥å†™ä»€ä¹ˆï¼Œé‚£ä¹ˆè¿™ä¸ªjspé¡µé¢ä¸­è¡¨è¾¾å¼é‡Œé¢å°±å¯ä»¥å†™ä»€ä¹ˆ</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œåœ¨jspä¸­çš„è¡¨è¾¾å¼ï¼Œè¯­å¥çš„æœ€åä¸éœ€è¦åŠ ;å·</p>
</blockquote>
<h3 id="4-2-è„šæœ¬"><a href="#4-2-è„šæœ¬" class="headerlink" title="4.2 è„šæœ¬"></a>4.2 è„šæœ¬</h3><p>å½¢å¼ï¼š</p>
<p><code>&lt;% %&gt;</code></p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line"> &lt;%</span><br><span class="line">    Student s = <span class="keyword">new</span> Student();</span><br><span class="line"></span><br><span class="line">    String name = <span class="string">&quot;tom&quot;</span>;</span><br><span class="line"></span><br><span class="line">    String username = s.getName();</span><br><span class="line"></span><br><span class="line">    List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">    list.add(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>



<p>å°†æ¥ç¿»è¯‘åˆ°javaæ–‡ä»¶ä¸­çš„ä½ç½®ï¼š</p>
<p>è„šæœ¬ä¸­çš„ä»£ç å°†æ¥ä¼šè¢«ç›´æ¥ç¿»è¯‘åˆ°_jspServiceè¿™ä¸ªæ–¹æ³•ä¸­</p>
<blockquote>
<p>æ‰€ä»¥ï¼Œåœ¨ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥å†™ä»€ä¹ˆæ ·çš„ä»£ç ï¼Œé‚£ä¹ˆåœ¨è„šæœ¬ä¸­å°±å¯ä»¥å†™ä»€ä¹ˆæ ·çš„ä»£ç .</p>
</blockquote>
<h3 id="4-3-å£°æ˜"><a href="#4-3-å£°æ˜" class="headerlink" title="4.3 å£°æ˜"></a>4.3 å£°æ˜</h3><p>å½¢å¼ï¼š</p>
<p><code>&lt;%! %&gt;</code></p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%!</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">go</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello world &quot;</span>+name);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;this is go()&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>



<p>å°†æ¥ç¿»è¯‘åˆ°javaæ–‡ä»¶ä¸­çš„ä½ç½®ï¼š</p>
<p>ç›´æ¥å°†å£°æ˜ä¸­çš„ä»£ç ç¿»è¯‘åˆ°javaæ–‡ä»¶é‡Œé¢æ‰€å®šä¹‰çš„ç±»ä¸­</p>
<blockquote>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªç±»ä¸­å†™ä»€ä¹ˆï¼ˆå±æ€§å’Œæ–¹æ³•ï¼‰ï¼Œå°±å¯ä»¥åœ¨å£°æ˜ä¸­å†™ä»€ä¹ˆ</p>
</blockquote>
<h2 id="5-æŒ‡ä»¤"><a href="#5-æŒ‡ä»¤" class="headerlink" title="5 æŒ‡ä»¤"></a>5 æŒ‡ä»¤</h2><p>jspçš„æŒ‡ä»¤æ˜¯ç»™jspå¼•æ“çœ‹çš„ï¼Œè®©jspå¼•æ“åœ¨ç¿»è¯‘jspé¡µé¢æˆjavaæ–‡ä»¶çš„æ—¶å€™ï¼ŒçŸ¥é“éœ€è¦æ³¨æ„å“ªäº›åœ°æ–¹çš„è®¾ç½®ã€‚æ¯”å¦‚é¡µé¢ä¸­çš„ç¼–ç ã€é¡µé¢ä¸­è„šæœ¬é‡Œé¢æ‰€ç”¨çš„ç¼–ç¨‹è¯­è¨€ã€ç¿»è¯‘çš„javaæ–‡ä»¶ä¸­éœ€è¦å¼•å…¥å“ªäº›åŒ…ä¸‹çš„javaç±»ç­‰ç­‰</p>
<p>å†™æ³•ï¼š</p>
<p><code>&lt;%@æŒ‡ä»¤åå­—  å±æ€§=&quot;å€¼&quot; ..  %&gt;</code></p>
<p>åˆ†ç±»ï¼š</p>
<ul>
<li>pageæŒ‡ä»¤</li>
<li>includeæŒ‡ä»¤</li>
<li>taglibæŒ‡ä»¤</li>
</ul>
<h3 id="5-1-page"><a href="#5-1-page" class="headerlink" title="5.1 page"></a>5.1 page</h3><p>pageæ˜¯å¸¸ç”¨çš„ä¸€ä¸ªjspæŒ‡ä»¤ï¼Œå¯ä»¥ç”¨æ¥æŒ‡å®šå½“å‰jspçš„ä¸€äº›åŸºæœ¬è®¾ç½®</p>
<p>ä¾‹å¦‚ï¼Œæ–°å»ºjspé¡µé¢åï¼Œæ–‡ä»¶å¤´éƒ¨ä¼šé»˜è®¤æœ‰ä»¥ä¸‹pageæŒ‡ä»¤çš„è®¾ç½®</p>
<p><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;     pageEncoding=&quot;UTF-8&quot;%&gt;</code></p>
<p>å…¶ä½œç”¨åˆ†åˆ«æ˜¯</p>
<ul>
<li>æŒ‡å®šå½“å‰jspé¡µé¢ä¸­åµŒå…¥çš„è¯­è¨€æ˜¯java</li>
<li>æŒ‡å®šå†™å›ç»™æµè§ˆå™¨é¡µé¢çš„æ—¶å€™ï¼ŒcontentTypeçš„å†…å®¹</li>
<li>æŒ‡å®šå½“å‰é¡µé¢ä»¶ä¿å­˜æ—¶å€™æ‰€ç”¨çš„ç¼–ç </li>
</ul>
<p>ä¾‹å¦‚ï¼Œåœ¨jspä¸­å¼•å…¥å…¶ä»–çš„ç±»å’Œæ¥å£</p>
<p><code>&lt;%@ page import=&quot;java.util.List,java.util.ArrayList&quot; %&gt;</code></p>
<p>ä¾‹å¦‚ï¼ŒæŒ‡å®šå½“å‰jspé¡µé¢ä¸­æ˜¯å¦æ”¯æŒsessionçš„ä½¿ç”¨ï¼Œé»˜è®¤å€¼å°±æ˜¯true</p>
<p><code>&lt;%@ page session=&quot;true&quot; %&gt;</code></p>
<p>ä¾‹å¦‚ï¼ŒæŒ‡å®šå½“å‰é¡µé¢å‡ºé”™ä¹‹åï¼Œä¼šè·³è½¬åˆ°error.jspé¡µé¢</p>
<p><code>&lt;%@ page errorPage=&quot;error.jsp&quot; %&gt;</code></p>
<p>ä¾‹å¦‚ï¼ŒæŒ‡å®šå½“å‰é¡µé¢æ˜¯ä¸“é—¨ç”¨æ¥æ˜¾ç¤ºé”™è¯¯çš„é¡µé¢ï¼Œåœ¨å½“å‰é¡µé¢ä¸­å¯ä»¥ä½¿ç”¨éšè—å¯¹è±¡exceptionæ¥æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯</p>
<p><code>&lt;%@ page isErrorPage=&quot;true&quot; %&gt;</code></p>
<h3 id="5-2-include"><a href="#5-2-include" class="headerlink" title="5.2 include"></a>5.2 include</h3><p>includeæŒ‡ä»¤ï¼Œå¯ä»¥å°†å¦ä¸€ä¸ªé¡µé¢çš„æ˜¾ç¤ºå†…å®¹ï¼Œå¼•å…¥åˆ°å½“å‰é¡µé¢ä¸­çš„æŒ‡å®šä½ç½®</p>
<p>å½¢å¼ï¼Œ</p>
<p><code>&lt;%@include file=&quot;&quot; %&gt;</code></p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;hello&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;h1&gt;hello!jsp&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;index.html&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;h1&gt;index&lt;/h1&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;%@ include file=<span class="string">&quot;/hello.jsp&quot;</span> %&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>



<p>è®¿é—®é¡µé¢index.jspï¼ŒæŸ¥çœ‹å…¶é¡µé¢æºä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>index.html<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>index<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello!jsp<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨index.jspé¡µé¢ä¸­çš„includeæŒ‡ä»¤å¤„ï¼ŒæŠŠhello.jspçš„å†…å®¹å¼•å…¥äº†è¿‡æ¥</p>
</blockquote>
<h3 id="5-3-taglib"><a href="#5-3-taglib" class="headerlink" title="5.3 taglib"></a>5.3 taglib</h3><p>taglibæŒ‡ä»¤ï¼Œåœ¨jspä¸­å¯ä»¥å¼•å…¥æ ‡ç­¾åº“ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨æ ‡ç­¾åº“ä¸­çš„æ ‡ç­¾ï¼Œæ¥å®Œæˆç›¸åº”çš„åŠŸèƒ½äº†</p>
<p>ä¾‹å¦‚ï¼Œå¼•å…¥JSTLæ ‡ç­¾åº“ (ç®€åŒ–jspå¼€å‘)</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> prefix=<span class="string">&quot;c&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œå¼•å…¥springæ¡†æ¶çš„æ ‡ç­¾åº“</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">&quot;http://www.springframework.org/tags&quot;</span> prefix=<span class="string">&quot;s&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œå¼•å…¥struts2æ¡†æ¶çš„æ ‡ç­¾</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">&quot;/struts-tags&quot;</span> prefix=<span class="string">&quot;s&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>



<p>æ³¨æ„1ï¼Œå¼•å…¥æ ‡ç­¾åº“ï¼Œéœ€è¦å…ˆåœ¨é¡¹ç›®ä¸­å¼•å…¥å¯¹åº”çš„jaråŒ…</p>
<p>æ³¨æ„2ï¼Œuriå±æ€§ï¼ŒæŒ‡çš„æ˜¯æ ‡ç­¾åº“çš„è®¾ç½®çš„URIåœ°å€</p>
<p>æ³¨æ„3ï¼Œprefixå±æ€§ï¼ŒæŒ‡çš„æ˜¯ç»™å¼•å…¥çš„æ ‡ç­¾åº“èµ·ä¸€ä¸ªåˆ«åï¼Œè¿™æ ·ä½¿ç”¨èµ·æ¥è¾ƒä¸ºæ–¹ä¾¿</p>
<blockquote>
<p>æ³¨æ„ï¼Œåé¢å­¦ä¹ åˆ°JSTLæ ‡ç­¾åº“çš„æ—¶å€™ï¼Œå†å…·ä½“æ¥ä½¿ç”¨</p>
</blockquote>
<h2 id="6-åŠ¨ä½œ"><a href="#6-åŠ¨ä½œ" class="headerlink" title="6 åŠ¨ä½œ"></a>6 åŠ¨ä½œ</h2><p>jspä¸­è¿˜æœ‰å†…ç½®çš„æ ‡ç­¾ï¼Œç§°ä¹‹ä¸ºjspçš„åŠ¨ä½œå…ƒç´ ï¼Œå®ƒçš„æœ¬è´¨å°±æ˜¯æŠŠå›ºå®šçš„javaä»£ç ï¼Œå°è£…æˆäº†æ ‡ç­¾çš„å½¢å¼ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p><code>&lt;jsp:useBean id=&quot;s&quot; class=&quot;com.briup.bean.Student&quot; scope=&quot;page&quot;&gt;&lt;/jsp:useBean&gt;</code></p>
<p>ç›¸å½“äºä»£ç ï¼š</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line"> &lt;%</span><br><span class="line">    Student s = <span class="keyword">null</span>;</span><br><span class="line">    s = (Student)pageContext.getAttribute(<span class="string">&quot;s&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(s==<span class="keyword">null</span>)&#123;</span><br><span class="line">        s = <span class="keyword">new</span> Student();</span><br><span class="line">        pageContext.setAttribute(<span class="string">&quot;s&quot;</span>,s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ•ˆæœ</p>
<p><code>&lt;%= pageContext.getAttribute(&quot;user&quot;) %&gt;</code></p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p><code>&lt;jsp:setProperty property=&quot;name&quot; value=&quot;tom&quot; name=&quot;s&quot;/&gt;</code></p>
<p>ç›¸å½“äºä»£ç ï¼š</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    Student s = (Student)pageContext.getAttribute(<span class="string">&quot;s&quot;</span>);</span><br><span class="line">    s.setName(<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ•ˆæœ</p>
<p><code>&lt;%= pageContext.getAttribute(&quot;user&quot;) %&gt;</code></p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p><code>&lt;jsp:getProperty property=&quot;name&quot; name=&quot;s&quot;/&gt;</code></p>
<p>ç›¸å½“äºä»£ç ï¼š</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">	Student s = (Student)pageContext.getAttribute(<span class="string">&quot;s&quot;</span>);</span><br><span class="line">	out.write(s.getName());</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>





<p>JSPçš„åŠ¨ä½œå…ƒç´ ä¸­ï¼Œå¸¸è¢«ç”¨çš„æœ‰ä¿©ä¸ªï¼š</p>
<ul>
<li>forward</li>
<li>include</li>
</ul>
<p>ä¾‹å¦‚ï¼Œé¡µé¢è·³è½¬</p>
<p><code>&lt;jsp:forward page=&quot;target.jsp&quot;&gt;&lt;/jsp:forward&gt;</code></p>
<p>ä¾‹å¦‚ï¼Œè·³è½¬çš„åŒæ—¶è¿˜å¯ä»¥ä¼ å‚æ•°</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;jsp:forward page=<span class="string">&quot;target.jsp&quot;</span>&gt;</span><br><span class="line">    &lt;jsp:param value=<span class="string">&quot;tom&quot;</span> name=<span class="string">&quot;name&quot;</span>/&gt;</span><br><span class="line">&lt;/jsp:forward&gt;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œåœ¨å½“å‰é¡µé¢ä¸­åŒ…å«å¦ä¸€ä¸ªé¡µé¢</p>
<p><code>&lt;jsp:include page=&quot;foot.jsp&quot;&gt;&lt;/jsp:include&gt;</code></p>
<p>ä¾‹å¦‚ï¼Œåœ¨åŒ…å«é¡µé¢çš„åŒæ—¶ï¼Œè¿˜å¯ä»¥ä¼ å‚</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;jsp:include page=<span class="string">&quot;foot.jsp&quot;</span>&gt;</span><br><span class="line">    &lt;jsp:param value=<span class="string">&quot;lisi&quot;</span> name=<span class="string">&quot;name&quot;</span>/&gt;</span><br><span class="line">&lt;/jsp:include&gt;</span><br></pre></td></tr></table></figure>

<p>foot.jsp</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">æ³¨å†Œ|ç™»å½•|è´­ç‰©è½¦ ä½ å¥½ &lt;%= request.getParameter(<span class="string">&quot;username&quot;</span>) %&gt;</span><br></pre></td></tr></table></figure>



<hr>
<p>ä¸€ä¸ªé¡µé¢åŒ…å«/å¼•å…¥å¦å¤–ä¸€ä¸ªé¡µé¢æœ‰ä¿©ç§æ–¹å¼</p>
<ul>
<li>é™æ€åŒ…å«ï¼Œ<code>&lt;%@include file=&quot;&quot; %&gt;</code></li>
<li>åŠ¨æ€åŒ…å«ï¼Œ<code>&lt;jsp:include page=&quot;&quot;&gt;&lt;/jsp:include&gt;</code></li>
</ul>
<p>é™æ€åŒ…å«ï¼Œåœ¨jspç¿»è¯‘æˆjavaç¨‹åºçš„æ—¶å€™ï¼Œç›´æ¥å°†å¦ä¸€ä¸ªé¡µé¢çš„å†…å®¹åŸå°ä¸åŠ¨çš„å†™å…¥åˆ°ä»£ç ä¸­ã€‚</p>
<p>åŠ¨æ€åŒ…å«ï¼Œåœ¨jspç¿»è¯‘æˆjavaç¨‹åºçš„æ—¶å€™ï¼Œåªä¼šæŠŠåŒ…å«çš„åŠ¨ä½œç¿»è¯‘æˆä¸€ä¸ªæ–¹æ³•çš„è°ƒç”¨ï¼Œå°†æ¥åœ¨è®¿é—®çš„æ—¶å€™æ‰ä¼šçœŸæ­£çš„å»è·å–å¦ä¸€ä¸ªé¡µé¢çš„å†…å®¹ã€‚</p>
<p><code>å…·ä½“å¯æŸ¥çœ‹ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶åšå¯¹æ¯”</code></p>
<blockquote>
<p>æ³¨æ„ï¼ŒåŠ¨æ€åŒ…å«å¯ä»¥ä¼ å‚ï¼Œé™æ€åŒ…å«ä¸èƒ½ç©¿å‚</p>
</blockquote>
<h2 id="7-æ³¨é‡Š"><a href="#7-æ³¨é‡Š" class="headerlink" title="7 æ³¨é‡Š"></a>7 æ³¨é‡Š</h2><p>jspä¸­çš„æ³¨é‡Šï¼Œåˆ†ä¸ºä¸‰ç§</p>
<ul>
<li>html/xmlä¸­çš„æ³¨é‡Šæ–¹å¼</li>
<li>jspä¸­çš„æ³¨é‡Šæ–¹å¼</li>
<li>javaä¸­çš„æ³¨é‡Šæ–¹å¼</li>
</ul>
<h3 id="7-1-htmlæ³¨é‡Š"><a href="#7-1-htmlæ³¨é‡Š" class="headerlink" title="7.1 htmlæ³¨é‡Š"></a>7.1 htmlæ³¨é‡Š</h3><p>å½¢å¼ï¼š</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;!-- html/xmlä¸­çš„æ³¨é‡Šæ–¹å¼ --&gt;</span><br></pre></td></tr></table></figure>

<p>ç‰¹ç‚¹:</p>
<ol>
<li>ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­å³é”®æŸ¥çœ‹æºä»£ç  ã€èƒ½ã€‘ çœ‹åˆ°è¿™ä¸ªæ³¨é‡Š</li>
<li>åœ¨æœåŠ¡å™¨ç«¯,è¿™ä¸ªjspé¡µé¢è¢«ç¿»è¯‘æˆçš„javaæ–‡ä»¶ä¸­ ã€èƒ½ã€‘ çœ‹åˆ°è¿™ä¸ªæ³¨é‡Š.</li>
</ol>
<blockquote>
<p>æ³¨æ„ï¼ŒjspåŠ¨ä½œå…ƒç´ ï¼Œæ”¾åœ¨è¿™ç§æ³¨é‡Šé‡Œé¢å¯èƒ½ä¸èµ·ä½œç”¨(æ³¨é‡Šä¸èµ·ä½œç”¨,jspåŠ¨ä½œå…ƒç´ æ­£å¸¸æ‰§è¡Œ)</p>
</blockquote>
<p>ä¾‹å¦‚ï¼šä¸‹é¢çš„æ³¨é‡Šä¸èµ·ä½œç”¨</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;!-- </span><br><span class="line">	&lt;jsp:forward page=<span class="string">&quot;hello.jsp&quot;</span>&gt;&lt;/jsp:forward&gt;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<p>èµ·ä½œç”¨</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;!-- username: &lt;jsp:getProperty property=<span class="string">&quot;username&quot;</span> name=<span class="string">&quot;user&quot;</span>/&gt; --&gt;</span><br></pre></td></tr></table></figure>



<h3 id="7-2-jspæ³¨é‡Š"><a href="#7-2-jspæ³¨é‡Š" class="headerlink" title="7.2 jspæ³¨é‡Š"></a>7.2 jspæ³¨é‡Š</h3><p>å½¢å¼ï¼š</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%-- </span><br><span class="line">    jspä¸­çš„æ³¨é‡Šæ–¹å¼(éšè—æ³¨é‡Š)</span><br><span class="line">--%&gt;</span><br></pre></td></tr></table></figure>

<p>ç‰¹ç‚¹:</p>
<ol>
<li>ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­å³é”®æŸ¥çœ‹æºä»£ç  ã€ä¸èƒ½ã€‘çœ‹åˆ°è¿™ä¸ªæ³¨é‡Šã€‚</li>
<li>åœ¨æœåŠ¡å™¨ç«¯,è¿™ä¸ªjspé¡µé¢è¢«ç¿»è¯‘æˆçš„javaæ–‡ä»¶ä¸­ [ä¸èƒ½] çœ‹åˆ°è¿™ä¸ªæ³¨é‡Š.</li>
</ol>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™ç§æ³¨é‡Šï¼Œä¹Ÿè¢«ç§°ä¸ºJSPä¸­çš„éšè—æ³¨é‡Š</p>
</blockquote>
<h3 id="7-3-javaæ³¨é‡Š"><a href="#7-3-javaæ³¨é‡Š" class="headerlink" title="7.3 javaæ³¨é‡Š"></a>7.3 javaæ³¨é‡Š</h3><p>javaä¸­çš„æ³¨é‡Šæ–¹å¼ï¼Œåªèƒ½åœ¨jspçš„è„šæœ¬æˆ–è€…å£°æ˜ä¸­ä½¿ç”¨ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">	<span class="comment">//String name = &quot;tom&quot;;</span></span><br><span class="line">	<span class="comment">/* </span></span><br><span class="line"><span class="comment">		int b = 40;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">  		 	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">		int a = 20;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>ç‰¹ç‚¹:</p>
<ol>
<li>ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­å³é”®æŸ¥çœ‹æºä»£ç  ã€ä¸èƒ½ã€‘ çœ‹åˆ°è¿™ä¸ªæ³¨é‡Šã€‚</li>
<li>åœ¨æœåŠ¡å™¨ç«¯,è¿™ä¸ªjspé¡µé¢è¢«ç¿»è¯‘æˆçš„javaæ–‡ä»¶ä¸­ ã€èƒ½ã€‘ çœ‹åˆ°è¿™ä¸ªæ³¨é‡Š.</li>
</ol>
<h2 id="8-å¯¹è±¡"><a href="#8-å¯¹è±¡" class="headerlink" title="8 å¯¹è±¡"></a>8 å¯¹è±¡</h2><p>åœ¨jspé¡µé¢ä»£ç ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨çš„å†…ç½®çš„å¯¹è±¡ï¼Œåªè¦å¯¹è±¡åå­—å†™å¯¹å³å¯ã€‚</p>
<p>jspä¸­çš„å†…ç½®å¯¹è±¡ä¸€å…±æœ‰ä¹ç§ï¼š</p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>åå­—</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>PageContext</td>
<td>pageContext</td>
<td>é¡µé¢èŒƒå›´å¯¹è±¡</td>
</tr>
<tr>
<td>HttpServletRequest</td>
<td>request</td>
<td>å’Œservletä¸­çš„ç›¸åŒ</td>
</tr>
<tr>
<td>HttpSession</td>
<td>session</td>
<td>å’Œservletä¸­çš„ç›¸åŒ</td>
</tr>
<tr>
<td>ServletContext</td>
<td>application</td>
<td>å’Œservletä¸­çš„ç›¸åŒ</td>
</tr>
<tr>
<td>Object</td>
<td>page</td>
<td>jspé¡µé¢æœ¬èº«ï¼ˆthisï¼‰</td>
</tr>
<tr>
<td>HttpServletResponse</td>
<td>response</td>
<td>å’Œservletä¸­çš„ç›¸åŒ</td>
</tr>
<tr>
<td>JspWriter</td>
<td>out</td>
<td>è¾“å‡ºæµï¼Œå¯ä»¥ç»™å®¢æˆ·ç«¯å†™å›å†…å®¹</td>
</tr>
<tr>
<td>ServletConfig</td>
<td>config</td>
<td>å’Œservletä¸­çš„ç›¸åŒ</td>
</tr>
<tr>
<td>Throwable</td>
<td>exception</td>
<td>éšè—å¯¹è±¡ï¼Œè¡¨ç¤ºjspä¸­çš„å¼‚å¸¸</td>
</tr>
</tbody></table>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™äº›å¯¹è±¡çš„ç±»å‹å’Œåå­—éƒ½æ˜¯å›ºå®šçš„ï¼Œä»»æ„æ‰“å¼€ä¸€ä¸ªjspé¡µé¢ç¿»è¯‘æˆçš„javaä»£ç ï¼ŒæŸ¥çœ‹_jspServiceæ–¹æ³•ï¼Œå°±å¯ä»¥çœ‹åˆ°è¿™äº›å†…ç½®çš„å¯¹è±¡</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼ŒJSPä¸­æ¯”servletå¤šäº†ä¸€ä¸ªæ›´åŠ å°çš„ä¼ å€¼èŒƒå›´pageContextï¼Œå­˜è¿›å»çš„å€¼ï¼Œåªä¼šåœ¨ä¸€ä¸ªé¡µé¢ä¸­æœ‰æ•ˆï¼Œæ¯”ä¹‹å‰çš„requestèŒƒå›´è¿˜è¦å°</p>
</blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œjspé¡µé¢ä¸­æ˜¯ä¸èƒ½ä½¿ç”¨exceptionè¿™ä¸ªå¯¹è±¡çš„ï¼Œé™¤éé¡µé¢ä¸­è®¾ç½®äº†isErrorPageå±æ€§ï¼š</p>
<p><code>&lt;%@ page isErrorPage=&quot;true&quot; %&gt;</code></p>
<p>æŸ¥çœ‹é”™è¯¯ä¿¡æ¯</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%=</span><br><span class="line">    exception.getMessage()</span><br><span class="line">%&gt; </span><br></pre></td></tr></table></figure>



<h2 id="9-è·¯å¾„"><a href="#9-è·¯å¾„" class="headerlink" title="9 è·¯å¾„"></a>9 è·¯å¾„</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œjspä¸­è·¯å¾„é—®é¢˜æ˜¯å’Œæˆ‘ä»¬ä¹‹å‰åœ¨servletä¸­è®¨è®ºçš„htmlé‡Œé¢çš„è·¯å¾„é—®é¢˜æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯åœ¨jspä¸­å¯ä»¥åŠ¨æ€è·å¾—è¯¥é¡¹ç›®çš„URLåœ°å€</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	String path = request.getContextPath();</span><br><span class="line">	String basePath = request.getScheme()+<span class="string">&quot;://&quot;</span>+request.getServerName()+<span class="string">&quot;:&quot;</span>+request.getServerPort()+path+<span class="string">&quot;/&quot;</span>;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;base href=<span class="string">&quot;&lt;%=basePath%&gt;&quot;</span> /&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;index.html&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;h1&gt;index&lt;/h1&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;a href=<span class="string">&quot;hello.jsp&quot;</span>&gt;hello&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é‡ŒæŠŠé¡¹ç›®çš„åŸºç¡€URLåœ°å€ï¼ŒåŠ¨æ€çš„æ‹¼æ¥äº†å‡ºæ¥ï¼Œå¹¶ä¸”ä½¿ç”¨äº†baseæ ‡ç­¾ï¼Œæ¥æŒ‡å®šé¡µé¢ä¸­ç›¸å¯¹è·¯å¾„çš„å‚ç…§ç‚¹</p>
</blockquote>
<h2 id="10-EL"><a href="#10-EL" class="headerlink" title="10 EL"></a>10 EL</h2><blockquote>
<p>ELï¼ˆExpression Languageï¼‰ï¼Œç§°ä¸ºELè¡¨è¾¾å¼ï¼Œç›®çš„æ˜¯ä¸ºäº†ä½¿JSPå†™èµ·æ¥æ›´åŠ ç®€å•</p>
</blockquote>
<p>åœ¨jspé¡µé¢ä¸­ï¼Œä½¿ç”¨ELè¡¨è¾¾å¼ï¼Œå°±å¯ä»¥ä¸ç”¨å†™å¤§é‡çš„javaä»£ç äº†ï¼Œè¿™æ ·å¯ä»¥æé«˜é¡µé¢çš„å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚</p>
<p>å½¢å¼ï¼š</p>
<p><code>$&#123;&#125;</code></p>
<p>ä¾‹å¦‚ï¼Œæ¥æ”¶å®¢æˆ·ç«¯å‚æ•°</p>
<p><code>http://localhost:8989/day9-jsp/el.jsp?name=lucy</code></p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">$&#123;param.name1 &#125;  &lt;%requet.getParmeter(<span class="string">&quot;usernm&quot;</span>%&gt;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼ŒæŒ‡å®šèŒƒå›´å¹¶å–å€¼</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">$&#123;pageScope.name2 &#125;</span><br><span class="line">$&#123;requestScope.name3 &#125;</span><br><span class="line">$&#123;sessionScope.name4 &#125;</span><br><span class="line">$&#123;applicationScope.name5 &#125;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œå¯ä»¥ä¸æŒ‡å®šèŒƒå›´å†å»å–å€¼</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">$&#123;name&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™æ—¶å€™ä¼šæŒ‰ç…§pageContext request session applicationè¿™æ ·ä¸€ä¸ªé¡ºåºä¾æ¬¡çš„å»æ‰¾ï¼Œæœ‰æ²¡æœ‰ä¸€ä¸ªå«nameçš„å€¼å­˜åœ¨ï¼Œä¸€æ—¦æ‰¾åˆ°äº†å°±è¾“å‡ºå‡ºæ¥ï¼Œæœ€ç»ˆæ²¡æœ‰æ‰¾åˆ°é‚£ä¹ˆå°±ä»€ä¹ˆéƒ½ä¸è¾“å‡º</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œå–å‡ºä¸€ä¸ªå¯¹è±¡ä¸­çš„å±æ€§å€¼</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">$&#123;requestScope.student.id&#125;</span><br><span class="line">$&#123;requestScope.student.name&#125;</span><br><span class="line">$&#123;requestScope.student.age&#125;</span><br><span class="line"><span class="comment">//æˆ–è€…</span></span><br><span class="line">$&#123;student.id&#125;</span><br><span class="line">$&#123;student.name&#125;</span><br><span class="line">$&#123;student.age&#125;</span><br><span class="line"><span class="comment">//æˆ–è€…</span></span><br><span class="line">$&#123;student[<span class="string">&quot;id&quot;</span>]&#125;</span><br><span class="line">$&#123;student[<span class="string">&#x27;id&#x27;</span>]&#125;</span><br><span class="line"></span><br><span class="line">$&#123;student[<span class="string">&quot;name&quot;</span>]&#125;</span><br><span class="line">$&#123;student[<span class="string">&#x27;name&#x27;</span>]&#125;</span><br><span class="line"></span><br><span class="line">$&#123;student[<span class="string">&quot;age&quot;</span>]&#125;</span><br><span class="line">$&#123;student[<span class="string">&#x27;age&#x27;</span>]&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œ${student.id}è¡¨ç¤ºè¦è°ƒç”¨studentå¯¹è±¡ä¸­çš„getIdæ–¹æ³•ï¼Œè‡³äºå¯¹è±¡ä¸­æœ‰æ²¡æœ‰idå±æ€§ï¼Œå¯¹è¿™ä¸ªæ“ä½œæ²¡æœ‰ä»»ä½•å½±å“ã€‚æ‰€ä»¥è¿™å’ŒidæŒ‡çš„æ˜¯å¯¹è±¡ä¸­çš„propertyè€Œä¸æ˜¯attribute</p>
<p>${student[â€˜nameâ€™]}è°ƒç”¨çš„æ˜¯attribute</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œå¦‚æœStudentç±»ä¸­ä¸€ä¸ªæ–¹æ³•æ˜¯getAddressï¼Œè¿”å›ä¸€ä¸ªAddressç±»çš„å¯¹è±¡ï¼ŒAddressç±»ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•getCityï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥è¿™æ ·å†™å»æ‹¿åˆ°cityå±æ€§çš„å€¼.</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">$&#123;student.address.city&#125;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œè¾“å‡ºå­—ç¬¦ä¸²</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">$&#123;<span class="string">&quot;hello&quot;</span>&#125;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œè¾“å‡ºè¿ç®—ç»“æœæˆ–è€…booleanè¡¨è¾¾å¼</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">$&#123;<span class="number">1</span>+<span class="number">1</span> &#125;</span><br><span class="line">$&#123;(<span class="number">1</span>+<span class="number">2</span>)*<span class="number">3</span>-<span class="number">4</span>+<span class="number">5</span>*<span class="number">3</span> &#125;</span><br><span class="line">$&#123;u.age * <span class="number">10</span> &#125;</span><br><span class="line">$&#123;<span class="number">1</span>&lt;<span class="number">3</span> &#125;</span><br><span class="line">      </span><br><span class="line">&lt;%</span><br><span class="line">		String name = <span class="string">&quot;&quot;</span>;</span><br><span class="line">		String name2 = <span class="string">&quot;lucy&quot;</span>;</span><br><span class="line">	%&gt;      </span><br><span class="line"><span class="comment">//ä¸ºç©ºçš„è¯è¿”å›true æ³¨æ„å–ä¸åˆ°è„šæœ¬çš„å€¼ å¯ä»¥å°†nameå­˜åˆ°requestä¸­</span></span><br><span class="line">$&#123;empty <span class="string">&quot;&quot;</span> &#125;</span><br><span class="line">$&#123;empty <span class="string">&quot;hello&quot;</span> &#125;</span><br><span class="line"> åˆ¤æ–­<span class="number">1</span> $&#123;empty <span class="string">&quot;$&#123;name&#125;&quot;</span> &#125;&lt;br&gt;  </span><br><span class="line"><span class="comment">//å–å¦ ä¸ä¸ºç©ºçš„è¯è¿”å›true</span></span><br><span class="line">$&#123;not empty <span class="string">&quot;hello&quot;</span> &#125;</span><br><span class="line">$&#123;! empty <span class="string">&quot;hello&quot;</span> &#125;</span><br><span class="line">$&#123;param.score &gt;<span class="number">50</span> &#125;</span><br><span class="line">    </span><br><span class="line">$&#123;param.score &gt;<span class="number">60</span>?<span class="string">&quot;good&quot;</span>:<span class="string">&quot;bad&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;%</span><br><span class="line">		request.setAttribute(<span class="string">&quot;s&quot;</span>, <span class="keyword">new</span> Student(<span class="number">1</span>,<span class="string">&quot;lucy&quot;</span>));</span><br><span class="line">	%&gt;</span><br><span class="line">	$&#123;<span class="number">1</span>&lt;<span class="number">3</span> &#125; &lt;br&gt;</span><br><span class="line">	$&#123;empty <span class="number">1</span> &#125;&lt;br&gt;</span><br><span class="line">	$&#123;empty <span class="string">&quot;&quot;</span> &#125;&lt;br&gt;</span><br><span class="line">	$&#123;<span class="number">5</span>&lt;<span class="number">6</span>? <span class="number">5</span>:<span class="number">6</span> &#125;&lt;br&gt;</span><br><span class="line">	$&#123; empty requestScope.s? <span class="string">&quot;ç™»å½•&quot;</span>:requestScope.s.name&#125;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œè¾“å‡ºæ•°ç»„ã€é›†åˆä¸­çš„å…ƒç´ </p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">String[] str = &#123;<span class="string">&quot;hello&quot;</span>,<span class="string">&quot;world&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">list.add(<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;lisi&quot;</span>);</span><br><span class="line"></span><br><span class="line">Map&lt;String,Integer&gt; map = <span class="keyword">new</span> HashMap&lt;String,Integer&gt;();</span><br><span class="line">map.put(<span class="string">&quot;a&quot;</span>,<span class="number">100</span>);</span><br><span class="line">map.put(<span class="string">&quot;b&quot;</span>,<span class="number">200</span>);</span><br><span class="line">map.put(<span class="string">&quot;c&quot;</span>,<span class="number">300</span>);</span><br><span class="line"></span><br><span class="line">request.setAttribute(<span class="string">&quot;str&quot;</span>,str);</span><br><span class="line">request.setAttribute(<span class="string">&quot;list&quot;</span>,list);</span><br><span class="line">request.setAttribute(<span class="string">&quot;map&quot;</span>,map);</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">$&#123;str[<span class="number">0</span>] &#125;&lt;br&gt;</span><br><span class="line">$&#123;list[<span class="number">1</span>] &#125;&lt;br&gt;</span><br><span class="line">$&#123;map[<span class="string">&quot;c&quot;</span>] &#125;&lt;br&gt;</span><br></pre></td></tr></table></figure>



<p>éå†é›†åˆ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;!-- éå†é›†åˆ æ”¾å…¥è¡¨æ ¼ä¸­--&gt;</span><br><span class="line">	&lt;table border=<span class="string">&quot;1px&quot;</span> cellpadding=<span class="string">&quot;0px&quot;</span> cellspacing=<span class="string">&quot;0px&quot;</span>&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;name&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;%	</span><br><span class="line">			List&lt;String&gt; l = (List&lt;String&gt;)request.getAttribute(<span class="string">&quot;list&quot;</span>);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; l.size(); i++ )&#123;</span><br><span class="line">				String name = l.get(i);</span><br><span class="line">		%&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;&lt;%= name %&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;%</span><br><span class="line">			&#125;</span><br><span class="line">		%&gt;</span><br><span class="line">	&lt;/table&gt;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œkeyçš„å€¼ä¸­å«æœ‰ç‰¹æ®Šç¬¦å·ç‚¹</p>
<p>requestå¯¹è±¡ä¸­æœ‰ä¸€ä¸ªkeyå€¼ä¸º:javax.servlet.forward.request_uri</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">$&#123;requestScope[<span class="string">&#x27;javax.servlet.forward.request_uri&#x27;</span>] &#125;</span><br></pre></td></tr></table></figure>





<h2 id="11-JSTL"><a href="#11-JSTL" class="headerlink" title="11 JSTL"></a>11 JSTL</h2><blockquote>
<p>JSTLï¼ˆJSP Standard Tag Libraryï¼‰ï¼Œjspæ ‡å‡†çš„æ ‡ç­¾åº“ï¼Œå…¶ç›®çš„ä¹Ÿæ˜¯ç®€åŒ–jspä¸­javaä»£ç çš„ç¼–å†™</p>
</blockquote>
<h3 id="11-1-å¼•å…¥"><a href="#11-1-å¼•å…¥" class="headerlink" title="11.1 å¼•å…¥"></a>11.1 å¼•å…¥</h3><p>1ã€å…ˆå°†æ ‡ç­¾åº“å¯¹åº”çš„jarå¯¼å…¥é¡¹ç›®ä¸­</p>
<p>å¦‚æœæ˜¯åŠ¨æ€çš„webé¡¹ç›®ï¼Œç›´æ¥å°†jstl-1.2.jarå¤åˆ¶ç²˜è´´åˆ°libç›®å½•ä¸­å³å¯ã€‚</p>
<p>å¦‚æœæ˜¯mavené¡¹ç›®ï¼Œå¼•å…¥å…¶ä¾èµ–åæ ‡å³å¯ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>2ã€ç„¶åå†éœ€è¦ä½¿ç”¨çš„JSPé¡µé¢ä¸­ï¼Œä½¿ç”¨tablibæŒ‡ä»¤ï¼Œå°†æ ‡ç­¾åº“å¼•å…¥ï¼š</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> prefix=<span class="string">&quot;c&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>



<h3 id="11-2-ä½¿ç”¨"><a href="#11-2-ä½¿ç”¨" class="headerlink" title="11.2 ä½¿ç”¨"></a>11.2 ä½¿ç”¨</h3><blockquote>
<p>æ³¨æ„ï¼ŒJSTLæ ‡ç­¾åº“ä¸€èˆ¬ä¼šç»“åˆç€ELè¡¨è¾¾å¼ä¸€èµ·ä½¿ç”¨</p>
</blockquote>
<p>å¸¸ç”¨çš„å‡ ç§æ ‡ç­¾ä¸ºï¼š</p>
<p><code>&lt;c:forEach&gt;</code>æ ‡ç­¾(éå†ä½¿ç”¨)</p>
<p>è„šæœ¬éå†</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">		<span class="comment">// å‡†å¤‡æ•°æ®</span></span><br><span class="line">		List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line">		list.add(<span class="keyword">new</span> User(<span class="number">1</span>,<span class="string">&quot;lucy&quot;</span>));</span><br><span class="line">		list.add(<span class="keyword">new</span> User(<span class="number">2</span>,<span class="string">&quot;tom&quot;</span>));</span><br><span class="line">		list.add(<span class="keyword">new</span> User(<span class="number">1</span>,<span class="string">&quot;jack&quot;</span>));</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;table&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;id&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;name&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;%</span><br><span class="line">		   <span class="keyword">for</span>(User user : list)&#123;</span><br><span class="line">			 <span class="keyword">int</span> id =  user.getId(); </span><br><span class="line">			 String username = user.getUsername();</span><br><span class="line">		%&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;&lt;%=id%&gt;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;%=username%&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;%  </span><br><span class="line">			&#125;</span><br><span class="line">		%&gt;</span><br><span class="line">	&lt;/table&gt;</span><br></pre></td></tr></table></figure>



<p>æ ‡ç­¾éå†ï¼Œ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    List&lt;Student&gt; list = <span class="keyword">new</span> ArrayList&lt;Student&gt;();</span><br><span class="line">    list.add(<span class="keyword">new</span> Student(<span class="number">1</span>,<span class="string">&quot;tom1&quot;</span>,<span class="number">21</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Student(<span class="number">2</span>,<span class="string">&quot;tom2&quot;</span>,<span class="number">22</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Student(<span class="number">3</span>,<span class="string">&quot;tom3&quot;</span>,<span class="number">23</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Student(<span class="number">4</span>,<span class="string">&quot;tom4&quot;</span>,<span class="number">24</span>));</span><br><span class="line">    session.setAttribute(<span class="string">&quot;list&quot;</span>, list);</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;c:forEach items=<span class="string">&quot;$&#123;list &#125;&quot;</span> <span class="keyword">var</span> =<span class="string">&quot;stu&quot;</span> begin=<span class="string">&quot;0&quot;</span> end =<span class="string">&quot;3&quot;</span> varStatus=<span class="string">&quot;status&quot;</span> step=<span class="string">&quot;1&quot;</span>&gt;  </span><br><span class="line">    $&#123;status.index &#125; : $&#123;stu.id &#125; - $&#123;stu.name &#125; - $&#123;stu.age &#125; &lt;br&gt;  </span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œ</p>
<p><code>varStatus</code>è¡¨ç¤ºå½“å‰å¾ªç¯éå†çš„åºå·</p>
<p><code>begin=&quot;&quot;</code>é»˜è®¤å€¼æ˜¯0  ï¼Œ<code>end=&quot;&quot;</code>é»˜è®¤å€¼æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œ<code>step=&quot;&quot;</code>é»˜è®¤å€¼æ˜¯1ï¼Œä¸€èˆ¬çš„éå†åªè¦å†™varå’Œitemsæ¥ä¸ªå±æ€§å³å¯</p>
<p>ä¾‹å¦‚ï¼Œéå†Listé›†åˆï¼Œå‡è®¾studentsæ˜¯æ”¾è¿›requestå¯¹è±¡ä¸­çš„ä¸€ä¸ªListé›†åˆï¼Œé›†åˆä¸­å­˜æ”¾çš„æ˜¯Studentç±»å‹çš„å¯¹è±¡</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;c:forEach items=<span class="string">&quot;$&#123;students&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;stu&quot;</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;$&#123;stu.id &#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;stu.name &#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;stu.age &#125;&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œéå†Mapé›†åˆï¼Œå‡è®¾æœ‰ä¸€ä¸ªMapç±»å‹çš„é›†åˆï¼Œæ”¾åˆ°äº†requestå¯¹è±¡ä¸­ï¼Œkeyæ˜¯idå€¼ï¼Œvalueæ˜¯Studentå¯¹è±¡</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;c:forEach items=<span class="string">&quot;$&#123;map&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;entry&quot;</span>&gt;</span><br><span class="line">  		$&#123;entry.key &#125;--&gt;$&#123;entry.value.id &#125; &amp;nbsp; $&#123;entry.value.name &#125; &amp;nbsp; $&#123;entry.value.age &#125;&lt;br&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>entryæ˜¯å®šä¹‰çš„ä¸€ä¸ªå˜é‡ï¼Œç”¨åšæ¥æ”¶æ¯æ¬¡éå†åˆ°çš„é›†åˆä¸­çš„ä¸€ç»„é”®å€¼å¯¹,å¯ä»¥é€šè¿‡entry.key å’Œ entry.valueåˆ†åˆ«æ‹¿åˆ°è¿™æ¬¡éå†åˆ°çš„keyå€¼å’Œvalueå€¼</p>
</blockquote>
<p><code>&lt;if&gt;</code>æ ‡ç­¾</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">    &lt;%</span><br><span class="line">        request.setAttribute(<span class="string">&quot;score&quot;</span>,<span class="number">40</span>);</span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;score&gt;85 &#125;&quot;</span>&gt;</span><br><span class="line">        &lt;font color=<span class="string">&quot;red&quot;</span>&gt;ä½ çš„åˆ†æ•°è¶…è¿‡äº†<span class="number">85</span>åˆ†&lt;/font&gt;</span><br><span class="line">    &lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">&lt;!-- æ³¨æ„æ”¾reuqestå³å¯,sessionä¸€ç›´åœ¨ä¼šè¯çº§åˆ« --&gt;</span><br><span class="line">&lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;!empty s&#125;&quot;</span>&gt;</span><br><span class="line">		&lt;font color=<span class="string">&quot;red&quot;</span>&gt;$&#123;s.name &#125;&lt;/font&gt;</span><br><span class="line">	&lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">	&lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;empty s&#125;&quot;</span>&gt;</span><br><span class="line">		&lt;font color=<span class="string">&quot;green&quot;</span>&gt;ç™»å½•&lt;/font&gt;</span><br><span class="line">	&lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;c:choose&gt;</span><br><span class="line">		&lt;c:when test=<span class="string">&quot;$&#123;!empty s&#125;&quot;</span>&gt;</span><br><span class="line">			&lt;font color=<span class="string">&quot;red&quot;</span>&gt;$&#123;s.name &#125;&lt;/font&gt;</span><br><span class="line">		&lt;/c:when&gt;</span><br><span class="line">		&lt;c:otherwise&gt;</span><br><span class="line">			&lt;font color=<span class="string">&quot;green&quot;</span>&gt;ç™»å½•&lt;/font&gt;</span><br><span class="line">		&lt;/c:otherwise&gt;</span><br><span class="line">	&lt;/c:choose&gt;</span><br></pre></td></tr></table></figure>



<p><code>&lt;c:import&gt;</code>æ ‡ç­¾</p>
<p>å’Œ<code>&lt;jsp:include&gt;</code>çš„ä½œç”¨åŸºæœ¬ç›¸åŒï¼Œä½†æ˜¯<code>&lt;c:import&gt;</code>è¿˜å¯ä»¥é€‰æ‹©æŠŠå¼•å…¥çš„å†…å®¹å…ˆä¿å­˜åœ¨ä¸€ä¸ªå˜é‡ä¸­ï¼Œä¹‹åé€šè¿‡ELè¡¨è¾¾å¼å†æ‹¿å‡ºæ¥æ˜¾ç¤º</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;c:<span class="keyword">import</span> <span class="keyword">var</span>=<span class="string">&quot;data&quot;</span> url=<span class="string">&quot;a.jsp&quot;</span> /&gt;</span><br><span class="line"><span class="comment">// ä»€ä¹ˆæ—¶å€™å¯¼å…¥ å°±ä»€ä¹ˆæ—¶å€™ç”¨</span></span><br><span class="line">&lt;div&gt;$&#123;data&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>



<p><code>&lt;c:redirect&gt;</code>æ ‡ç­¾</p>
<p>é‡å®šå‘æ ‡ç­¾</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;c:redirect url=<span class="string">&quot;a.jsp&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>





<h2 id="12-è‡ªå®šä¹‰"><a href="#12-è‡ªå®šä¹‰" class="headerlink" title="12 è‡ªå®šä¹‰"></a>12 è‡ªå®šä¹‰</h2><blockquote>
<p>é™¤äº†ä½¿ç”¨ç°æœ‰çš„æ ‡ç­¾åº“ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰çš„è‡ªå·±çš„æ ‡ç­¾åº“ã€‚ï¼ˆä½œä¸ºæ‰©å±•äº†è§£çš„å†…å®¹å³å¯ï¼‰</p>
</blockquote>
<p>JSP1.1ç‰ˆæœ¬ä¸­å¢åŠ äº†è‡ªå®šä¹‰æ ‡ç­¾åº“è§„èŒƒï¼Œä½†æ˜¯åœ¨ JSP1.1è§„èŒƒä¸­å¼€å‘è‡ªå®šä¹‰æ ‡ç­¾åº“æ¯”è¾ƒå¤æ‚ï¼ŒJSP2.0 åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ç®€åŒ–äº†æ ‡ç­¾åº“çš„å¼€å‘ï¼Œåªéœ€å¦‚ä¸‹å‡ ä¸ªæ­¥éª¤</p>
<ul>
<li><p>ç¼–å†™è‡ªå®šä¹‰æ ‡ç­¾å¤„ç†ç±»</p>
</li>
<li><p>å»ºç«‹ä¸€ä¸ª *.tld æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ”¾åœ¨WEB-INFä¸‹å³å¯</p>
<p>æ¯ä¸ª *.tld æ–‡ä»¶å¯¹åº”ä¸€ä¸ªæ ‡ç­¾åº“ï¼Œæ¯ä¸ªæ ‡ç­¾åº“å¯ä»¥å¯¹åº”å¤šä¸ªæ ‡ç­¾</p>
</li>
<li><p>åœ¨jspæ–‡ä»¶ä¸­ä½¿ç”¨tablibæŒ‡ä»¤å¼•å…¥å¹¶ä½¿ç”¨è‡ªå®šä¹‰æ ‡ç­¾</p>
</li>
<li><p>jspé¡µé¢ä¸­ä½¿ç”¨è¯¥æ ‡ç­¾åº“</p>
</li>
</ul>
<p><strong>ä¾‹å¦‚1</strong>ï¼Œç¼–å†™ä¸€ä¸ªæ ‡ç­¾ï¼Œå¯ä»¥è‡ªåŠ¨è¾“å‡ºhello</p>
<p>ç¬¬ä¸€æ­¥ï¼Œç»§æ‰¿SimpleTagSupportï¼Œé‡å†™doTagå³å¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloTag</span> <span class="keyword">extends</span> <span class="title">SimpleTagSupport</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doTag</span><span class="params">()</span> <span class="keyword">throws</span> JspException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.getJspContext().getOut().println(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ç¬¬äºŒæ­¥ï¼Œç¼–å†™my-tag.tldæ–‡ä»¶(åå­—éšæ„)ï¼Œå­˜æ”¾åœ¨WEB-INFä¸‹</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">taglib</span></span></span><br><span class="line"><span class="meta">   <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//Sun Microsystems, Inc.//DTD JSP Tag Library 1.2//EN&quot;</span></span></span><br><span class="line"><span class="meta">   <span class="meta-string">&quot;http://java.sun.com/j2ee/dtd/web-jsptaglibrary_1_2.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">taglib</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tlib-version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">tlib-version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jsp-version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">jsp-version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">short-name</span>&gt;</span>my-taglib<span class="tag">&lt;/<span class="name">short-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uri</span>&gt;</span>briup-taglib<span class="tag">&lt;/<span class="name">uri</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tag</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tag-class</span>&gt;</span>com.briup.test.HelloTag<span class="tag">&lt;/<span class="name">tag-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">body-content</span>&gt;</span>empty<span class="tag">&lt;/<span class="name">body-content</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tag</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">taglib</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„1ï¼Œè¯¥æ–‡ä»¶çš„æ ·ä¾‹å¯ä»¥åœ¨tomcatä¸­çš„å®ä¾‹é¡¹ç›®ä¸­å¤åˆ¶å‡ºæ¥ä¿®æ”¹</p>
<p>ä¾‹å¦‚ï¼Œtomcat\webapps\examples\WEB-INF\jsp\example-taglib.tldæ–‡ä»¶</p>
<p>æ³¨æ„2ï¼Œ<code>&lt;body-content&gt;</code>æ ‡ç­¾ä¸­çš„å€¼ï¼Œè¡¨ç¤ºè‡ªå®šä¹‰æ ‡ç­¾ä¸­bodyéƒ¨åˆ†å¯ä»¥å¡«å†™çš„å†…å®¹ç±»å‹ï¼Œæœ‰å››ç§ï¼š</p>
<ul>
<li>emptyï¼Œç©ºæ ‡è®°ï¼Œå³èµ·å§‹æ ‡è®°å’Œç»“æŸæ ‡è®°ä¹‹é—´æ²¡æœ‰å†…å®¹</li>
<li>scriptlessï¼Œå¯ä»¥æ¥æ”¶æ–‡æœ¬ã€ELå’ŒJSPåŠ¨ä½œ</li>
<li>JSPï¼Œï¼ˆSimpleTagSupportç±»å‹ä¸æ”¯æŒï¼‰ï¼Œæ¥å—æ‰€æœ‰JSPè¯­æ³•ï¼Œå¦‚å®šåˆ¶çš„æˆ–å†…éƒ¨çš„tagã€scriptsã€é™æ€HTMLã€è„šæœ¬å…ƒç´ ã€JSPæŒ‡ä»¤å’ŒåŠ¨ä½œ</li>
<li>tagdependentï¼Œæ ‡ç­¾ä½“å†…å®¹ç›´æ¥è¢«å†™å…¥BodyContentï¼Œç”±è‡ªå®šä¹‰æ ‡ç­¾ç±»æ¥è¿›è¡Œå¤„ç†ï¼Œè€Œä¸è¢«JSPå®¹å™¨è§£é‡Š</li>
</ul>
<p>ç¬¬ä¸‰æ­¥ï¼Œjspé¡µé¢ä¸­å¼•å…¥å¹¶ä½¿ç”¨æ ‡ç­¾åº“</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">&quot;briup-taglib&quot;</span> prefix=<span class="string">&quot;briup&quot;</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">        &lt;title&gt;hello.jsp&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;briup:hello&gt;&lt;/briup:hello&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>



<p><strong>ä¾‹å¦‚2</strong>ï¼Œç¼–å†™ä¸€ä¸ªæ ‡ç­¾ï¼Œå¯ä»¥è‡ªåŠ¨è¾“å‡ºhelloï¼Œå¹¶é™„å¸¦ä¸Šæ ‡ç­¾ä½“ä¸­çš„å†…å®¹</p>
<p>ç¬¬ä¸€æ­¥ï¼Œä¿®æ”¹HelloTagç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloTag</span> <span class="keyword">extends</span> <span class="title">SimpleTagSupport</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doTag</span><span class="params">()</span> <span class="keyword">throws</span> JspException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//å‡†å¤‡å¥½ä¸€ä¸ªStringWriterï¼Œæ¥æ”¶æ ‡ç­¾ä½“å†…å®¹</span></span><br><span class="line">        StringWriter sw = <span class="keyword">new</span> StringWriter();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æŠŠæ ‡ç­¾ä½“å†…å®¹å†™åˆ°StringWriterä¸­</span></span><br><span class="line">        <span class="keyword">super</span>.getJspBody().invoke(sw);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä»StringWriterä¸­è·å–æ ‡ç­¾ä½“çš„å†…å®¹</span></span><br><span class="line">        String tagBody = sw.toString();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">super</span>.getJspContext().getOut().println(<span class="string">&quot;hello! &quot;</span>+tagBody);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ç¬¬äºŒæ­¥ï¼Œä¿®æ”¹my-tag.tldæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tag</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tag-class</span>&gt;</span>com.briup.test.HelloTag<span class="tag">&lt;/<span class="name">tag-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body-content</span>&gt;</span>scriptless<span class="tag">&lt;/<span class="name">body-content</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tag</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¿™é‡Œåªæ˜¯ä¿®æ”¹äº†<code>&lt;body-content&gt;</code>æ ‡ç­¾ä¸­çš„å€¼ï¼Œæ”¹ä¸ºscriptlessæˆ–è€…tagdependentéƒ½æ˜¯å¯ä»¥çš„.å…¶ä»–åœ°æ–¹ä¸ç”¨ä¿®æ”¹</p>
<p>ç¬¬ä¸‰æ­¥ï¼Œä¿®æ”¹jspæ–‡ä»¶ï¼Œæ·»åŠ æ ‡ç­¾bodyå†…å®¹å³å¯</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;briup:hello&gt;tom&lt;/briup:hello&gt;</span><br></pre></td></tr></table></figure>





<p><strong>ä¾‹å¦‚3</strong>ï¼Œç¼–å†™ä¸€ä¸ªæ ‡ç­¾ï¼Œå¯ä»¥è‡ªåŠ¨è¾“å‡ºhelloï¼Œå¹¶é™„å¸¦ä¸Šæ ‡ç­¾ä½“ä¸­çš„å†…å®¹ï¼Œå¹¶ä¸”æ ¹æ®æ ‡ç­¾ä¸­å±æ€§çš„å€¼ï¼Œæ¥ç¡®å®šå†…å®¹å°†ä¼šè¾“å‡ºå¤šå°‘æ¬¡</p>
<p>ç¬¬ä¸€æ­¥ï¼Œä¿®æ”¹HelloTagç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloTag</span> <span class="keyword">extends</span> <span class="title">SimpleTagSupport</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doTag</span><span class="params">()</span> <span class="keyword">throws</span> JspException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//å‡†å¤‡å¥½ä¸€ä¸ªStringWriterï¼Œæ¥æ”¶æ ‡ç­¾ä½“å†…å®¹</span></span><br><span class="line">        StringWriter sw = <span class="keyword">new</span> StringWriter();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æŠŠæ ‡ç­¾ä½“å†…å®¹å†™åˆ°StringWriterä¸­</span></span><br><span class="line">        <span class="keyword">super</span>.getJspBody().invoke(sw);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä»StringWriterä¸­è·å–æ ‡ç­¾ä½“çš„å†…å®¹</span></span><br><span class="line">        String tagBody = sw.toString();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;count;i++) &#123;</span><br><span class="line">            <span class="keyword">super</span>.getJspContext().getOut().println(<span class="string">&quot;hello! &quot;</span>+tagBody+<span class="string">&quot;&lt;br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCount</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.count = count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹åœ°æ–¹1ï¼Œæ·»åŠ å±æ€§countï¼Œæä¾›get/setæ–¹æ³•ï¼Œç”¨æ¥æ¥æ”¶æ ‡ç­¾ä¸­å±æ€§çš„countå±æ€§çš„å€¼<br>ä¿®æ”¹åœ°æ–¹2ï¼Œè¾“å‡ºå†…å®¹è¯­å¥å¤–é¢åµŒå¥—å¾ªç¯ï¼Œå¾ªç¯æ¬¡æ•°ç”±countçš„å€¼æ¥æ§åˆ¶</p>
<p>ç¬¬äºŒæ­¥ï¼Œä¿®æ”¹my-tag.tldæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tag</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tag-class</span>&gt;</span>com.briup.test.HelloTag<span class="tag">&lt;/<span class="name">tag-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body-content</span>&gt;</span>scriptless<span class="tag">&lt;/<span class="name">body-content</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>count<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">required</span>&gt;</span>true<span class="tag">&lt;/<span class="name">required</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tag</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹åœ°æ–¹ï¼Œæ·»åŠ attributeæ ‡ç­¾æ¥æŒ‡å®šå±æ€§çš„ç›¸å…³ä¿¡æ¯</p>
<p>ç¬¬ä¸‰æ­¥ï¼Œä¿®æ”¹jspæ–‡ä»¶ï¼Œæ·»åŠ æ ‡ç­¾çš„å±æ€§</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;briup:hello count=<span class="string">&quot;5&quot;</span>&gt;tom&lt;/briup:hello&gt;</span><br></pre></td></tr></table></figure>



<p><strong>ä¾‹å¦‚4</strong>ï¼Œç¼–å†™ä¸€ä¸ªæ ‡ç­¾ï¼Œå¯ä»¥è‡ªåŠ¨è¾“å‡ºhelloï¼Œå¹¶é™„å¸¦ä¸Šæ ‡ç­¾ä½“ä¸­çš„å†…å®¹ï¼Œå¹¶ä¸”æ ¹æ®æ ‡ç­¾ä¸­å±æ€§çš„å€¼ï¼Œæ¥ç¡®å®šå†…å®¹å°†ä¼šè¾“å‡ºå¤šå°‘æ¬¡ï¼ŒåŒæ—¶æ ‡ç­¾ä½“å€¼å’Œå±æ€§çš„å€¼éƒ½æ˜¯è¦ELè¡¨è¾¾å¼æ¥è¡¨ç¤º</p>
<p>ç¬¬ä¸€æ­¥ï¼ŒHelloTagç±»ï¼Œå’Œä¾‹3ä¿æŒä¸€è‡´ï¼Œä¸éœ€è¦æ”¹åŠ¨</p>
<p>ç¬¬äºŒæ­¥ï¼Œä¿®æ”¹my-tag.tldæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tag</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tag-class</span>&gt;</span>com.briup.test.HelloTag<span class="tag">&lt;/<span class="name">tag-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body-content</span>&gt;</span>scriptless<span class="tag">&lt;/<span class="name">body-content</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>count<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">required</span>&gt;</span>true<span class="tag">&lt;/<span class="name">required</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rtexprvalue</span>&gt;</span>true<span class="tag">&lt;/<span class="name">rtexprvalue</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tag</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹åœ°æ–¹ï¼Œæ·»åŠ æ ‡ç­¾<code>&lt;rtexprvalue&gt;</code>ï¼Œè¡¨ç¤ºæ”¯æŒEL</p>
<p>æ³¨æ„ï¼Œrtexprvalueçš„æ„æ€æ˜¯ï¼šRuntime Expression Value</p>
<p>ç¬¬ä¸‰æ­¥ï¼Œä¿®æ”¹jspæ–‡ä»¶ï¼Œæ·»åŠ æ ‡ç­¾çš„å±æ€§</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    request.setAttribute(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;zs&quot;</span>);</span><br><span class="line">    request.setAttribute(<span class="string">&quot;count&quot;</span>, <span class="string">&quot;10&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;briup:hello count=<span class="string">&quot;$&#123;count &#125;&quot;</span>&gt;$&#123;name &#125;&lt;/briup:hello&gt;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹åœ°æ–¹ï¼Œæ·»åŠ äº†jspè„šæœ¬ï¼Œé…åˆæµ‹è¯•ï¼ŒåŒæ—¶æ ‡ç­¾ä¸­æ˜¯ä½¿ç”¨äº†ELè¡¨è¾¾å¼</p>
]]></content>
      <tags>
        <tag>briup</tag>
      </tags>
  </entry>
  <entry>
    <title>briup-springmvc</title>
    <url>/archives/briup/briup-springmvc.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script>]]></content>
  </entry>
  <entry>
    <title>briup-spring</title>
    <url>/archives/briup/briup-spring.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script>]]></content>
  </entry>
  <entry>
    <title>briup-ajax</title>
    <url>/archives/briup/briup-ajax.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="ajax-jquery"><a href="#ajax-jquery" class="headerlink" title="ajax-jquery"></a>ajax-jquery</h1><h2 id="1-åŒæ­¥è¯·æ±‚"><a href="#1-åŒæ­¥è¯·æ±‚" class="headerlink" title="1 åŒæ­¥è¯·æ±‚"></a>1 åŒæ­¥è¯·æ±‚</h2><p>ä¼ ç»Ÿçš„åº”ç”¨ä¸­ï¼Œæµè§ˆå™¨å‘å‡ºçš„è¯·æ±‚ï¼Œä¸€èˆ¬éƒ½æ˜¯åŒæ­¥è¯·æ±‚ï¼Œæµè§ˆå™¨éœ€è¦ç­‰å¾…è¿™ä¸ªè¯·æ±‚å‘å‡ºä¹‹åï¼ŒæœåŠ¡å™¨ç«¯çš„å“åº”ï¼Œæµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åï¼Œè§£ææœ¬æ¬¡å†…å®¹ï¼Œå†æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>å¦‚æœæœåŠ¡å™¨å“åº”æ—¶é—´è¿‡é•¿ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªæœŸé—´ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨åªèƒ½ç­‰å¾…ç€ã€‚</p>
<p>å¹¶ä¸”å“åº”å›æ¥åï¼Œéœ€è¦é‡æ–°åˆ·æ–°å’ŒåŠ è½½æ•´ä¸ªé¡µé¢ã€‚</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/test?username=tom&quot;</span>&gt;</span>åŒæ­¥è¯·æ±‚æµ‹è¯•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;d1&quot;</span>&gt;</span>$&#123;msg &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.web.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		String username = req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Thread.sleep(<span class="number">1000</span>*<span class="number">10</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		req.setAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;hello!&quot;</span>+username);</span><br><span class="line">		String path = <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">		req.getRequestDispatcher(path).forward(req, resp);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>æ³¨æ„ï¼Œtomcatä¸­é»˜è®¤è¯·æ±‚çš„è¶…æ—¶æ—¶é—´æ˜¯20ç§’ï¼Œ<code>connectionTimeout=&quot;20000&quot;</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">URIEncoding</span>=<span class="string">&quot;UTF-8&quot;</span> <span class="attr">connectionTimeout</span>=<span class="string">&quot;20000&quot;</span> <span class="attr">port</span>=<span class="string">&quot;8989&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;HTTP/1.1&quot;</span> <span class="attr">redirectPort</span>=<span class="string">&quot;8443&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨å“åº”å›æ¥ä¹‹å‰ï¼Œå®¢æˆ·ç«¯åªèƒ½ç­‰å¾…ç€ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹æ˜¯æ¯”è¾ƒå½±å“ç”¨æˆ·ä½“éªŒçš„</p>
</blockquote>
<blockquote>
<p>è§‚å¯ŸåŒæ­¥è¯·æ±‚è¿”å›çš„å“åº”å†…å®¹ï¼Œå¯ä»¥çœ‹å‡ºï¼Œè¯¥å“åº”æŠŠæ•´ä¸ªé¡µé¢çš„å†…å®¹åˆå‘é€äº†å›æ¥</p>
</blockquote>
<p>==åŒæ­¥è¯·æ±‚å­˜åœ¨çš„é—®é¢˜==</p>
<ul>
<li>ç½‘é€Ÿæ…¢çš„æƒ…å†µä¸‹ï¼Œé¡µé¢åŠ è½½æ—¶é—´é•¿ï¼Œç”¨æˆ·åªèƒ½ç­‰å¾…</li>
<li>è¡¨å•æäº¤åï¼Œå¦‚æœä¸€é¡¹å†…å®¹ä¸åˆæ ¼ï¼Œéœ€è¦é‡æ–°å¡«å†™æ‰€æœ‰è¡¨å•å†…å®¹</li>
<li>é¡µé¢è·³è½¬ï¼Œé‡æ–°åŠ è½½é¡µé¢ï¼Œé€ æˆèµ„æºæµªè´¹ï¼Œå¢åŠ ç”¨æˆ·ç­‰å¾…æ—¶é—´</li>
</ul>
<h2 id="2-å¼‚æ­¥è¯·æ±‚"><a href="#2-å¼‚æ­¥è¯·æ±‚" class="headerlink" title="2 å¼‚æ­¥è¯·æ±‚"></a>2 å¼‚æ­¥è¯·æ±‚</h2><blockquote>
<p>å¼‚æ­¥è¯·æ±‚ï¼Œå¯ä»¥è§£å†³ä¸Šè¿°åŒæ­¥è¯·æ±‚ä¸­ï¼Œæ‰€é‡åˆ°çš„é—®é¢˜</p>
</blockquote>
<p>AJAXï¼ˆAsynchronous JavaScript And XMLï¼‰ï¼Œå¼‚æ­¥çš„ JavaScript å’Œ XMLã€‚</p>
<p>å®ƒä¸æ˜¯ä¸€é—¨æ–°çš„æŠ€æœ¯æˆ–è€…è¯­è¨€ï¼Œå®ƒæ˜¯æŠŠå·²ç»æœ‰çš„å‡ ç§æŠ€æœ¯ï¼Œç»“åˆåœ¨ä¸€èµ·ï¼Œå‡ºç°çš„ä¸€ç§æ–°çš„ç”¨æ³•ï¼Œè‡³å°‘åœ¨å½“æ—¶åˆšå‡ºç°çš„æ—¶å€™æ˜¯ä¸€ç§æ–°çš„ç”¨æ³•ï¼Œä½†æ˜¯ç°åœ¨ajaxçš„åº”ç”¨å·²ç»ç›¸å½“æˆç†Ÿäº†ã€‚</p>
<p>åŒæ­¥è¯·æ±‚æ˜¯è¯·æ±‚å‘é€åï¼Œç­‰å¾…æœåŠ¡å™¨å“åº”å›æ¥ï¼Œå“åº”ä¸­å¸¦ç€å½“å‰è¦æ˜¾ç¤ºçš„æ–°çš„é¡µé¢å†…å®¹ï¼ˆå®Œæ•´é¡µé¢å†…å®¹ï¼‰ï¼Œç„¶åæµè§ˆå™¨æ¥æ”¶å“åº”ï¼Œå¹¶ä¸”åŠ è½½åˆ·æ–°æ•´ä¸ªé¡µé¢ï¼Œæœ€åæ˜¾ç¤ºå‡ºä¸€ä¸ªæ–°çš„é¡µé¢ã€‚</p>
<p>ajaxå‘å‡ºçš„å¼‚æ­¥è¯·æ±‚ï¼Œä¸éœ€è¦ç­‰å¾…æœåŠ¡å™¨çš„å“åº”ï¼Œé¡µé¢ä¸­å¯ä»¥ç»§ç»­å®Œæˆå…¶ä»–å·¥ä½œï¼Œç­‰å“åº”å›æ¥åï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ajaxä¸­è®¾ç½®å¥½çš„å‡½æ•°ï¼ˆå›è°ƒå‡½æ•°ï¼‰ï¼Œå‡½æ•°ä¸­æ¥æ”¶å“åº”ä¸­çš„æ•°æ®ï¼ˆå°‘é‡æ•°æ®ï¼‰ï¼Œå¹¶æŠŠæ•°æ®æ›´æ–°åˆ°é¡µé¢ä¸­ï¼ˆå±€éƒ¨åˆ·æ–°ï¼‰ã€‚</p>
<p>åœ¨æ•´ä¸ªå¼‚æ­¥è¯·æ±‚çš„è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·æ„Ÿå—ä¸åˆ°è¯·æ±‚çš„å‘é€ï¼Œå¹¶ä¸”æ•´ä¸ªé¡µé¢ä¸­ä¹Ÿåªæœ‰å±€éƒ¨åœ°æ–¹çš„æ•°æ®æœ‰åˆ·æ–°ï¼Œå…¶ä»–å†…å®¹ä¸å˜ï¼Œç”¨æˆ·çš„ä½“éªŒè¾ƒå¥½ã€‚</p>
<p>å¼‚æ­¥è¯·æ±‚çš„ç‰¹ç‚¹ï¼šï¼ˆå…«ä¸ªå­—ï¼‰</p>
<ul>
<li>å¼‚æ­¥äº¤äº’</li>
<li>å±€éƒ¨åˆ·æ–°</li>
</ul>
<p>ä¾‹å¦‚ï¼Œä¸€ä¸ªå…¸å‹çš„åœºæ™¯ï¼Œç”¨æˆ·æ³¨å†Œ</p>
<p>å¦‚æœæ˜¯åŒæ­¥è¯·æ±‚ï¼Œéœ€è¦ç”¨æˆ·å¡«å†™å®Œè¡¨å•ä¸­çš„æ‰€æœ‰é€‰é¡¹ï¼Œç„¶åç‚¹å‡»æ³¨å†Œï¼Œå°†æ•°æ®å‘é€ç»™æœåŠ¡å™¨ï¼Œç„¶åå®¢æˆ·ç«¯ç­‰å¾…æœåŠ¡å™¨ç«¯çš„å“åº”ï¼Œå¦‚æœè¿™æ¬¡å“åº”å›æ¥ï¼Œæç¤ºç”¨æˆ·åå·²ç»è¢«å ç”¨ï¼Œéœ€è¦æ¢ä¸ªåå­—é‡æ–°æ³¨å†Œï¼Œæ­¤æ—¶å¯ä»¥æƒ³è±¡ç”¨æˆ·çš„å†…å¿ƒæ„Ÿå—ã€‚ã€‚ã€‚</p>
<p>å¦‚æœæ˜¯å¼‚æ­¥è¯·æ±‚ï¼Œå½“ç”¨æˆ·å¡«å†™å®Œç¬¬ä¸€é¡¹ç”¨æˆ·åçš„æ—¶å€™ï¼Œå°±å¯ä»¥â€œå·å·â€çš„å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œå°†ç”¨æˆ·åå‘é€ç»™æœåŠ¡å™¨ç«¯éªŒè¯ï¼Œçœ‹æ˜¯å¦å¯ç”¨ï¼Œå¦‚æœå¯ç”¨è¾“å…¥æ¡†åé¢å¯ä»¥æç¤ºå‡ºâ€œè¯¥ç”¨æˆ·åå¯ç”¨â€ï¼Œå¦‚æœä¸å¯ç”¨ï¼Œè¾“å…¥æ¡†åæç¤ºâ€œè¯¥ç”¨æˆ·åä¸å¯ç”¨â€ï¼Œæ­¤æ—¶å°±å¯ä»¥å¤§å¤§æé«˜ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒã€‚</p>
<p>==æ€è€ƒï¼Œè¿˜æœ‰å“ªäº›å¸¸è§çš„åœºæ™¯ä¸­ï¼Œä¼šâ€œå·å·â€çš„å‘å‡ºå¼‚æ­¥è¯·æ±‚ï¼Ÿ==</p>
<h2 id="3-XMLHttpRequest"><a href="#3-XMLHttpRequest" class="headerlink" title="3 XMLHttpRequest"></a>3 XMLHttpRequest</h2><p>èƒ½å¤Ÿå®Œæˆå¼‚æ­¥è¯·æ±‚çš„å‘é€ï¼Œå®Œå…¨ä¾èµ–äºä¸€ä¸ªæ ¸å¿ƒçš„å¯¹è±¡ï¼š<code>XMLHttpRequest</code></p>
<p>XMLHttpRequestæœ€æ—©åœ¨IE5ä¸­ä»¥ActiveXå¯¹è±¡çš„å½¢å¼å®ç°çš„ã€‚ç°åœ¨ï¼ŒFireFoxã€Safariã€Operaã€Konquerorå’ŒIEéƒ½å®ç°äº†XMLHttpRequestå¯¹è±¡çš„è¡Œä¸ºã€‚</p>
<p>XMLHttpRequestä¸æ˜¯ä¸€ä¸ªW3Cçš„æ ‡å‡†ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨å¤šç§æ–¹æ³•æ¥åˆ›å»ºXMLHttpRequestçš„å¯¹è±¡ï¼ŒIEæŠŠXMLHttpRequestå®ç°ä¸ºä¸€ä¸ªActiveXçš„å¯¹è±¡ï¼Œè€Œå…¶å®ƒæµè§ˆå™¨å°†å®ƒå®ç°ä¸ºä¸€ä¸ªæœ¬åœ°çš„JavaScriptå¯¹è±¡ã€‚</p>
<p>å¦‚æœæµè§ˆå™¨æ”¯æŒActiveXå¯¹è±¡ï¼Œå°±å¯ä»¥ä½¿ç”¨ActiveXæ¥åˆ›å»ºXMLHttpRequestå¯¹è±¡ï¼Œå¦åˆ™å°±è¦ä½¿ç”¨æœ¬åœ°JavaScriptå¯¹è±¡æŠ€æœ¯æ¥åˆ›å»ºè¯¥å¯¹è±¡ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåˆ›å»ºXMLHttpRequestå¯¹è±¡</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">	</span></span><br><span class="line"><span class="javascript">	<span class="keyword">var</span> xmlHttp;</span></span><br><span class="line"><span class="javascript">    </span></span><br><span class="line"><span class="javascript">    <span class="comment">//åˆ›å»ºXMLHttpRequestå¯¹è±¡</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//æœ¬åœ°æµè§ˆå™¨æ˜¯å¦æ”¯æŒActiveXå¯¹è±¡ï¼Œè¿”å›å¯¹è±¡ä¸ºtrueï¼Œè¿”å›nullä¸ºfalse</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span>(<span class="built_in">window</span>.ActiveXObject)&#123; </span></span><br><span class="line"><span class="javascript">        xmlHttp = <span class="keyword">new</span> ActiveXObject(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="comment">//æœ¬åœ°æµè§ˆå™¨æ˜¯å¦æ”¯æŒXMLHttpRequestå¯¹è±¡</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">//ä½œä¸ºä¸€ä¸ªJavaScriptå¯¹è±¡æ¥åˆ›å»º</span></span></span><br><span class="line"><span class="javascript">        xmlHttp = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript">	</span></span><br><span class="line"><span class="javascript">	</span></span><br><span class="line"><span class="javascript">	alert(xmlHttp);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="4-ä½¿ç”¨ajax"><a href="#4-ä½¿ç”¨ajax" class="headerlink" title="4 ä½¿ç”¨ajax"></a>4 ä½¿ç”¨ajax</h2><p>JavaScriptä¸­ï¼Œæœ‰äº†XMLHttpRequestå¯¹è±¡åï¼Œå°±å¯ä»¥å‘é€å¼‚æ­¥è¯·æ±‚äº†ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">	<span class="function"><span class="keyword">function</span> <span class="title">createXMLHttpRequest</span>(<span class="params">xmlHttp</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">if</span>(<span class="built_in">window</span>.ActiveXObject)&#123; </span></span><br><span class="line"><span class="javascript">			xmlHttp = <span class="keyword">new</span> ActiveXObject(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>);</span></span><br><span class="line"><span class="javascript">			</span></span><br><span class="line"><span class="javascript">		&#125;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</span></span><br><span class="line"><span class="javascript">			xmlHttp = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">		&#125;</span></span><br><span class="line"><span class="javascript">	&#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">	<span class="function"><span class="keyword">function</span> <span class="title">ajaxRequest</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> xmlHttp;</span></span><br><span class="line"><span class="javascript">		</span></span><br><span class="line"><span class="javascript">		<span class="comment">//1 åˆ›å»ºæ ¸å¿ƒå¯¹è±¡</span></span></span><br><span class="line"><span class="javascript">		<span class="keyword">if</span>(<span class="built_in">window</span>.ActiveXObject)&#123; </span></span><br><span class="line"><span class="javascript">			xmlHttp = <span class="keyword">new</span> ActiveXObject(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>);</span></span><br><span class="line"><span class="javascript">		&#125;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</span></span><br><span class="line"><span class="javascript">			xmlHttp = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">		&#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">		<span class="comment">//2 å»ºç«‹è¿æ¥</span></span></span><br><span class="line"><span class="javascript">		<span class="comment">//å‚æ•°1 è¯·æ±‚æ–¹å¼</span></span></span><br><span class="line"><span class="javascript">		<span class="comment">//å‚æ•°2 è¯·æ±‚çš„URL</span></span></span><br><span class="line"><span class="javascript">		<span class="comment">//å‚æ•°3 æ˜¯å¦æ˜¯å¼‚æ­¥è¯·æ±‚</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// æ³¨æ„:å‚æ•°ä¸èƒ½ä¸ºç©º,åå°åœ¨write(username)</span></span></span><br><span class="line"><span class="javascript">		xmlHttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/ajax-test?username=mary&quot;</span>,<span class="literal">true</span>);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">		<span class="comment">//3 å‘é€è¯·æ±‚</span></span></span><br><span class="line"><span class="javascript">		xmlHttp.send();</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">		<span class="comment">//4 æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œæ¥å—å¹¶å¤„ç†æ¥è‡ªæœåŠ¡å™¨çš„å“åº”ç»“æœ</span></span></span><br><span class="line"><span class="javascript">		xmlHttp.onreadystatechange=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">			<span class="comment">//åˆ¤æ–­readyStateå°±ç»ªçŠ¶æ€æ˜¯å¦ä¸º4</span></span></span><br><span class="line"><span class="javascript">			<span class="comment">//åˆ¤æ–­statuså“åº”çŠ¶æ€ç æ˜¯å¦ä¸º200</span></span></span><br><span class="line"><span class="javascript">	        <span class="keyword">if</span> (xmlHttp.readyState==<span class="number">4</span> &amp;&amp; xmlHttp.status==<span class="number">200</span>)&#123;</span></span><br><span class="line"><span class="javascript">	           <span class="comment">//è·å–æœåŠ¡å™¨çš„å“åº”ç»“æœ</span></span></span><br><span class="line"><span class="javascript">	            <span class="keyword">var</span> responseText = xmlHttp.responseText;</span></span><br><span class="line"><span class="javascript">	            <span class="comment">//alert(responseText);</span></span></span><br><span class="line"><span class="javascript">	            <span class="keyword">var</span> div = <span class="built_in">document</span>.getElementById(<span class="string">&quot;d2&quot;</span>);</span></span><br><span class="line"><span class="javascript">	            div.innerHTML = responseText;</span></span><br><span class="line"><span class="javascript">	        &#125;</span></span><br><span class="line"><span class="javascript">		&#125;;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">	&#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/test?username=tom&quot;</span>&gt;</span>åŒæ­¥è¯·æ±‚æµ‹è¯•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:void(0);&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;ajaxRequest()&quot;</span>&gt;</span>å¼‚æ­¥è¯·æ±‚æµ‹è¯•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;d1&quot;</span>&gt;</span>$&#123;msg &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;d2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„: æ­¤æ—¶å‚æ•°ä¸èƒ½ä¸ºç©º,åå°åœ¨write</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.web.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/ajax-test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AjaxTestServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		String username = req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Thread.sleep(<span class="number">1000</span>*<span class="number">10</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = resp.getWriter();</span><br><span class="line">		</span><br><span class="line">		out.println(<span class="string">&quot;hello! &quot;</span>+username);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>åŒæ­¥ä¸ºè¯·æ±‚è½¬å‘html,å¼‚æ­¥ä¸ºå†™å›å±€éƒ¨æ•°æ®</code></p>
<blockquote>
<p>è§‚å¯ŸåŒæ­¥è¯·æ±‚è¿”å›çš„å“åº”å†…å®¹ï¼Œå¯ä»¥çœ‹å‡ºè¯¥å“åº”åªæŠŠå°‘é‡çš„æ•°æ®è¿”å›äº†ï¼ˆhello! maryï¼‰,ç„¶åajaxçš„å›è°ƒå‡½æ•°ä¸­æŠŠè¯¥å†…å®¹å±€éƒ¨åˆ·åˆ°äº†é¡µé¢çš„divé‡Œé¢</p>
</blockquote>
<blockquote>
<p>æ„Ÿå—ajaxå‘å¼‚æ­¥è¯·æ±‚çš„ç‰¹ç‚¹ï¼šå¼‚æ­¥äº¤äº’ã€å±€éƒ¨åˆ·æ–°</p>
</blockquote>
<h2 id="5-jquery"><a href="#5-jquery" class="headerlink" title="5 jquery"></a>5 jquery</h2><blockquote>
<p>ä½¿ç”¨ajaxçš„åŸç”Ÿä»£ç ï¼Œå®Œæˆå¼‚æ­¥äº¤äº’è¿˜æ˜¯æ¯”è¾ƒç¹ççš„ï¼Œé€šå¸¸ä¼šä½¿ç”¨ä¸€äº›å¯¹JSå°è£…çš„åº“ä¸­çš„å‡½æ•°å®Œæˆ</p>
</blockquote>
<h3 id="5-1-æ¦‚è¿°"><a href="#5-1-æ¦‚è¿°" class="headerlink" title="5.1 æ¦‚è¿°"></a>5.1 æ¦‚è¿°</h3><p>jqueryæ˜¯å¯¹jså°è£…çš„ä¸€ä¸ªåº“ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªjsæ–‡ä»¶ï¼Œä½¿ç”¨çš„æ—¶å€™ï¼Œåªéœ€è¦å°†jqueryæ–‡ä»¶å¼•å…¥åˆ°å½“å‰é¡µé¢ä¸­å³å¯ã€‚</p>
<p>jqueryçš„ç‰ˆæœ¬ä¼—å¤šï¼Œä¸åŒç‰ˆæœ¬ä¸­çš„å‡½æ•°ç¨æœ‰å·®å¼‚ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯1.8.3ç‰ˆæœ¬ã€‚</p>
<p>1ã€å¯ä»¥å°†jqueryæ–‡ä»¶å­˜æ”¾åˆ°é¡¹ç›®ä¸­ï¼Œç„¶åå†å¼•å…¥åˆ°é¡µé¢ä¸­ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.8.3.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œjqueryå¯ä»¥åœ¨jspé¡µé¢ä¸­ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨htmlé™æ€é¡µé¢ä¸­ä½¿ç”¨ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„</p>
</blockquote>
<p>2ã€å¯ä»¥ä½¿ç”¨ç½‘ç»œä¸­å…¬å¼€çš„è¿æ¥åœ°å€</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/1.8.3/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚ï¼Œä½¿ç”¨ <a href="https://www.bootcdn.cn/">https://www.bootcdn.cn/</a> ä¸­çš„jqueryåœ°å€</p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/ajax/202205221608648.png" alt="image-20201008232743892"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/ajax/202205221608311.png" alt="image-20201008232806009"></p>
<p><img src="image/image-20201008232822183.png" alt="image-20201008232822183"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wangsidandan/blog_images@main/ajax/202205221608972.png" alt="image-20201008232842734"></p>
<blockquote>
<p>ç±»ä¼¼çš„ï¼Œå¦‚æœå°†æ¥è¦ä½¿ç”¨å…¶ä»–çš„jsåº“ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™é‡ŒæŸ¥æ‰¾</p>
</blockquote>
<h3 id="5-2-åŠ è½½"><a href="#5-2-åŠ è½½" class="headerlink" title="5.2 åŠ è½½"></a>5.2 åŠ è½½</h3><blockquote>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéœ€è¦è®©æµè§ˆå™¨å…ˆåŠ è½½å®Œæ•´ä¸ªé¡µé¢çš„htmlå…ƒç´ åï¼Œåœ¨æ‰§è¡Œjsæˆ–jqueryä»£ç ï¼Œå› ä¸ºè¿™æ ·ä»£ç ä¸­æ‰èƒ½æ“ä½œæŒ‡å®šçš„å…ƒç´ </p>
</blockquote>
<p>ç”±äºæµè§ˆå™¨è§£æé¡µé¢ï¼Œæ˜¯ä»ä¸Šå¾€ä¸‹ï¼Œä¾æ¬¡è§£æï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¸Œæœ›çš„æ˜¯ï¼Œå…ˆåŠ è½½å®Œæ‰€æœ‰çš„htmlæ ‡ç­¾å…ƒç´ ï¼Œç„¶åå†æ‰§è¡Œjsä»£ç ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨jsä¸­è·å–å·²ç»åŠ è½½çš„htmlæ ‡ç­¾å…ƒç´ äº†ã€‚</p>
<p>ä¹‹å‰åœ¨jsä»£ç ä¸­ï¼Œå¯ä»¥è¿™æ ·æ¥å®ç°è¯¥æ•ˆæœï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.getElementById(<span class="string">&quot;div&quot;</span>)</span></span><br><span class="line"><span class="javascript">            <span class="comment">//ç»™windowå¯¹è±¡çš„onloadäº‹ä»¶ç»‘å®šä¸€ä¸ªåŒ¿åå‡½æ•°</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// jsä»£ç ï¼Œæ“ä½œé¡µé¢å…ƒç´ </span></span></span><br><span class="line"><span class="javascript">                <span class="built_in">document</span>.getElementById(<span class="string">&quot;div&quot;</span>)</span></span><br><span class="line"><span class="javascript">            &#125;;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        .....</span><br><span class="line">        .....<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div&quot;</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        .....</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯¥jsä»£ç è¡¨ç¤ºï¼Œå½“windowå¯¹è±¡åŠ è½½å®Œæ¯•ä¹‹åï¼Œå†æ‰§è¡ŒåŒ¿åå‡½æ•°ä¸­çš„jsä»£ç </p>
<p>windowå¯¹è±¡åŠ è½½å®Œæ¯•å°±è¡¨ç¤ºæ•´ä¸ªhtmlé¡µé¢å…ƒç´ éƒ½åŠ è½½å®Œæ¯•äº†</p>
</blockquote>
<p>åœ¨å¼•å…¥jqueryåï¼Œä¹Ÿæœ‰å¯¹åº”çš„è§£å†³æ–¹æ¡ˆï¼Œå…¶æ•ˆæœå’Œä»¥ä¸Šjsä»£ç æ˜¯ä¸€æ ·çš„</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/1.8.3/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">            $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">//jqueryä»£ç ï¼Œæ“ä½œé¡µé¢å…ƒç´ </span></span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        .....</span><br><span class="line">        .....</span><br><span class="line">        .....</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œ$æ˜¯jQueryçš„ä¸€ä¸ªç®€å†™å½¢å¼ï¼Œè¡¨ç¤ºè°ƒç”¨jqueryä¸­çš„å‡½æ•°</p>
</blockquote>
<p>è¿™ä¸ªä»£ç å¯ä»¥ç®€å†™ä¸ºï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/1.8.3/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">            <span class="comment">//$();</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//$(function()&#123;&#125;);</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//å°†ä¸Šé¢å¤§æ‹¬å·å±•å¼€å³å¯</span></span></span><br><span class="line"><span class="javascript">            </span></span><br><span class="line"><span class="javascript">            $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">               <span class="comment">//jqueryä»£ç ï¼Œæ“ä½œé¡µé¢å…ƒç´ </span></span></span><br><span class="line"><span class="javascript">            &#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ€è€ƒ: jså¯¹è±¡å’Œjqå¯¹è±¡çš„å…³ç³»</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">$(function() &#123;</span><br><span class="line">		var divEle = $(&quot;#d&quot;);</span><br><span class="line">		// console.log(divEle);</span><br><span class="line">		divEle.html(&quot;jq&quot;);</span><br><span class="line">		var divJS = divEle[0];</span><br><span class="line">		// console.log(divJS);</span><br><span class="line">		divJS.innerHTML = &quot;js&quot;;</span><br><span class="line">		var divJQ = $(divJS);</span><br><span class="line">		console.log(divJQ);</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>js-&gt;jq  <code>$(js)â€‹</code></li>
<li>jq-&gt;js  <code>jq[0]</code></li>
</ul>
<h3 id="5-3-ä½¿ç”¨"><a href="#5-3-ä½¿ç”¨" class="headerlink" title="5.3 ä½¿ç”¨"></a>5.3 ä½¿ç”¨</h3><p>jqueryæå¤§çš„ç®€åŒ–äº†jsä¸­å¯¹htmlå…ƒç´ çš„domæ“ä½œï¼Œjqueryå€¡å¯¼çš„ç†å¿µæ˜¯ï¼šwrite less,do more</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.8.3.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">//é¡µé¢åŠ è½½å®Œæ¯•åï¼Œå†æ‰§è¡Œjqueryä»£ç </span></span></span><br><span class="line"><span class="javascript">	$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">		<span class="comment">//ç»™btn1æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶</span></span></span><br><span class="line"><span class="javascript">		$(<span class="string">&quot;#btn1&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">			<span class="comment">//ç‚¹å‡»è§¦å‘äº‹ä»¶åï¼Œç»™divæ·»åŠ å†…å®¹ï¼Œå¹¶ä¸”è®¾ç½®å…¶cssçš„æ ·å¼</span></span></span><br><span class="line"><span class="javascript">			$(<span class="string">&quot;#dd&quot;</span>).html(<span class="string">&quot;hello world&quot;</span>).css(&#123;<span class="attr">width</span>:<span class="string">&quot;100px&quot;</span>,<span class="attr">height</span>:<span class="string">&quot;100px&quot;</span>,<span class="attr">border</span>:<span class="string">&quot;1px solid red&quot;</span>&#125;);</span></span><br><span class="line"><span class="javascript">		&#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">		<span class="comment">//ç»™btn2æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶</span></span></span><br><span class="line"><span class="javascript">		$(<span class="string">&quot;#btn2&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">			<span class="comment">//ç‚¹å‡»è§¦å‘äº‹ä»¶åï¼Œè®©divéšè—èµ·æ¥ï¼Œå¹¶ä¸”ä½¿ç”¨åŠ¨ç”»æ•ˆæœ</span></span></span><br><span class="line"><span class="javascript">			$(<span class="string">&quot;#dd&quot;</span>).slideUp();</span></span><br><span class="line"><span class="javascript">		&#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">		<span class="comment">//ç»™btn3æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶</span></span></span><br><span class="line"><span class="javascript">		$(<span class="string">&quot;#btn3&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">			<span class="comment">//ç‚¹å‡»è§¦å‘äº‹ä»¶åï¼Œè®©divæ˜¾ç¤ºå‡ºæ¥ï¼Œå¹¶ä¸”ä½¿ç”¨åŠ¨ç”»æ•ˆæœ</span></span></span><br><span class="line"><span class="javascript">			$(<span class="string">&quot;#dd&quot;</span>).slideDown();</span></span><br><span class="line"><span class="javascript">		&#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">	&#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn1&quot;</span>&gt;</span>æµ‹è¯•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn2&quot;</span>&gt;</span>éšè—<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn3&quot;</span>&gt;</span>æ˜¾ç¤º<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;dd&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>æ›´å¤šçš„æ“ä½œï¼Œå¯ä»¥æŸ¥çœ‹jquery1.8çš„apiæ–‡æ¡£</p>
<p><a href="http://t.mb5u.com/jquery/">jquery1.8åœ¨çº¿APIæ–‡æ¡£</a></p>
<p><img src="image/image-20201008235649562.png" alt="image-20201008235649562"></p>
<blockquote>
<p>APIæ–‡æ¡£ä¸­ï¼Œæœ‰å¤§é‡è¯¦ç»†çš„æ¡ˆä¾‹ï¼ŒåŸºæœ¬æŸ¥çœ‹åå³å¯ä½¿ç”¨</p>
</blockquote>
<h3 id="5-4-ajax"><a href="#5-4-ajax" class="headerlink" title="5.4 ajax"></a>5.4 ajax</h3><blockquote>
<p>jqueryåŒæ ·çš„å¯¹ajaxä»£ç ä¹Ÿè¿›è¡Œå°è£…ï¼Œè®©æˆ‘ä»¬åœ¨é¡µé¢ä¸­å‘é€ajaxè¯·æ±‚å˜çš„æ›´åŠ ç®€å•ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨ajaxä¸­ä»‹ç»å¹¶ä½¿ç”¨jqueryçš„åŸå› </p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œä¿®æ”¹AjaxTestServletä»£ç ï¼Œé‡å†™doPostæ–¹æ³•ï¼ŒdoPostæ–¹æ³•ä¸­è°ƒç”¨doGetæ–¹æ³•ï¼Œè¿™æ ·ä¸ç®¡æ˜¯getè¯·æ±‚è¿˜æ˜¯postè¯·æ±‚ï¼Œéƒ½å¯ä»¥ä½¿ç”¨åŒæ ·çš„ä»£ç æ¥å¤„ç†ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.web.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/ajax-test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AjaxTestServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String username = req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		PrintWriter out = resp.getWriter();</span><br><span class="line">		</span><br><span class="line">		out.println(<span class="string">&quot;hello! &quot;</span>+username);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		doGet(req,resp);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å®˜ç½‘é…ç½®</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      $(<span class="string">&quot;#b01&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      htmlobj=$.ajax(&#123;<span class="attr">url</span>:<span class="string">&quot;/jquery/test1.txt&quot;</span>,<span class="attr">async</span>:<span class="literal">false</span>&#125;);</span><br><span class="line">      $(<span class="string">&quot;#myDiv&quot;</span>).html(htmlobj.responseText);</span><br><span class="line">      &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>





<p>ä½¿ç”¨jqueryä¸­å°è£…çš„ajaxå‡½æ•°ï¼Œå‘é€GETè¯·æ±‚ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.8.3.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">	$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">		$(<span class="string">&quot;#btn&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">			$.ajax(&#123;</span></span><br><span class="line"><span class="javascript">				<span class="attr">type</span>: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line"><span class="javascript">				<span class="attr">url</span>: <span class="string">&quot;/ajax-test?username=mary&quot;</span>,</span></span><br><span class="line"><span class="javascript">				<span class="attr">dataType</span>: <span class="string">&quot;text&quot;</span>,</span></span><br><span class="line"><span class="javascript">				<span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">					$(<span class="string">&quot;#dd&quot;</span>).html(result);</span></span><br><span class="line"><span class="javascript">                    <span class="comment">//$(&quot;#dd&quot;).html(result).css(&#123;width:&quot;100px&quot;,height:&quot;100px&quot;,border:&quot;1px solid red&quot;&#125;).hide().slideDown(4000,function()&#123;alert(&quot;åŠ è½½å®Œæ¯•&quot;)&#125;);</span></span></span><br><span class="line"><span class="javascript">				&#125;</span></span><br><span class="line"><span class="javascript">			&#125;);</span></span><br><span class="line"><span class="javascript">			</span></span><br><span class="line"><span class="javascript">		&#125;);	</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">	&#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>å¼‚æ­¥è¯·æ±‚æµ‹è¯•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;dd&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œçš„<code>dataType</code>å±æ€§ï¼Œè¡¨ç¤ºå½“å‰ajaxè¯·æ±‚ï¼Œå¸Œæœ›æœåŠ¡å™¨è¿”å›çš„å“åº”ä¸­çš„æ•°æ®ä¸ºtextæ–‡æœ¬ç±»å‹</p>
</blockquote>
<p><img src="image/image-20201009001943945.png" alt="image-20201009001943945"></p>
<p>ä½¿ç”¨jqueryä¸­å°è£…çš„ajaxå‡½æ•°ï¼Œå‘é€POSTè¯·æ±‚ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.8.3.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">	$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">		$(<span class="string">&quot;#btn&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">			$.ajax(&#123;</span></span><br><span class="line"><span class="javascript">				<span class="attr">type</span>: <span class="string">&quot;POST&quot;</span>,</span></span><br><span class="line"><span class="javascript">				<span class="attr">url</span>: <span class="string">&quot;/ajax-test&quot;</span>,</span></span><br><span class="line"><span class="javascript">				<span class="comment">//data: &quot;username=lucy&quot;,</span></span></span><br><span class="line"><span class="javascript">             <span class="attr">data</span>: &#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;jack&quot;</span>&#125;,</span></span><br><span class="line"><span class="javascript">				<span class="attr">dataType</span>: <span class="string">&quot;text&quot;</span>,</span></span><br><span class="line"><span class="javascript">				<span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">					$(<span class="string">&quot;#dd&quot;</span>).html(result);</span></span><br><span class="line"><span class="javascript">                    <span class="comment">//$(&quot;#dd&quot;).html(result).css(&#123;width:&quot;100px&quot;,height:&quot;100px&quot;,border:&quot;1px solid red&quot;&#125;).hide().slideDown(4000,function()&#123;alert(&quot;åŠ è½½å®Œæ¯•&quot;)&#125;);</span></span></span><br><span class="line"><span class="javascript">				&#125;</span></span><br><span class="line"><span class="javascript">			&#125;);</span></span><br><span class="line"><span class="javascript">			</span></span><br><span class="line"><span class="javascript">		&#125;);		</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">	&#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>å¼‚æ­¥è¯·æ±‚æµ‹è¯•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;dd&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œ<code>data</code>å±æ€§ï¼Œç”¨æ¥æŒ‡å®šæœ¬æ¬¡POSTè¯·æ±‚ä¸­æ‰€æºå¸¦çš„æ•°æ®ï¼Œå¦å¤–å¦‚æœæ˜¯GETè¯·æ±‚ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¯¥å±æ€§æ¥æŒ‡å®šæºå¸¦çš„æ•°æ®ï¼Œå®ƒä¼šè‡ªåŠ¨å°†æ•°æ®æ·»åŠ åˆ°è¯·æ±‚çš„URIåé¢çš„</p>
<p>æ­¤å¤„postå’Œgetä¼ å‚æ²¡æœ‰æ˜ç¡®åŒºåˆ†</p>
</blockquote>
<h3 id="5-5-get"><a href="#5-5-get" class="headerlink" title="5.5 get"></a>5.5 get</h3><blockquote>
<p>jqueryä¸­ï¼Œä¸“é—¨å°è£…äº†getå‡½æ•°ï¼Œç”¨æ¥ç®€åŒ–ajaxä¸­çš„getè¯·æ±‚çš„å‘é€</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.8.3.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">	$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">		$(<span class="string">&quot;#btn&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">			</span></span><br><span class="line"><span class="javascript">            <span class="comment">//ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥å†™æˆ &quot;username=tom&quot; æˆ–è€… &#123;username:&quot;tom&quot;&#125;</span></span></span><br><span class="line"><span class="javascript">			$.get(<span class="string">&quot;/ajax-test&quot;</span>,&#123;<span class="attr">username</span>:<span class="string">&quot;tom&quot;</span>&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">				$(<span class="string">&quot;#dd&quot;</span>).html(result);</span></span><br><span class="line"><span class="javascript">				</span></span><br><span class="line"><span class="javascript">			&#125;,<span class="string">&quot;text&quot;</span>);</span></span><br><span class="line"><span class="javascript">			</span></span><br><span class="line"><span class="javascript">		&#125;);</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">		</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">	&#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>å¼‚æ­¥è¯·æ±‚æµ‹è¯•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;dd&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œgetå‡½æ•°çš„å››ä¸ªå‚æ•°åˆ†åˆ«ä¸ºï¼š</p>
<p><img src="image/image-20201009002944254.png" alt="image-20201009002944254"></p>
<blockquote>
<p>æ³¨æ„ï¼Œé™¤äº†ç¬¬ä¸€ä¸ªå‚æ•°urlåœ°å€åï¼Œåé¢ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯å¯ä»¥ä¸å†™çš„</p>
</blockquote>
<h3 id="5-6-post"><a href="#5-6-post" class="headerlink" title="5.6 post"></a>5.6 post</h3><blockquote>
<p>jqueryä¸­ï¼Œä¸“é—¨å°è£…äº†postå‡½æ•°ï¼Œç”¨æ¥ç®€åŒ–ajaxä¸­çš„postè¯·æ±‚çš„å‘é€</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.8.3.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">	$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">		$(<span class="string">&quot;#btn&quot;</span>).on(<span class="string">&quot;click&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">			</span></span><br><span class="line"><span class="javascript">            <span class="comment">//ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥å†™æˆ &quot;username=briup&quot; æˆ–è€… &#123;username:&quot;briup&quot;&#125;</span></span></span><br><span class="line"><span class="javascript">			$.post(<span class="string">&quot;/ajax-test&quot;</span>,&#123;<span class="attr">username</span>:<span class="string">&quot;briup&quot;</span>&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">				$(<span class="string">&quot;#dd&quot;</span>).html(result);</span></span><br><span class="line"><span class="javascript">				</span></span><br><span class="line"><span class="javascript">			&#125;,<span class="string">&quot;text&quot;</span>);</span></span><br><span class="line"><span class="javascript">			</span></span><br><span class="line"><span class="javascript">		&#125;);		</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">	&#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>å¼‚æ­¥è¯·æ±‚æµ‹è¯•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;dd&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼Œpostå‡½æ•°çš„ç”¨æ³•å’Œgetå‡½æ•°æ˜¯ä¸€æ ·çš„ï¼Œå‚æ•°ä¸ªæ•°ã€é¡ºåºã€ç±»å‹éƒ½æ˜¯ç›¸åŒçš„</p>
</blockquote>
<h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><p><strong>CheckServlet</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/checkServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">//æ¨¡æ‹Ÿæ•°æ®åº“æ•°æ®</span></span><br><span class="line">		List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">		list.add(<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">		list.add(<span class="string">&quot;lucy&quot;</span>);</span><br><span class="line">		list.add(<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">		<span class="comment">//ajaxæºå¸¦ç”¨æˆ·å æ ¡éªŒ</span></span><br><span class="line">		String username = req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		<span class="comment">//æ ¹æ®è¾“å…¥çš„ç”¨æˆ·å æ¯”å¯¹æ•°æ®</span></span><br><span class="line">		resp.setContentType(<span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(list.contains(username)) &#123;</span><br><span class="line">			<span class="comment">//å¦‚æœå­˜åœ¨,è¿”å›æç¤ºä¿¡æ¯</span></span><br><span class="line">			resp.getWriter().write(<span class="string">&quot;&lt;font color=&#x27;red&#x27;&gt;ç”¨æˆ·åå·²ç»å­˜åœ¨&lt;/font&gt;&quot;</span>);</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>login.html</strong></p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">	pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span> src=<span class="string">&quot;/jq/jquery-1.8.3.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">	<span class="function">function <span class="title">check</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// å‘é€ajaxè¯·æ±‚ ,æ ¡éªŒç”¨æˆ·å</span></span><br><span class="line">		<span class="keyword">var</span> value = $(<span class="string">&quot;#username&quot;</span>).val();</span><br><span class="line">		<span class="comment">//alert(value);</span></span><br><span class="line">		$.get(<span class="string">&quot;/check&quot;</span>, &#123;</span><br><span class="line">			<span class="string">&quot;username&quot;</span> : value</span><br><span class="line">		&#125;, function(result) &#123;</span><br><span class="line">			<span class="comment">//alert(result);</span></span><br><span class="line">			$(<span class="string">&quot;#tip&quot;</span>).html(result);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;form action=<span class="string">&quot;/login&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">		ç”¨æˆ·å &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span> onblur=<span class="string">&quot;check();&quot;</span> id=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">		&lt;span id=<span class="string">&quot;tip&quot;</span>&gt;&lt;/span&gt;&lt;br&gt; å¯†ç : &lt;input type=<span class="string">&quot;password&quot;</span></span><br><span class="line">			name=<span class="string">&quot;password&quot;</span>&gt;&lt;br&gt; &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;æ³¨å†Œ&quot;</span>&gt;</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>







<p>jsonæ ¼å¼</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery-1.8.3.min.js&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">checkName</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> value = $(<span class="string">&quot;#username&quot;</span>).val();</span></span><br><span class="line"><span class="javascript">        $.get(<span class="string">&quot;checkName&quot;</span>,&#123;<span class="string">&quot;username&quot;</span>:value&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;#usernameTip&quot;</span>).text(data.tip).hide().css(&#123;<span class="string">&quot;color&quot;</span>:data.color&#125;).slideDown(<span class="number">2000</span>).slideUp(<span class="number">1000</span>);</span></span><br><span class="line"><span class="javascript">        &#125;,<span class="string">&quot;json&quot;</span>);</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;#&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">id</span> = <span class="string">&quot;username&quot;</span> <span class="attr">onblur</span>=<span class="string">&quot;checkName()&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;usernameTip&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>  <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æ³¨å†Œ&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.web.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: vanse</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/10/18-10-18-13:55</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>ï¼šcom.briup.web.servlet</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>ï¼š1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/checkName&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckName</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        list.add(<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;lucy&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">        String username = req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="comment">// resp.setContentType(&quot;text/plain;charset=utf-8&quot;);</span></span><br><span class="line">        resp.setContentType(<span class="string">&quot;application/json;charset=utf-8&quot;</span>);</span><br><span class="line">        resp.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        String msg = <span class="string">&quot;  &#123;\&quot;tip\&quot;:\&quot;ç”¨æˆ·åå·²ç»å­˜åœ¨\&quot;,\&quot;color\&quot;:\&quot;red\&quot;&#125; &quot;</span>;</span><br><span class="line">        String msg2 = <span class="string">&quot;  &#123;\&quot;tip\&quot;:\&quot;å¯ä»¥æ³¨å†Œ\&quot;,\&quot;color\&quot;:\&quot;green\&quot;&#125; &quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(list.contains(username))&#123;</span><br><span class="line">            resp.getWriter().write(msg);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            resp.getWriter().write(msg2);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>briup</tag>
      </tags>
  </entry>
  <entry>
    <title>briup-mybatis</title>
    <url>/archives/briup/briup-mybatis.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="ç¬¬ä¸€ç« -åŸºç¡€"><a href="#ç¬¬ä¸€ç« -åŸºç¡€" class="headerlink" title="ç¬¬ä¸€ç« -åŸºç¡€"></a>ç¬¬ä¸€ç« -åŸºç¡€</h1><h2 id="0-jdbc"><a href="#0-jdbc" class="headerlink" title="0.jdbc"></a>0.jdbc</h2><p><code>jdbc é—®é¢˜åˆ†æ</code></p>
<p>1ã€æ•°æ®åº“é“¾æ¥åˆ›å»ºã€é‡Šæ”¾é¢‘ç¹é€ æˆç³»ç»Ÿèµ„æºæµªè´¹ä»è€Œå½±å“ç³»ç»Ÿæ€§èƒ½ï¼Œå¦‚æœä½¿ç”¨æ•°æ®åº“é“¾æ¥æ± å¯è§£å†³æ­¤é—®é¢˜ã€‚ </p>
<p>2ã€Sql è¯­å¥åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ï¼Œé€ æˆä»£ç ä¸æ˜“ç»´æŠ¤ï¼Œå®é™…åº”ç”¨ sql å˜åŒ–çš„å¯èƒ½è¾ƒå¤§ï¼Œsql å˜åŠ¨éœ€è¦æ”¹å˜ java ä»£ç ã€‚ </p>
<p>3ã€ä½¿ç”¨ preparedStatement å‘å æœ‰ä½ç¬¦å·ä¼ å‚æ•°å­˜åœ¨ç¡¬ç¼–ç ï¼Œå› ä¸º sql è¯­å¥çš„ where æ¡ä»¶ä¸ä¸€å®šï¼Œå¯èƒ½ å¤šä¹Ÿå¯èƒ½å°‘ï¼Œä¿®æ”¹ sql è¿˜è¦ä¿®æ”¹ä»£ç ï¼Œç³»ç»Ÿä¸æ˜“ç»´æŠ¤ã€‚ </p>
<p>4ã€å¯¹ç»“æœé›†è§£æå­˜åœ¨ç¡¬ç¼–ç ï¼ˆæŸ¥è¯¢åˆ—åï¼‰ï¼Œsql å˜åŒ–å¯¼è‡´è§£æä»£ç å˜åŒ–ï¼Œç³»ç»Ÿä¸æ˜“ç»´æŠ¤ï¼Œå¦‚æœèƒ½å°†æ•°æ®åº“è®° å½•å°è£…æˆ pojo å¯¹è±¡è§£ææ¯”è¾ƒæ–¹ä¾¿ã€‚</p>
<p><img src="image/image-20210914092945449.png" alt="image-20210914092945449"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ç»“æ„ä¸€æ ·,sqlä¸ä¸€æ ·	</span><br><span class="line"><span class="meta">Jdbc-&gt;</span><span class="bash">JdbcUtil-&gt;QueryRunner-&gt;  Mybatis</span></span><br><span class="line">				JdbcTemplate   Hibernate</span><br><span class="line">				...</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">é…ç½®æ–‡ä»¶-&gt; mybatisåŠ è½½é…ç½®æ–‡ä»¶ -&gt; SqlSesson -&gt; è°ƒç”¨sql</span><br><span class="line"></span><br><span class="line">åŠ è½½é…ç½®æ–‡ä»¶</span><br><span class="line">	InputStream in = Resources.getRresourceAsStream(&quot;&quot;);</span><br><span class="line"></span><br><span class="line">è·å–session</span><br><span class="line">	SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">	SqlSession session = factory.openSqlSession();</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">// è°ƒç”¨sql	</span><br><span class="line">	// session.insert(&quot;com.briup.dao.student.InsertStudent&quot;,student);</span><br><span class="line">è°ƒç”¨Mapperæ¥å£</span><br><span class="line">	StudentMapper studentMapper= session.getMapper(StudentMapper.class);</span><br><span class="line">	studentMapper.insertStudent(student);</span><br><span class="line">	</span><br><span class="line">è¯¥æ–¹å¼å¯èƒ½ä¸ä¼šå‡ºé”™</span><br><span class="line">	æ˜ å°„å™¨:</span><br><span class="line">		æ˜ å°„æ¥å£å’Œæ˜ å°„æ–‡ä»¶ç›¸å…³è”</span><br><span class="line">		StudentMapper&#123;					 </span><br><span class="line">			insertStudent(Student);			</span><br><span class="line">		&#125;</span><br><span class="line">		StudentMapper.xml</span><br><span class="line">			 &lt;insert id=&quot;insert&quot; param=&quot;Student&quot;&gt;</span><br><span class="line">			 &lt;/insert&gt;</span><br><span class="line"></span><br><span class="line">ä¸»é…ç½®æ–‡ä»¶</span><br><span class="line">æ—¥å¿—</span><br><span class="line">å°è£…</span><br><span class="line">æ˜ å°„æ–‡ä»¶</span><br></pre></td></tr></table></figure>



<h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h2><h3 id="1-1èµ·æº"><a href="#1-1èµ·æº" class="headerlink" title="1.1èµ·æº"></a>1.1èµ·æº</h3><p><code>MyBatis</code> æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚å¼€æºæ¡†æ¶ï¼Œå®ƒæ”¯æŒè‡ªå®šä¹‰ SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚<code>MyBatis</code>å…é™¤äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç ä»¥åŠè®¾ç½®å‚æ•°å’Œè·å–ç»“æœé›†çš„å·¥ä½œã€‚<code>MyBatis</code>å¯ä»¥é€šè¿‡ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸå§‹ç±»å‹ã€æ¥å£å’Œ Java POJOï¼ˆPlain Old java Objectsï¼Œæ™®é€šè€å¼ Java å¯¹è±¡ï¼‰ä¸ºæ•°æ®åº“ä¸­çš„è®°å½•ã€‚</p>
<p>MyBatisçš„å‰èº«æ˜¯iBATISï¼ŒiBATISäº2002å¹´ç”±ClintonBeginåˆ›å»ºã€‚MyBatis3æ˜¯iBATISçš„å…¨æ–°è®¾è®¡ï¼Œæ”¯æŒæ³¨è§£å’ŒMapperã€‚</p>
<p>MyBatisæµè¡Œçš„ä¸»è¦åŸå› åœ¨äºå®ƒçš„ç®€å•æ€§å’Œæ˜“ä½¿ç”¨æ€§ã€‚åœ¨Javaåº”ç”¨ç¨‹åºä¸­ï¼Œæ•°æ®æŒä¹…åŒ–å±‚æ¶‰åŠåˆ°çš„å·¥ä½œæœ‰ï¼š</p>
<ul>
<li>å°†ä»æ•°æ®åº“æŸ¥è¯¢åˆ°çš„æ•°æ®ç”Ÿæˆæ‰€éœ€è¦çš„Javaå¯¹è±¡</li>
<li>å°†Javaå¯¹è±¡ä¸­çš„æ•°æ®é€šSQLæŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­</li>
</ul>
<p>MyBatisé€šè¿‡æŠ½è±¡åº•å±‚çš„JDBCä»£ç ï¼Œè‡ªåŠ¨åŒ–å°è£…SQLç»“æœé›†äº§ç”ŸJavaå¯¹è±¡ã€Javaå¯¹è±¡çš„æ•°æ®æŒä¹…åŒ–æ•°æ®åº“ä¸­çš„è¿‡ç¨‹ä½¿å¾—å¯¹SQLçš„ä½¿ç”¨å˜å¾—å®¹æ˜“ã€‚</p>
<h3 id="1-2-è·å–"><a href="#1-2-è·å–" class="headerlink" title="1.2 è·å–"></a>1.2 è·å–</h3><p>iBATISä¸€è¯æ¥æºäºinternetå’Œabatisçš„ç»„åˆï¼Œæ˜¯ä¸€ä¸ªåœ¨2002å¹´å‘èµ·çš„å¼€æ”¾æºä»£ç é¡¹ç›®ã€‚äº2010å¹´6æœˆ16å·è¢«è°·æ­Œæ‰˜ç®¡ï¼Œæ”¹åä¸ºMyBatisã€‚</p>
<p>ibatisçš„å®˜ç½‘ <a href="http://ibatis.apache.org/">http://ibatis.apache.org/</a> è¿›å»å®˜ç½‘ä¼šçœ‹åˆ°ä¸‹é¢æç¤º:</p>
<p>apache ibatis is retired at the apache software foundation (2010/06/16) the original project team has moved to mybatis hosted at google code. see <a href="http://www.mybatis.org/">http://www.mybatis.org/</a> for more.ç„¶è€Œ<a href="http://www.mybatis.org/%E8%BF%99%E4%B8%AA%E5%9C%B0%E5%9D%80%E4%B8%80%E7%9B%B4%E5%A4%84%E4%BA%8E%E6%89%93%E4%B8%8D%E5%BC%80%E7%8A%B6%E6%80%81">http://www.mybatis.org/è¿™ä¸ªåœ°å€ä¸€ç›´å¤„äºæ‰“ä¸å¼€çŠ¶æ€</a>â€¦</p>
<p>ä½†æ˜¯æˆ‘ä»¬æœ€ç»ˆæ˜¯å¯ä»¥åœ¨githubä¸­æ‰¾åˆ°mybatisçš„ç›¸å…³ä¸‹è½½çš„:</p>
<p>mybatisåœ¨githubä¸­çš„åœ°å€</p>
<p><a href="https://github.com/mybatis/mybatis-3">https://github.com/mybatis/mybatis-3</a></p>
<p>æœ€æ–°ç‰ˆæœ¬çš„mybatisçš„ä¸‹è½½åœ°å€</p>
<p><a href="https://github.com/mybatis/mybatis-3/releases">https://github.com/mybatis/mybatis-3/releases</a></p>
<p>docæ–‡æ¡£</p>
<p><a href="http://www.mybatis.org/mybatis-3/">http://www.mybatis.org/mybatis-3/</a></p>
<h3 id="1-3-ç‰¹ç‚¹"><a href="#1-3-ç‰¹ç‚¹" class="headerlink" title="1.3 ç‰¹ç‚¹"></a>1.3 ç‰¹ç‚¹</h3><p>é€šè¿‡ä¸Šé¢æˆ‘ä»¬äº†è§£åˆ°Mybatisçš„ä¸»è¦åŠŸèƒ½æ˜¯<strong>æ•°æ®æŒä¹…åŒ–</strong>ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯èƒ½ä¼šå›æƒ³èµ·ä¹‹å‰çš„<strong>JDBC</strong>è¯¾ç¨‹ï¼Œæ—¢ç„¶æˆ‘ä»¬å·²ç»æŒæ¡äº†JDBCä¸ºä»€ä¹ˆè¿˜è¦å†å»å­¦ä¹ Mybatiså‘¢ï¼Ÿ</p>
<p>ä¸»è¦åŸå› æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ol>
<li>Mybatisæ¶ˆé™¤äº†å¤§é‡çš„JDBCå†—ä½™ä»£ç </li>
<li>Mybatisæœ‰ä½çš„å­¦ä¹ æ›²çº¿</li>
<li>Mybatisèƒ½å¾ˆå¥½åœ°ä¸ä¼ ç»Ÿæ•°æ®åº“ååŒå·¥ä½œ</li>
<li>Mybatiså¯ä»¥æ¥å—SQLè¯­å¥</li>
<li>Mybatisæä¾›äº†ä¸Springæ¡†æ¶çš„é›†æˆæ”¯æŒ</li>
<li>Mybatisæä¾›äº†ä¸ç¬¬ä¸‰æ–¹ç¼“å­˜ç±»åº“çš„é›†æˆæ”¯æŒ</li>
<li>Mybatiså¼•å…¥äº†æ›´å¥½çš„æ€§èƒ½</li>
</ol>
<p>1ï¼‰å®ƒæ¶ˆé™¤äº†å¤§é‡çš„JDBCå†—ä½™ä»£ç </p>
<p>Javaé€šè¿‡JDBCçš„APIæ¥æ“ä½œå…³ç³»å‹æ•°æ®åº“ï¼Œä½†æ˜¯JDBCæ˜¯ä¸€ä¸ªéå¸¸åº•å±‚çš„APIï¼Œæˆ‘ä»¬éœ€è¦ä¹¦å†™å¤§é‡çš„ä»£ç æ¥å®Œæˆå¯¹æ•°æ®åº“çš„æ“ä½œã€‚ä¾‹å¦‚ä¸€ä¸ªæ’å…¥æ“ä½œ(å‚è€ƒä¹‹å‰å­¦ä¹ JDBCæ—¶å€™çš„ä»£ç å®ä¾‹)ï¼Œä½†æ˜¯ä½¿ç”¨mybatisæ¥å®Œæˆç›¸åŒçš„æ’å…¥æ“ä½œè¦ç®€å•æ–¹ä¾¿çµæ´»çš„å¤šã€‚</p>
<p>ç‰¹åˆ«ä¹‹å¤„çš„æ˜¯ï¼ŒMyBatisè¿˜æä¾›äº†å…¶ä»–çš„ä¸€äº›ç‰¹æ€§æ¥ç®€åŒ–æŒä¹…åŒ–é€»è¾‘çš„å®ç°ï¼Œå®ƒæ”¯æŒå¤æ‚çš„SQLç»“æœé›†æ•°æ®æ˜ å°„åˆ°åµŒå¥—çš„å¯¹è±¡ç»“æ„ï¼Œå®ƒæ”¯æŒä¸€å¯¹ä¸€å’Œä¸€å¯¹å¤šçš„ç»“æœé›†å’ŒJavaå¯¹è±¡çš„æ˜ å°„ï¼Œå®ƒæ”¯æŒæ ¹æ®è¾“å…¥çš„æ•°æ®æ„å»ºåŠ¨æ€çš„SQLè¯­å¥</p>
<p>2ï¼‰å®ƒæœ‰ä½çš„å­¦ä¹ æ›²çº¿</p>
<p>MyBatisèƒ½å¤Ÿæµè¡Œçš„é¦–è¦åŸå› ä¹‹ä¸€åœ¨äºå®ƒå­¦ä¹ å’Œä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œå®ƒå–å†³äºä½ Javaå’Œ SQLæ–¹é¢çš„çŸ¥è¯†ã€‚å¦‚æœå¼€å‘äººå‘˜å¾ˆç†Ÿæ‚‰Javaå’ŒSQLï¼Œä»–ä»¬ä¼šå‘ç°MyBatiså…¥é—¨éå¸¸ç®€å•ã€‚</p>
<p>3ï¼‰å®ƒèƒ½å¾ˆå¥½åœ°ä¸ä¼ ç»Ÿæ•°æ®åº“ååŒå·¥ä½œ</p>
<p>æœ‰æ—¶æˆ‘ä»¬å¯èƒ½éœ€è¦ç”¨ä¸æ­£è§„å½¢å¼ä¸ä¼ ç»Ÿæ•°æ®åº“ååŒå·¥ä½œï¼Œä½¿ç”¨æˆç†Ÿçš„ORMæ¡†æ¶(ä¾‹å¦‚å¤§å®¶ç†ŸçŸ¥çš„Hibernate)æœ‰å¯èƒ½ã€ä½†æ˜¯å¾ˆéš¾è·Ÿä¼ ç»Ÿæ•°æ®åº“å¾ˆå¥½åœ°ååŒå·¥ä½œï¼Œå› ä¸ºä»–ä»¬å°è¯•å°†Javaå¯¹è±¡é™æ€åœ°æ˜ å°„åˆ°æ•°æ®åº“çš„è¡¨ä¸Š.è€ŒMyBatisæ˜¯å°†æŸ¥è¯¢çš„ç»“æœä¸Javaå¯¹è±¡æ˜ å°„èµ·æ¥ï¼Œè¿™ä½¿å¾—MyBatiså¯ä»¥å¾ˆå¥½åœ°ä¸ä¼ ç»Ÿæ•°æ®åº“ååŒå·¥ä½œã€‚ä½ å¯ä»¥æ ¹æ®é¢ç›¸å¯¹è±¡çš„æ¨¡å‹åˆ›å»ºJavaåŸŸå¯¹è±¡ï¼Œæ‰§è¡Œä¼ ç»Ÿæ•°æ®åº“çš„æŸ¥è¯¢ï¼Œç„¶åå°†ç»“æœæ˜ å°„åˆ°å¯¹åº”çš„Javaå¯¹è±¡ä¸Šã€‚</p>
<p>4ï¼‰å®ƒå¯ä»¥æ¥å—SQLè¯­å¥</p>
<p>æˆç†Ÿçš„ORMæ¡†æ¶é¼“åŠ±ä½¿ç”¨å®ä½“å¯¹è±¡å’Œåœ¨å…¶åº•å±‚è‡ªåŠ¨äº§ç”ŸSQLè¯­å¥ã€‚ç”±äºè¿™ç§çš„SQLç”Ÿæˆæ–¹å¼ï¼Œæˆ‘ä»¬æœ‰å¯èƒ½ä¸èƒ½å¤Ÿåˆ©ç”¨åˆ°æ•°æ®åº“çš„ä¸€äº›ç‰¹æœ‰çš„ç‰¹æ€§ã€‚Hibernateå…è®¸æ‰§è¡Œæœ¬åœ°SQLï¼Œä½†æ˜¯è¿™æ ·ä¼šæ‰“ç ´æŒä¹…å±‚å’Œæ•°æ®åº“ç‹¬ç«‹çš„åŸåˆ™ã€‚MyBatisæ¡†æ¶æ¥å—SQLè¯­å¥ï¼Œè€Œä¸æ˜¯å°†å…¶å¯¹å¼€å‘äººå‘˜éšè—èµ·æ¥ã€‚ç”±äºMyBatisä¸ä¼šäº§ç”Ÿä»»ä½•çš„SQLè¯­å¥ï¼Œæ‰€ä»¥å¼€å‘äººå‘˜å°±è¦å‡†å¤‡SQLè¯­å¥ï¼Œè¿™æ ·å°±å¯ä»¥å……åˆ†åˆ©ç”¨æ•°æ®åº“ç‰¹æœ‰çš„ç‰¹æ€§å¹¶ä¸”å¯ä»¥å‡†å¤‡è‡ªå®šä¹‰çš„æŸ¥è¯¢ã€‚å¦å¤–ï¼ŒMyBatis å¯¹å­˜å‚¨è¿‡ç¨‹ä¹Ÿæä¾›äº†æ”¯æŒã€‚</p>
<p>5ï¼‰å®ƒæä¾›äº†ä¸Springæ¡†æ¶çš„é›†æˆæ”¯æŒ</p>
<p>MyBatisæä¾›äº†ä¸æµè¡Œçš„ä¾èµ–æ³¨å…¥æ¡†æ¶Springçš„å¼€åŒ…å³ç”¨çš„é›†æˆæ”¯æŒï¼Œè¿™å°†è¿›ä¸€æ­¥ç®€åŒ–MyBatisçš„ä½¿ç”¨ã€‚</p>
<p>6ï¼‰å®ƒæä¾›äº†ä¸ç¬¬ä¸‰æ–¹ç¼“å­˜ç±»åº“çš„é›†æˆæ”¯æŒ</p>
<p>MyBatisæœ‰å†…å»ºçš„SqlSessionçº§åˆ«çš„ç¼“å­˜æœºåˆ¶ï¼Œç”¨äºç¼“å­˜Selectè¯­å¥æŸ¥è¯¢å‡ºæ¥çš„ç»“æœã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒMyBatisæä¾›äº†ä¸å¤šç§ç¬¬ä¸‰æ–¹ç¼“å­˜ç±»åº“çš„é›†æˆæ”¯æŒï¼Œå¦‚EHCacheï¼ŒOSCacheï¼ŒHazelcastç­‰ã€‚</p>
<p>7ï¼‰å®ƒå¼•å…¥äº†æ›´å¥½çš„æ€§èƒ½</p>
<p>æ€§èƒ½é—®é¢˜æ˜¯å…³ä¹è½¯ä»¶åº”ç”¨æˆåŠŸä¸å¦çš„å…³é”®å› ç´ ä¹‹ä¸€ã€‚ä¸ºäº†è¾¾åˆ°æ›´å¥½çš„æ€§èƒ½ï¼Œéœ€è¦è€ƒè™‘å¾ˆå¤šäº‹æƒ…ï¼Œè€Œå¯¹å¾ˆå¤šåº”ç”¨è€Œè¨€ï¼Œæ•°æ®æŒä¹…åŒ–å±‚æ˜¯æ•´ä¸ªç³»ç»Ÿæ€§èƒ½çš„å…³é”®ã€‚MyBatisæ”¯æŒæ•°æ®åº“è¿æ¥æ± ï¼Œæ¶ˆé™¤äº†ä¸ºæ¯ä¸€ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥çš„å¼€é”€,MyBatisæä¾›äº†å†…å»ºçš„ç¼“å­˜æœºåˆ¶ï¼Œåœ¨SqlSessionçº§åˆ«æä¾›äº†å¯¹SQLæŸ¥è¯¢ç»“æœçš„ç¼“å­˜ã€‚å³:å¦‚æœä½ è°ƒç”¨äº†ç›¸åŒçš„selectæŸ¥è¯¢ï¼ŒMyBatis ä¼šå°†æ”¾åœ¨ç¼“å­˜çš„ç»“æœè¿”å›ï¼Œè€Œä¸ä¼šå»å†æŸ¥è¯¢æ•°æ®åº“ã€‚MyBatisæ¡†æ¶å¹¶æ²¡æœ‰å¤§é‡åœ°ä½¿ç”¨ä»£ç†æœºåˆ¶ï¼Œå› æ­¤å¯¹äºå…¶ä»–çš„è¿‡åº¦åœ°ä½¿ç”¨ä»£ç†çš„ORMæ¡†æ¶è€Œè¨€ï¼ŒMyBatiså¯ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.demo;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.datasource.pooled.PooledDataSource;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.Environment;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.transaction.TransactionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.transaction.jdbc.JdbcTransactionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.briup.mappers.UserMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestConn</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		PooledDataSource dataSource = <span class="keyword">new</span> PooledDataSource();</span><br><span class="line">		dataSource.setDriver(<span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>);</span><br><span class="line">		dataSource.setUrl(<span class="string">&quot;jdbc:oracle:thin:@127.0.0.1:1521:XE&quot;</span>);</span><br><span class="line">		dataSource.setUsername(<span class="string">&quot;briup&quot;</span>);</span><br><span class="line">		dataSource.setPassword(<span class="string">&quot;briup&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		TransactionFactory transactionFactory = <span class="keyword">new</span> JdbcTransactionFactory();</span><br><span class="line">		</span><br><span class="line">		Environment environment = <span class="keyword">new</span> Environment(<span class="string">&quot;development&quot;</span>, transactionFactory, dataSource);</span><br><span class="line">		</span><br><span class="line">		Configuration configuration = <span class="keyword">new</span> Configuration(environment);</span><br><span class="line">		</span><br><span class="line">		configuration.addMapper(UserMapper.class);</span><br><span class="line">		</span><br><span class="line">		SqlSessionFactory sqlSessionFactory = </span><br><span class="line">				<span class="keyword">new</span> SqlSessionFactoryBuilder().build(configuration);</span><br><span class="line">		SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">		UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">		</span><br><span class="line">		List&lt;User&gt; userList = mapper.findAll();</span><br><span class="line">		System.out.println(userList);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h3 id="1-4-æ¡ˆä¾‹"><a href="#1-4-æ¡ˆä¾‹" class="headerlink" title="1.4 æ¡ˆä¾‹"></a>1.4 æ¡ˆä¾‹</h3><p>åœ¨å®ä¾‹å¼€å§‹ä¹‹å‰æˆ‘ä»¬å…ˆåšä¸€äº›å‡†å¤‡å·¥ä½œã€‚å…ˆæ¥å»ºè¡¨å’Œå»ºä¸€ä¸ªå®ä½“ç±»ã€‚(==åˆ›å»ºjavaé¡¹ç›®å³å¯==)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> students;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> students ( </span><br><span class="line">	id number <span class="keyword">PRIMARY</span> KEY, </span><br><span class="line">	name varchar2(<span class="number">50</span>) , </span><br><span class="line">	email varchar2(<span class="number">50</span>) , </span><br><span class="line">	dob <span class="type">date</span> </span><br><span class="line">); </span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Integer id; </span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	<span class="keyword">private</span> String email; </span><br><span class="line">	<span class="keyword">private</span> Date dob;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> email;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.email = email;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Date <span class="title">getDob</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> dob;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDob</span><span class="params">(Date dob)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.dob = dob;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(Integer id, String name, String email, Date dob)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.email = email;</span><br><span class="line">		<span class="keyword">this</span>.dob = dob;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="1-4-1-jaråŒ…å¯¼å…¥"><a href="#1-4-1-jaråŒ…å¯¼å…¥" class="headerlink" title="1.4.1 jaråŒ…å¯¼å…¥"></a>1.4.1 jaråŒ…å¯¼å…¥</h4><blockquote>
<p>å¯¼å…¥mybatis-jar/ojdbc.jar/junit.jar</p>
</blockquote>
<p>mybatisçš„æ ¸å¿ƒåŒ…åªæœ‰ä¸€ä¸ªmybatis-3.x.x.jar,å¦å¤–è¿˜æœ‰ä¸€äº›ã€å¯é€‰ã€‘çš„ä¾èµ–åŒ…(æ—¥å¿—ã€ä»£ç†ç­‰æ‰€éœ€è¦çš„),åœ¨ä¸‹è½½çš„å‹ç¼©åŒ…ä¸­å¯ä»¥æ‰¾åˆ°.ä¹Ÿå¯ä»¥è‡ªè¡Œå»ä¸‹è½½ã€‚</p>
<p>å¦‚æœæ˜¯mavené¡¹ç›®ï¼Œåªæœ‰å¼•å…¥ä¾èµ–åæ ‡å³å¯ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.x.x<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="1-4-2-é…ç½®æ–‡ä»¶"><a href="#1-4-2-é…ç½®æ–‡ä»¶" class="headerlink" title="1.4.2 é…ç½®æ–‡ä»¶"></a>1.4.2 é…ç½®æ–‡ä»¶</h4><p>mybatisçš„é…ç½®æ–‡ä»¶ä¸€èˆ¬æ¥è¯´åå­—æ˜¯å›ºå®šçš„ï¼Œå°±å«<code>mybatis-config.xml</code>,å…¶ä¸­åŒ…æ‹¬æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼Œç±»å‹åˆ«å,æ˜ å°„æ–‡ä»¶è·¯å¾„ç­‰ç­‰ï¼›ç›´æ¥åˆ›å»ºåœ¨srcç›®å½•ä¸‹ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span> </span></span><br><span class="line"><span class="meta">   <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.briup.pojo.Student&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span> /&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">     &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot; /&gt; </span></span><br><span class="line"><span class="comment">     &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/test&quot; /&gt; </span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span> /&gt;</span> </span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:oracle:thin:@127.0.0.1:1521:XE&quot;</span> /&gt;</span> </span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;briup&quot;</span> /&gt;</span> </span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;briup&quot;</span> /&gt;</span> </span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/briup/mappers/StudentMapper.xml&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<h4 id="1-4-3-æ˜ å°„æ–‡ä»¶"><a href="#1-4-3-æ˜ å°„æ–‡ä»¶" class="headerlink" title="1.4.3 æ˜ å°„æ–‡ä»¶"></a>1.4.3 æ˜ å°„æ–‡ä»¶</h4><p>æ˜ å°„æ–‡ä»¶å‘½åä¸€èˆ¬éƒ½æ˜¯<code>XxxxMapper.xml</code>ï¼Œ<code>Xxxx</code>æ˜¯å¯¹åº”çš„ç±»çš„åå­—ï¼Œè¿™ä¸ªxmlæ–‡ä»¶ä¸­åŒ…æ‹¬<code>Xxxx</code>ç±»æ‰€å¯¹åº”çš„æ•°æ®åº“è¡¨çš„å„ç§å¢åˆ æ”¹æŸ¥sqlè¯­å¥ã€‚</p>
<p>ä¾‹å¦‚:<code>StudentMapper.xml</code>æ–‡ä»¶ä¸­æ˜¯<code>Student</code>ç±»å¯¹åº”çš„è¡¨çš„å„ç§<code>select</code> <code>insert</code> <code>update</code> <code>delete</code>ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> </span></span><br><span class="line"><span class="meta">   <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.dao.StudentMapper&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAllStudents&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span></span><br><span class="line">		SELECT * FROM STUDENTS</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">resultType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">		SELECT ID,NAME, EMAIL</span><br><span class="line">		FROM STUDENTS WHERE ID=#&#123;Id&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">		INSERT INTO STUDENTS(ID,NAME,EMAIL)</span><br><span class="line">		VALUES(#&#123;id &#125;,#&#123;name&#125;,#&#123;email&#125;)</span><br><span class="line">	<span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<h4 id="1-4-4-æ˜ å°„æ¥å£"><a href="#1-4-4-æ˜ å°„æ¥å£" class="headerlink" title="1.4.4 æ˜ å°„æ¥å£"></a>1.4.4 æ˜ å°„æ¥å£</h4><p>mybatisä¸­çš„æ˜ å°„æ¥å£<code>XxxxMapper.java</code>(å¯¹<code>XxxxMapper.xml</code>ä¸­çš„sqlè¯­å¥è¿›è¡Œæ˜ å°„)<br>mybatisä¸­é™¤äº†å¿…é¡»çš„jaråŒ…ã€å„ç§xmlé…ç½®æ–‡ä»¶ä¹‹å¤–,ä¸€èˆ¬è¿˜éœ€è¦æœ‰è°ƒç”¨sqlè¯­å¥æ‰§è¡Œçš„æ¥å£XxxxMapper.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span></span>&#123;</span><br><span class="line">	<span class="function">List&lt;Student&gt; <span class="title">findAllStudents</span><span class="params">()</span></span>; </span><br><span class="line">	<span class="function">Student <span class="title">findStudentById</span><span class="params">(Integer id)</span></span>; </span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">insertStudent</span><span class="params">(Student student)</span></span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™ä¸ªåå­—ä¾ç„¶å¯ä»¥å«StudentDao</p>
</blockquote>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li><p>æ¥å£ä¸­çš„æ–¹æ³•çš„åå­—å’ŒXMLæ–‡ä»¶å®šä¹‰çš„SQLæ˜ å°„è¯­å¥çš„<code>id</code>å€¼è¦ç›¸åŒ</p>
</li>
<li><p>æˆ‘ä»¬ä¸éœ€è¦å»å®ç°è¯¥æ¥å£,å› ä¸ºmybatisä¸­æä¾›äº†ç›¸åº”çš„æ–¹å¼åœ¨è¿è¡ŒæœŸé—´åŠ¨æ€ç”Ÿæˆè¯¥æ¥å£çš„å®ç°ç±»å¯¹è±¡.</p>
</li>
</ol>
<h4 id="1-4-5-æµ‹è¯•"><a href="#1-4-5-æµ‹è¯•" class="headerlink" title="1.4.5 æµ‹è¯•"></a>1.4.5 æµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.briup.dao.StudentMapper;</span><br><span class="line"><span class="keyword">import</span> com.briup.pojo.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentMapperTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			InputStream inputStream = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">			SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">			SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">			StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line">			Student s = <span class="keyword">new</span> Student(<span class="number">1</span>, <span class="string">&quot;tom&quot;</span>, <span class="string">&quot;123@briup.com&quot;</span>, <span class="keyword">new</span> Date());</span><br><span class="line">			studentMapper.insertStudent(s);</span><br><span class="line">			sqlSession.commit();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="1-4-6-å›¾è§£"><a href="#1-4-6-å›¾è§£" class="headerlink" title="1.4.6 å›¾è§£"></a>1.4.6 å›¾è§£</h4><p><img src="image/image-20201019112222960.png" alt="image-20201019112222960"></p>
<blockquote>
<p>æ³¨æ„ï¼Œè¯¥å›¾æè¿°äº†ä¸Šè¿°ä¾‹å­ä¸­çš„ä¿©ä¸ªè¿‡ç¨‹ï¼Œmybatiså·¦è¾¹æ˜¯é…ç½®çš„è¿‡ç¨‹ï¼Œmybatiså³è¾¹æ˜¯å†™ä»£ç çš„è¿‡ç¨‹</p>
</blockquote>
<h2 id="2-é…ç½®"><a href="#2-é…ç½®" class="headerlink" title="2.é…ç½®"></a>2.é…ç½®</h2><h3 id="2-1-æ ¸å¿ƒé…ç½®"><a href="#2-1-æ ¸å¿ƒé…ç½®" class="headerlink" title="2.1 æ ¸å¿ƒé…ç½®"></a>2.1 æ ¸å¿ƒé…ç½®</h3><p>MyBatisæœ€å…³é”®çš„ç»„æˆéƒ¨åˆ†æ˜¯<code>SqlSessionFactory</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­è·å–<code>SqlSession</code>ï¼Œ å¹¶æ‰§è¡Œæ˜ å°„çš„SQLè¯­å¥ã€‚è¦è·å–<code>SqlSessionFactory</code>å¯¹è±¡ï¼Œå°±å¿…é¡»è¦å…ˆè¯»å– mybaitsçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶<code>mybaits-config.xml</code></p>
<p>ä¸‹é¢çš„ mybatis-config.xmlå±•ç¤ºäº†ä¸€ä¸ªå…¸å‹çš„MyBatisé…ç½®æ–‡ä»¶çš„å†…å®¹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;application.properties&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;db_user&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;verysecurepwd&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.briup.pojo.Student&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.briup.pojo&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeHandlers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeHandler</span> <span class="attr">handler</span>=<span class="string">&quot;com.mybatis3.typehandlers.PhoneTypeHandler&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.briup.typehandlers&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeHandlers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driverClassName&#125;&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;production&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;MANAGED&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;JNDI&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;data_source&quot;</span> <span class="attr">value</span>=<span class="string">&quot;java:comp/jdbc/MyBatisDemoDS&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/briup/mappers/StudentMapper.xml&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">url</span>=<span class="string">&quot;file:///D:/mybatis/mappers/StudentMapper.xml&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.dao.StudentMapper&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>mybaits-config.xmlä¸­çš„å¸¸è§æ ‡ç­¾å…ƒç´ æœ‰ï¼š</p>
<ul>
<li><code>&lt;environments&gt;</code></li>
<li><code>&lt;dataSource&gt;</code></li>
<li><code>&lt;transactionManager&gt;</code></li>
<li><code>&lt;properties&gt;</code></li>
<li><code>&lt;typeAliases&gt;</code></li>
<li><code>&lt;typeHandlers&gt;</code></li>
<li><code>&lt;settings&gt;</code></li>
<li><code>&lt;mappers&gt;</code></li>
</ul>
<h4 id="2-1-1-environments"><a href="#2-1-1-environments" class="headerlink" title="2.1.1 environments"></a>2.1.1 environments</h4><p><code>environments</code>æ˜¯é…ç½®mybatiså½“å‰å·¥ä½œçš„æ•°æ®åº“ç¯å¢ƒçš„åœ°æ–¹</p>
<p>MyBatiså¯ä»¥æ”¯æŒé…ç½®å¤šä¸ªdataSourceç¯å¢ƒï¼Œå¯ä»¥å°†åº”ç”¨éƒ¨ç½²åˆ°ä¸åŒçš„ç¯å¢ƒä¸Šï¼Œå¦‚DEV(å¼€å‘ç¯å¢ƒ)ï¼ŒTESTï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰ï¼ŒQAï¼ˆè´¨é‡è¯„ä¼°ç¯å¢ƒï¼‰,UAT(ç”¨æˆ·éªŒæ”¶ç¯å¢ƒ),PRODUCTIONï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰ï¼Œå¯ä»¥é€šè¿‡å°†é»˜è®¤environmentså€¼è®¾ç½®æˆæƒ³è¦çš„environmentçš„idå€¼.</p>
<p>å¦‚æœä½ çš„åº”ç”¨éœ€è¦è¿æ¥å¤šä¸ªæ•°æ®åº“ï¼Œä½ éœ€è¦å°†æ¯ä¸ªæ•°æ®åº“é…ç½®æˆç‹¬ç«‹çš„ç¯å¢ƒï¼Œå¹¶ä¸”ä¸ºæ¯ä¸€ä¸ªæ•°æ®åº“åˆ›å»ºä¸€ä¸ªSqlSessionFactory</p>
<p>ä¾‹å¦‚:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;shoppingcart&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;shoppingcart&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;MANAGED&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;JNDI&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;data_source&quot;</span> <span class="attr">value</span>=<span class="string">&quot;java:comp/jdbc/ShoppingcartDS&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;reports&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">transaction</span> <span class="attr">Managertype</span>=<span class="string">&quot;MANAGED&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;JNDI&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;data_source&quot;</span> <span class="attr">value</span>=<span class="string">&quot;java:comp/jdbc/ReportsDS&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥ä¸ºä»¥ä¸Šæ¯ä¸ªç¯å¢ƒåˆ›å»ºä¸€ä¸ªSqlSessionFactory</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">inputStream = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line"><span class="comment">//é»˜è®¤çš„ç¯å¢ƒ default</span></span><br><span class="line">SqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line"><span class="comment">//ç»Ÿè®¡æ˜ç»†çš„ç¯å¢ƒ cart</span></span><br><span class="line">SqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream, <span class="string">&quot;shoppingcart&quot;</span>);</span><br><span class="line"><span class="comment">//ç»Ÿè®¡æŠ¥è¡¨çš„ç¯å¢ƒ report</span></span><br><span class="line">SqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream, <span class="string">&quot;reports&quot;</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„:ä¸€ä¸ªæ•°æ®åº“ç¯å¢ƒå¯¹åº”ä¸€ä¸ªSqlSessionFactoryå¯¹è±¡;å¯¹äºenvironments,æˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­é…ç½®å¤šä¸ªenvironmentå­å…ƒç´ ,åŒæ—¶è¿˜éœ€è¦åœ¨environmentä¸­é…ç½®dataSourceå’ŒtransactionManagerå…ƒç´ ã€‚</p>
</blockquote>
<h4 id="2-1-2-dataSource"><a href="#2-1-2-dataSource" class="headerlink" title="2.1.2 dataSource"></a>2.1.2 dataSource</h4><p><code>dataSource</code>è¡¨ç¤ºçš„æ˜¯æ•°æ®æº;è‡³å°‘ä¼šåŒ…æ‹¬è¯¥è¿æ¥æ•°æ®åº“çš„å››ç§ä¿¡æ¯.</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driverClassName&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>dataSourceçš„ç±»å‹typeå±æ€§å¯ä»¥é…ç½®æˆå…¶å†…ç½®ç±»å‹ä¹‹ä¸€ï¼Œå¦‚UNPOOLEDï¼ŒPOOLEDï¼ŒJNDIã€‚</p>
<p>å¦‚æœå°†ç±»å‹è®¾ç½®æˆUNPOOLEDï¼ŒMyBatisä¼šä¸ºæ¯ä¸€ä¸ªæ•°æ®åº“æ“ä½œåˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œä½¿ç”¨å®Œäº†å¹¶å…³é—­å®ƒï¼Œè¯¥æ–¹å¼é€‚ç”¨äºåªæœ‰å°è§„æ¨¡æ•°é‡å¹¶å‘ç”¨æˆ·çš„ç®€å•åº”ç”¨ç¨‹åºä¸Šã€‚</p>
<p>å¦‚æœå°†å±æ€§è®¾ç½®æˆPOOLEDï¼ŒMyBatisä¼šåˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œè¿æ¥æ± ä¸­çš„ä¸€ä¸ªè¿æ¥å°†ä¼šè¢«ç”¨ä½œæ•°æ®åº“æ“ä½œ(åˆ†é…ï¼Œç®¡ç†ï¼Œé‡Šæ”¾)ã€‚ä¸€æ—¦æ•°æ®åº“æ“ä½œå®Œæˆï¼ŒMyBatisä¼šå°†æ­¤è¿æ¥è¿”å›ç»™è¿æ¥æ± ã€‚</p>
<p>å¦‚æœå°†ç±»å‹è®¾ç½®æˆJNDI(Java Naming and Directory Interface , Javaå‘½åå’Œç›®å½•æ¥å£, æ˜¯SUNå…¬å¸æä¾›çš„ä¸€ç§æ ‡å‡†çš„Javaå‘½åç³»ç»Ÿæ¥å£)ï¼ŒMyBatisä»åœ¨åº”ç”¨æœåŠ¡å™¨å‘é…ç½®å¥½çš„JNDIæ•°æ®æºdataSourceè·å–æ•°æ®åº“è¿æ¥ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¼˜å…ˆè€ƒè™‘è¿™ç§æ–¹å¼ã€‚</p>
<h4 id="2-1-3-transactionManager"><a href="#2-1-3-transactionManager" class="headerlink" title="2.1.3 transactionManager"></a>2.1.3 transactionManager</h4><p>MyBatisæ”¯æŒä¸¤ç§ç±»å‹çš„<strong>äº‹åŠ¡ç®¡ç†å™¨</strong>ï¼šJDBC å’Œ MANAGED.</p>
<p>JDBCäº‹åŠ¡ç®¡ç†å™¨çš„ä½¿ç”¨ï¼Œæ˜¯åœ¨<code>JDBCç¨‹åº</code>è´Ÿè´£ç®¡ç†æ•°æ®åº“è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸï¼ˆæäº¤ã€å›é€€ç­‰ç­‰ï¼‰çš„æ—¶å€™ã€‚å¦‚æœå°†TransactionManager å±æ€§è®¾ç½®æˆJDBCï¼ŒMyBatiså†…éƒ¨å°†ä½¿ç”¨JdbcTransactionFactoryç±»åˆ›å»ºTransactionManagerã€‚ä¾‹å¦‚ï¼Œéƒ¨ç½²åˆ°ApacheTomcatçš„åº”ç”¨ç¨‹åºï¼Œéœ€è¦åº”ç”¨ç¨‹åºè‡ªå·±ç®¡ç†äº‹åŠ¡ã€‚</p>
<p>MANAGED äº‹åŠ¡ç®¡ç†å™¨çš„ä½¿ç”¨ï¼Œæ˜¯åœ¨<code>åº”ç”¨æœåŠ¡å™¨</code>è´Ÿè´£ç®¡ç†æ•°æ®åº“è¿æ¥ç”Ÿå‘½å‘¨æœŸçš„æ—¶å€™ã€‚å¦‚æœTransactionManagerå±æ€§è®¾ç½®æˆMANAGEDæ—¶ï¼ŒMyBatiså†…éƒ¨ä½¿ç”¨ManagedTransactionFactory ç±»åˆ›å»ºäº‹åŠ¡ç®¡ç†å™¨TransactionManagerã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªJava EEçš„åº”ç”¨ç¨‹åºéƒ¨ç½²åœ¨ç±»ä¼¼JBossï¼ŒWebLogicï¼ŒGlassFishç­‰åº”ç”¨æœåŠ¡å™¨ä¸Šæ—¶ï¼Œå®ƒä»¬ä¼šä½¿ç”¨EJBè¿›è¡Œåº”ç”¨æœåŠ¡å™¨çš„äº‹åŠ¡ç®¡ç†èƒ½åŠ›ã€‚åœ¨è¿™äº›ç®¡ç†ç¯å¢ƒä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨MANAGEDäº‹åŠ¡ç®¡ç†å™¨ã€‚</p>
<blockquote>
<p>æ³¨ï¼šManaged æ˜¯æ‰˜ç®¡çš„æ„æ€ï¼Œå³æˆ‘ä»¬ç¼–å†™çš„åº”ç”¨ç¨‹åºæœ¬èº«ä¸å»ç®¡ç†äº‹åŠ¡ï¼Œè€Œæ˜¯æŠŠäº‹åŠ¡ç®¡ç†äº¤ç»™åº”ç”¨æ‰€åœ¨çš„æœåŠ¡å™¨è¿›è¡Œç®¡ç†ã€‚</p>
</blockquote>
<h4 id="2-1-4-properties"><a href="#2-1-4-properties" class="headerlink" title="2.1.4 properties"></a>2.1.4 properties</h4><p>å±æ€§é…ç½®å…ƒç´ propertieså¯ä»¥å°†é…ç½®å€¼å†™æ­»åˆ°mybatis-config.xmlä¸­,ä¹Ÿå¯ä»¥å…·ä½“åˆ°ä¸€ä¸ªå±æ€§æ–‡ä»¶ä¸­,å¹¶ä¸”ä½¿ç”¨å±æ€§æ–‡ä»¶çš„keyåä½œä¸ºå ä½ç¬¦ã€‚</p>
<p>åœ¨ä¸Šè¿°çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬å°†æ•°æ®åº“è¿æ¥å±æ€§é…ç½®åˆ°äº†application.propertiesæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”ä¸ºdriverï¼ŒURLç­‰å±æ€§ä½¿ç”¨äº†å ä½ç¬¦.</p>
<p>åœ¨applications.propertiesæ–‡ä»¶ä¸­é…ç½®æ•°æ®åº“è¿æ¥å‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">jdbc.driverClassName=oracle.jdbc.driver.OracleDriver</span><br><span class="line">jdbc.url=jdbc:oracle:thin:@<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">1521</span>:XE</span><br><span class="line">jdbc.username=briup</span><br><span class="line">jdbc.password=briup </span><br></pre></td></tr></table></figure>

<p>åœ¨mybatis-config.xmlæ–‡ä»¶ä¸­ï¼Œä¸ºå±æ€§ä½¿ç”¨application.propertiesæ–‡ä»¶ä¸­å®šä¹‰çš„å ä½ç¬¦ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è¯»å–application.propertiesæ–‡ä»¶ä¸­çš„æ•°æ®key-valueçš„å½¢å¼ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;application.properties&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- æ³¨æ„:æ˜¯applications.propertiesæ–‡ä»¶ä¸­çš„å€¼ä¼˜å…ˆçº§é«˜ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbc.username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;briup&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbc.password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;briup&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driverClassName&#125;&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-1-5-typeAliases"><a href="#2-1-5-typeAliases" class="headerlink" title="2.1.5 typeAliases"></a>2.1.5 typeAliases</h4><p>åœ¨SQLMapperé…ç½®æ–‡ä»¶ä¸­ï¼Œå¯¹äºresultTypeå’ŒparameterTypeå±æ€§å€¼ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨JavaBean çš„å®Œå…¨é™å®šåã€‚</p>
<p>ä¾‹å¦‚:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">resultType</span>=<span class="string">&quot;com.briup.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">	 SELECT  ID, NAME, EMAIL, DOB</span><br><span class="line">	 FROM STUDENTS WHERE id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.briup.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">	 UPDATE STUDENTS</span><br><span class="line">	 SET NAME=#&#123;name&#125;, EMAIL=#&#123;email&#125;, DOB=#&#123;dob&#125;</span><br><span class="line">	 WHERE id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨:parameterTypeè¡¨ç¤ºå°†æ¥è°ƒç”¨è¿™ä¸ªsqlè¯­å¥çš„æ—¶å€™æ‰€ä¼ çš„å‚æ•°çš„ç±»å‹(å‚æ•°å€¼æˆ–è€…å‚æ•°å¯¹è±¡é‡Œé¢çš„å±æ€§å€¼ ç”¨æ¥æ›¿æ¢sqlè¯­å¥ä¸­çš„å ä½ç¬¦)</p>
</blockquote>
<p><code>resultType</code>è¡¨ç¤ºå°†æ¥è°ƒç”¨è¿™ä¸ªsqlè¯­å¥çš„æ—¶å€™æ‰€è¿”å›çš„ç»“æœçš„ç±»å‹(æ–¹ä¾¿mybatisç»™æˆ‘ä»¬è‡ªåŠ¨å°è£…ç»“æœé›†)</p>
<p>è¿™é‡Œæˆ‘ä»¬ä¸º<code>resultType</code>å’Œ<code>parameterType</code>å±æ€§å€¼è®¾ç½®ä¸ºStudentç±»å‹çš„å®Œå…¨é™å®šåï¼šcom.briup.com.Student</p>
<p>æˆ‘ä»¬å¯ä»¥ä¸ºå®Œå…¨é™å®šåå–ä¸€ä¸ªåˆ«åï¼ˆaliasï¼‰ï¼Œç„¶åå°±å¯ä»¥åœ¨éœ€è¦ä½¿ç”¨å®Œå…¨é™å®šåçš„åœ°æ–¹ä½¿ç”¨åˆ«åï¼Œè€Œä¸æ˜¯åˆ°å¤„ä½¿ç”¨å®Œå…¨é™å®šåã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸ºå®Œå…¨é™å®šåèµ·ä¸€ä¸ªåˆ«åï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.briup.pojo.Student&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">&quot;Teacher&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.briup.pojo.Teacher&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨SQLMapperæ˜ å°„æ–‡ä»¶ä¸­, å¦‚ä¸‹ä½¿ç”¨Studentçš„åˆ«åï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">resultType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">	 SELECT  ID, NAME, EMAIL, DOB</span><br><span class="line">	 FROM STUDENTS</span><br><span class="line">	WHERE id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">	 UPDATE STUDENTS</span><br><span class="line">	 SET NAME=#&#123;name&#125;, EMAIL=#&#123;email&#125;, DOB=#&#123;dob&#125;</span><br><span class="line">	 WHERE id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ä¹Ÿå¯ä»¥ä¸ç”¨ä¸ºæ¯ä¸€ä¸ªJavaBeanå•ç‹¬å®šä¹‰åˆ«å,ä½ å¯ä»¥ä¸ºé…ç½®å‡ºéœ€è¦å–åˆ«åçš„ç±»çš„æ‰€åœ¨çš„åŒ…(package)ï¼ŒMyBatisä¼šè‡ªåŠ¨æ‰«æåŒ…å†…å®šä¹‰çš„ç±»ï¼Œç„¶ååˆ†åˆ«ä¸ºæ¯ä¸ªç±»æ³¨å†Œä¸€ä¸ªå°å†™å­—æ¯å¼€å¤´çš„ç®€å•ç±»åå½¢å¼çš„åˆ«åã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.briup.pojo&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœStudent.javaå’Œ Teacher.java å®šä¹‰åœ¨com.briup.pojoåŒ…ä¸­ï¼Œåˆ™ com.briup.pojo.Studentçš„åˆ«åä¼šè¢«æ³¨å†Œä¸ºstudentã€‚è€Œcom.briup.pojo.Teacheråˆ«åå°†ä¼šè¢«æ³¨å†Œä¸ºteacher</p>
<p>è¿˜æœ‰å¦å¤–ä¸€ç§æ–¹å¼ä¸ºJavaBeansèµ·åˆ«åï¼Œä½¿ç”¨æ³¨è§£ <code>@Alias</code>:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Alias(&quot;stu&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>&#123;</span><br><span class="line">          </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„: </p>
<p>@Aliasæ³¨è§£å°†ä¼šè¦†ç›–é…ç½®æ–‡ä»¶ä¸­çš„&lt;typeAliases&gt;å®šä¹‰ã€‚</p>
<p>@Alias è¦å’Œ<code>&lt;package name=&quot;&quot;/&gt;</code>æ ‡ç­¾é…åˆä½¿ç”¨,Mybatisä¼šè‡ªåŠ¨æŸ¥çœ‹æŒ‡å®šåŒ…å†…çš„ç±»åˆ«åæ³¨è§£,å¦‚æœæ²¡æœ‰è¿™ä¸ªæ³¨è§£,é‚£ä¹ˆé»˜è®¤çš„åˆ«åå°±æ˜¯ç±»çš„åå­—ã€‚</p>
</blockquote>
<h4 id="2-1-6-typeHandlers"><a href="#2-1-6-typeHandlers" class="headerlink" title="2.1.6 typeHandlers"></a>2.1.6 typeHandlers</h4><p>å½“MyBatiså°†ä¸€ä¸ªJavaå¯¹è±¡ä½œä¸ºè¾“å…¥å‚æ•°æ‰§è¡ŒINSERTè¯­å¥æ“ä½œæ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªPreparedStatementå¯¹è±¡ï¼Œå¹¶ä¸”ä½¿ç”¨setXXX()æ–¹æ³•å¯¹?å·å ä½ç¬¦è®¾ç½®ç›¸åº”çš„å‚æ•°å€¼ ã€‚è¿™é‡Œï¼ŒXXXå¯ä»¥æ˜¯intï¼ŒStringï¼ŒDate ç­‰ Javaå¯¹è±¡å±æ€§ç±»å‹çš„ä»»æ„ä¸€ä¸ªã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">	 INSERT INTO STUDENTS(id,NAME,EMAIL,DOB)</span><br><span class="line">	 VALUES(#&#123;id&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;dob&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸ºæ‰§è¡Œè¿™ä¸ªè¯­å¥ï¼ŒMyBatiså°†é‡‡å–ä»¥ä¸‹ä¸€ç³»åˆ—åŠ¨ä½œï¼Œåˆ›å»ºä¸€ä¸ªæœ‰å ä½ç¬¦çš„PreparedStatementæ¥å£ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">PreparedStatement ps = connection.prepareStatement(<span class="string">&quot;INSERT INTO STUDENTS(id,NAME,EMAIL,DOB) VALUES(?,?,?,?)&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>æ£€æŸ¥Studentå¯¹è±¡çš„å±æ€§studIdçš„ç±»å‹ï¼Œç„¶åä½¿ç”¨åˆé€‚setXXXæ–¹æ³•å»è®¾ç½®å‚æ•°å€¼ã€‚è¿™é‡ŒstudIdæ˜¯Integerç±»å‹ï¼Œæ‰€ä»¥ä¼šä½¿ç”¨setInt()æ–¹æ³•ï¼šps.setInt(1,student.getStudId());ç±»ä¼¼åœ°ï¼Œå¯¹äºnameå’Œemailå±æ€§éƒ½æ˜¯Stringç±»å‹MyBatisä½¿ç”¨setString()æ–¹æ³•è®¾ç½®å‚æ•°ã€‚</p>
<blockquote>
<p>   æ³¨æ„ï¼š MyBaitsä¼šå°†java.util.Dateç±»å‹è½¬æ¢ä¸ºjava.sql.Timestampå¹¶è®¾å€¼ï¼š</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ps.setTimestamp(<span class="number">4</span>, <span class="keyword">new</span> Timestamp((student.getDob()).getTime()));</span><br></pre></td></tr></table></figure>

<p>MyBatisæ˜¯æ€ä¹ˆçŸ¥é“å¯¹äºIntegerç±»å‹å±æ€§ä½¿ç”¨setInt()å’ŒStringç±»å‹å±æ€§ä½¿ç”¨setString()æ–¹æ³•å‘¢ï¼Ÿå…¶å®MyBatisæ˜¯é€šè¿‡ä½¿ç”¨ç±»å‹å¤„ç†å™¨typeHandlersæ¥å†³å®šè¿™ä¹ˆåšçš„ã€‚</p>
<p>MyBatiså¯¹äºä»¥ä¸‹çš„ç±»å‹ä½¿ç”¨å†…ç½®çš„ç±»å‹å¤„ç†å™¨ï¼šæ‰€æœ‰çš„åŸºæœ¬æ•°æ®ç±»å‹ã€åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»å‹ã€ byte[]ã€java.util.Dateã€java.sql.Dateã€java.sql.Timeã€java.sql.Timestampã€javaæšä¸¾ç±»å‹ç­‰ã€‚æ‰€ä»¥å½“MyBatiså‘ç°å±æ€§çš„ç±»å‹å±äºä¸Šè¿°ç±»å‹ï¼Œä»–ä¼šä½¿ç”¨å¯¹åº”çš„ç±»å‹å¤„ç†å™¨å°†å€¼è®¾ç½®åˆ°PreparedStatementä¸­ï¼ŒåŒæ ·åœ°ï¼Œå½“SQLç»“æœé›†å°è£…æˆjavaç±»å¯¹è±¡çš„æ—¶å€™ï¼Œä¹Ÿæœ‰ç±»ä¼¼çš„è¿‡ç¨‹ã€‚ </p>
<p>é‚£å¦‚æœæœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»å‹ï¼Œæ€ä¹ˆå­˜å‚¨åˆ°æ•°æ®åº“å‘¢ï¼Ÿç¤ºä¾‹å¦‚ä¸‹ï¼šå‡è®¾è¡¨STUDENTS æœ‰ä¸€ä¸ª PHONE å­—æ®µï¼Œç±»å‹ä¸º VARCHAR2(15)ï¼Œè€Œ Studentç±»æœ‰ä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹å±æ€§phone(PhoneNumberç±») </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students <span class="keyword">add</span> phone varchar2(<span class="number">15</span>);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students <span class="keyword">drop</span> <span class="keyword">column</span> phone;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PhoneNumber</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String countryCode;</span><br><span class="line">	<span class="keyword">private</span> String stateCode;</span><br><span class="line">	<span class="keyword">private</span> String number;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">PhoneNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">PhoneNumber</span><span class="params">(String countryCode, String stateCode, String number)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.countryCode = countryCode;</span><br><span class="line">		<span class="keyword">this</span>.stateCode = stateCode;</span><br><span class="line">		<span class="keyword">this</span>.number = number;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PhoneNumber</span><span class="params">(String str)</span></span>&#123; </span><br><span class="line">        <span class="comment">// å¦‚æœ == null</span></span><br><span class="line">        <span class="keyword">if</span>(str!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            String[] args = str.split(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="keyword">this</span>.countryCode = 	args[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">this</span>.stateCode = 	args[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">this</span>.number = 		args[<span class="number">2</span>];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.countryCode = 	args[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">this</span>.stateCode = 	args[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">this</span>.number = 		args[<span class="number">2</span>] </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getAsString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> countryCode + <span class="string">&quot;-&quot;</span> + stateCode + <span class="string">&quot;-&quot;</span> + number;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// Setters and getters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id; </span><br><span class="line">    <span class="keyword">private</span> String name; </span><br><span class="line">    <span class="keyword">private</span> String email; </span><br><span class="line">    <span class="keyword">private</span> Date dob;</span><br><span class="line">    <span class="keyword">private</span> PhoneNumber phoneNumber;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>xmlé…ç½®:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">   <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.dao.StudentMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> /&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;phoneNumber&quot;</span> <span class="attr">column</span>=<span class="string">&quot;phone&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAllStudents&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span></span><br><span class="line">        SELECT * FROM STUDENTS</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">resultType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">        SELECT ID, NAME, EMAIL,PHONE as phoneNumber</span><br><span class="line">        FROM STUDENTS WHERE ID=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">        INSERT INTO STUDENTS(ID,NAME,EMAIL,PHONE)</span><br><span class="line">        VALUES(#&#123;id &#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;phoneNumber&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„è‡ªåŠ¨æ˜ å°„ PHONE as phoneNumber</p>
</blockquote>
<p>è¿™é‡Œï¼Œå‚æ•°å¯¹è±¡ä¸­çš„å±æ€§phoneçš„å€¼éœ€è¦ä¼ é€’ç»™#{phone}ï¼›è€Œå‚æ•°å¯¹è±¡çš„å±æ€§phoneæ˜¯ PhoneNumberç±»å‹ã€‚ä½†æ˜¯ï¼ŒMyBatis å¹¶ä¸çŸ¥é“è¯¥æ€æ ·æ¥å¤„ç†è¿™ä¸ªç±»å‹çš„å¯¹è±¡ã€‚</p>
<p>ä¸ºäº†è®©MyBatisæ˜ç™½æ€æ ·å¤„ç†è¿™ä¸ªè‡ªå®šä¹‰çš„Javaå¯¹è±¡ç±»å‹ï¼Œå¦‚PhoneNumberï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»å‹å¤„ç†å™¨,MyBatisæä¾›äº†æŠ½è±¡ç±»<code>BaseTypeHandler&lt;T&gt;</code> ï¼Œæˆ‘ä»¬å¯ä»¥ç»§æ‰¿æ­¤ç±»åˆ›å»ºè‡ªå®šä¹‰ç±»å‹å¤„ç†å™¨ã€‚</p>
<p>ä»£ç å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.typehandler;</span><br><span class="line"><span class="keyword">import</span> java.sql.CallableStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.type.BaseTypeHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.type.JdbcType;</span><br><span class="line"><span class="keyword">import</span> com.briup.pojo.PhoneNumber;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PhoneTypeHandler</span> <span class="keyword">extends</span> <span class="title">BaseTypeHandler</span>&lt;<span class="title">PhoneNumber</span>&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//é‡åˆ°PhoneNumberå‚æ•°çš„æ—¶å€™åº”è¯¥å¦‚ä½•åœ¨psä¸­è®¾ç½®å€¼</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNonNullParameter</span><span class="params">(PreparedStatement ps, <span class="keyword">int</span> i, PhoneNumber parameter, JdbcType jdbcType)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        ps.setString(i, parameter.getAsString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŸ¥è¯¢ä¸­é‡åˆ°PhoneNumberç±»å‹çš„åº”è¯¥å¦‚ä½•å°è£…(ä½¿ç”¨åˆ—åå°è£…)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PhoneNumber <span class="title">getNullableResult</span><span class="params">(ResultSet rs, String columnName)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PhoneNumber(rs.getString(columnName));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢ä¸­é‡åˆ°PhoneNumberç±»å‹çš„åº”è¯¥å¦‚ä½•å°è£…(ä½¿ç”¨åˆ—çš„ä¸‹æ ‡)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PhoneNumber <span class="title">getNullableResult</span><span class="params">(ResultSet rs, <span class="keyword">int</span> columnIndex)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PhoneNumber(rs.getString(columnIndex));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//CallableStatementä½¿ç”¨ä¸­é‡åˆ°äº†PhoneNumberç±»å‹çš„åº”è¯¥å¦‚ä½•å°è£…</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PhoneNumber <span class="title">getNullableResult</span><span class="params">(CallableStatement cs, <span class="keyword">int</span> columnIndex)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PhoneNumber(cs.getString(columnIndex));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„:ä½¿ç”¨ps.setString()å’Œrs.getString()æ–¹æ³•æ˜¯ :å› ä¸ºåœ¨æ•°æ®åº“çš„è¡¨ä¸­phoneåˆ—æ˜¯VARCHARç±»å‹ã€‚</p>
</blockquote>
<p>æœ€åä¸€æ—¦æˆ‘ä»¬å®ç°äº†è‡ªå®šä¹‰çš„ç±»å‹å¤„ç†å™¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨mybatis-config.xmlä¸­æ³¨å†Œå®ƒï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;application.properties&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeHandlers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeHandler</span> <span class="attr">handler</span>=<span class="string">&quot;com.briup.typehandlers.PhoneTypeHandler&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeHandlers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨å†ŒPhoneTypeHandlerå, MyBatiså°±èƒ½å¤Ÿå°†Phoneç±»å‹çš„å¯¹è±¡å€¼å­˜å‚¨åˆ°VARCHARç±»å‹çš„åˆ—ä¸Šã€‚</p>
</blockquote>
<h4 id="2-1-7-settings"><a href="#2-1-7-settings" class="headerlink" title="2.1.7 settings"></a>2.1.7 settings</h4><blockquote>
<p>æ³¨æ„:å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œã€è¿™äº›å‚æ•°ä½¿ç”¨å®ƒä»¬çš„é»˜è®¤å€¼å³å¯ã€‘</p>
</blockquote>
<p> ä¸ºæ»¡è¶³åº”ç”¨ç‰¹å®šçš„éœ€æ±‚ï¼ŒMyBatisé»˜è®¤çš„å…¨å±€å‚æ•°è®¾ç½®å¯ä»¥è¢«è¦†ç›–æ‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- è¿™ä¸ªé…ç½®ä½¿å…¨å±€çš„æ˜ å°„å™¨å¯ç”¨æˆ–ç¦ç”¨ç¼“å­˜ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å…¨å±€å¯ç”¨æˆ–ç¦ç”¨å»¶è¿ŸåŠ è½½ã€‚å½“ç¦ç”¨æ—¶ï¼Œæ‰€æœ‰å…³è”å¯¹è±¡éƒ½ä¼šå³æ—¶åŠ è½½ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadingEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å…è®¸æˆ–ä¸å…è®¸å¤šç§ç»“æœé›†ä»ä¸€ä¸ªå•ç‹¬çš„è¯­å¥ä¸­è¿”å›ï¼ˆéœ€è¦é€‚åˆçš„é©±åŠ¨ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;multipleResultSetsEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä½¿ç”¨åˆ—æ ‡ç­¾ä»£æ›¿åˆ—åã€‚ä¸åŒçš„é©±åŠ¨åœ¨è¿™æ–¹ä¾¿è¡¨ç°ä¸åŒã€‚å‚è€ƒé©±åŠ¨æ–‡æ¡£æˆ–å……åˆ†æµ‹è¯•ä¸¤ç§æ–¹æ³•æ¥å†³å®šæ‰€ä½¿ç”¨çš„é©±åŠ¨ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;useColumnLabel&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å…è®¸JDBCæ”¯æŒç”Ÿæˆçš„é”®ã€‚éœ€è¦é€‚åˆçš„é©±åŠ¨ã€‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;useGeneratedKeys&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šMyBatiså¦‚ä½•è‡ªåŠ¨æ˜ å°„åˆ—åˆ°å­—æ®µ/å±æ€§ã€‚PARTIALåªä¼šè‡ªåŠ¨æ˜ å°„ç®€å•ã€æ²¡æœ‰åµŒå¥—çš„ç»“æœã€‚FULLä¼šè‡ªåŠ¨æ˜ å°„ä»»æ„å¤æ‚çš„ç»“æœï¼ˆåµŒå¥—çš„æˆ–å…¶ä»–æƒ…å†µï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;autoMappingBehavior&quot;</span> <span class="attr">value</span>=<span class="string">&quot;PARTIAL&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®é»˜è®¤çš„æ‰§è¡Œå™¨ã€‚SIMPLEæ‰§è¡Œå™¨æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ã€‚REUSEæ‰§è¡Œå™¨é‡ç”¨é¢„å¤„ç†è¯­å¥ã€‚BATCHæ‰§è¡Œå™¨é‡ç”¨è¯­å¥å’Œæ‰¹é‡æ›´æ–° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;defaultExecutorType&quot;</span> <span class="attr">value</span>=<span class="string">&quot;SIMPLE&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå®ƒå†³å®šé©±åŠ¨ç­‰å¾…ä¸€ä¸ªæ•°æ®åº“å“åº”çš„æ—¶é—´ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;defaultStatementTimeout&quot;</span> <span class="attr">value</span>=<span class="string">&quot;25000&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å…è®¸åœ¨åµŒå¥—è¯­å¥ä¸­ä½¿ç”¨åˆ†é¡µï¼ˆRowBoundsï¼‰é»˜è®¤false --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;safeRowBoundsEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ˜¯å¦å¼€å¯è‡ªåŠ¨é©¼å³°å‘½åè§„åˆ™ï¼ˆcamel caseï¼‰æ˜ å°„ï¼Œå³ä»ç»å…¸æ•°æ®åº“åˆ—å A_COLUMN åˆ°ç»å…¸ Java å±æ€§å aColumn çš„ç±»ä¼¼æ˜ å°„ã€‚é»˜è®¤false --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- MyBatis åˆ©ç”¨æœ¬åœ°ç¼“å­˜æœºåˆ¶ï¼ˆLocal Cacheï¼‰é˜²æ­¢å¾ªç¯å¼•ç”¨ï¼ˆcircular referencesï¼‰å’ŒåŠ é€Ÿé‡å¤åµŒå¥—æŸ¥è¯¢ã€‚ é»˜è®¤å€¼ä¸º SESSIONï¼Œè¿™ç§æƒ…å†µä¸‹ä¼šç¼“å­˜ä¸€ä¸ªä¼šè¯ä¸­æ‰§è¡Œçš„æ‰€æœ‰æŸ¥è¯¢ã€‚ è‹¥è®¾ç½®å€¼ä¸º STATEMENTï¼Œæœ¬åœ°ä¼šè¯ä»…ç”¨åœ¨è¯­å¥æ‰§è¡Œä¸Šï¼Œå¯¹ç›¸åŒ SqlSession çš„ä¸åŒè°ƒç”¨å°†ä¸ä¼šå…±äº«æ•°æ®ã€‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;localCacheScope&quot;</span> <span class="attr">value</span>=<span class="string">&quot;SESSION&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å½“æ²¡æœ‰ä¸ºå‚æ•°æä¾›ç‰¹å®šçš„ JDBC ç±»å‹æ—¶ï¼Œä¸ºç©ºå€¼æŒ‡å®š JDBC ç±»å‹ã€‚ æŸäº›é©±åŠ¨éœ€è¦æŒ‡å®šåˆ—çš„ JDBC ç±»å‹ï¼Œå¤šæ•°æƒ…å†µç›´æ¥ç”¨ä¸€èˆ¬ç±»å‹å³å¯ï¼Œæ¯”å¦‚ NULLã€VARCHAR æˆ– OTHERã€‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;jdbcTypeForNull&quot;</span> <span class="attr">value</span>=<span class="string">&quot;OTHER&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šå¯¹è±¡çš„å“ªä¸ªæ–¹æ³•è§¦å‘ä¸€æ¬¡å»¶è¿ŸåŠ è½½ã€‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadTriggerMethods&quot;</span> <span class="attr">value</span>=<span class="string">&quot;equals,clone,hashCode ,toString&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- CGLIB | JAVASSIST é»˜è®¤JAVASSIST(MyBatis 3.3 or above) --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®š Mybatis åˆ›å»ºå…·æœ‰å»¶è¿ŸåŠ è½½èƒ½åŠ›çš„å¯¹è±¡æ‰€ç”¨åˆ°çš„ä»£ç†å·¥å…·ã€‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;proxyFactory&quot;</span> <span class="attr">value</span>=<span class="string">&quot;JAVASSIST&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å½“å¯ç”¨æ—¶ï¼Œå¯¹ä»»æ„å»¶è¿Ÿå±æ€§çš„è°ƒç”¨ä¼šä½¿å¸¦æœ‰å»¶è¿ŸåŠ è½½å±æ€§çš„å¯¹è±¡å®Œæ•´åŠ è½½ï¼›åä¹‹ï¼Œæ¯ç§å±æ€§å°†ä¼šæŒ‰éœ€åŠ è½½ã€‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;aggressiveLazyLoading&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®š MyBatis æ‰€ç”¨æ—¥å¿—çš„å…·ä½“å®ç°ï¼ŒæœªæŒ‡å®šæ—¶å°†è‡ªåŠ¨æŸ¥æ‰¾ã€‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;LOG4J &quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®š MyBatis å¢åŠ åˆ°æ—¥å¿—åç§°çš„å‰ç¼€ã€‚å€¼å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸² --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logPrefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;LOG4J &quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šå½“ç»“æœé›†ä¸­å€¼ä¸º null çš„æ—¶å€™æ˜¯å¦è°ƒç”¨æ˜ å°„å¯¹è±¡çš„ setterï¼ˆmap å¯¹è±¡æ—¶ä¸º putï¼‰æ–¹æ³•ï¼Œè¿™å¯¹äºæœ‰ Map.keySet() ä¾èµ–æˆ– null å€¼åˆå§‹åŒ–çš„æ—¶å€™æ˜¯æœ‰ç”¨çš„ã€‚æ³¨æ„åŸºæœ¬ç±»å‹ï¼ˆintã€booleanç­‰ï¼‰æ˜¯ä¸èƒ½è®¾ç½®æˆ null çš„ã€‚ é»˜è®¤false--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;callSettersOnNulls&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false &quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-1-8-mappers"><a href="#2-1-8-mappers" class="headerlink" title="2.1.8 mappers"></a>2.1.8 mappers</h4><p> Mapperæ–‡ä»¶ä¸­åŒ…å«äº†è¦æ‰§è¡Œçš„SQLè¯­å¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨mybatis-config.xmlæ–‡ä»¶ä¸­é…ç½®Mapperæ–‡ä»¶çš„ä½ç½®ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/briup/mappers/StudentMapper.xml&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">url</span>=<span class="string">&quot;file:///D:/mybatisdemo/app/mappers/StudentMapper.xml&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.dao.StudentMapper&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.briup.mappers&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šæ¯ä¸€ä¸ª&lt;mapper&gt; æ ‡ç­¾éƒ½å¯ä»¥ä»ä¸åŒç±»å‹çš„èµ„æºä¸­åŠ è½½æ˜ å°„mapperï¼š</p>
<ul>
<li>resourceå±æ€§ç”¨æ¥æŒ‡å®šåœ¨classpathä¸­çš„mapperæ–‡ä»¶ã€‚</li>
<li>urlå±æ€§ç”¨æ¥é€šè¿‡å®Œå…¨æ–‡ä»¶ç³»ç»Ÿè·¯å¾„æˆ–è€…web URLåœ°å€æ¥æŒ‡å‘mapperæ–‡ä»¶ </li>
<li>classå±æ€§ç”¨æ¥æŒ‡å‘ä¸€ä¸ªmapperæ¥å£<ul>
<li>éœ€è¦æ³¨è§£sql</li>
<li>æˆ–è€…æ³•è¦æ±‚ mapper æ¥å£åç§°å’Œ mapper æ˜ å°„æ–‡ä»¶åç§°ç›¸åŒï¼Œä¸”æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸­ã€‚</li>
</ul>
</li>
<li>packageå±æ€§ç”¨æ¥æŒ‡å‘å¯ä»¥æ‰¾åˆ°Mapperæ¥å£çš„åŒ…å (éœ€è¦æ³¨è§£sql)<ul>
<li>éœ€è¦æ³¨è§£sql</li>
<li>æˆ–è€…æ³•è¦æ±‚ mapper æ¥å£åç§°å’Œ mapper æ˜ å°„æ–‡ä»¶åç§°ç›¸åŒï¼Œä¸”æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸­ã€‚</li>
</ul>
</li>
</ul>
<h3 id="2-2-æ—¥å¿—é…ç½®"><a href="#2-2-æ—¥å¿—é…ç½®" class="headerlink" title="2.2 æ—¥å¿—é…ç½®"></a>2.2 æ—¥å¿—é…ç½®</h3><p>Mybatis é€šè¿‡ä½¿ç”¨å†…ç½®çš„æ—¥å¿—å·¥å‚æä¾›æ—¥å¿—åŠŸèƒ½ã€‚å†…ç½®æ—¥å¿—å·¥å‚å°†ä¼šæŠŠæ—¥å¿—å·¥ä½œå§”æ‰˜ç»™ä¸‹é¢çš„å®ç°ä¹‹ä¸€ï¼š</p>
<ul>
<li><strong>SLF4J</strong></li>
<li><strong>Apache Commons Logging</strong></li>
<li><strong>Log4j 2</strong></li>
<li><strong>Log4j</strong></li>
<li><strong>JDK logging</strong></li>
</ul>
<p>MyBatis å†…ç½®æ—¥å¿—å·¥å‚ä¼šåŸºäºè¿è¡Œæ—¶æ£€æµ‹ä¿¡æ¯é€‰æ‹©æ—¥å¿—å§”æ‰˜å®ç°ã€‚å®ƒä¼šï¼ˆæŒ‰ä¸Šé¢ç½—åˆ—çš„é¡ºåºï¼‰ä½¿ç”¨ç¬¬ä¸€ä¸ªæŸ¥æ‰¾åˆ°çš„å®ç°ã€‚å½“æ²¡æœ‰æ‰¾åˆ°è¿™äº›å®ç°æ—¶ï¼Œå°†ä¼šç¦ç”¨æ—¥å¿—åŠŸèƒ½ã€‚</p>
<p>å¦‚æœæƒ³ä½¿ç”¨æŒ‡å®šçš„æ—¥å¿—å®ç°ï¼Œå¯ä»¥é€šè¿‡åœ¨ MyBatis é…ç½®æ–‡ä»¶ mybatis-config.xml é‡Œé¢æ·»åŠ ä¸€é¡¹ setting æ¥é€‰æ‹©å…¶å®ƒæ—¥å¿—å®ç°ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;LOG4J&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯é€‰çš„å€¼æœ‰ï¼šSLF4Jã€LOG4Jã€LOG4J2ã€JDK_LOGGINGã€COMMONS_LOGGINGã€STDOUT_LOGGINGã€NO_LOGGINGï¼Œæˆ–è€…æ˜¯å®ç°äº† <code>org.apache.ibatis.logging.Log</code> æ¥å£ï¼Œä¸”æ„é€ æ–¹æ³•ä»¥å­—ç¬¦ä¸²ä¸ºå‚æ•°çš„ç±»çš„å®Œå…¨é™å®šåã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥è°ƒç”¨ä»¥ä¸‹ä»»ä¸€æ–¹æ³•æ¥é€‰æ‹©æ—¥å¿—å®ç°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">org.apache.ibatis.logging.LogFactory.useSlf4jLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useLog4JLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useJdkLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useCommonsLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useStdOutLogging();</span><br></pre></td></tr></table></figure>

<p>ä½ åº”è¯¥åœ¨è°ƒç”¨å…¶å®ƒ MyBatis æ–¹æ³•ä¹‹å‰è°ƒç”¨ä»¥ä¸Šçš„æŸä¸ªæ–¹æ³•ã€‚å¦å¤–ï¼Œä»…å½“è¿è¡Œæ—¶ç±»è·¯å¾„ä¸­å­˜åœ¨è¯¥æ—¥å¿—å®ç°æ—¶ï¼Œæ—¥å¿—å®ç°çš„åˆ‡æ¢æ‰ä¼šç”Ÿæ•ˆã€‚</p>
<p>å…³äº SLF4Jã€Apache Commons Loggingã€Apache Log4J å’Œ JDK Logging çš„æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹é“¾æ¥ï¼š</p>
<ul>
<li><a href="http://www.slf4j.org/">SLF4J</a></li>
<li><a href="http://commons.apache.org/logging">Apache Commons Logging</a></li>
<li><a href="http://logging.apache.org/log4j/">Apache Log4j 1.x and 2.x</a></li>
<li><a href="http://java.sun.com/j2se/1.4.1/docs/guide/util/logging/">JDK Logging API</a></li>
</ul>
<h4 id="2-2-1-æ·»åŠ -jar-åŒ…"><a href="#2-2-1-æ·»åŠ -jar-åŒ…" class="headerlink" title="2.2.1 æ·»åŠ   jar åŒ…"></a>2.2.1 æ·»åŠ   jar åŒ…</h4><p>ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Log4Jï¼Œæˆ‘ä»¬è¦ç¡®ä¿å®ƒçš„ jar åŒ…å¯ä»¥è¢«åº”ç”¨ä½¿ç”¨ã€‚ä¸ºæ­¤ï¼Œéœ€è¦å°† jar åŒ…æ·»åŠ åˆ°åº”ç”¨çš„ç±»è·¯å¾„ä¸­ã€‚Log4J çš„ jar åŒ…å¯ä»¥åœ¨ä¸Šé¢çš„é“¾æ¥ä¸­ä¸‹è½½ã€‚</p>
<p>å¯¹äº web åº”ç”¨å¯ä»¥å°† <code>log4j.jar</code> æ·»åŠ åˆ° <code>WEB-INF/lib</code> ç›®å½•ä¸‹</p>
<h4 id="2-2-2-é…ç½®-Log4J"><a href="#2-2-2-é…ç½®-Log4J" class="headerlink" title="2.2.2 é…ç½® Log4J"></a>2.2.2 é…ç½® Log4J</h4><p>åœ¨åº”ç”¨çš„ç±»è·¯å¾„ä¸­ï¼ˆä¾‹å¦‚srcï¼‰åˆ›å»ºä¸€ä¸ªåä¸º <code>log4j.properties</code> çš„æ–‡ä»¶ï¼Œæ–‡ä»¶çš„å…·ä½“å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG, stdout </span></span><br><span class="line"><span class="meta">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender </span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.PatternLayout </span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%d [%-5p] %c - %m%n</span></span><br><span class="line"><span class="comment">#show sql</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.ResultSet</span>=<span class="string">INFO  </span></span><br><span class="line"><span class="meta">log4j.logger.org.apache</span>=<span class="string">INFO  </span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.Connection</span>=<span class="string">DEBUG  </span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.Statement</span>=<span class="string">DEBUG  </span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.PreparedStatement</span>=<span class="string">DEBUG </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ­¤æ—¶è¿è¡Œmybatisç¨‹åºåï¼Œå°±ä¼šæœ‰å¯¹åº”çš„æ—¥å¿—è¾“å‡ºäº†</p>
</blockquote>
<h3 id="2-3-åŸºæœ¬å°è£…"><a href="#2-3-åŸºæœ¬å°è£…" class="headerlink" title="2.3 åŸºæœ¬å°è£…"></a>2.3 åŸºæœ¬å°è£…</h3><p>æ¯æ¬¡è¯»å–é…ç½®æ–‡ä»¶,äº§ç”Ÿä¸€ä¸ªå·¥å‚å¯¹è±¡SqlSessionFactory,ç„¶åå†ç”Ÿæˆå‡ºSqlSessionå¯¹è±¡,è¿™ä¸ªè¿‡ç¨‹è™½ç„¶å¹¶ä¸å¤æ‚,ä½†æ˜¯ä¹Ÿéƒ½æ˜¯ä¸€äº›é‡å¤çš„ä»£ç æµç¨‹,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œä¸€ä¸ªç®€å•çš„å°è£…ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: vanse</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/9/5-09-05-6:04</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>ï¼šcom.briup.utils</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>ï¼š1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SqlSessionUtil</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SqlSessionUtil</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory <span class="title">getSqlSessionFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (SqlSessionUtil.class)&#123;</span><br><span class="line">                <span class="keyword">if</span> (sqlSessionFactory == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    InputStream in = Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">                    sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactory;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">openSqlSession</span><span class="params">(<span class="keyword">boolean</span> autoCommint)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getSqlSessionFactory().openSession(autoCommint);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">openSqlSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> openSqlSession(<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="ç¬¬äºŒç« -æ˜ å°„"><a href="#ç¬¬äºŒç« -æ˜ å°„" class="headerlink" title="ç¬¬äºŒç« -æ˜ å°„"></a>ç¬¬äºŒç« -æ˜ å°„</h1><h2 id="1-æ˜ å°„"><a href="#1-æ˜ å°„" class="headerlink" title="1.æ˜ å°„"></a>1.æ˜ å°„</h2><p>å…³ç³»å‹æ•°æ®åº“å’ŒSQLæ˜¯ç»å—æ—¶é—´è€ƒéªŒå’ŒéªŒè¯çš„æ•°æ®å­˜å‚¨æœºåˆ¶ã€‚å’Œå…¶ä»–çš„<code>ORM</code> æ¡†æ¶å¦‚Hibernateä¸åŒï¼ŒMyBatisé¼“åŠ±å¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨æ•°æ®åº“ï¼Œè€Œä¸æ˜¯å°†å…¶å¯¹å¼€å‘è€…éšè—ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥å……åˆ†å‘æŒ¥æ•°æ®åº“æœåŠ¡å™¨æ‰€æä¾›çš„SQLè¯­å¥çš„å·¨å¤§å¨åŠ›ã€‚</p>
<p>ä¸æ­¤åŒæ—¶ï¼ŒMyBaitsæ¶ˆé™¤äº†ä¹¦å†™å¤§é‡å†—ä½™ä»£ç çš„ç—›è‹¦ï¼Œå®ƒè®©ä½¿ç”¨SQLæ›´å®¹æ˜“ã€‚åœ¨ä»£ç é‡Œç›´æ¥åµŒå¥—SQLè¯­å¥æ˜¯å¾ˆå·®çš„ç¼–ç å®è·µï¼Œå¹¶ä¸”ç»´æŠ¤èµ·æ¥å›°éš¾ã€‚MyBaitsä½¿ç”¨äº†æ˜ å°„æ–‡ä»¶æˆ–æ³¨è§£æ¥é…ç½®SQLè¯­å¥ã€‚</p>
<h3 id="1-1-è°ƒç”¨"><a href="#1-1-è°ƒç”¨" class="headerlink" title="1.1 è°ƒç”¨"></a>1.1 è°ƒç”¨</h3><p>æˆ‘ä»¬å·²ç»çœ‹è§äº†ä¸€äº›åœ¨æ˜ å°„å™¨é…ç½®æ–‡ä»¶ä¸­é…ç½®åŸºæœ¬çš„æ˜ å°„è¯­å¥ï¼Œä»¥åŠæ€æ ·ä½¿ç”¨SqlSessionå¯¹è±¡è°ƒç”¨å®ƒä»¬çš„ä¾‹å­ã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹åœ¨com.briup.mappersåŒ…ä¸­çš„StudentMapper.xml é…ç½®æ–‡ä»¶å†…ï¼Œæ˜¯å¦‚ä½•é…ç½®idä¸º<code>findStudentById</code>çš„SQLè¯­å¥çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace+id ä»£è¡¨å”¯ä¸€sql--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;www.baidu.com&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">       select id,name,email,phone as phoneNumber</span><br><span class="line">       from students where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼ŒStudentç±»ä¸­çš„å±æ€§åå­—å’Œæ•°æ®åº“ä¸­è¡¨ä¸­å­—æ®µçš„åå­—æ˜¯å¯ä»¥ä¸ä¸€æ ·çš„ï¼Œä¾‹å¦‚ç±»ä¸­å¯ä»¥æ˜¯studIdï¼Œè€Œè¡¨ä¸­çš„å­—æ®µåå­—ä¸ºid</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹åˆ—ä»£ç è°ƒç”¨findStudentByIdæ˜ å°„çš„SQLè¯­å¥:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Student <span class="title">findStudentById</span><span class="params">(Integer studId)</span> </span>&#123;</span><br><span class="line">		SqlSession sqlSession=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">			Student student = sqlSession.selectOne(<span class="string">&quot;www.baidu.com.findStudentById&quot;</span>, studId);</span><br><span class="line">			<span class="keyword">return</span> student;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">finally</span> &#123;</span><br><span class="line">			sqlSession.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²å½¢å¼æ¥è°ƒç”¨æ˜ å°„çš„SQLè¯­å¥ï¼Œå½¢å¼ä¸º namespace + sqlè¯­å¥idå€¼ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å®¹æ˜“å‡ºé”™ã€‚ä½ éœ€è¦æ£€æŸ¥æ˜ å°„å™¨é…ç½®æ–‡ä»¶ä¸­çš„å®šä¹‰ï¼Œä»¥ä¿è¯ä½ çš„è¾“å…¥å‚æ•°ç±»å‹å’Œç»“æœè¿”å›ç±»å‹æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼Œä½¿ç”¨è¿™ç§å­—ç¬¦ä¸²çš„å½¢å¼æ¥è°ƒç”¨sqlè¯­å¥ï¼Œå³ä½¿æ¥å£ä¸­æ²¡æœ‰å¯¹åº”çš„æ–¹æ³•ï¼Œä¹Ÿä¸ä¼šå½±å“sqlè¯­å¥çš„æ‰§è¡Œã€‚</p>
</blockquote>
<p>MyBatisé€šè¿‡ä½¿ç”¨æ˜ å°„å™¨Mapperæ¥å£ï¼Œæä¾›äº†æ›´å¥½çš„è°ƒç”¨æ˜ å°„sqlè¯­å¥çš„æ–¹å¼ã€‚</p>
<p>è¦æ±‚xmlæ˜ å°„æ–‡ä»¶ä¸­çš„namespaceå±æ€§å€¼å’Œæ˜ å°„æ¥å£çš„å…¨é™å®šåä¿æŒä¸€è‡´ï¼ŒåŒæ—¶ï¼š</p>
<ul>
<li>æ–¹æ³•åå’Œé…ç½®æ–‡ä»¶ä¸­sqlè¯­å¥çš„idå€¼ä¸€è‡´</li>
<li>æ–¹æ³•å‚æ•°ç±»å‹å’ŒparameterTypeå±æ€§å€¼ä¸€è‡´</li>
<li>æ–¹æ³•è¿”å›å€¼ç±»å‹å’ŒreturnTypeå±æ€§å€¼ä¸€è‡´</li>
</ul>
<p>ä¸Šè¿°çš„StudentMapper.xmlæ–‡ä»¶,æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ˜ å°„å™¨æ¥å£StudentMapper.javaå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span></span>&#123;</span><br><span class="line">	<span class="function">Student <span class="title">findStudentById</span><span class="params">(Integer id)</span></span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>åœ¨Student Mapper.xmlæ˜ å°„å™¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå…¶åç©ºé—´namespaceåº”è¯¥è·ŸStudentMapperæ¥å£çš„å…¨é™å®šåä¿æŒä¸€è‡´ã€‚å¦å¤–ï¼ŒStudentMapper.xmlä¸­è¯­å¥id, parameterTypeï¼ŒreturnType åº”è¯¥åˆ†åˆ«å’ŒStudentMapperæ¥å£ä¸­çš„æ–¹æ³•åï¼Œå‚æ•°ç±»å‹ï¼Œè¿”å›å€¼ç›¸å¯¹åº”ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.dao.StudentMapper&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">        select id as studId, name, email, dob</span><br><span class="line">        from students</span><br><span class="line">        where id=#&#123;studId&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="1-2-æ˜ å°„sql"><a href="#1-2-æ˜ å°„sql" class="headerlink" title="1.2 æ˜ å°„sql"></a>1.2 æ˜ å°„sql</h3><p>MyBatisæä¾›äº†å¤šç§å…ƒç´ æ¥é…ç½®ä¸åŒç±»å‹çš„è¯­å¥ï¼Œå¦‚SELECTï¼ŒINSERTï¼ŒUPDATEï¼ŒDELETEã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å…·ä½“é…ç½®æ˜ å°„è¯­å¥</p>
<h4 id="1-2-1-INSERT"><a href="#1-2-1-INSERT" class="headerlink" title="1.2.1 INSERT"></a>1.2.1 INSERT</h4><p>ä¸€ä¸ªINSERTè¯­å¥å¯ä»¥åœ¨<code>&lt;insert&gt;</code>æ ‡ç­¾å…ƒç´ åœ¨æ˜ å°„å™¨XMLé…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">    INSERT INTO</span><br><span class="line">    STUDENTS(ID,NAME,EMAIL,PHONE)</span><br><span class="line">    VALUES(#&#123;id&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;phone&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>ç†è§£</strong></p>
<ul>
<li>parameterType<ul>
<li>ä»£è¡¨å‚æ•°çš„ç±»å‹ï¼Œå› ä¸ºæˆ‘ä»¬è¦ä¼ å…¥çš„æ˜¯ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼Œæ‰€ä»¥ç±»å‹å°±å†™ç±»çš„å…¨åç§°(æˆ–è€…åˆ«å)ã€‚</li>
</ul>
</li>
<li><code>#&#123;&#125;</code><ul>
<li>å®ƒä»£è¡¨å ä½ç¬¦ï¼Œç›¸å½“äºåŸæ¥ jdbc éƒ¨åˆ†æ‰€å­¦çš„?ï¼Œéƒ½æ˜¯ç”¨äºæ‰§è¡Œè¯­å¥æ—¶æ›¿æ¢å®é™…çš„æ•°æ®ã€‚ å…·ä½“çš„æ•°æ®æ˜¯ç”±#{}é‡Œé¢çš„å†…å®¹å†³å®šçš„ã€‚</li>
</ul>
</li>
<li>ognlè¡¨è¾¾å¼<ul>
<li>Object Graphic Navigation Language å¯¹è±¡å›¾å¯¼èˆªè¯­è¨€ </li>
<li>å®ƒæ˜¯æŒ‰ç…§ä¸€å®šçš„è¯­æ³•æ ¼å¼æ¥è·å–æ•°æ®çš„ã€‚</li>
<li>è¯­æ³•æ ¼å¼å°±æ˜¯ä½¿ç”¨ #{å¯¹è±¡.å¯¹è±¡}çš„æ–¹å¼</li>
</ul>
</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥å¦‚ä¸‹è°ƒç”¨è¿™ä¸ªè¯­å¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> count = sqlSession.insert(<span class="string">&quot;com.briup.dao.StudentMapper.insertStudent&quot;</span>, student);</span><br><span class="line"><span class="comment">//sqlSession.insert() è¿”å›æ‰§è¡Œ INSERT è¯­å¥åæ‰€å½±å“çš„è¡Œæ•°ã€‚</span></span><br></pre></td></tr></table></figure>



<p>æˆ–è€…ä½¿ç”¨æ˜ å°„æ¥å£Mapperæ¥è°ƒç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span></span>&#123;</span><br><span class="line">	<span class="function">Student <span class="title">findStudentById</span><span class="params">(Integer id)</span></span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line"><span class="keyword">int</span> count = mapper.insertStudent(student); </span><br></pre></td></tr></table></figure>



<p><strong>ç‰¹åˆ«æ³¨æ„</strong>ï¼Œæœ‰äº›ç‰ˆæœ¬çš„mybatisä¸­ï¼Œå¦‚æœæ’å…¥çš„å¯¹è±¡ä¸­æŸä¸€ä¸ªå±æ€§ä¸º<strong>null</strong>ï¼Œé‚£ä¹ˆè¿™æ—¶å€™è¿è¡Œä¼šæŠ¥é”™ï¼šï¼ˆæ— æ•ˆçš„åˆ—ç±»å‹ï¼‰ï¼ŒåŸå› æ˜¯nullåœ¨mybaitsçš„JdbcTypeä¸­æ²¡æœ‰å¯¹åº”çš„ç±»å‹</p>
<ul>
<li><p>è§£å†³æ–¹å¼1ï¼Œå¯ä»¥åœ¨insertè¯­å¥ä¸­æŒ‡å®šå‚æ•°çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#&#123;phone&#125; </span><br><span class="line">ä¿®æ”¹ä¸º </span><br><span class="line">#&#123;phone,jdbcType=VARCHAR&#125; </span><br></pre></td></tr></table></figure></li>
<li><p>è§£å†³æ–¹å¼2ï¼Œå¯ä»¥åœ¨settingæ–‡ä»¶ä¸­è¿›è¡Œç»Ÿä¸€çš„å…¨å±€è®¾ç½®ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;setting name=&quot;jdbcTypeForNull&quot; value=&quot;NULL&quot; /&gt;</span><br><span class="line">æˆ–è€…</span><br><span class="line">&lt;setting name=&quot;jdbcTypeForNull&quot; value=&quot;VARCHAR&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p>â€‹            </p>
</li>
</ul>
<p>è‡ªåŠ¨ç”Ÿæˆä¸»é”®:</p>
<p>åœ¨ä¸Šè¿°çš„INSERTè¯­å¥ä¸­ï¼Œæˆ‘ä»¬ä¸ºå¯ä»¥è‡ªåŠ¨ç”Ÿæˆï¼ˆauto-generatedï¼‰ä¸»é”®çš„åˆ— ID æ’å…¥å€¼ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨useGeneratedKeyså’ŒkeyPropertyå±æ€§è®©æ•°æ®åº“ç”Ÿæˆauto_incrementåˆ—çš„å€¼ï¼Œå¹¶å°†ç”Ÿæˆçš„å€¼è®¾ç½®åˆ°å…¶ä¸­ä¸€ä¸ªè¾“å…¥å¯¹è±¡å±æ€§å†…ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Student&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;studId&quot;</span>&gt;</span></span><br><span class="line">    INSERT INTO STUDENTS(NAME, EMAIL, PHONE)</span><br><span class="line">    VALUES(#&#123;name&#125;,#&#123;email&#125;,#&#123;phone&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æˆ–è€…ä½¿ç”¨mysqlçš„å†…ç½®æ–¹æ³•</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®ä¿å­˜æ—¶è·å–æ’å…¥çš„ id --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyColumn</span>=<span class="string">&quot;id&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">	select last_insert_id();</span><br><span class="line"><span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>è¿™é‡ŒIDåˆ—å€¼å°†ä¼šè¢«æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆ(å¦‚mysql)ï¼Œå¹¶ä¸”ç”Ÿæˆçš„å€¼ä¼šè¢«è®¾ç½®åˆ°studentå¯¹è±¡çš„studIdå±æ€§ä¸Šã€‚</p>
<p>ä½†æ˜¯æœ‰äº›æ•°æ®åº“å¦‚Oracleå¹¶ä¸æ”¯æŒAUTO_INCREMENTåˆ—ï¼Œå…¶ä½¿ç”¨åºåˆ—ï¼ˆSEQUENCEï¼‰æ¥ç”Ÿæˆä¸»é”®å€¼ã€‚    </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> sequence my_seq;</span><br><span class="line"><span class="keyword">create</span> sequence my_seq;</span><br></pre></td></tr></table></figure>



<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†<code>&lt;selectKey&gt;</code>å­å…ƒç´ æ¥ç”Ÿæˆä¸»é”®å€¼ï¼Œå¹¶å°†å€¼ä¿å­˜åˆ°Studentå¯¹è±¡çš„studId å±æ€§ä¸Šã€‚å±æ€§order=â€beforeâ€è¡¨ç¤ºMyBatiså°†å–å¾—åºåˆ—çš„ä¸‹ä¸€ä¸ªå€¼ä½œä¸ºä¸»é”®å€¼ï¼Œå¹¶ä¸”åœ¨æ‰§è¡ŒINSERTè¯­å¥ä¹‹å‰å°†å€¼è®¾ç½®åˆ°studIdå±æ€§ä¸Šã€‚(ç¨‹åºä¸­çš„studentå¯¹è±¡çš„studIdå±æ€§)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">&quot;studId&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">order</span>=<span class="string">&quot;BEFORE&quot;</span>&gt;</span></span><br><span class="line">        SELECT my_seq.nextval FROM DUAL</span><br><span class="line">    <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">    INSERT INTO STUDENTS(ID,NAME,EMAIL, PHONE)</span><br><span class="line">    VALUES(#&#123;studId&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;phone&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼ŒSelectKeyéœ€è¦æ³¨æ„orderå±æ€§ï¼ŒåƒMySQLã€SQLServerç­‰ä¸€ç±»æ”¯æŒè‡ªåŠ¨å¢é•¿ç±»å‹çš„æ•°æ®åº“ä¸­ï¼Œorderéœ€è¦è®¾ç½®ä¸ºafteræ‰ä¼šå–åˆ°æ­£ç¡®çš„å€¼ï¼Œè€ŒOracleè¿™æ ·å–åºåˆ—çš„æƒ…å†µï¼Œéœ€è¦è®¾ç½®ä¸ºbefore</p>
</blockquote>
<h4 id="1-2-2-UPDATE"><a href="#1-2-2-UPDATE" class="headerlink" title="1.2.2 UPDATE"></a>1.2.2 UPDATE</h4><p>ä¸€ä¸ªUPDATE SQLè¯­å¥å¯ä»¥åœ¨<code>&lt;update&gt;</code>å…ƒç´ åœ¨æ˜ å°„å™¨XMLé…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">    UPDATE STUDENTS SET</span><br><span class="line">    NAME=#&#123;name&#125;, EMAIL=#&#123;email&#125;, PHONE=#&#123;phone&#125;</span><br><span class="line">    WHERE ID=#&#123;studId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å¦‚ä¸‹è°ƒç”¨è¿™ä¸ªsqlè¯­å¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> updateCount = sqlSession.update(<span class="string">&quot;com.briup.dao.StudentMapper.updateStudent&quot;</span>, student);</span><br><span class="line"><span class="comment">//sqlSession.update();è¿”å›æ‰§è¡ŒUPDATEè¯­å¥ä¹‹åå½±å“çš„è¡Œæ•°ã€‚</span></span><br></pre></td></tr></table></figure>



<p>æˆ–è€…ä½¿ç”¨æ˜ å°„æ¥å£Mapperæ¥è°ƒç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">updateStudent</span><span class="params">(Student student)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line"><span class="keyword">int</span> updateCount = mapper.updateStudent(student);</span><br></pre></td></tr></table></figure>



<h4 id="1-2-3-DELETE"><a href="#1-2-3-DELETE" class="headerlink" title="1.2.3 DELETE"></a>1.2.3 DELETE</h4><p>ä¸€ä¸ªDELETEè¯­å¥å¯ä»¥åœ¨<code>&lt;delete&gt;</code>æ ‡ç­¾å…ƒç´ ä¸­è¿›è¡Œé…ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    DELETE FROM STUDENTS</span><br><span class="line">    WHERE ID=#&#123;studId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å¦‚ä¸‹è°ƒç”¨è¿™ä¸ªsqlè¯­å¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">SqlSession sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"><span class="keyword">int</span> studId = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> deleteCount = sqlSession.delete(<span class="string">&quot;com.briup.dao.StudentMapper.deleteStudent&quot;</span>, studId);</span><br><span class="line"><span class="comment">//sqlSession.delete()è¿”å› delete è¯­å¥æ‰§è¡Œåå½±å“çš„è¡Œæ•°ã€‚</span></span><br></pre></td></tr></table></figure>



<p>æˆ–è€…ä½¿ç”¨æ˜ å°„æ¥å£Mapperæ¥è°ƒç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">deleteStudent</span><span class="params">(<span class="keyword">int</span> studId)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line"><span class="keyword">int</span> deleteCount = mapper.deleteStudent(studId);</span><br></pre></td></tr></table></figure>



<h4 id="1-2-4-SELECT"><a href="#1-2-4-SELECT" class="headerlink" title="1.2.4 SELECT"></a>1.2.4 SELECT</h4><blockquote>
<p>MyBatisçœŸæ­£å¼ºå¤§çš„åŠŸèƒ½ï¼Œåœ¨äºæ˜ å°„SELECTæŸ¥è¯¢ç»“æœåˆ°javaçš„å„ç§ç±»å‹</p>
</blockquote>
<p>ä¸€ä¸ªç®€å•çš„selectæŸ¥è¯¢é…ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">    SELECT ID, NAME, EMAIL, PHONE</span><br><span class="line">    FROM STUDENTS</span><br><span class="line">    WHERE ID=#&#123;studId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å¦‚ä¸‹è°ƒç”¨è¿™ä¸ªsqlè¯­å¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Student student = sqlSession.selectOne(<span class="string">&quot;com.briup.dao.StudentMapper.findStudentById&quot;</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>



<p>æˆ–è€…ä½¿ç”¨æ˜ å°„æ¥å£Mapperæ¥è°ƒç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span></span>&#123;</span><br><span class="line">	<span class="function">Student <span class="title">findStudentById</span><span class="params">(Integer studId)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class); </span><br><span class="line">Student student = mapper.findStudentById(studId); </span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶å€™Studentå¯¹è±¡çš„studIdå±æ€§å€¼ä¸ºç©ºï¼Œä½†æ˜¯å…¶ä»–å±æ€§çš„å€¼éƒ½æœ‰ï¼Œå› ä¸ºæ•°æ®åº“è¡¨ä¸­çš„å­—æ®µä¸ºid,ç±»ä¸­å±æ€§åä¸ºstudIdï¼Œæ‰€ä»¥æ²¡æœ‰è‡ªåŠ¨æŠŠå€¼å°è£…è¿›æ¥ã€‚</p>
<p>è¿™æ—¶ç»™stud_idåˆ—èµ·ä¸€ä¸ªåˆ«åä¸ºstudIdï¼Œå’Œç±»ä¸­å±æ€§åä¿æŒä¸€è‡´å³å¯ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">		SELECT ID AS studId, NAME,EMAIL, PHONE FROM STUDENTS</span><br><span class="line">		WHERE ID=#&#123;studId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>MyBatisæ‰§è¡Œè¿”å›å¤šæ¡ç»“æœçš„SELECTè¯­å¥æŸ¥è¯¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAllStudents&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">		SELECT ID AS studId, NAME,EMAIL, PHONE</span><br><span class="line">		FROM STUDENTS</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å¦‚ä¸‹è°ƒç”¨è¿™ä¸ªsqlè¯­å¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;Student&gt; students =  </span><br><span class="line">		sqlSession.selectList(<span class="string">&quot;com.briup.dao.StudentMapper.findAllStudents&quot;</span>); </span><br></pre></td></tr></table></figure>



<p>æˆ–è€…ä½¿ç”¨æ˜ å°„æ¥å£Mapperæ¥è°ƒç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span></span>&#123;</span><br><span class="line">	<span class="function">List&lt;Student&gt; <span class="title">findAllStudents</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line">List&lt;Student&gt; students = mapper.findAllStudents();</span><br></pre></td></tr></table></figure>



<p>é™¤äº†Listé›†åˆç±»å‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ç±»å‹çš„ é›†åˆï¼Œå¦‚Set,Mapç­‰ã€‚</p>
<p>MyBatisä¼šæ ¹æ®é›†åˆçš„ç±»å‹ï¼Œé‡‡ç”¨é€‚å½“çš„é›†åˆå®ç°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li><p>å¯¹äºListï¼ŒCollectionï¼ŒIterableç±»å‹ï¼ŒMyBatiså°†è¿”å›java.util.ArrayList</p>
</li>
<li><p>å¯¹äºMapç±»å‹ï¼ŒMyBatis å°†è¿”å›java.util.HashMap</p>
</li>
<li><p>å¯¹äºSetç±»å‹ï¼ŒMyBatis å°†è¿”å›java.util.HashSet</p>
</li>
<li><p>å¯¹äºSortedSetç±»å‹ï¼ŒMyBatiså°†è¿”å›java.util.TreeSet</p>
</li>
</ul>
<p>ä¾‹å¦‚1ï¼ŒæŸ¥è¯¢ã€ä¸€æ¡ã€‘æ•°æ®å¡«å……åˆ°Mapä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">	SELECT * FROM STUDENTS WHERE ID=#&#123;studId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç»“æœé›†çš„åˆ—åå°†ä¼šä½œä¸ºMapä¸­çš„keyå€¼ï¼Œè€Œåˆ—å€¼å°†ä½œä¸ºMapçš„valueå€¼ã€‚ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">HashMap&lt;String,Object&gt; studentMap = sqlSession.selectOne(<span class="string">&quot;com.briup.dao.StudentMapper.findStudentById&quot;</span>, studId);</span><br><span class="line">System.out.println(<span class="string">&quot;studId :&quot;</span> + studentMap.get(<span class="string">&quot;ID&quot;</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;name :&quot;</span> + studentMap.get(<span class="string">&quot;NAME&quot;</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;email :&quot;</span> + studentMap.get(<span class="string">&quot;EMAIL&quot;</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;phone :&quot;</span> + studentMap.get(<span class="string">&quot;PHONE&quot;</span>));</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨çš„selectOneæ–¹æ³•ï¼Œå¹¶ä¸”è¡¨ä¸­çš„å­—æ®µåé»˜è®¤æ˜¯å¤§å†™</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥åƒä¹‹å‰ä¸€æ ·ï¼Œä½¿ç”¨æ˜ å°„æ¥å£çš„æ–¹å¼æ¥è°ƒç”¨</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">Map&lt;String,Object&gt; <span class="title">findStudentById</span><span class="params">(Integer studId)</span></span>; </span><br></pre></td></tr></table></figure>





<p>ä¾‹å¦‚2ï¼Œ æŸ¥è¯¢ã€å¤šæ¡ã€‘æ•°æ®å¡«å……åˆ°Mapä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAllStudents&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">	SELECT ID, NAME, EMAIL, PHONE FROM STUDENTS</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€ç»ˆè¿”å›çš„æ•°æ®ç±»å‹æ˜¯List&lt;Map&lt;String,Object&gt;&gt;ï¼Œå¦‚ä¸‹æ‰€æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;Map&lt;String, Object&gt;&gt; studentMapList = sqlSession.selectList(<span class="string">&quot;com.briup.dao.StudentMapper.findAllStudents&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(Map&lt;String, Object&gt; studentMap : studentMapList) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;studId :&quot;</span> + studentMap.get(<span class="string">&quot;ID&quot;</span>));</span><br><span class="line">    System.out.println(<span class="string">&quot;name :&quot;</span> + studentMap.get(<span class="string">&quot;NAME&quot;</span>));</span><br><span class="line">    System.out.println(<span class="string">&quot;email :&quot;</span> + studentMap.get(<span class="string">&quot;EMAIL&quot;</span>));</span><br><span class="line">    System.out.println(<span class="string">&quot;phone :&quot;</span> + studentMap.get(<span class="string">&quot;PHONE&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨çš„selectListæ–¹æ³•ï¼Œå¹¶ä¸”è¡¨ä¸­çš„å­—æ®µåé»˜è®¤æ˜¯å¤§å†™</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥åƒä¹‹å‰ä¸€æ ·ï¼Œä½¿ç”¨æ˜ å°„æ¥å£çš„æ–¹å¼æ¥è°ƒç”¨</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;Map&lt;String,Object&gt;&gt; findAllStudents(); </span><br></pre></td></tr></table></figure>





<p>ä¾‹å¦‚3ï¼ŒæŸ¥è¯¢åˆ°æ‰€æœ‰åå­—éƒ½æ”¾åˆ°Listé›†åˆä¸­å¹¶è¿”å›</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;select id=&quot;findAllName_list&quot; resultType=&quot;String&quot;&gt;</span><br><span class="line">	SELECT NAME FROM STUDENTS</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<p>å¯¹åº”çš„æ˜ å°„æ¥å£ä¸­çš„æ–¹æ³•ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">findAllName_list</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚4ï¼ŒæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®çš„æ¡æ•°</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findCount_int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    SELECT count(*) FROM STUDENTS</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯¹åº”çš„æ˜ å°„æ¥å£ä¸­çš„æ–¹æ³•ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findCount_int</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>



<h3 id="1-3-ResultMap"><a href="#1-3-ResultMap" class="headerlink" title="1.3 ResultMap"></a>1.3 ResultMap</h3><p>ResultMapè¢«ç”¨æ¥å°†SELECTè¯­å¥çš„ç»“æœé›†æ˜ å°„åˆ°javaå¯¹è±¡å±æ€§ä¸­ã€‚</p>
<p>åœ¨æ˜ å°„æ–‡ä»¶ä¸­ï¼Œå¯ä»¥å…ˆå®šä¹‰å‡ºç»“æœé›†æ˜ å°„resultMapï¼Œç„¶ååœ¨ä¸€äº›SELECTè¯­å¥ä¸Šå¼•ç”¨è¿™ä¸ªresultMapã€‚</p>
<p>æ‰€ä»¥ï¼ŒResultMapå°±æ˜¯æå‰å®šä¹‰å¥½çš„ä¸€ä¸ªæ˜ å°„è§„åˆ™ï¼Œselectè¯­å¥å¯ä»¥ä½¿ç”¨ResultMapçš„æ˜ å°„è§„åˆ™æ¥å¤„ç†æŸ¥è¯¢ç»“æœã€‚</p>
<p>MyBatisçš„ç»“æœé›†æ˜ å°„resultMapéå¸¸å¼ºå¤§ï¼Œå¯ä»¥ä½¿ç”¨å®ƒæŒ‡å®šsqlæŸ¥è¯¢å‡ºçš„ç»“æœé›†ï¼Œä¼šè¢«æ€ä¹ˆå¤„ç†å¹¶å°è£…æˆå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒå®Œæˆå¤æ‚æŸ¥è¯¢çš„æ˜ å°„ï¼Œä¾‹å¦‚ä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šå…³ç³»çš„SELECTè¯­å¥ã€‚</p>
<h4 id="1-3-1-ç®€å•ResultMap"><a href="#1-3-1-ç®€å•ResultMap" class="headerlink" title="1.3.1 ç®€å•ResultMap"></a>1.3.1 ç®€å•ResultMap</h4><p>å®šä¹‰ä¸€ä¸ªresultMapï¼Œå®ƒçš„idå€¼æ˜¯å”¯ä¸€çš„ï¼Œå¹¶ä¸”typeå±æ€§æ˜¯å…¨é™å®šç±»åæˆ–è€…æ˜¯ç±»å‹çš„åˆ«åã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;StudentResult&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.briup.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;dob&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dob&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;phoneNumber&quot;</span> <span class="attr">column</span>=<span class="string">&quot;phone&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;resultMap&gt;</code>æœ‰ä¿©ä¸ªå­å…ƒç´ ï¼š</p>
<ul>
<li><code>&lt;result&gt;</code>ï¼Œç”¨æ¥å°†æŸ¥è¯¢çš„æ•°æ®ä¸­ä¸€ä¸ªæŒ‡å®šç±»åˆ—çš„å€¼æ˜ å°„åˆ°å¯¹è±¡æŒ‡å®šçš„å±æ€§ä¸­</li>
<li><code>&lt;id&gt;</code>ï¼Œå’Œ<code>&lt;result&gt;</code>æ ‡ç­¾åŠŸèƒ½ç›¸åŒï¼Œä½†æ˜¯<code>&lt;id&gt;</code>ç”¨æ¥æ˜ å°„çš„æ˜¯è¡¨ä¸­çš„ä¸»é”®</li>
</ul>
<p>åœ¨selectè¯­å¥ä¸­ï¼Œå¼•ç”¨è¿™ä¸ªresultMapï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span></span><br><span class="line">		SELECT * FROM STUDENTS WHERE STUD_ID=#&#123;studId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAllStudents&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span></span><br><span class="line">		SELECT * FROM STUDENTS</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li><p>åœ¨<code>&lt;select&gt;</code>è¯­å¥ä¸­ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯resultMapå±æ€§ï¼Œè€Œä¸æ˜¯resultTypeå±æ€§</p>
</li>
<li><p>resultTypeå±æ€§ä¸­ä¸€èˆ¬æ˜¯å†™ä¸€ä¸ªç±»å‹çš„å…¨é™å®šåæˆ–è€…åˆ«åï¼Œè¡¨ç¤ºå­—æ®µå’Œå±æ€§åå®Œå…¨ä¸€è‡´ï¼Œè¿›è¡Œè‡ªåŠ¨å°è£…å³å¯</p>
</li>
<li><p>å½“<code>&lt;select&gt;</code>è¯­å¥ä¸­é…ç½®äº†resutlMapå±æ€§ï¼ŒMyBatisä¼šä½¿ç”¨è¡¨ä¸­çš„åˆ—åä¸å¯¹è±¡å±æ€§ ã€æ˜ å°„å…³ç³»ã€‘ æ¥å¡«å……å¯¹è±¡ä¸­çš„å±æ€§å€¼ã€‚</p>
</li>
<li><p>resultTypeå’ŒresultMapäºŒè€…åªèƒ½ç”¨å…¶ä¸€ï¼Œä¸èƒ½åŒæ—¶ä½¿ç”¨</p>
</li>
</ol>
<h4 id="1-3-2-ç»§æ‰¿ResultMap"><a href="#1-3-2-ç»§æ‰¿ResultMap" class="headerlink" title="1.3.2 ç»§æ‰¿ResultMap"></a>1.3.2 ç»§æ‰¿ResultMap</h4><blockquote>
<p>ä¸€ä¸ªResultMapå¯ä»¥ç»§æ‰¿å¦ä¸€ä¸ªResultMapï¼Œä½†æ˜¯æ­¤åŠŸèƒ½æ˜¯å¯é€‰çš„ï¼Œè¿™é‡Œè¿›è¡Œäº†è§£å³å¯</p>
</blockquote>
<p>(æ³¨:è¿™ä¸ªå¯ä»¥åœ¨ä¸‹é¢çš„ä¸€å¯¹ä¸€æ˜ å°„ä¸­è¿›è¡Œæµ‹è¯•,å› ä¸ºè¿™é‡Œéœ€è¦å»ºç«‹ä¸€å¯¹ä¸€å…³ç³»çš„è¡¨ç»“æ„)</p>
<p>ç¬¬ä¸€ä¸ªresultMapï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;studId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;stud_id&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">column</span>=<span class="string">&quot;phone&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>ç¬¬äºŒä¸ªresultMapï¼šç»§æ‰¿ç¬¬ä¸€ä¸ªResultMap</p>
<p>å‡è®¾æ–°å¢äº†ä¸€ä¸ªå®ä½“ç±»Addressï¼Œè¯¥ç±»ä¸­æœ‰å¤šä¸ªå±æ€§ï¼Œåˆ†åˆ«å’Œæ•°æ®åº“ä¸­ADDRESSESè¡¨å¯¹åº”ã€‚<br>åœ¨Studentç±»ä¸­åˆæ–°å¢åŠ äº†ä¸€ä¸ªå±æ€§Address</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;StudentWithAddressResult&quot;</span> <span class="attr">extends</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.addrId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.street&quot;</span> <span class="attr">column</span>=<span class="string">&quot;street&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.city&quot;</span> <span class="attr">column</span>=<span class="string">&quot;city&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.state&quot;</span> <span class="attr">column</span>=<span class="string">&quot;state&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.zip&quot;</span> <span class="attr">column</span>=<span class="string">&quot;zip&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.country&quot;</span> <span class="attr">column</span>=<span class="string">&quot;country&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p><code>å¦‚æœä¸ç»§æ‰¿</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;studId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;stud_id&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">column</span>=<span class="string">&quot;phone&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.addrId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.street&quot;</span> <span class="attr">column</span>=<span class="string">&quot;street&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.city&quot;</span> <span class="attr">column</span>=<span class="string">&quot;city&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.state&quot;</span> <span class="attr">column</span>=<span class="string">&quot;state&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.zip&quot;</span> <span class="attr">column</span>=<span class="string">&quot;zip&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.country&quot;</span> <span class="attr">column</span>=<span class="string">&quot;country&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>å¦‚æœåªæƒ³æ˜ å°„Studentæ•°æ®ï¼Œä½ å¯ä»¥ä½¿ç”¨idä¸ºStudentResultçš„resultMap,å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">resultMap</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span></span><br><span class="line">    SELECT * FROM STUDENTS WHERE STUD_ID=#&#123;stud Id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>



<p>å¦‚æœä½ æƒ³å°†æ˜ å°„Studentæ•°æ®å’ŒAddressæ•°æ®ï¼Œä½ å¯ä»¥ä½¿ç”¨idä¸ºStudentWithAddressResultçš„ resultMapï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectStudentWithAddress&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> </span></span><br><span class="line"><span class="tag">		<span class="attr">resultMap</span>=<span class="string">&quot;StudentWithAddressResult&quot;</span>&gt;</span></span><br><span class="line">    SELECT ID, NAME, EMAIL, PHONE, A.ADDR_ID, STREET, CITY, STATE, ZIP,</span><br><span class="line">    COUNTRY</span><br><span class="line">    FROM STUDENTS S LEFT OUTER JOIN ADDRESSES A ON S.ADDR_ID=A.ADDR_ID</span><br><span class="line">    WHERE STUD_ID=#&#123;studId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¯¥sqlè¯­å¥ä½¿ç”¨äº†è¿æ¥æŸ¥è¯¢ä¸­çš„å¤–è¿æ¥,ä¹Ÿå¯ä»¥ä½¿ç”¨ç­‰å€¼è¿æ¥</p>
</blockquote>
<h4 id="1-3-3-sqlæ ‡ç­¾"><a href="#1-3-3-sqlæ ‡ç­¾" class="headerlink" title="1.3.3 sqlæ ‡ç­¾"></a>1.3.3 sqlæ ‡ç­¾</h4><p>mybatisä¸­sqlæ ‡ç­¾ï¼Œä¸»è¦æ˜¯ä¸ºäº†é¿å…åœ¨é¡¹ç›®å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œé‡å¤ç¼–å†™å¤§é‡ç›¸åŒçš„sqlè¯­å¥ã€‚</p>
<p>ä¾‹å¦‚ï¼Œé€šè¿‡ä½¿ç”¨sqlæ ‡ç­¾ï¼Œå¯ä»¥å°†æ‰€æœ‰éœ€è¦æŸ¥è¯¢çš„å­—æ®µå°è£…åœ¨ä¸€ä¸ªsqlè¯­å¥ä¸­ </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å°†éœ€è¦å¤šæ¬¡åå¤æŸ¥çš„ä¸œè¥¿æå–å‡ºæ¥ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;querycolumns&quot;</span>&gt;</span></span><br><span class="line">	id,name,email,phone</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;Student&quot;</span>&gt;</span>         </span><br><span class="line">	select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;querycolumns&quot;</span>/&gt;</span> from students where id = #&#123;studId&#125; </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="1-4-ä¸€å¯¹ä¸€æ˜ å°„"><a href="#1-4-ä¸€å¯¹ä¸€æ˜ å°„" class="headerlink" title="1==.4 ä¸€å¯¹ä¸€æ˜ å°„=="></a>1==.4 ä¸€å¯¹ä¸€æ˜ å°„==</h3><blockquote>
<p>Studentå’ŒAddressæ˜¯ã€ä¸€å¯¹ä¸€ã€‘å…³ç³»</p>
</blockquote>
<p>å»ºè¡¨ä»¥åŠæ•°æ®æ’å…¥:</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> students;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> addresses;</span><br><span class="line"><span class="comment">--å¦‚æœéœ€è¦å¯ä»¥ä½¿ç”¨ cascade constraints;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> addresses(</span><br><span class="line">    addr_id number <span class="keyword">primary</span> key,</span><br><span class="line">    street varchar2(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    city varchar2(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    state varchar2(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    zip varchar2(<span class="number">10</span>),</span><br><span class="line">    country varchar2(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> students(</span><br><span class="line">    id number <span class="keyword">primary</span> key,</span><br><span class="line">    name varchar2(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    email varchar2(<span class="number">50</span>),</span><br><span class="line">    dob <span class="type">date</span> ,</span><br><span class="line">    phone varchar2(<span class="number">15</span>),  </span><br><span class="line">    addr_id number <span class="keyword">references</span> addresses(addr_id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> addresses(addr_id,street,city,state,zip,country) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;redSt&#x27;</span>,<span class="string">&#x27;kunshan&#x27;</span>,<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;12345&#x27;</span>,<span class="string">&#x27;china&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> addresses(addr_id,street,city,state,zip,country) <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;blueST&#x27;</span>,<span class="string">&#x27;kunshan&#x27;</span>,<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;12345&#x27;</span>,<span class="string">&#x27;china&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(id,name,email,phone,addr_id) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;John&#x27;</span>,<span class="string">&#x27;john@gmail.com&#x27;</span>,<span class="string">&#x27;123-456-7890&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(id,name,email,phone,addr_id) <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;Paul&#x27;</span>,<span class="string">&#x27;paul@gmail.com&#x27;</span>,<span class="string">&#x27;111-222-3333&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œæ­¤æ—¶Studentsè¡¨ä¸­çš„ä¸»é”®åˆ—æ˜¯idï¼Œaddressesè¡¨ä¸­çš„ä¸»é”®åˆ—æ˜¯addr_id</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œä¸€å®šè¦è®°å¾—æŠŠäº‹åŠ¡æäº¤commitï¼Œå¦åˆ™ç¨‹åºæŸ¥è¯¢ä¸åˆ°</p>
</blockquote>
<p>å®ä½“ç±»ï¼š</p>
<blockquote>
<p>æ³¨æ„: æ­¤å¤„çš„PhoneNumber éœ€è¦ä½¿ç”¨ç±»å‹è½¬æ¢å™¨</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PhoneNumber</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String countryCode;</span><br><span class="line">	<span class="keyword">private</span> String stateCode;</span><br><span class="line">	<span class="keyword">private</span> String number;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;PhoneNumber&#123;&quot;</span> +</span><br><span class="line">				<span class="string">&quot;countryCode=&#x27;&quot;</span> + countryCode + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, stateCode=&#x27;&quot;</span> + stateCode + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, number=&#x27;&quot;</span> + number + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">PhoneNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// alt+insert</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">PhoneNumber</span><span class="params">(String countryCode, String stateCode, String number)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//  111</span></span><br><span class="line">		<span class="keyword">this</span>.countryCode = countryCode;</span><br><span class="line">		<span class="keyword">this</span>.stateCode = stateCode;</span><br><span class="line">		<span class="keyword">this</span>.number = number;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// åˆ›å»ºæ–¹æ³•å°†å¯¹è±¡è½¬æˆå­—ç¬¦ä¸² new Phone(&quot;000&quot;,&quot;111&quot;,&quot;222&quot;)</span></span><br><span class="line">	<span class="comment">// &quot;000-111-222&quot;</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">asStr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.countryCode + <span class="string">&quot;-&quot;</span> + <span class="keyword">this</span>.stateCode + <span class="string">&quot;-&quot;</span> + <span class="keyword">this</span>.number;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// åˆ›å»ºæ–¹æ³•å°†å­—ç¬¦ä¸²æ¢æˆæˆå¯¹è±¡</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">PhoneNumber</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// &quot;000-111-222&quot;</span></span><br><span class="line">		PhoneNumber phoneNumber = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">if</span> (str != <span class="keyword">null</span>) &#123;</span><br><span class="line">			String[] arr = str.split(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">			<span class="comment">// phoneNumber = new PhoneNumber(arr[0], arr[1], arr[2]);</span></span><br><span class="line">			<span class="keyword">this</span>.countryCode = arr[<span class="number">0</span>];</span><br><span class="line">			<span class="keyword">this</span>.stateCode = arr[<span class="number">1</span>];</span><br><span class="line">			<span class="keyword">this</span>.number = arr[<span class="number">2</span>];</span><br><span class="line">			<span class="comment">// this.countryCode=...</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//return phoneNumber;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCountryCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> countryCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCountryCode</span><span class="params">(String countryCode)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.countryCode = countryCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getStateCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> stateCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStateCode</span><span class="params">(String stateCode)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.stateCode = stateCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> number;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNumber</span><span class="params">(String number)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.number = number;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.pojo.onetoone;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Integer addrId;</span><br><span class="line">	<span class="keyword">private</span> String street;</span><br><span class="line">	<span class="keyword">private</span> String city;</span><br><span class="line">	<span class="keyword">private</span> String state;</span><br><span class="line">	<span class="keyword">private</span> String zip;</span><br><span class="line">	<span class="keyword">private</span> String country;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getAddrId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> addrId;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddrId</span><span class="params">(Integer addrId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.addrId = addrId;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getStreet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> street;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStreet</span><span class="params">(String street)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.street = street;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> city;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCity</span><span class="params">(String city)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.city = city;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> state;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.state = state;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getZip</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> zip;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setZip</span><span class="params">(String zip)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.zip = zip;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCountry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> country;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCountry</span><span class="params">(String country)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.country = country;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="title">Address</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Address</span><span class="params">(Integer addrId, String street, String city, String state, String zip, String country)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.addrId = addrId;</span><br><span class="line">		<span class="keyword">this</span>.street = street;</span><br><span class="line">		<span class="keyword">this</span>.city = city;</span><br><span class="line">		<span class="keyword">this</span>.state = state;</span><br><span class="line">		<span class="keyword">this</span>.zip = zip;</span><br><span class="line">		<span class="keyword">this</span>.country = country;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Address&#123;&quot;</span> +</span><br><span class="line">				<span class="string">&quot;addrId=&quot;</span> + addrId +</span><br><span class="line">				<span class="string">&quot;, street=&#x27;&quot;</span> + street + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, city=&#x27;&quot;</span> + city + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, state=&#x27;&quot;</span> + state + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, zip=&#x27;&quot;</span> + zip + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, country=&#x27;&quot;</span> + country + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.pojo.onetoone;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Integer studId;</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	<span class="keyword">private</span> String email; </span><br><span class="line">	<span class="keyword">private</span> Date dob;</span><br><span class="line">	<span class="keyword">private</span> PhoneNumber phone;</span><br><span class="line">	<span class="keyword">private</span> Address address;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getStudId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> studId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStudId</span><span class="params">(Integer studId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.studId = studId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> email;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.email = email;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Date <span class="title">getDob</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> dob;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDob</span><span class="params">(Date dob)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.dob = dob;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> PhoneNumber <span class="title">getPhone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> phone;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPhone</span><span class="params">(PhoneNumber phone)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.phone = phone;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Address <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> address;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(Address address)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.address = address;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(Integer studId, String name, String email, Date dob)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.studId = studId;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.email = email;</span><br><span class="line">		<span class="keyword">this</span>.dob = dob;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">				<span class="string">&quot;studId=&quot;</span> + studId +</span><br><span class="line">				<span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, email=&#x27;&quot;</span> + email + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">				<span class="string">&quot;, dob=&quot;</span> + dob +</span><br><span class="line">				<span class="string">&quot;, phone=&quot;</span> + phone +</span><br><span class="line">				<span class="string">&quot;, address=&quot;</span> + address +</span><br><span class="line">				<span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>æ­¤æ—¶ä¸¤å¼ è¡¨çš„è¡¨ç»“æ„ä»¥åŠæ ·ä¾‹æ•°æ®å¦‚ä¸‹æ‰€ç¤º</p>
<p>1.<code>addresses</code>è¡¨</p>
<table>
<thead>
<tr>
<th>addr_id</th>
<th>street</th>
<th>city</th>
<th>state</th>
<th>zip</th>
<th>country</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>redSt</td>
<td>kunshan</td>
<td>W</td>
<td>12345</td>
<td>china</td>
</tr>
<tr>
<td>2</td>
<td>blueST</td>
<td>kunshan</td>
<td>W</td>
<td>12345</td>
<td>china</td>
</tr>
</tbody></table>
<p>2.<code>students</code>è¡¨</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>email</th>
<th>phone</th>
<th>addr_id</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>John</td>
<td><a href="mailto:&#106;&#111;&#x68;&#110;&#64;&#x67;&#x6d;&#97;&#x69;&#x6c;&#x2e;&#x63;&#111;&#x6d;">&#106;&#111;&#x68;&#110;&#64;&#x67;&#x6d;&#97;&#x69;&#x6c;&#x2e;&#x63;&#111;&#x6d;</a></td>
<td>123-456-7890</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>Paul</td>
<td><a href="mailto:&#112;&#97;&#x75;&#108;&#64;&#x67;&#x6d;&#97;&#x69;&#108;&#46;&#x63;&#x6f;&#109;">&#112;&#97;&#x75;&#108;&#64;&#x67;&#x6d;&#97;&#x69;&#108;&#46;&#x63;&#x6f;&#109;</a></td>
<td>111-222-3333</td>
<td>2</td>
</tr>
</tbody></table>
<p>StudentMapper.xmlæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;StudentWithAddressResult&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;studId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">column</span>=<span class="string">&quot;phone&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.addrId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.street&quot;</span> <span class="attr">column</span>=<span class="string">&quot;street&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.city&quot;</span> <span class="attr">column</span>=<span class="string">&quot;city&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.state&quot;</span> <span class="attr">column</span>=<span class="string">&quot;state&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.zip&quot;</span> <span class="attr">column</span>=<span class="string">&quot;zip&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address.country&quot;</span> <span class="attr">column</span>=<span class="string">&quot;country&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectStudentWithAddress&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentWithAddressResult&quot;</span>&gt;</span></span><br><span class="line">    select</span><br><span class="line">        s.id , s.name, s.email,s.dob,s.phone,</span><br><span class="line">        a.addr_id, a.street, a.city, a.state, a.zip, a.country</span><br><span class="line">    from</span><br><span class="line">    	students s</span><br><span class="line">    	left outer join addresses a on s.addr_id = a.addr_id</span><br><span class="line">    where</span><br><span class="line">    	id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼šå¯ä»¥ä½¿ç”¨ å¯¹è±¡.å±æ€§å çš„æ–¹å¼ä¸ºå†…åµŒçš„å¯¹è±¡å†…çš„å±æ€§èµ‹å€¼ã€‚ä¾‹å¦‚ <code>address.city</code></p>
</blockquote>
<p>StudentMapper.javaæ–‡ä»¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Student</span> <span class="title">Mapper</span></span>&#123; </span><br><span class="line">    <span class="function">Student <span class="title">selectStudentWithAddress</span><span class="params">(<span class="keyword">int</span> studId)</span></span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> studId = <span class="number">1</span>; </span><br><span class="line">StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class); </span><br><span class="line">Student student = studentMapper.selectStudentWithAddress(studId); </span><br><span class="line">System.out.println(<span class="string">&quot;Student :&quot;</span> + student); </span><br><span class="line">System.out.println(<span class="string">&quot;Address :&quot;</span> + student.getAddress()); </span><br></pre></td></tr></table></figure>



<p>åœ¨ä½¿ç”¨è¿™ç§æ–¹å¼æ˜ å°„çš„æ—¶å€™ï¼Œå¦‚æœaddressç»“æœéœ€è¦åœ¨å…¶ä»–çš„SELECTæ˜ å°„è¯­å¥ä¸­å•ç‹¬å°è£…æˆAddresså¯¹è±¡ï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠåŒæ ·çš„é…ç½®åœ¨é‡æ–°å†™ä¸€éï¼Œå› ä¸ºå½“å‰æ˜¯åœ¨å°è£…Studentå¯¹è±¡çš„æ—¶å€™åµŒå…¥äº†Addresså¯¹è±¡çš„å°è£…ï¼Œè¿™æ®µå¯¹Addressæ˜ å°„çš„é…ç½®ä¸èƒ½åœ¨å…¶ä»–åœ°æ–¹é‡å¤çš„å•ç‹¬ä½¿ç”¨</p>
<p>é’ˆå¯¹äºè¿™ç§æƒ…å†µï¼ŒMyBatisæä¾›äº†æ›´å¥½åœ°å®ç°ä¸€å¯¹ä¸€å…³è”æ˜ å°„çš„ä¿©ç§æ–¹æ³•ï¼š</p>
<ul>
<li>ã€åµŒå¥—ç»“æœã€‘ResultMap</li>
<li>ã€åµŒå¥—æŸ¥è¯¢ã€‘Select</li>
</ul>
<h4 id="1-4-1-åµŒå¥—ç»“æœ"><a href="#1-4-1-åµŒå¥—ç»“æœ" class="headerlink" title="1.4.1 åµŒå¥—ç»“æœ"></a>1.4.1 åµŒå¥—ç»“æœ</h4><p>ä½¿ç”¨ã€åµŒå¥—ç»“æœã€‘ResultMapï¼Œå®ç°ä¸€å¯¹ä¸€å…³ç³»æ˜ å°„ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç‹¬ç«‹çš„Addresså°è£…æ˜ å°„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Address&quot;</span> <span class="attr">id</span>=<span class="string">&quot;AddressResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;addrId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;street&quot;</span> <span class="attr">column</span>=<span class="string">&quot;street&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;city&quot;</span> <span class="attr">column</span>=<span class="string">&quot;city&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;state&quot;</span> <span class="attr">column</span>=<span class="string">&quot;state&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;zip&quot;</span> <span class="attr">column</span>=<span class="string">&quot;zip&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;country&quot;</span> <span class="attr">column</span>=<span class="string">&quot;country&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line">		</span><br><span class="line"><span class="comment">&lt;!-- Studentå°è£…æ˜ å°„ï¼Œé‡Œé¢å…³è”ä¸ŠAddressçš„å°è£…æ˜ å°„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;StudentWithAddressResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;studId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;stud_id&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;dob&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dob&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">column</span>=<span class="string">&quot;phone&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;AddressResult&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">		</span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectStudentWithAddress&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentWithAddressResult&quot;</span>&gt;</span> </span><br><span class="line">    select </span><br><span class="line">        s.stud_id, s.name, s.email,s.dob,s.phone, </span><br><span class="line">        a.addr_id, a.street, a.city, a.state, a.zip, a.country</span><br><span class="line">    from </span><br><span class="line">    	students s </span><br><span class="line">    	left outer join addresses a on s.addr_id = a.addr_id</span><br><span class="line">    where </span><br><span class="line">    	stud_id = #&#123;id&#125;  </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œ<code>&lt;association&gt;</code>æ˜¯å…³è”çš„æ„æ€,å¸¸è¢«ç”¨æ¥è¡¨ç¤º(has-one)ç±»å‹çš„å…³è”ã€‚å°±æ˜¯å¯¹è±¡1é‡Œé¢å…³è”å¦ä¸€ä¸ªå¯¹è±¡2</p>
</blockquote>
<p>åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>&lt;association&gt; </code>å®šä¹‰ã€å†…è”ã€‘çš„resultMapï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼šï¼ˆäº†è§£å³å¯ï¼Œä¸å¸¸ç”¨ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç›¸å½“äºæŠŠStudentæ˜ å°„å’ŒAddressæ˜ å°„åˆåˆå¹¶åœ¨ä¸€èµ·å†™äº†ï¼Œè¿˜æ˜¯ä½¿ç”¨&lt;association&gt;æ ‡ç­¾ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;StudentWithAddressResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;studId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;stud_id&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Address&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;addrId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;street&quot;</span> <span class="attr">column</span>=<span class="string">&quot;street&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;city&quot;</span> <span class="attr">column</span>=<span class="string">&quot;city&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;state&quot;</span> <span class="attr">column</span>=<span class="string">&quot;state&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;zip&quot;</span> <span class="attr">column</span>=<span class="string">&quot;zip&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;country&quot;</span> <span class="attr">column</span>=<span class="string">&quot;country&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="1-4-2-åµŒå¥—æŸ¥è¯¢"><a href="#1-4-2-åµŒå¥—æŸ¥è¯¢" class="headerlink" title="1.4.2 åµŒå¥—æŸ¥è¯¢"></a>1.4.2 åµŒå¥—æŸ¥è¯¢</h4><p>ä½¿ç”¨ã€åµŒå¥—æŸ¥è¯¢ã€‘selectï¼Œå®ç°ä¸€å¯¹ä¸€å…³ç³»æ˜ å°„ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç‹¬ç«‹çš„Addresså°è£…æ˜ å°„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Address&quot;</span> <span class="attr">id</span>=<span class="string">&quot;AddressResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;addrId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;street&quot;</span> <span class="attr">column</span>=<span class="string">&quot;street&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;city&quot;</span> <span class="attr">column</span>=<span class="string">&quot;city&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;state&quot;</span> <span class="attr">column</span>=<span class="string">&quot;state&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;zip&quot;</span> <span class="attr">column</span>=<span class="string">&quot;zip&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;country&quot;</span> <span class="attr">column</span>=<span class="string">&quot;country&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">		</span><br><span class="line"><span class="comment">&lt;!-- ç‹¬ç«‹çš„selectæŸ¥è¯¢ï¼Œä¸“é—¨æŸ¥è¯¢Address --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAddressById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;AddressResult&quot;</span>&gt;</span> </span><br><span class="line">    select * from addresses </span><br><span class="line">    where addr_id=#&#123;id&#125; </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br><span class="line">		</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Studentå°è£…æ˜ å°„ï¼Œé‡Œé¢å…³è”äº†æŸ¥è¯¢addressä½¿ç”¨çš„selectè¯­å¥ï¼Œå¹¶æŒ‡å®šæ•°æ®åº“è¡¨ä¸­çš„è¿™ä¸ªå…³è”çš„å¤–é”®åˆ—çš„åå­—ï¼Œè¿™é‡Œæ˜¯addr_id --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;StudentWithAddressResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;studId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;dob&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dob&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">column</span>=<span class="string">&quot;phone&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;findAddressById&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æŸ¥è¯¢Studentçš„selectè¯­å¥ï¼Œè¿™é‡Œä¸ç”¨å†™å¤šè¡¨æŸ¥è¯¢ï¼Œå› ä¸ºå¯¹äºaddressçš„å…³è”æŸ¥è¯¢ï¼Œå·²ç»åœ¨ä¸Šè¾¹å®šä¹‰å¥½äº†ï¼Œå¹¶ä¸”åœ¨ç»“æœæ˜ å°„ä¸­å…³è”è¿›æ¥äº† --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectStudentWithAddress&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentWithAddressResult&quot;</span>&gt;</span> </span><br><span class="line">    	select </span><br><span class="line">	    	id,name,email,dob,phone,addr_id</span><br><span class="line">	    from </span><br><span class="line">	    	students </span><br><span class="line">	    where </span><br><span class="line">	    	id = #&#123;id&#125; </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>åœ¨æ­¤æ–¹å¼ä¸­ï¼Œ<code>&lt;association</code>&gt;å…ƒç´ çš„selectå±æ€§è¢«è®¾ç½®æˆäº†idä¸ºfindAddressByIdçš„è¯­å¥ã€‚</p>
<p>ä¸¤ä¸ªåˆ†å¼€çš„SQLè¯­å¥å°†ä¼šåœ¨æ•°æ®åº“ä¸­åˆ†åˆ«æ‰§è¡Œï¼Œç¬¬ä¸€ä¸ªé€šè¿‡idæŸ¥è¯¢studentä¿¡æ¯ï¼Œè€Œç¬¬äºŒä¸ªè°ƒç”¨findAddressByIdæ¥åŠ è½½addressä¿¡æ¯ã€‚</p>
<p>addr_idåˆ—çš„å€¼å°†ä¼šè¢«ä½œä¸ºè¾“å…¥å‚æ•°ä¼ é€’ç»™selectAddressByIdè¯­å¥ä½œä¸ºå‚æ•°è¿›è¡Œæ¡ä»¶æŸ¥è¯¢ã€‚</p>
<p>æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">StudentMapper mapper = sqlSession.getMapper(StudentMapper.class); </span><br><span class="line">Student student = mapper.selectStudentWithAddress(<span class="number">1</span>); </span><br><span class="line">System.out.println(student); </span><br><span class="line">System.out.println(student.getAddress());</span><br></pre></td></tr></table></figure>



<p>åµŒå¥—æŸ¥è¯¢ï¼Œæ“ä½œè¿‡ç¨‹åˆ†æï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>é€šè¿‡ç”¨æˆ·ä¼ çš„idå€¼ï¼ŒæŸ¥è¯¢å‡ºæŒ‡å®šçš„å­¦ç”Ÿ</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>æ³¨æ„ï¼Œè¿™ä¸ªæ—¶å€™åªæ˜¯æŸ¥è¯¢å­¦ç”Ÿï¼Œæ²¡æœ‰æŸ¥è¯¢åœ°å€</span><br><span class="line"><span class="keyword">select</span> id,name,email,dob,phone,addr_id <span class="keyword">from</span> students </span><br><span class="line"><span class="keyword">where</span> id <span class="operator">=</span> #&#123;studId&#125;</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>åŠ ä¸Šidä¸º<span class="number">1</span></span><br><span class="line"><span class="keyword">select</span> id,name,email,dob,phone,addr_id <span class="keyword">from</span> students </span><br><span class="line"><span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>æŸ¥è¯¢ç»“æœä¸º</span><br><span class="line">        ID NAME    EMAIL           DOB    PHONE      ADDR_ID</span><br><span class="line"><span class="comment">---------- ------- --------------- ------ -------- ----------</span></span><br><span class="line">         <span class="number">1</span> John    john<span class="variable">@gmail</span>.com        <span class="number">123</span><span class="number">-456</span><span class="number">-7890</span>   <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>è¿™æ—¶å€™ï¼Œåªèƒ½é£å°è£…å­¦ç”Ÿå¯¹è±¡çš„æ™®é€šå±æ€§ï¼Œaddresså±æ€§æ˜¯å°è£…ä¸äº†</span><br><span class="line">public class Student &#123;</span><br><span class="line">	<span class="operator">/</span><span class="operator">/</span>...å…¶ä»–æ™®é€šå±æ€§</span><br><span class="line">	private Address address;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>éœ€è¦ä¸“é—¨çš„å»æŸ¥è¯¢å’Œè¿™ä¸ªå­¦ç”Ÿå¯¹åº”çš„addressï¼Œç„¶åè¿›è¡Œå°è£…</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>ä½¿ç”¨è¿™ä¸ª<span class="keyword">sql</span>è¯­å¥</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> addresses </span><br><span class="line"><span class="keyword">where</span> addr_id <span class="operator">=</span> #&#123;id&#125; </span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>éœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå’Œè¿™ä¸ªå­¦ç”Ÿå¯¹åº”çš„åœ°å€id</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>å…¶å®è¿™ä¸ªå‚æ•°,å°±æ˜¯ä¸Šé¢ç¬¬ä¸€æ¡<span class="keyword">sql</span>è¯­å¥æŸ¥è¯¢ç»“æœä¸­çš„addr_idå­—æ®µçš„å€¼,ä¹Ÿå°±æ˜¯<span class="number">1</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> addresses </span><br><span class="line"><span class="keyword">where</span> addr_id <span class="operator">=</span> <span class="number">1</span> </span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>è¿™ä¸€æ­¥æ“ä½œå¯¹åº”çš„é…ç½®ä¸ºï¼š</span><br><span class="line"><span class="operator">&lt;</span>association property<span class="operator">=</span>&quot;address&quot; <span class="keyword">column</span><span class="operator">=</span>&quot;addr_id&quot; <span class="keyword">select</span><span class="operator">=</span>&quot;findAddressById&quot; <span class="operator">/</span><span class="operator">&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>æŸ¥è¯¢ç»“æœä¸º</span><br><span class="line">   ADDR_ID STREET     CITY       STATE ZIP        COUNTRY</span><br><span class="line"><span class="comment">---------- ---------- ---------- ----- ---------- ----------</span></span><br><span class="line">         <span class="number">1</span> redSt      kunshan    W     <span class="number">12345</span>      china</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>ç„¶åå¯¹è¿™ä¸ªæ•°æ®è¿›è¡Œå°è£…ï¼Œå¾—åˆ°addresså¯¹è±¡</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>æœ€åæŠŠaddresså¯¹å­˜åˆ°studentå¯¹è±¡ä¸­å³å¯</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>æ€»ç»“å¯¹æ¯”ï¼š</p>
<ul>
<li><p>åµŒå¥—ç»“æœ</p>
<p>ä¸€æ¡sqlè¯­å¥ï¼ŒæŸ¥è¯¢å‡ºæ‰€æœ‰è¡¨ä¸­çš„æ•°æ®ï¼Œç„¶åäº¤ç»™ä¸€ä¸ªResultMapå»æ˜ å°„ï¼Œè¿™ä¸ªResultMapåªè´Ÿè´£æ˜ å°„å°è£…ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¦ä¸€éƒ¨åˆ†æ•°æ®äº¤ç»™ç¬¬äºŒä¸ªResultMapæ¥æ˜ å°„ï¼Œè¿™ä¸ªä¿©ä¸ªResultMapä¹‹é—´ï¼Œä½¿ç”¨æ ‡ç­¾<code>&lt;association&gt;</code>è¿›è¡Œå…³è”</p>
<p>ä¾‹å¦‚ï¼Œ<code>&lt;association property=&quot;address&quot; resultMap=&quot;AddressResult&quot; /&gt; </code></p>
</li>
<li><p>åµŒå¥—æŸ¥è¯¢</p>
<p>æŠŠä¹‹å‰ä¸€æ¡sqlè¯­å¥ï¼Œæ‹†åˆ†æˆå¤šæ¡sqlè¯­å¥ï¼Œæ¯æ¡sqlè¯­å¥åªæŸ¥è¯¢ä¸€å¼ è¡¨å¹¶å°è£…ä¸€éƒ¨åˆ†æ•°æ®ï¼Œç„¶åä½¿ç”¨æ ‡ç­¾<code>&lt;association&gt;</code>å°†å¤šæ¡sqlè¯­å¥å…³è”èµ·æ¥ï¼Œæœ€åæŠŠç»“æœåˆå¹¶èµ·æ¥å°±æ˜¯å®Œæ•´çš„æŸ¥è¯¢ç»“æœ</p>
<p>ä¾‹å¦‚ï¼Œ<code>&lt;association property=&quot;address&quot; column=&quot;addr_id&quot; select=&quot;findAddressById&quot; /&gt; </code></p>
</li>
</ul>
<h3 id="1-5-ä¸€å¯¹å¤šæ˜ å°„"><a href="#1-5-ä¸€å¯¹å¤šæ˜ å°„" class="headerlink" title="1.5 ==ä¸€å¯¹å¤šæ˜ å°„=="></a>1.5 ==ä¸€å¯¹å¤šæ˜ å°„==</h3><blockquote>
<p>åœ¨ä¸€å¯¹å¤šå…³ç³»ä¸­ï¼Œæ•°æ®åº“å»ºè¡¨çš„æ—¶å€™å¤–é”®ï¼Œä¸€å®šæ˜¯åœ¨å¤šçš„é‚£ä¸€æ–¹å»ºç«‹</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œä¸€ä¸ªè®²å¸ˆtutorså¯ä»¥æ•™æˆä¸€ä¸ªæˆ–è€…å¤šä¸ªè¯¾ç¨‹courseã€‚è¿™æ„å‘³ç€è®²å¸ˆå’Œè¯¾ç¨‹ä¹‹é—´å­˜åœ¨ä¸€å¯¹å¤šçš„æ˜ å°„å…³ç³»ã€‚</p>
<p>å»ºè¡¨ä»¥åŠæ•°æ®æ’å…¥è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> courses;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> tutors;</span><br><span class="line"><span class="comment">--å¦‚æœéœ€è¦å¯ä»¥ä½¿ç”¨ cascade constraints;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tutors(</span><br><span class="line">    tutor_id number <span class="keyword">primary</span> key,</span><br><span class="line">    name varchar2(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    email varchar2(<span class="number">50</span>) ,</span><br><span class="line">    phone varchar2(<span class="number">15</span>) ,  </span><br><span class="line">    addr_id number(<span class="number">11</span>) <span class="keyword">references</span> addresses (addr_id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> courses(</span><br><span class="line">    course_id number <span class="keyword">primary</span> key,</span><br><span class="line">    name varchar2(<span class="number">100</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    description varchar2(<span class="number">512</span>),</span><br><span class="line">    start_date <span class="type">date</span> ,</span><br><span class="line">    end_date <span class="type">date</span> ,</span><br><span class="line">    tutor_id number <span class="keyword">references</span> tutors (tutor_id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tutors(tutor_id,name,email,phone,addr_id) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;zs&#x27;</span>,<span class="string">&#x27;zs@briup.com&#x27;</span>,<span class="string">&#x27;123-456-7890&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tutors(tutor_id,name,email,phone,addr_id) <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;ls&#x27;</span>,<span class="string">&#x27;ls@briup.com&#x27;</span>,<span class="string">&#x27;111-222-3333&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> courses(course_id,name,description,start_date,end_date,tutor_id) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;JavaSE&#x27;</span>,<span class="string">&#x27;JavaSE&#x27;</span>,to_date(<span class="string">&#x27;2022-01-10&#x27;</span>,<span class="string">&#x27;yyyy-mm-dd&#x27;</span>),to_date(<span class="string">&#x27;2022-02-10&#x27;</span>,<span class="string">&#x27;yyyy-mm-dd&#x27;</span>),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> courses(course_id,name,description,start_date,end_date,tutor_id)	<span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;JavaEE&#x27;</span>,<span class="string">&#x27;JavaEE&#x27;</span>,to_date(<span class="string">&#x27;2022-01-10&#x27;</span>,<span class="string">&#x27;yyyy-mm-dd&#x27;</span>),to_date(<span class="string">&#x27;2022-03-10&#x27;</span>,<span class="string">&#x27;yyyy-mm-dd&#x27;</span>),<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> courses(course_id,name,description,start_date,end_date,tutor_id)	<span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;MyBatis&#x27;</span>,<span class="string">&#x27;MyBatis&#x27;</span>,to_date(<span class="string">&#x27;2022-01-10&#x27;</span>,<span class="string">&#x27;yyyy-mm-dd&#x27;</span>),to_date(<span class="string">&#x27;2022-02-20&#x27;</span>,<span class="string">&#x27;yyyy-mm-dd&#x27;</span>),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè®°å¾—æäº¤æ•°æ®</p>
</blockquote>
<p>æ­¤æ—¶ä¸¤å¼ è¡¨ä¸­çš„ç¤ºä¾‹æ•°æ®å¦‚ä¸‹</p>
<p>1.<code>tutors</code>è¡¨</p>
<table>
<thead>
<tr>
<th>tutor_id</th>
<th>name</th>
<th>email</th>
<th>phone</th>
<th>addr_id</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>zs</td>
<td><a href="mailto:&#x7a;&#115;&#x40;&#x62;&#x72;&#105;&#x75;&#x70;&#46;&#99;&#111;&#x6d;">&#x7a;&#115;&#x40;&#x62;&#x72;&#105;&#x75;&#x70;&#46;&#99;&#111;&#x6d;</a></td>
<td>123-456-7890</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>ls</td>
<td><a href="mailto:&#108;&#115;&#64;&#x62;&#x72;&#105;&#x75;&#112;&#x2e;&#99;&#111;&#x6d;">&#108;&#115;&#64;&#x62;&#x72;&#105;&#x75;&#112;&#x2e;&#99;&#111;&#x6d;</a></td>
<td>111-222-3333</td>
<td>2</td>
</tr>
</tbody></table>
<p>2.<code>courses</code>è¡¨</p>
<table>
<thead>
<tr>
<th>course_id</th>
<th>name</th>
<th>description</th>
<th>start_date</th>
<th>end_date</th>
<th>tutor_id</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>JavaSE</td>
<td>JavaSE</td>
<td>2022-01-10</td>
<td>2022-02-10</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>JavaEE</td>
<td>JavaEE</td>
<td>2022-01-10</td>
<td>2022-03-10</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>MyBatis</td>
<td>MyBatis</td>
<td>2022-01-10</td>
<td>2022-02-20</td>
<td>1</td>
</tr>
</tbody></table>
<p>åœ¨ä¸Šè¿°çš„è¡¨æ•°æ®ä¸­ï¼Œzs è®²å¸ˆæ•™æˆä¸€ä¸ªè¯¾ç¨‹ï¼Œè€Œ ls è®²å¸ˆæ•™æˆä¸¤ä¸ªè¯¾ç¨‹ã€‚</p>
<p>å®ä½“ç±»è®¾è®¡å¦‚ä¸‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Course</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Integer courseId; </span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	<span class="keyword">private</span> String description; </span><br><span class="line">	<span class="keyword">private</span> Date startDate; </span><br><span class="line">	<span class="keyword">private</span> Date endDate;</span><br><span class="line">    </span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getCourseId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> courseId;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourseId</span><span class="params">(Integer courseId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.courseId = courseId;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> description;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDescription</span><span class="params">(String description)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.description = description;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Date <span class="title">getStartDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> startDate;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStartDate</span><span class="params">(Date startDate)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.startDate = startDate;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Date <span class="title">getEndDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> endDate;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEndDate</span><span class="params">(Date endDate)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.endDate = endDate;</span><br><span class="line">	&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tutor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer tutorId; </span><br><span class="line">    <span class="keyword">private</span> String name; </span><br><span class="line">    <span class="keyword">private</span> String email; </span><br><span class="line">    <span class="keyword">private</span> PhoneNumber phone;</span><br><span class="line">    <span class="keyword">private</span> Address address; </span><br><span class="line">    <span class="keyword">private</span> List&lt;Course&gt; courses;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getTutorId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> tutorId;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTutorId</span><span class="params">(Integer tutorId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.tutorId = tutorId;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> email;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> PhoneNumber <span class="title">getPhone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> phone;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPhone</span><span class="params">(PhoneNumber phone)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.phone = phone;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Address <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(Address address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Course&gt; <span class="title">getCourses</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> courses;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourses</span><span class="params">(List&lt;Course&gt; courses)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courses = courses;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><code>&lt;collection&gt;</code>æ ‡ç­¾å¯ä»¥ç”¨æ¥å°†å¤šè¡Œè¯¾ç¨‹ç»“æœæ˜ å°„æˆä¸€ä¸ªè¯¾ç¨‹Courseå¯¹è±¡çš„é›†åˆã€‚</p>
<p>å’Œä¹‹å‰çš„ä¸€å¯¹ä¸€æ˜ å°„ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨ã€åµŒå¥—ç»“æœã€‘ResultMapå’Œã€åµŒå¥—æŸ¥è¯¢ã€‘Selectè¯­å¥ä¸¤ç§æ–¹å¼ï¼Œæ˜ å°„ä¸€å¯¹å¤šå…³ç³»ã€‚</p>
<h4 id="1-5-1-åµŒå¥—ç»“æœ"><a href="#1-5-1-åµŒå¥—ç»“æœ" class="headerlink" title="1.5.1 åµŒå¥—ç»“æœ"></a>1.5.1 åµŒå¥—ç»“æœ</h4><p>ä½¿ç”¨ã€åµŒå¥—ç»“æœã€‘ResultMap å®ç°ä¸€å¯¹å¤šæ˜ å°„ï¼Œè·å¾—è®²å¸ˆåŠå…¶è¯¾ç¨‹ä¿¡æ¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç‹¬ç«‹çš„Addresså°è£…æ˜ å°„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Address&quot;</span> <span class="attr">id</span>=<span class="string">&quot;AddressResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;addrId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;street&quot;</span> <span class="attr">column</span>=<span class="string">&quot;street&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;city&quot;</span> <span class="attr">column</span>=<span class="string">&quot;city&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;state&quot;</span> <span class="attr">column</span>=<span class="string">&quot;state&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;zip&quot;</span> <span class="attr">column</span>=<span class="string">&quot;zip&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;country&quot;</span> <span class="attr">column</span>=<span class="string">&quot;country&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">&lt;!-- ç‹¬ç«‹çš„Courseå°è£…æ˜ å°„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Course&quot;</span> <span class="attr">id</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;course_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;courseId&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;description&quot;</span> <span class="attr">property</span>=<span class="string">&quot;description&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;start_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;startDate&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;end_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;endDate&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- Tutorå°è£…æ˜ å°„ï¼Œé‡Œé¢æ˜¯æœ‰åµŒå¥—ç»“æœçš„æ–¹å¼å…³è”ä¸€ä¸ªAddreså’Œå¤šä¸ªCourseï¼Œåˆ†åˆ«ä½¿ç”¨associationæ ‡ç­¾å’Œcollectionæ ‡ç­¾ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Tutor&quot;</span> <span class="attr">id</span>=<span class="string">&quot;TutorResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;tutor_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;tutorId&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">property</span>=<span class="string">&quot;phone&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;AddressResult&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;courses&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;CourseResult&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line">	</span><br><span class="line"><span class="comment">&lt;!-- æŸ¥è¯¢Tutorçš„selectè¯­å¥ï¼Œå¤šè¡¨è¿æ¥æŸ¥è¯¢ï¼ŒæŠŠæŸ¥è¯¢çš„ç»“æœç»™ä¸ªä¸Šé¢çš„æ˜ å°„ç»“æœç»Ÿä¸€è¿›è¡Œå°è£… --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findTutorById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;TutorResult&quot;</span>&gt;</span> </span><br><span class="line">		select </span><br><span class="line">			t.tutor_id, t.name, t.email,t.phone, </span><br><span class="line">			c.course_id, c.name, c.description, c.start_date, c.end_date,</span><br><span class="line">			a.addr_id,a.street,a.city,a.state,a.zip,a.country </span><br><span class="line">		from </span><br><span class="line">			tutors t </span><br><span class="line">			left outer join addresses a on t.addr_id  = a.addr_id </span><br><span class="line">			left outer join courses   c on t.tutor_id = c.tutor_id </span><br><span class="line">		where </span><br><span class="line">			t.tutor_id=#&#123;id&#125; </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡ŒæŸ¥è¯¢äº†ä¸‰å¼ è¡¨ï¼Œå¦‚æœè¡¨ä¸­æœ‰å­—æ®µå’Œå…¶ä»–è¡¨ä¸­çš„å­—æ®µåå­—ä¸€æ ·ï¼Œé‚£ä¹ˆä¸€å®šè¦èµ·åˆ«åè¿›è¡ŒåŒºåˆ«ï¼Œå¦åˆ™å°è£…æ˜ å°„ç»“æœçš„æ—¶å€™ä¼šå‡ºé—®é¢˜ã€‚</p>
</blockquote>
<h4 id="1-5-2-åµŒå¥—æŸ¥è¯¢"><a href="#1-5-2-åµŒå¥—æŸ¥è¯¢" class="headerlink" title="1.5.2 åµŒå¥—æŸ¥è¯¢"></a>1.5.2 åµŒå¥—æŸ¥è¯¢</h4><p>ä½¿ç”¨ã€åµŒå¥—æŸ¥è¯¢ã€‘Selectï¼Œå®ç°ä¸€å¯¹å¤šæ˜ å°„ï¼Œå¼è·å¾—è®²å¸ˆåŠå…¶è¯¾ç¨‹ä¿¡æ¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç‹¬ç«‹çš„Addresså°è£…æ˜ å°„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Address&quot;</span> <span class="attr">id</span>=<span class="string">&quot;AddressResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;addrId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;street&quot;</span> <span class="attr">column</span>=<span class="string">&quot;street&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;city&quot;</span> <span class="attr">column</span>=<span class="string">&quot;city&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;state&quot;</span> <span class="attr">column</span>=<span class="string">&quot;state&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;zip&quot;</span> <span class="attr">column</span>=<span class="string">&quot;zip&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;country&quot;</span> <span class="attr">column</span>=<span class="string">&quot;country&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ç‹¬ç«‹çš„Courseå°è£…æ˜ å°„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Course&quot;</span> <span class="attr">id</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;course_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;courseId&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;description&quot;</span> <span class="attr">property</span>=<span class="string">&quot;description&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;start_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;startDate&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;end_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;endDate&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">&lt;!-- Tutorå°è£…æ˜ å°„ï¼Œé‡Œåˆ†åˆ«ä½¿ç”¨associationå’Œcollectionæ ‡ç­¾æ¥è¿›è¡Œå…³è”æŸ¥è¯¢ï¼Œç›´æ¥æŠŠå¯¹åº”çš„selectæŸ¥è¯¢è¯­å¥ç®¡ç†è¿›è¡Œ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Tutor&quot;</span> <span class="attr">id</span>=<span class="string">&quot;TutorResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;tutor_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;tutorId&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">property</span>=<span class="string">&quot;phone&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æŠŠaddr_idåˆ—çš„å€¼å½“åšå‚æ•°ä¼ ç»™findAddressByIdè¿›è¡ŒæŸ¥è¯¢ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;findAddressById&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æŠŠtutor_idåˆ—çš„å€¼å½“åšå‚æ•°ä¼ ç»™findCoursesByTutorè¿›è¡ŒæŸ¥è¯¢ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;courses&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tutor_id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;findCoursesByTutor&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line">	</span><br><span class="line"><span class="comment">&lt;!-- å•ç‹¬çš„TutoræŸ¥è¯¢è¯­å¥ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findTutorById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;TutorResult&quot;</span>&gt;</span> </span><br><span class="line">    select tutor_id,name,email,phone,addr_id</span><br><span class="line">    from tutors</span><br><span class="line">    where tutor_id = #&#123;tutor_id&#125; </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å•ç‹¬çš„AddressæŸ¥è¯¢è¯­å¥ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAddressById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;AddressResult&quot;</span>&gt;</span></span><br><span class="line">    select addr_id,street,city,state,zip,country</span><br><span class="line">    from addresses</span><br><span class="line">    where addr_id = #&#123;addr_id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å•ç‹¬çš„CourseæŸ¥è¯¢è¯­å¥ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findCoursesByTutor&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span></span><br><span class="line">    select course_id,name,description,start_date,end_date </span><br><span class="line">    from courses </span><br><span class="line">    where tutor_id = #&#123;tutor_id&#125; </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>mapperæ¥å£ä»£ç :</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TutorMapper</span></span>&#123; </span><br><span class="line">    <span class="function">Tutor <span class="title">findTutorById</span><span class="params">(<span class="keyword">int</span> tutorId)</span></span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>


<p>æµ‹è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">TutorMapper mapper = sqlSession.getMapper(TutorMapper.class); </span><br><span class="line">Tutor tutor = mapper.findTutorById(tutor Id); </span><br><span class="line">System.out.println(tutor); </span><br><span class="line">List&lt;Course&gt; courses = tutor.getCourses();</span><br><span class="line">courses.foreach(System.out::println);</span><br></pre></td></tr></table></figure>



<blockquote>
<p>æ³¨æ„ï¼ŒåµŒå¥—æŸ¥è¯¢Selectè¯­å¥æŸ¥è¯¢ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚é¦–å…ˆï¼Œä¸»æŸ¥è¯¢å°†ä¼šæ‰§è¡Œï¼Œå¯¹äºä¸»æŸ¥è¯¢è¿”å›çš„æ¯ä¸€è¡Œæ•°æ®ï¼Œå¦å¤–ä¸€ä¸ªæŸ¥è¯¢å°†ä¼šè¢«æ‰§è¡Œã€‚å¯¹äºå¤§é‡æ•°æ®è€Œè¨€ï¼Œè¿™ä¼šå¯¼è‡´æ•´ä½“æ•ˆç‡é™ä½ã€‚</p>
</blockquote>
<p>==æ€è€ƒï¼Œè¿™æ—¶å€™å¦‚æœéœ€è¦ç¼–å†™ä¸€ä¸ªCourseçš„æ’å…¥åŠŸèƒ½ï¼Œè¯¥å¦‚ä½•æ“ä½œï¼Ÿæ³¨æ„å¤–é”®åˆ—åœ¨Courseå¯¹åº”çš„è¡¨ä¸­==</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tutor(id,name,cName,tutor_id)</span><br><span class="line">	<span class="keyword">values</span>(#&#123;id&#125;,#&#123;name&#125;,#&#123;tutor.id&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="1-6-å¤šå¯¹å¤šæ˜ å°„"><a href="#1-6-å¤šå¯¹å¤šæ˜ å°„" class="headerlink" title="1.6 ==å¤šå¯¹å¤šæ˜ å°„=="></a>1.6 ==å¤šå¯¹å¤šæ˜ å°„==</h3><p>å¯¹äºåœ¨mybatisä¸­çš„å¤šå¯¹å¤šçš„å¤„ç†ï¼Œå¯ä»¥å‚ç…§ä¸€å¯¹å¤šæ¥è§£å†³ï¼Œä»¥è¯¾ç¨‹å’Œå­¦ç”Ÿä¸ºä¾‹</p>
<p>å»ºè¡¨è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> student_course;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> course;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> student;</span><br><span class="line"><span class="comment">--å¦‚æœéœ€è¦å¯ä»¥ä½¿ç”¨ cascade constraints;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> course (</span><br><span class="line">    id number <span class="keyword">primary</span> key,</span><br><span class="line">    course_code varchar2(<span class="number">30</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    course_name varchar2(<span class="number">30</span>) <span class="keyword">not</span> <span class="keyword">null</span> </span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (</span><br><span class="line">    id number <span class="keyword">primary</span> key,</span><br><span class="line">    name varchar2(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    gender varchar2(<span class="number">10</span>) ,</span><br><span class="line">    major varchar2(<span class="number">10</span>) ,</span><br><span class="line">    grade varchar2(<span class="number">10</span>) </span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student_course (</span><br><span class="line">    id number <span class="keyword">primary</span> key,</span><br><span class="line">    student_id number <span class="keyword">references</span> student(id),</span><br><span class="line">    course_id number <span class="keyword">references</span> course(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<p>javaå®ä½“ç±»ï¼š æ–°å»ºåŒ… <code>com.briup.many2many</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.many2many;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Course</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String courseCode; <span class="comment">// è¯¾ç¨‹ç¼–å·</span></span><br><span class="line">	<span class="keyword">private</span> String courseName;<span class="comment">// è¯¾ç¨‹åç§°</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;Student&gt; students;<span class="comment">// é€‰è¯¾å­¦ç”Ÿ</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCourseCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> courseCode;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourseCode</span><span class="params">(String courseCode)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.courseCode = courseCode;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCourseName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> courseName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourseName</span><span class="params">(String courseName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.courseName = courseName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">getStudents</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> students;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStudents</span><span class="params">(List&lt;Student&gt; students)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.students = students;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.many2many;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String name; <span class="comment">// å§“å</span></span><br><span class="line">	<span class="keyword">private</span> String gender; <span class="comment">// æ€§åˆ«</span></span><br><span class="line">	<span class="keyword">private</span> String major; <span class="comment">// ä¸“ä¸š</span></span><br><span class="line">	<span class="keyword">private</span> String grade; <span class="comment">// å¹´çº§</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;Course&gt; courses;<span class="comment">// æ‰€é€‰çš„è¯¾ç¨‹</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getGender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> gender;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGender</span><span class="params">(String gender)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.gender = gender;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getMajor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> major;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMajor</span><span class="params">(String major)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.major = major;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getGrade</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> grade;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGrade</span><span class="params">(String grade)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.grade = grade;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Course&gt; <span class="title">getCourses</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> courses;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourses</span><span class="params">(List&lt;Course&gt; courses)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.courses = courses;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>æ˜ å°„æ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Many2ManyMapper</span> </span>&#123;</span><br><span class="line">	<span class="comment">//æ’å…¥studentæ•°æ®</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertStudent</span><span class="params">(Student student)</span></span>;</span><br><span class="line">	<span class="comment">//æ’å…¥courseæ•°æ®</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertCourse</span><span class="params">(Course course)</span></span>;</span><br><span class="line">	<span class="comment">//é€šè¿‡idæŸ¥è¯¢å­¦ç”Ÿ</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Student <span class="title">getStudentById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">	<span class="comment">//é€šè¿‡idæŸ¥è¯¢è¯¾ç¨‹</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Course <span class="title">getCourseById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">  	<span class="comment">//å­¦ç”Ÿxé€‰è¯¾y</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">studentSelectCourse</span><span class="params">(Student student, Course course)</span></span>;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢æ¯”æŒ‡å®šidå€¼å°çš„å­¦ç”Ÿä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">getStudentByIdOnCondition</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢studentçº§è”æŸ¥è¯¢å‡ºæ‰€é€‰çš„courseå¹¶ä¸”ç»„è£…æˆå®Œæ•´çš„å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">getStudentByIdWithCourses</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>æ˜ å°„æ–‡ä»¶ï¼šä¸ºäº†é¿å…å’Œä¹‹å‰ç±»å‹çš„åˆ«åå†²çªï¼Œè¿™é‡Œå…¨éƒ½ä½¿ç”¨çš„æ˜¯ç±»å‹çš„å…¨é™å®šå</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> </span></span><br><span class="line"><span class="meta"> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.mappers.Many2ManyMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.briup.many2many.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span> </span></span><br><span class="line"><span class="tag">                   <span class="attr">order</span>=<span class="string">&quot;BEFORE&quot;</span>&gt;</span></span><br><span class="line">            select my_seq.nextval from dual</span><br><span class="line">        <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">        insert into</span><br><span class="line">        student(id,name,gender,major,grade)</span><br><span class="line">        values</span><br><span class="line">        (#&#123;id&#125;,#&#123;name&#125;,#&#123;gender&#125;,#&#123;major&#125;,#&#123;grade&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertCourse&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.briup.many2many.Course&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">order</span>=<span class="string">&quot;BEFORE&quot;</span>&gt;</span></span><br><span class="line">            select my_seq.nextval from dual</span><br><span class="line">        <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">        insert into</span><br><span class="line">        course(id,course_code,course_name)</span><br><span class="line">        values</span><br><span class="line">        (#&#123;id&#125;,#&#123;courseCode&#125;,#&#123;courseName&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">resultType</span>=<span class="string">&quot;com.briup.many2many.Student&quot;</span>&gt;</span></span><br><span class="line">        select id,name,gender,major,grade</span><br><span class="line">        from student</span><br><span class="line">        where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getCourseById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">resultType</span>=<span class="string">&quot;com.briup.many2many.Course&quot;</span>&gt;</span></span><br><span class="line">        select id,course_code as courseCode,course_name as courseName</span><br><span class="line">        from course</span><br><span class="line">        where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- param1ä»£è¡¨æ–¹æ³•ä¸­ç¬¬ä¸€ä¸ªå‚æ•° ä»¥æ­¤ç±»æ¨ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;studentSelectCourse&quot;</span>&gt;</span></span><br><span class="line">        insert into</span><br><span class="line">        student_course(id,student_id,course_id)</span><br><span class="line">        values</span><br><span class="line">        (my_seq.nextval,#&#123;param1.id&#125;,#&#123;param2.id&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¦‚æœæœ‰ç‰¹æ®Šç¬¦å·çš„è¯ éœ€è¦ç”¨ &lt;![CDATA[ ç‰¹æ®Šç¬¦å· ]]&gt; ä¾‹å¦‚ &lt; &amp; ç­‰ç­‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentByIdOnCondition&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">resultType</span>=<span class="string">&quot;com.briup.many2many.Student&quot;</span>&gt;</span></span><br><span class="line">        select *</span><br><span class="line">        from student</span><br><span class="line">        where id &lt;![CDATA[ &lt; ]]&gt;</span><br><span class="line">        #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- è¿™é‡Œä½¿ç”¨äº†åµŒå¥—ç»“æœResultMapçš„æ–¹å¼è¿›è¡Œçº§è”æŸ¥è¯¢ å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨åµŒå¥—æŸ¥è¯¢select --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ˜ å°„ä¸€ä¸ªåŸºæœ¬çš„StudentæŸ¥è¯¢ç»“æœ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;StudentResult&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.briup.many2many.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sid&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">column</span>=<span class="string">&quot;gender&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;major&quot;</span> <span class="attr">column</span>=<span class="string">&quot;major&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;grade&quot;</span> <span class="attr">column</span>=<span class="string">&quot;grade&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ç»§æ‰¿ä¸Šé¢é‚£ä¸ªåŸºæœ¬çš„æ˜ å°„,å†æ‰©å±•å‡ºçº§è”æŸ¥è¯¢ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;StudentResultWithCourses&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.briup.many2many.Student&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">extends</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;courses&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- è¿™é‡Œç‰¹åˆ«æ³¨æ„çš„æ˜¯column=&quot;cid&quot; è¿™æ˜¯å’Œselectè¯­å¥ä¸­çš„ c.id as cidå¯¹åº”çš„ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;CourseResult&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.briup.many2many.Course&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;cid&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;courseCode&quot;</span> <span class="attr">column</span>=<span class="string">&quot;course_code&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;courseName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;course_name&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ³¨æ„:æŸ¥è¯¢è¯­å¥çš„ä¸­çš„c.id as cidè¿™ä¸ªåœ°æ–¹,é¿å…åå­—ç›¸åŒå‡ºç°æŸ¥è¯¢ç»“æœä¸æ­£ç¡®çš„æƒ…å†µ åŒæ—¶åœ¨id=&quot;CourseResult&quot;çš„resultMapä¸­ä¹Ÿæœ‰ä¸è¿™é‡Œå¯¹åº”çš„è®¾ç½®è¦ç‰¹åˆ«ç‰¹åˆ«æ³¨æ„ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ³¨æ„ï¼Œå­¦ç”Ÿçš„idèµ·çš„åˆ«åä¸ºsid --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentByIdWithCourses&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">resultMap</span>=<span class="string">&quot;StudentResultWithCourses&quot;</span>&gt;</span></span><br><span class="line">        select </span><br><span class="line">			s.id  as sid,s.name,s.gender,s.major,s.grade,</span><br><span class="line">			c.id  as cid,c.course_code,c.course_name,</span><br><span class="line">			sc.id as scid,sc.student_id,sc.course_id</span><br><span class="line">		from </span><br><span class="line">			student s,</span><br><span class="line">			course c,</span><br><span class="line">			student_course sc</span><br><span class="line">		where</span><br><span class="line">			s.id= #&#123;id&#125;</span><br><span class="line">			and</span><br><span class="line">			s.id = sc.student_id</span><br><span class="line">			and</span><br><span class="line">			c.id = sc.course_id</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line">			</span><br></pre></td></tr></table></figure>


<p>æµ‹è¯•ï¼šMany2ManyMapperTest.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_insertStudent</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession session = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        session = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        Many2ManyMapper mapper = session.getMapper(Many2ManyMapper.class);</span><br><span class="line"></span><br><span class="line">        mapper.insertStudent(<span class="keyword">new</span> Student(<span class="string">&quot;å¼ ä¸‰&quot;</span>,<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;è®¡ç®—æœº&quot;</span>,<span class="string">&quot;å¤§å››&quot;</span>));</span><br><span class="line"></span><br><span class="line">        session.commit();</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        session.rollback();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(session!=<span class="keyword">null</span>)session.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_insertCourse</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession session = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        session = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        Many2ManyMapper mapper = session.getMapper(Many2ManyMapper.class);</span><br><span class="line"></span><br><span class="line">        mapper.insertCourse(<span class="keyword">new</span> Course(<span class="string">&quot;001&quot;</span>,<span class="string">&quot;corejava&quot;</span>));</span><br><span class="line">        mapper.insertCourse(<span class="keyword">new</span> Course(<span class="string">&quot;002&quot;</span>,<span class="string">&quot;oracle&quot;</span>));</span><br><span class="line"></span><br><span class="line">        session.commit();</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        session.rollback();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(session!=<span class="keyword">null</span>)session.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_studentSelectCourse</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession session = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        session = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        Many2ManyMapper mapper = session.getMapper(Many2ManyMapper.class);</span><br><span class="line"></span><br><span class="line">        Student student = mapper.getStudentById(<span class="number">58</span>);</span><br><span class="line">        Course course = mapper.getCourseById(<span class="number">59</span>);</span><br><span class="line"></span><br><span class="line">        mapper.studentSelectCourse(student, course);</span><br><span class="line"></span><br><span class="line">        session.commit();</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        session.rollback();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(session!=<span class="keyword">null</span>)session.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_getStudentByIdOnCondition</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession session = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        session = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        Many2ManyMapper mapper = session.getMapper(Many2ManyMapper.class);</span><br><span class="line"></span><br><span class="line">        List&lt;Student&gt; list = mapper.getStudentByIdOnCondition(<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(Student s:list)&#123;</span><br><span class="line">            System.out.println(s);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(session!=<span class="keyword">null</span>)session.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_getStudentByIdWithCourses</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession session = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        session = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        Many2ManyMapper mapper = session.getMapper(Many2ManyMapper.class);</span><br><span class="line"></span><br><span class="line">        Student student = mapper.getStudentByIdWithCourses(<span class="number">58</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(student);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(session!=<span class="keyword">null</span>)session.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™æ˜¯ä»studentè¿™è¾¹å‡ºå‘æ‰€åšçš„ä¸€äº›æ“ä½œ ,ä»courseä¸€è¾¹å¼€å§‹æ“ä½œæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºä¿©è€…çš„å…³ç³»æ˜¯å¤šå¯¹å¤š(å¯¹ç§°çš„)ã€‚</p>
</blockquote>
<h1 id="ç¬¬ä¸‰ç« -å…¶ä»–"><a href="#ç¬¬ä¸‰ç« -å…¶ä»–" class="headerlink" title="ç¬¬ä¸‰ç« -å…¶ä»–"></a>ç¬¬ä¸‰ç« -å…¶ä»–</h1><h2 id="1-åŠ¨æ€"><a href="#1-åŠ¨æ€" class="headerlink" title="1.==åŠ¨æ€=="></a>1.==åŠ¨æ€==</h2><blockquote>
<p>åŠ¨æ€SQL æ˜¯ MyBatis çš„å¼ºå¤§ç‰¹æ€§ä¹‹ä¸€</p>
</blockquote>
<p>å¾ˆå¤šæ—¶å€™ï¼Œé™æ€sqlå¹¶ä¸èƒ½å®Œå…¨æ»¡è¶³ç¨‹åºçš„è¦æ±‚ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ç”¨æˆ·è¾“å…¥çš„æ¡ä»¶æ¥åŠ¨æ€çš„æ”¹å˜å’Œæ„é€ ä¸€ä¸ªsqlè¯­å¥ã€‚</p>
<p>mybaitsé€šè¿‡ä»¥ä¸‹æ ‡ç­¾å¯¹åŠ¨æ€sqlæä¾›æ”¯æŒï¼š</p>
<ol>
<li><p><code>&lt;if&gt;</code></p>
</li>
<li><p><code>&lt;choose&gt;</code> </p>
</li>
<li><p><code>&lt;where&gt;</code></p>
</li>
<li><p><code>&lt;foreach&gt;</code></p>
</li>
<li><p><code>&lt;trim&gt;</code> </p>
</li>
<li><p><code>&lt;set&gt;</code></p>
</li>
</ol>
<h3 id="1-1-if"><a href="#1-1-if" class="headerlink" title="1.1 if"></a>1.1 if</h3><p><code>&lt;if&gt;</code>æ ‡ç­¾è¢«ç”¨æ¥é€šè¿‡æ¡ä»¶åµŒå…¥SQLç‰‡æ®µï¼Œå¦‚æœæ¡ä»¶ä¸ºtrueï¼Œåˆ™ç›¸åº”åœ°SQLç‰‡æ®µå°†ä¼šè¢«æ·»åŠ åˆ°SQLè¯­å¥ä¸­ã€‚</p>
<p>å‡å®šæœ‰ä¸€ä¸ªè¯¾ç¨‹æœç´¢ç•Œé¢ï¼Œè®¾ç½®äº†è®²å¸ˆï¼ˆTutorï¼‰ä¸‹æ‹‰åˆ—è¡¨æ¡†ï¼Œè¯¾ç¨‹åç§°ï¼ˆCourseNameï¼‰æ–‡æœ¬è¾“å…¥æ¡†ï¼Œå¼€å§‹æ—¶é—´ï¼ˆStartDateï¼‰è¾“å…¥æ¡†ï¼Œç»“æŸæ—¶é—´ï¼ˆEndDateï¼‰è¾“å…¥æ¡†ï¼Œä½œä¸ºæœç´¢æ¡ä»¶ï¼Œå…¶ä¸­è®²å¸ˆä¸‹æ‹‰åˆ—è¡¨æ˜¯å¿…é¡»é€‰çš„ï¼Œå…¶ä»–çš„éƒ½æ˜¯å¯é€‰çš„ã€‚</p>
<p>å½“ç”¨æˆ·ç‚¹å‡»æœç´¢æŒ‰é’®æ—¶ï¼Œéœ€è¦æ˜¾ç¤ºç¬¦åˆæ¡ä»¶çš„åˆ—è¡¨æ•°æ®ã€‚</p>
<p>å¯¹åº”çš„sqlæ˜ å°„æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç‹¬ç«‹çš„Courseå°è£…æ˜ å°„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Course&quot;</span> <span class="attr">id</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;course_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;courseId&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;description&quot;</span> <span class="attr">property</span>=<span class="string">&quot;description&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;start_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;startDate&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;end_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;endDate&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æŸ¥è¯¢Courseçš„selectè¯­å¥ï¼Œé‡Œé¢åŠ å…¥äº†ifæ¡ä»¶åˆ¤æ–­ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;searchCourses&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span></span><br><span class="line">    SELECT * FROM COURSES </span><br><span class="line">    WHERE TUTOR_ID= #&#123;tutorId&#125; </span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;courseName != null&quot;</span>&gt;</span> </span><br><span class="line">        AND NAME LIKE #&#123;courseName&#125; </span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;startDate != null&quot;</span>&gt;</span> </span><br><span class="line">        AND START_DATE &gt;= #&#123;startDate&#125; </span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;endDate != null&quot;</span>&gt;</span> </span><br><span class="line">        AND END_DATE &lt;![CDATA[ &lt;= ]]&gt; #&#123;endDate&#125; </span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œå¯ä»¥æŠŠå¤šä¸ªå‚æ•°å­˜æ”¾åˆ°Mapé›†åˆä¸­ï¼Œè¿™æ ·æ–¹æ³•mybaitsåœ¨sqlè¯­å¥ä¸­åŠ¨æ€å–å€¼</p>
</blockquote>
<p>æ˜ å°„æ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DynamicSqlMapper</span></span>&#123; </span><br><span class="line">    <span class="function">List&lt;Course&gt; <span class="title">searchCourses</span><span class="params">(Map&lt;String, Object&gt; map)</span></span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_searchCourses1</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        DynamicSqlMapper mapper = sqlSession.getMapper(DynamicSqlMapper.class);</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;String,Object&gt;(); </span><br><span class="line">        map.put(<span class="string">&quot;tutorId&quot;</span>, <span class="number">1</span>); </span><br><span class="line">        map.put(<span class="string">&quot;courseName&quot;</span>, <span class="string">&quot;%Java%&quot;</span>); </span><br><span class="line"></span><br><span class="line">        LocalDate date = LocalDate.of(<span class="number">2022</span>, <span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">        map.put(<span class="string">&quot;startDate&quot;</span>, date);</span><br><span class="line"></span><br><span class="line">        List&lt;Course&gt; courses = mapper.searchCourses(map);</span><br><span class="line"></span><br><span class="line">        courses.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<p>æ­¤å¤„å°†ç”ŸæˆæŸ¥è¯¢è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> COURSES <span class="keyword">WHERE</span> TUTOR_ID<span class="operator">=</span> ? <span class="keyword">AND</span> NAME <span class="keyword">like</span> ? <span class="keyword">AND</span> START_DATE <span class="operator">&gt;=</span> ?</span><br></pre></td></tr></table></figure>



<h3 id="1-2-choose"><a href="#1-2-choose" class="headerlink" title="1.2 choose"></a>1.2 choose</h3><p>æœ‰æ—¶å€™ï¼ŒæŸ¥è¯¢åŠŸèƒ½æ˜¯ä»¥æŸ¥è¯¢ ç±»åˆ« ä¸ºåŸºç¡€çš„ã€‚</p>
<p>ä¾‹å¦‚ï¼Œé¡µé¢ä¸­æœ‰ä¸€ä¸ªä¸‹æ‹‰åˆ—è¡¨ï¼Œå¯ä»¥é€‰æ‹©æŸ¥è¯¢çš„ç±»åˆ«ï¼Œå¯ä»¥é€‰æ‹©æ ¹æ®è®²å¸ˆæŸ¥è¯¢ã€æˆ–è€…æ ¹æ®è¯¾ç¨‹åæŸ¥è¯¢ã€æˆ–è€…æ ¹æ®æ—¶é—´æŸ¥è¯¢ç­‰ç­‰ï¼Œé€‰æ‹©äº†åˆ—è¡¨ä¹‹åï¼Œå†è¾“å…¥å…³é”®å­—è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<p>MyBatisæä¾›äº†<code>&lt;choose&gt;</code>æ ‡ç­¾å¯ä»¥æ”¯æŒæ­¤ç±»å‹çš„æŸ¥è¯¢å¤„ç†ã€‚</p>
<p>å¯¹åº”çš„sqlæ˜ å°„æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Course&quot;</span> <span class="attr">id</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;course_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;courseId&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;description&quot;</span> <span class="attr">property</span>=<span class="string">&quot;description&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;start_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;startDate&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;end_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;endDate&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;searchCourses&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span> </span><br><span class="line">    SELECT * FROM COURSES </span><br><span class="line">    <span class="tag">&lt;<span class="name">choose</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;searchBy == &#x27;Tutor&#x27;&quot;</span>&gt;</span> </span><br><span class="line">            WHERE TUTOR_ID = #&#123;tutorId&#125; </span><br><span class="line">        <span class="tag">&lt;/<span class="name">when</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;searchBy == &#x27;CourseName&#x27;&quot;</span>&gt;</span> </span><br><span class="line">            WHERE name like #&#123;courseName&#125; </span><br><span class="line">        <span class="tag">&lt;/<span class="name">when</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span> </span><br><span class="line">            WHERE start_date &gt;= sysdate </span><br><span class="line">        <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">choose</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_searchCourses2</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        DynamicSqlMapper mapper = sqlSession.getMapper(DynamicSqlMapper.class);</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;String,Object&gt;(); </span><br><span class="line">        <span class="comment">//			map.put(&quot;searchBy&quot;, &quot;Tutor&quot;); </span></span><br><span class="line">        <span class="comment">//			map.put(&quot;tutorId&quot;, 1); </span></span><br><span class="line">        map.put(<span class="string">&quot;searchBy&quot;</span>, <span class="string">&quot;CourseName&quot;</span>); </span><br><span class="line">        map.put(<span class="string">&quot;courseName&quot;</span>, <span class="string">&quot;%MyBatis%&quot;</span>); </span><br><span class="line"></span><br><span class="line">        List&lt;Course&gt; courses = mapper.searchCourses(map);</span><br><span class="line"></span><br><span class="line">        courses.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-3-where"><a href="#1-3-where" class="headerlink" title="1.3 where"></a>1.3 where</h3><p>æœ‰æ—¶å€™ï¼Œæ‰€æœ‰çš„æŸ¥è¯¢æ¡ä»¶åº”è¯¥æ˜¯å¯é€‰çš„ã€‚</p>
<p>åœ¨éœ€è¦ä½¿ç”¨è‡³å°‘ä¸€ç§æŸ¥è¯¢æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨WHEREå­å¥ï¼Œå¦‚æœæœ‰å¤šä¸ªæ¡ä»¶ï¼Œéœ€è¦åœ¨æ¡ä»¶ä¸­æ·»åŠ ANDæˆ–ORã€‚</p>
<p>MyBatisæä¾›äº†<code>&lt;where&gt;</code>å…ƒç´ æ”¯æŒè¿™ç§ç±»å‹çš„åŠ¨æ€SQLè¯­å¥ã€‚ </p>
<p>ä¾‹å¦‚ï¼Œåœ¨æŸ¥è¯¢è¯¾ç¨‹ç•Œé¢ï¼Œå‡è®¾æ‰€æœ‰çš„æŸ¥è¯¢æ¡ä»¶æ˜¯å¯é€‰çš„</p>
<p>å¯¹åº”çš„sqlæ˜ å°„æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Course&quot;</span> <span class="attr">id</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;course_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;courseId&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;description&quot;</span> <span class="attr">property</span>=<span class="string">&quot;description&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;start_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;startDate&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;end_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;endDate&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;searchCourses&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span> </span><br><span class="line">    SELECT * FROM COURSES </span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;tutorId != null &quot;</span>&gt;</span> </span><br><span class="line">            TUTOR_ID= #&#123;tutorId&#125; </span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;courseName != null&quot;</span>&gt;</span> </span><br><span class="line">            AND name like #&#123;courseName&#125; </span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;startDate != null&quot;</span>&gt;</span> </span><br><span class="line">            AND start_date &gt;= #&#123;startDate&#125; </span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œ<code>&lt;where&gt;</code>å…ƒç´ åªæœ‰åœ¨å…¶å†…éƒ¨æ ‡ç­¾æœ‰è¿”å›å†…å®¹æ—¶æ‰ä¼šåœ¨åŠ¨æ€è¯­å¥ä¸Šæ’å…¥WHEREæ¡ä»¶è¯­å¥ã€‚<br>å¹¶ä¸”ï¼Œå¦‚æœWHEREå­å¥ä»¥ANDæˆ–è€…ORæ‰“å¤´ï¼Œåˆ™æ‰“å¤´çš„ANDæˆ–ORå°†ä¼šè¢«ç§»é™¤ã€‚</p>
</blockquote>
<p>æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_searchCourses3</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        DynamicSqlMapper mapper = sqlSession.getMapper(DynamicSqlMapper.class);</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;String,Object&gt;(); </span><br><span class="line">        <span class="comment">//map.put(&quot;tutorId&quot;, 1); </span></span><br><span class="line">        <span class="comment">//map.put(&quot;courseName&quot;, &quot;JavaSE&quot;); </span></span><br><span class="line">        <span class="comment">//map.put(&quot;startDate&quot;, LocalDate.of(2022, 1, 10)); </span></span><br><span class="line"></span><br><span class="line">        List&lt;Course&gt; courses = mapper.searchCourses(map);</span><br><span class="line"></span><br><span class="line">        courses.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-4-trim"><a href="#1-4-trim" class="headerlink" title="1.4 trim"></a>1.4 trim</h3><p><code>&lt;trim&gt;</code>å…ƒç´ å’Œ<code>&lt;where&gt;</code>å…ƒç´ ç±»ä¼¼ï¼ŒåŒæ—¶<code>&lt;trim&gt;</code>æä¾›äº†æ·»åŠ  å‰ç¼€/åç¼€ æˆ–è€… ç§»é™¤ å‰ç¼€/åç¼€ çš„åŠŸèƒ½ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;searchCourses&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span> </span><br><span class="line">    SELECT * FROM COURSES </span><br><span class="line">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;WHERE&quot;</span> <span class="attr">suffixOverrides</span>=<span class="string">&quot;and&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot; tutorId != null &quot;</span>&gt;</span></span><br><span class="line">            TUTOR_ID = #&#123;tutorId&#125; and</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;courseName != null&quot;</span>&gt;</span> </span><br><span class="line">            name like #&#123;courseName&#125; and</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼š</p>
<ul>
<li>prefixè¡¨ç¤ºæœ‰ä¸€ä¸ªifæˆç«‹åˆ™æ’å…¥whereè¯­å¥</li>
<li>suffixè¡¨ç¤ºåç¼€,å’Œprefixç›¸å</li>
<li>suffixOverrides=â€andâ€è¡¨ç¤ºå¦‚æœæœ€åç”Ÿæˆçš„sqlè¯­å¥å¤šä¸€ä¸ªand,åˆ™è‡ªåŠ¨å»æ‰.</li>
<li>prefixOverridesçš„æ„æ€æ˜¯å¤„ç†å‰ç¼€,å’ŒsuffixOverridesç›¸å</li>
</ul>
<p>æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_searchCourses4</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        DynamicSqlMapper mapper = sqlSession.getMapper(DynamicSqlMapper.class);</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;String,Object&gt;(); </span><br><span class="line">        <span class="comment">//			map.put(&quot;tutorId&quot;, 1); </span></span><br><span class="line">        <span class="comment">//			map.put(&quot;courseName&quot;, &quot;JavaSE&quot;); </span></span><br><span class="line"></span><br><span class="line">        List&lt;Course&gt; courses = mapper.searchCourses(map);</span><br><span class="line"></span><br><span class="line">        courses.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-5-foreach"><a href="#1-5-foreach" class="headerlink" title="1.5 foreach"></a>1.5 foreach</h3><p>å¦å¤–ä¸€ä¸ªå¼ºå¤§çš„åŠ¨æ€SQLè¯­å¥æ„é€ æ ‡ç­¾æ˜¯<code>&lt;foreach&gt;</code></p>
<p>å®ƒå¯ä»¥è¿­ä»£éå†ä¸€ä¸ªæ•°ç»„æˆ–è€…é›†åˆï¼Œæ„é€ AND/ORæ¡ä»¶æˆ–ä¸€ä¸ªINå­å¥ã€‚</p>
<p>å‡è®¾æŸ¥è¯¢tutor_idä¸º 1ï¼Œ3ï¼Œ6çš„è®²å¸ˆæ‰€æ•™æˆçš„è¯¾ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ªtutor_idç»„æˆçš„åˆ—è¡¨ç»™æ˜ å°„è¯­å¥ï¼Œç„¶åé€šè¿‡<code>&lt;foreach&gt;</code>éå†æ­¤åˆ—è¡¨æ„é€ åŠ¨æ€SQLã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;searchCourses&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span> </span><br><span class="line">    SELECT * FROM COURSES </span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;tutorIds != null&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">&quot;tutorId&quot;</span> <span class="attr">collection</span>=<span class="string">&quot;tutorIds&quot;</span>&gt;</span> </span><br><span class="line">                OR tutor_id = #&#123;tutorId&#125; </span><br><span class="line">            <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>



<p>æ˜ å°„æ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DynamicSqlMapper</span></span>&#123; </span><br><span class="line">	<span class="function">List&lt;Course&gt; <span class="title">searchCourses</span><span class="params">(Map&lt;String,Object&gt; map)</span></span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_searchCourses5</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        DynamicSqlMapper mapper = sqlSession.getMapper(DynamicSqlMapper.class);</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;String,Object&gt;(); </span><br><span class="line"></span><br><span class="line">        List&lt;Integer&gt; tutorIds = <span class="keyword">new</span> ArrayList&lt;Integer&gt;(); </span><br><span class="line">        tutorIds.add(<span class="number">1</span>); </span><br><span class="line">        tutorIds.add(<span class="number">3</span>); </span><br><span class="line">        tutorIds.add(<span class="number">6</span>); </span><br><span class="line"></span><br><span class="line">        map.put(<span class="string">&quot;tutorIds&quot;</span>, tutorIds); </span><br><span class="line"></span><br><span class="line">        List&lt;Course&gt; courses = mapper.searchCourses(map);</span><br><span class="line"></span><br><span class="line">        courses.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å’Œä¸Šé¢åŒæ ·çš„åŠŸèƒ½ï¼Œä½¿ç”¨<code>&lt;foreach&gt;</code>ç”ŸæˆINå­å¥ï¼šï¼ˆå¸¸ç”¨ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;searchCourses&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span> </span><br><span class="line">    SELECT * FROM COURSES </span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;tutorIds != null&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span> </span><br><span class="line">            tutor_id IN </span><br><span class="line">            <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">&quot;tempValue&quot;</span> <span class="attr">collection</span>=<span class="string">&quot;tutorIds&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span> </span><br><span class="line">                #&#123;tempValue&#125; </span><br><span class="line">            <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<blockquote>
<p>åŠ¨æ€æ’å…¥</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;saveOrderLine&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;collection&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	insert into</span><br><span class="line">	es_orderline(num,cost,book_id,orderForm_id)</span><br><span class="line">	values</span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;collection&quot;</span> <span class="attr">item</span>=<span class="string">&quot;orderLine&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">           (</span><br><span class="line">               #&#123;orderLine.num&#125;,</span><br><span class="line">               #&#123;orderLine.cost&#125;,</span><br><span class="line">               #&#123;orderLine.book.id&#125;,</span><br><span class="line">               #&#123;orderLine.orderForm.id&#125;</span><br><span class="line">           )</span><br><span class="line">       <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="1-6-set"><a href="#1-6-set" class="headerlink" title="1.6 set"></a>1.6 set</h3><p><code>&lt;set&gt;</code>å…ƒç´ å’Œ<code>&lt;where&gt;</code>å…ƒç´ ç±»ä¼¼ï¼Œä½†æ˜¯setå…ƒç´ åªæ˜¯é’ˆå¯¹updateæ›´æ–°è¯­å¥ä½¿ç”¨çš„ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateStudent&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span> </span><br><span class="line">    update students  </span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name != null&quot;</span>&gt;</span>name=#&#123;name&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;email != null&quot;</span>&gt;</span>email=#&#123;email&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;phone != null&quot;</span>&gt;</span>phone=#&#123;phone&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span> </span><br><span class="line">    where id=#&#123;studId&#125; </span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œå¦‚æœ<code>&lt;if&gt;</code>æ¡ä»¶è¿”å›äº†ä»»ä½•æ–‡æœ¬å†…å®¹ï¼Œ<code>&lt;set&gt;</code>å°†ä¼šæ’å…¥setå…³é”®å­—å’Œå…¶æ–‡æœ¬å†…å®¹ï¼Œå¹¶ä¸”ä¼šå‰”é™¤å°†æœ«å°¾çš„é€—å·ã€‚</p>
</blockquote>
<p>æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_updateStudent</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        DynamicSqlMapper mapper = sqlSession.getMapper(DynamicSqlMapper.class);</span><br><span class="line"></span><br><span class="line">        Student student = <span class="keyword">new</span> Student();</span><br><span class="line">        student.setStudId(<span class="number">45</span>);</span><br><span class="line">        student.setEmail(<span class="string">&quot;xx@briup.com&quot;</span>);</span><br><span class="line"></span><br><span class="line">        mapper.updateStudent(student);</span><br><span class="line"></span><br><span class="line">        sqlSession.commit();</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="2-ç‰¹æ®Š"><a href="#2-ç‰¹æ®Š" class="headerlink" title="2.ç‰¹æ®Š"></a>2.ç‰¹æ®Š</h2><p>é™¤äº†ç®€åŒ–æ•°æ®åº“ç¼–ç¨‹å¤–ï¼ŒMyBatisè¿˜æä¾›äº†å„ç§<strong>ç‰¹æ®ŠåŠŸèƒ½</strong>ï¼Œè¿™äº›å¯¹å®ç°ä¸€äº›å¸¸ç”¨ä»»åŠ¡éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åˆ†é¡µæŸ¥è¯¢ï¼Œå­˜å–CLOB/BLOBç±»å‹çš„æ•°æ®ï¼Œå¤„ç†æšä¸¾ç±»å‹å€¼ç­‰ç­‰ã€‚</p>
<p>å¯ä»¥æ–°å»ºåŒ…<strong>special</strong>ï¼Œç›¸å…³å®ä½“ç±»å­˜æ”¾åˆ°è¿™é‡Œé¢ã€‚<br>å¦å¤–ï¼Œåœ¨mybaits-configæ–‡ä»¶ä¸­é…ç½®åˆ«åå’Œæ–°å¢æ˜ å°„æ–‡ä»¶ã€‚</p>
<h3 id="2-1-æšä¸¾ç±»å‹"><a href="#2-1-æšä¸¾ç±»å‹" class="headerlink" title="2.1 æšä¸¾ç±»å‹"></a>2.1 æšä¸¾ç±»å‹</h3><p>MyBatisæ”¯æŒæŒä¹…åŒ–enumç±»å‹å±æ€§ã€‚</p>
<p>å‡è®¾t_userè¡¨ä¸­æœ‰ä¸€åˆ—genderï¼ˆæ€§åˆ«ï¼‰ç±»å‹ä¸º varchar2(10)ï¼Œå­˜å‚¨ MALE æˆ–è€… FEMALE ä¸¤ç§å€¼ã€‚</p>
<p>å¹¶ä¸”ï¼ŒUserå¯¹è±¡æœ‰ä¸€ä¸ªenumç±»å‹çš„gender å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">Gender</span> </span>&#123; </span><br><span class="line">    MALE,FEMALE; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<p>é»˜è®¤æƒ…å†µä¸‹MyBatisä½¿ç”¨<code>EnumTypeHandler</code>æ¥å¤„ç†enumç±»å‹çš„Javaå±æ€§ï¼Œå¹¶ä¸”å°†å…¶å­˜å‚¨ä¸ºenumå€¼çš„åç§°ã€‚</p>
<p>æˆ‘ä»¬ä¸éœ€è¦ä¸ºæ­¤åšä»»ä½•é¢å¤–çš„é…ç½®ã€‚å¯ä»¥åƒä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹å±æ€§ä¸€æ ·ä½¿ç”¨enumç±»å‹å±æ€§ã€‚</p>
<p>å»ºè¡¨è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> t_user;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_user(</span><br><span class="line">  id number <span class="keyword">primary</span> key,</span><br><span class="line">  name varchar2(<span class="number">50</span>),</span><br><span class="line">  gender varchar2(<span class="number">10</span>)</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å®ä½“ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.special;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123; </span><br><span class="line">	<span class="keyword">private</span> Integer id; </span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	<span class="keyword">private</span> Gender gender;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Gender <span class="title">getGender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> gender;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGender</span><span class="params">(Gender gender)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.gender = gender;</span><br><span class="line">	&#125; </span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<p>æ˜ å°„æ–‡ä»¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;User&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">order</span>=<span class="string">&quot;BEFORE&quot;</span>&gt;</span></span><br><span class="line">        select my_seq.nextval from dual</span><br><span class="line">    <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">    insert into t_user(id,name,gender) </span><br><span class="line">    values(#&#123;id&#125;,#&#123;name&#125;,#&#123;gender&#125;) </span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_insertUser</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        SpecialMapper mapper = sqlSession.getMapper(SpecialMapper.class);</span><br><span class="line">        User user = <span class="keyword">new</span> User(<span class="string">&quot;tom&quot;</span>,Gender.MALE);</span><br><span class="line"></span><br><span class="line">        mapper.insertUser(user);</span><br><span class="line"></span><br><span class="line">        sqlSession.commit();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œå½“æ‰§è¡ŒinsertStudentè¯­å¥çš„æ—¶å€™ï¼ŒMyBatisä¼šå–Genderæšä¸¾å¯¹è±¡ï¼ˆFEMALE/MALEï¼‰çš„åç§°ï¼Œå­˜å‚¨åˆ°GENDERåˆ—ä¸­ã€‚</p>
</blockquote>
<p>å¦‚æœæˆ‘ä»¬æƒ³å­˜å‚¨FEMALEä¸º0ï¼ŒMALEä¸º1åˆ°genderåˆ—ä¸­ï¼Œéœ€è¦åœ¨mybatis-config.xmlæ–‡ä»¶ä¸­é…ç½®ä¸“é—¨çš„<strong>ç±»å‹å¤„ç†å™¨</strong>ï¼Œå¹¶æŒ‡å®šå®ƒå¤„ç†çš„æšä¸¾ç±»å‹æ˜¯å“ªä¸ªã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeHandler</span> <span class="attr">handler</span>=<span class="string">&quot;org.apache.ibatis.type.EnumOrdinalTypeHandler&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.briup.special.Gender&quot;</span>/&gt;</span> </span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæšä¸¾ç±»å‹çš„ã€é¡ºåºå€¼ã€‘æ˜¯æ ¹æ®enumä¸­çš„å£°æ˜é¡ºåºèµ‹å€¼çš„ã€‚å¦‚æœæ”¹å˜äº†Genderé‡Œé¢å¯¹è±¡çš„å£°æ˜é¡ºåºï¼Œåˆ™æ•°æ®åº“å­˜å‚¨çš„æ•°æ®å’Œæ­¤é¡ºåºå€¼å°±ä¸åŒ¹é…äº†ã€‚</p>
<h3 id="2-2-CLOB-BLOB"><a href="#2-2-CLOB-BLOB" class="headerlink" title="2.2 CLOB/BLOB"></a>2.2 CLOB/BLOB</h3><p>BLOBå’ŒCLOBéƒ½æ˜¯å¤§å­—æ®µç±»å‹ã€‚</p>
<p>BLOBæ˜¯æŒ‰äºŒè¿›åˆ¶æ¥å­˜å‚¨çš„ï¼Œè€ŒCLOBæ˜¯å¯ä»¥ç›´æ¥å­˜å‚¨æ–‡å­—çš„ã€‚</p>
<p>é€šå¸¸åƒå›¾ç‰‡ã€æ–‡ä»¶ã€éŸ³ä¹ç­‰ä¿¡æ¯å°±ç”¨BLOBå­—æ®µæ¥å­˜å‚¨ï¼Œå…ˆå°†æ–‡ä»¶è½¬ä¸ºäºŒè¿›åˆ¶å†å­˜å‚¨è¿›å»ã€‚</p>
<p>æ–‡ç« æˆ–è€…æ˜¯è¾ƒé•¿çš„æ–‡å­—ï¼Œå°±ç”¨CLOBå­˜å‚¨.</p>
<p>BLOBå’ŒCLOBåœ¨ä¸åŒçš„æ•°æ®åº“ä¸­å¯¹åº”çš„ç±»å‹ä¹Ÿä¸ä¸€æ ·ï¼š</p>
<ul>
<li>åœ¨MySQLä¸­ï¼Œclobå¯¹åº”text/longtextï¼Œblobå¯¹åº”blob </li>
<li>åœ¨Oracleä¸­ï¼Œclobå¯¹åº”clobï¼Œblobå¯¹åº”blob  </li>
</ul>
<p>å¯¹æ­¤ï¼ŒMyBatisæä¾›äº†å†…å»ºçš„å¯¹CLOB/BLOBç±»å‹åˆ—çš„æ˜ å°„å¤„ç†æ”¯æŒï¼Œæ— éœ€æˆ‘ä»¬é¢å¤–é…ç½®å’Œæ“ä½œã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p>å»ºè¡¨è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> user_pics;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user_pics( </span><br><span class="line">    id number <span class="keyword">primary</span> key, </span><br><span class="line">    name varchar2(<span class="number">50</span>) , </span><br><span class="line">    pic <span class="type">blob</span>, </span><br><span class="line">    bio <span class="type">clob</span></span><br><span class="line">); </span><br></pre></td></tr></table></figure>

<p>ç…§ç‰‡ï¼ˆpicï¼‰å¯ä»¥æ˜¯PNG,JPGæˆ–å…¶ä»–æ ¼å¼çš„ã€‚ç®€ä»‹ä¿¡æ¯ï¼ˆbioï¼‰å¯ä»¥æ˜¯æ¯”è¾ƒé•¿çš„æ–‡å­—æè¿°ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMyBatiså°†CLOBç±»å‹çš„åˆ—æ˜ å°„åˆ°<code>java.lang.String</code>ç±»å‹ä¸Šã€è€ŒæŠŠBLOBåˆ—æ˜ å°„åˆ°<code>byte[]</code>ç±»å‹ä¸Šã€‚</p>
<p>å®ä½“ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.special;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserPic</span></span>&#123; </span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id; </span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">byte</span>[] pic; <span class="comment">//blob</span></span><br><span class="line">	<span class="keyword">private</span> String bio; <span class="comment">//clob</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">byte</span>[] getPic() &#123;</span><br><span class="line">		<span class="keyword">return</span> pic;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPic</span><span class="params">(<span class="keyword">byte</span>[] pic)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.pic = pic;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getBio</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> bio;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBio</span><span class="params">(String bio)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.bio = bio;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<p>æ˜ å°„æ–‡ä»¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUserPic&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;UserPic&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">order</span>=<span class="string">&quot;BEFORE&quot;</span>&gt;</span></span><br><span class="line">        select my_seq.nextval from dual</span><br><span class="line">    <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">    insert into user_pics(id,name, pic,bio) </span><br><span class="line">    values(#&#123;id&#125;,#&#123;name&#125;,#&#123;pic&#125;,#&#123;bio&#125;) </span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserPicById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;UserPic&quot;</span>&gt;</span> </span><br><span class="line">    select * from user_pics where id=#&#123;id&#125; </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_insertUserPic</span><span class="params">()</span></span>&#123; </span><br><span class="line">    String name = <span class="string">&quot;tom&quot;</span>; </span><br><span class="line">    String bio = <span class="string">&quot;å¯ä»¥æ˜¯å¾ˆé•¿çš„å­—ç¬¦ä¸²&quot;</span>;</span><br><span class="line">    <span class="keyword">byte</span>[] pic = <span class="keyword">null</span>; </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//è¯»å–ç”¨æˆ·å¤´åƒå›¾ç‰‡</span></span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">&quot;src/com/briup/special/1.gif&quot;</span>); </span><br><span class="line">        InputStream is = <span class="keyword">new</span> FileInputStream(file); </span><br><span class="line">        pic = <span class="keyword">new</span> <span class="keyword">byte</span>[is.available()]; </span><br><span class="line">        is.read(pic); </span><br><span class="line">        is.close(); </span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e)&#123; </span><br><span class="line">        e.printStackTrace(); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‡†å¤‡å¥½è¦æ’å…¥åˆ°æ•°æ®åº“ä¸­çš„æ•°æ®å¹¶å°è£…æˆå¯¹è±¡</span></span><br><span class="line">    UserPic userPic = <span class="keyword">new</span> UserPic(name, pic , bio); </span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>; </span><br><span class="line">    <span class="keyword">try</span>&#123; </span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        SpecialMapper mapper = sqlSession.getMapper(SpecialMapper.class);</span><br><span class="line"></span><br><span class="line">        mapper.insertUserPic(userPic);</span><br><span class="line"></span><br><span class="line">        sqlSession.commit(); </span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_getUserPicById</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">        SpecialMapper mapper = sqlSession.getMapper(SpecialMapper.class);</span><br><span class="line">        UserPic userPic = mapper.getUserPicById(<span class="number">59</span>);</span><br><span class="line">        System.out.println(userPic.getId());</span><br><span class="line">        System.out.println(userPic.getName());</span><br><span class="line">        System.out.println(userPic.getBio());</span><br><span class="line">        System.out.println(userPic.getPic().length);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-å¤šä¸ªå‚æ•°"><a href="#2-3-å¤šä¸ªå‚æ•°" class="headerlink" title="2.3 å¤šä¸ªå‚æ•°"></a>2.3 å¤šä¸ªå‚æ•°</h3><p>MyBatisä¸­çš„æ˜ å°„è¯­å¥æœ‰ä¸€ä¸ªparameterTypeå±æ€§æ¥åˆ¶å®šè¾“å…¥å‚æ•°çš„ç±»å‹ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æƒ³ç»™æ˜ å°„è¯­å¥ä¼ å…¥å¤šä¸ªå‚æ•°çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰çš„è¾“å…¥å‚æ•°æ”¾åˆ°HashMapä¸­ï¼Œå°†HashMapä¼ é€’ç»™æ˜ å°„è¯­å¥ã€‚</p>
<p>å…¶å®å°±æ˜¯æŠŠå¤šä¸ªå‚æ•°å­˜åˆ°Mapä¸­ï¼ŒæŠŠMapå½“åšä¸€ä¸ªå‚æ•°å†ä¼ ç»™sqlè¯­å¥ï¼Œmybaitsæ”¶åˆ°åå†è§£æMapé›†åˆæ‹¿åˆ°æ¯ä¸€ä¸ªå‚æ•°ã€‚</p>
<p>åŒæ—¶MyBatisè¿˜æä¾›äº†å¦å¤–ä¸€ç§ä¼ é€’å¤šä¸ªè¾“å…¥å‚æ•°ç»™æ˜ å°„è¯­å¥çš„æ–¹æ³•ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³é€šè¿‡ç»™å®šçš„nameå’Œemailä¿¡æ¯æŸ¥æ‰¾å­¦ç”Ÿä¿¡æ¯ï¼Œå®šä¹‰æŸ¥è¯¢æ¥å£å¦‚ä¸‹</p>
<p>æ˜ å°„æ–‡ä»¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUserPicNameById1&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">    update user_pics set name = #&#123;name&#125; where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUserPicNameById2&quot;</span>&gt;</span></span><br><span class="line">    update user_pics set name = #&#123;param2&#125; where id = #&#123;param1&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯¹äºæ˜ å°„å™¨ä¸­çš„æ–¹æ³•ï¼ŒMyBatisé»˜è®¤ä»å·¦åˆ°å³ç»™æ–¹æ³•çš„å‚æ•°å‘½åä¸ºparam1ã€param2â€¦ï¼Œä¾æ¬¡ç±»æ¨ã€‚</p>
</blockquote>
<p>æ˜ å°„æ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updateUserPicNameById1</span><span class="params">(Map&lt;String,String&gt; map)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updateUserPicNameById2</span><span class="params">(Integer id,String name)</span></span>;</span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_updateUserPicNameById1</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">        SpecialMapper mapper = sqlSession.getMapper(SpecialMapper.class);</span><br><span class="line">        Map&lt;String,String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;64&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;zs&quot;</span>);</span><br><span class="line">        mapper.updateUserPicNameById1(map);</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_updateUserPicNameById2</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">        SpecialMapper mapper = sqlSession.getMapper(SpecialMapper.class);</span><br><span class="line">        mapper.updateUserPicNameById2(<span class="number">64</span>,<span class="string">&quot;ww&quot;</span>);</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-æ˜ å°„Map"><a href="#2-4-æ˜ å°„Map" class="headerlink" title="2.4 æ˜ å°„Map"></a>2.4 æ˜ å°„Map</h3><p>å¯ä»¥ä½¿ç”¨ä¹‹å‰ç”¨è¿‡çš„æ–¹å¼ï¼Œæ¥å£ä¸­æ–¹æ³•è¿”å›å€¼å®šä¹‰ä¸ºMapç±»å‹ï¼Œsqlè¯­å¥çš„resultTypeå±æ€§è®¾ç½®ä¸ºmapå³å¯ã€‚è¿™ç§æƒ…å†µé»˜è®¤æŠŠåˆ—åä½œä¸ºkey,åˆ—ä¸­çš„å€¼ä½œä¸ºvalueã€‚</p>
<p>å¦‚æœæœ‰ä¸€äº›ç‰¹æ®Šçš„æƒ…å†µï¼Œæ¯”å¦‚éœ€è¦ä½¿ç”¨idå€¼ä½œä¸ºkeyï¼ŒæŠŠä¸€è¡Œæ•°æ®å°è£…æˆçš„å¯¹è±¡ä½œä¸ºvalueæ”¾åˆ°mapä¸­çš„è¯ï¼Œéœ€è¦ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p>æ˜ å°„æ–‡ä»¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAllUsers&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span> </span><br><span class="line">	select id,name,gender from t_user </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_findAllUsers_map</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">		Map&lt;Integer, User&gt; map = sqlSession.selectMap(<span class="string">&quot;com.briup.mappers.SpecialMapper.findAllUsers&quot;</span>,<span class="string">&quot;id&quot;</span>);</span><br><span class="line">		map.forEach((k,v)-&gt;System.out.println(k+<span class="string">&quot; : &quot;</span>+v));</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>è¿™æ—¶å€™åªèƒ½ä½¿ç”¨å­—ç¬¦ä¸²æ¥è°ƒç”¨sqlè¯­å¥ï¼Œä¸èƒ½ä½¿ç”¨æ˜ å°„æ¥å£çš„æ–¹å¼ï¼ˆä¸æ”¯æŒï¼‰</li>
<li>t_userè¡¨ä¸­genderåˆ—çš„å€¼éƒ½æ˜¯æ•°å­—è¿˜æ˜¯éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œéœ€è¦ä¿æŒä¸€è‡´ï¼Œå¦åˆ™æŸ¥è¯¢æŠ¥é”™</li>
<li>è¿™é‡Œmapå°†idä½œä¸ºkeyå€¼ï¼Œè€Œæ¯è¡Œæ•°æ®å°è£…æˆçš„Userå¯¹è±¡ä½œä¸ºvalueå€¼</li>
<li>mapä¸­çš„keyæˆ‘ä»¬å¯ä»¥æŒ‡å®šï¼Œä½†æ˜¯valueåªèƒ½æ˜¯å½“å‰è¿™æ¡æ•°æ®å°è£…æˆçš„å¯¹è±¡</li>
</ul>
<h3 id="2-5-åˆ†é¡µæŸ¥è¯¢"><a href="#2-5-åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="2.5 åˆ†é¡µæŸ¥è¯¢"></a>2.5 åˆ†é¡µæŸ¥è¯¢</h3><p>MyBatiså¯ä»¥ä½¿ç”¨RowBoundsé€é¡µåŠ è½½è¡¨æ•°æ®ã€‚RowBoundså¯¹è±¡å¯ä»¥ä½¿ç”¨offsetå’Œlimitå‚æ•°æ¥æ„å»ºã€‚å‚æ•°offsetè¡¨ç¤ºå¼€å§‹ä½ç½®ï¼Œè€Œlimitè¡¨ç¤ºè¦å–çš„è®°å½•çš„æ•°ç›®ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<p>æ˜ å°„æ–‡ä»¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAllUsers&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span> </span><br><span class="line">    select id,name,gender from t_user </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>



<p>æ˜ å°„æ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findAllUsers</span><span class="params">(RowBounds rowBounds)</span></span>;</span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_findAllUsers_page</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">        SpecialMapper mapper = sqlSession.getMapper(SpecialMapper.class);</span><br><span class="line">        <span class="comment">//è¡¨ç¤ºä»ç¬¬å‡ æ¡æ•°æ®å¼€å§‹</span></span><br><span class="line">        <span class="keyword">int</span> offset = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//è¿ç»­å–å‡ºå‡ æ¡æ•°æ®</span></span><br><span class="line">        <span class="keyword">int</span> limit = <span class="number">5</span>; </span><br><span class="line">        RowBounds rowBounds = <span class="keyword">new</span> RowBounds(offset, limit); </span><br><span class="line">        List&lt;User&gt; list = mapper.findAllUsers(rowBounds);</span><br><span class="line">        list.forEach(System.out::println);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè‹¥è§„å®šæ¯é¡µ5æ¡æ•°æ®ï¼Œè¦å±•ç¤ºç¬¬äºŒé¡µï¼Œä½¿ç”¨offset=5,limit=5</p>
</blockquote>
<p>å…¶å®Mybatisçš„è¿™ç§åˆ†é¡µæ˜¯åŸºäºå†…å­˜çš„åˆ†é¡µï¼ˆæŸ¥å‡ºæ‰€æœ‰è®°å½•å†æŒ‰åç§»é‡offsetå’Œlimitå–ç»“æœï¼‰ï¼Œåœ¨å¤§æ•°æ®é‡çš„æƒ…å†µä¸‹è¿™æ ·çš„åˆ†é¡µæ•ˆç‡ä¼šå¾ˆä½ï¼Œåé¢æˆ‘ä»¬ä¼šä½¿ç”¨mybaitsçš„åˆ†é¡µè¾…åŠ©/æ’ä»¶å·¥å…·æ¥å®Œæˆåˆ†é¡µã€‚</p>
<p>ä¹‹å‰ï¼Œåœ¨å­¦ä¹ oracleçš„æ—¶å€™ï¼Œä¹Ÿå­¦ä¹ äº†ä½¿ç”¨rownumè¿›è¡Œåˆ†é¡µï¼š</p>
<p>ä¾‹å¦‚ï¼ŒæŸ¥è¯¢å‡ºè¡Œå·åœ¨5~10ä¹‹é—´çš„æ•°æ®</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> rownum <span class="keyword">as</span> rowno, t.<span class="operator">*</span></span><br><span class="line">    <span class="keyword">from</span> t_user t</span><br><span class="line">    <span class="keyword">where</span> rownum <span class="operator">&lt;=</span> <span class="number">10</span></span><br><span class="line">) temp</span><br><span class="line"><span class="keyword">where</span> temp.rowno <span class="operator">&gt;=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼š</p>
<ul>
<li>rownum å¯ä»¥ç­‰äº1</li>
<li>rownum å¯ä»¥å¤§äº0</li>
<li>rownum å¯ä»¥å°äºä»»ä½•æ•°  </li>
</ul>
<p>ä½†æ˜¯å¯ä»¥ç»™rownumèµ·ä¸€ä¸ªåˆ«åï¼Œå¹¶æŠŠsqlè¯­å¥æŸ¥è¯¢ç»“æœå½“åšä¸€å¼ è¡¨å†æŸ¥è¯¢ï¼Œè¿™æ ·å°±å¯ä»¥å¯¹è¿™ä¸ªè¡Œå·è¿›è¡Œä»»æ„æ“ä½œäº†ã€‚</p>
<h3 id="2-6-å¤„ç†ç»“æœé›†"><a href="#2-6-å¤„ç†ç»“æœé›†" class="headerlink" title="2.6 å¤„ç†ç»“æœé›†"></a>2.6 å¤„ç†ç»“æœé›†</h3><p>MyBatisæä¾›äº†<code>ResultHandler</code>æ¥å£,å¯ä»¥è®©æˆ‘ä»¬ä»¥ä»»ä½•è‡ªå·±å–œæ¬¢çš„æ–¹å¼å¤„ç†ç»“æœé›†ResultSetã€‚</p>
<p><code>sqlSession.select()</code>æ–¹æ³•ï¼Œå¯ä»¥ä¼ é€’ç»™å®ƒä¸€ä¸ª<code>ResultHandler</code>æ¥å£çš„å®ç°ï¼Œå®ƒä¼šå¤„ç†<code>ResultSet</code>ä¸­æŸ¥è¯¢åˆ°çš„çš„æ¯ä¸€æ¡æ•°æ®ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è‡ªå·±çš„éœ€è¦è¿›è¡Œå°è£…ã€‚</p>
<p>ä¾‹å¦‚ï¼ŒæŠŠt_userè¡¨ä¸­æ‰€æœ‰æ•°æ®çš„idå’ŒnameæŸ¥è¯¢å‡ºæ¥,å¹¶ä¸”æŠŠidå€¼ä½œä¸ºkey,æŠŠnameå€¼ä½œä¸ºvalueå°è£…åˆ°Mapé›†åˆä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_ResultHandler</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Map&lt;Integer,String&gt; map = <span class="keyword">new</span> HashMap&lt;Integer, String&gt;(); </span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        sqlSession.select(<span class="string">&quot;com.briup.mappers.SpecialMapper.findAllUsers&quot;</span>, <span class="keyword">new</span> ResultHandler&lt;User&gt;() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleResult</span><span class="params">(ResultContext&lt;? extends User&gt; resultContext)</span> </span>&#123;</span><br><span class="line">                <span class="comment">//è·å–å½“è¿™æ¡æ•°æ®å°è£…å¥½çš„Userå¯¹è±¡</span></span><br><span class="line">                User user = resultContext.getResultObject(); </span><br><span class="line">                <span class="comment">//æŒ‰ç…§è‡ªå·±çš„è¦æ±‚çš„æ–¹å¼è¿›è¡Œå°è£…</span></span><br><span class="line">                map.put(user.getId(), user.getName()); </span><br><span class="line">            &#125;</span><br><span class="line">                       </span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//ä¹Ÿå¯ä»¥ä½¿ç”¨ä¹‹å‰labmdaè¡¨è¾¾å¼æ¥å®Œæˆ</span></span><br><span class="line">        sqlSession.select(<span class="string">&quot;com.briup.dao.SpecialMapper.findAllUsers&quot;</span>,</span><br><span class="line">			(resultContext) -&gt; &#123;</span><br><span class="line">				User user = (User) resultContext.getResultObject();</span><br><span class="line">				map.put(user.getId(), user.getName());</span><br><span class="line">			&#125;</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">        map.forEach((k,v)-&gt;System.out.println(k+<span class="string">&quot; : &quot;</span>+v));</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„: æ–¹æ³•åå­—å«select</p>
</blockquote>
<h3 id="2-7-ç¼“å­˜-redis"><a href="#2-7-ç¼“å­˜-redis" class="headerlink" title="2.7 ç¼“å­˜(redis)"></a>2.7 ç¼“å­˜(redis)</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œmybatisä¼šå¯ç”¨ä¸€çº§ç¼“å­˜ã€‚</p>
<p>å¦‚æœä½¿ç”¨åŒä¸€ä¸ªsessionå¯¹è±¡è°ƒç”¨äº†ç›¸åŒçš„SELECTè¯­å¥ï¼Œåˆ™ç›´æ¥ä¼šä»ç¼“å­˜ä¸­è¿”å›ç»“æœï¼Œè€Œä¸æ˜¯å†æŸ¥è¯¢ä¸€æ¬¡æ•°æ®åº“ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼Œsessionè°ƒç”¨commitæˆ–closeæ–¹æ³•å,è¿™ä¸ªsessionä¸­çš„ä¸€çº§ç¼“å­˜å°±ä¼šè¢«æ¸…ç©º </p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œæ ¹æ®æ—¥å¿—è¾“å‡ºå¯ä»¥çœ‹å‡º,ä¸‹é¢ä»£ç åªä¼šå‘å‡ºä¸€æ¡sqlæŸ¥è¯¢è¯­å¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test_cache1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession session = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        session = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">        SpecialMapper mapper = session.getMapper(SpecialMapper.class);</span><br><span class="line">        User user1 = mapper.findUserById(<span class="number">56</span>);</span><br><span class="line">        System.out.println(user1);</span><br><span class="line">        User user2 = mapper.findUserById(<span class="number">56</span>);</span><br><span class="line">        System.out.println(user2);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œæ ¹æ®æ—¥å¿—è¾“å‡ºå¯ä»¥çœ‹å‡º,ä¸‹é¢ä»£ç åªä¼šå‘å‡ºä¸€æ¡sqlæŸ¥è¯¢è¯­å¥</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼Œsessionè°ƒç”¨commitæˆ–closeæ–¹æ³•å,è¿™ä¸ªsessionä¸­çš„ä¸€çº§ç¼“å­˜å°±ä¼šè¢«æ¸…ç©º </p>
</blockquote>
<p>äºŒçº§ç¼“å­˜ï¼Œåœ¨ä¸åŒçš„sessionå¯¹è±¡ä¹‹é—´å¯ä»¥å…±äº«ç¼“å­˜çš„æ•°æ®</p>
<ol>
<li><code>mybatis-config.xml</code>æ–‡ä»¶ä¸­ä¿è¯<code>&lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;</code>è®¾ç½®ä¸­æ˜¯ç¼“å­˜åŠŸèƒ½æ˜¯å¼€å¯çš„ï¼Œé»˜è®¤å°±æ˜¯å¼€å¯çš„true</li>
<li>åœ¨éœ€è¦äºŒçº§ç¼“å­˜çš„xmlæ˜ å°„æ–‡ä»¶ä¸­,æ‰‹åŠ¨å¼€å¯ç¼“å­˜åŠŸèƒ½,åœ¨æ ¹å…ƒç´ ä¸­åŠ å…¥ä¸€ä¸ªæ ‡ç­¾å³å¯:<code>&lt;cache/&gt;</code></li>
<li>ä¸€ä¸ªsessionæŸ¥è¯¢å®Œæ•°æ®ä¹‹å,éœ€è¦è°ƒç”¨commitæˆ–è€…closeæ–¹æ³•å,è¿™ä¸ªæ•°æ®æ‰ä¼šè¿›å…¥åˆ°äºŒçº§ç¼“å­˜ä¸­,ç„¶åå…¶ä»–sessionå°±å¯ä»¥å…±äº«åˆ°è¿™ä¸ªç¼“å­˜æ•°æ®äº†</li>
<li>é»˜è®¤æƒ…å†µä¸‹,è¢«äºŒçº§ç¼“å­˜ä¿å­˜çš„å¯¹è±¡éœ€è¦å®ç°åºåˆ—åŒ–æ¥å£</li>
</ol>
<p>ä¾‹å¦‚ï¼Œ</p>
<p>é…ç½®æ–‡ä»¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>æ˜ å°„æ–‡ä»¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.mappers.SpecialMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cache</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span>&gt;</span> ..<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span>&gt;</span> ..<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span>&gt;</span> ..<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SqlSession session = SqlSessionUtil.openSqlSession();</span><br><span class="line">    SpecialMapper mapper = session.getMapper(SpecialMapper.class);</span><br><span class="line">    List&lt;User&gt; userList1 = mapper.findAllUsers();</span><br><span class="line">    session.close();</span><br><span class="line"></span><br><span class="line">    SqlSession session2 = SqlSessionUtil.openSqlSession();</span><br><span class="line">    SpecialMapper mapper2 = session2.getMapper(SpecialMapper.class);</span><br><span class="line">    List&lt;User&gt; userList2 = mapper2.findAllUsers();</span><br><span class="line">    session2.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>äºŒçº§ç¼“å­˜è¡¥å……è¯´æ˜ï¼š</p>
<p>  ã€€ã€€1. æ˜ å°„è¯­å¥æ–‡ä»¶ä¸­çš„æ‰€æœ‰selectè¯­å¥å°†ä¼šè¢«ç¼“å­˜<br>  ã€€ã€€2. æ˜ å°„è¯­å¥æ–‡ä»¶ä¸­çš„æ‰€æœ‰insertï¼Œupdateå’Œdeleteè¯­å¥ä¼šåˆ·æ–°ç¼“å­˜<br>  ã€€ã€€3. ç¼“å­˜ä¼šä½¿ç”¨Least Recently Usedï¼ˆLRUï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ï¼‰ç®—æ³•æ¥æ”¶å›ã€‚<br>  ã€€ã€€4. ç¼“å­˜ä¼šæ ¹æ®æŒ‡å®šçš„æ—¶é—´é—´éš”æ¥åˆ·æ–°ã€‚<br>  ã€€ã€€5. ç¼“å­˜ä¼šå­˜å‚¨1024ä¸ªå¯¹è±¡</p>
<p>cacheæ ‡ç­¾å¸¸ç”¨å±æ€§ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span>  <span class="attr">eviction</span>=<span class="string">&quot;FIFO&quot;</span> <span class="attr">flushInterval</span>=<span class="string">&quot;60000&quot;</span> <span class="attr">size</span>=<span class="string">&quot;512&quot;</span> <span class="attr">readOnly</span>=<span class="string">&quot;true&quot;</span>/&gt;</span> </span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼š</p>
<ul>
<li>eviction=â€FIFOâ€ ï¼Œå›æ”¶ç­–ç•¥ä¸ºå…ˆè¿›å…ˆå‡º</li>
<li>flushInterval=â€60000â€ ï¼Œè‡ªåŠ¨åˆ·æ–°æ—¶é—´60s</li>
<li>size=â€512â€ ï¼Œæœ€å¤šç¼“å­˜512ä¸ªå¼•ç”¨å¯¹è±¡</li>
<li>readOnly=â€trueâ€ï¼Œtrueè¡¨ç¤ºå¯¹è±¡ä¸å¯ä»¥è¢«åºåˆ—åŒ–,falseè¡¨ç¤ºå¯ä»¥è¢«åºåˆ—åŒ–,é»˜è®¤å€¼æ˜¯false</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼Œå°†æ¥æ›´å¤šçš„æ—¶å€™æˆ‘ä»¬ä¼šä½¿ç”¨redisæ¥è¿›è¡Œå¯¹æ•°æ®çš„ç¼“å­˜ï¼Œè€Œä¸æ˜¯ä½¿ç”¨mybaitsæä¾›çš„ç¼“å­˜åŠŸèƒ½</p>
</blockquote>
<h2 id="3-æ³¨è§£"><a href="#3-æ³¨è§£" class="headerlink" title="3.æ³¨è§£"></a>3.æ³¨è§£</h2><blockquote>
<p>æ³¨è§£ç›¸å…³çš„å†…å®¹ä½œä¸ºäº†è§£å³å¯ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè¿˜æ˜¯ä¼šä½¿ç”¨xmlæ–¹å¼è¿›è¡Œé…ç½®</p>
</blockquote>
<p>ä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯åœ¨æ˜ å°„å™¨MapperXMLé…ç½®æ–‡ä»¶ä¸­é…ç½®æ˜ å°„è¯­å¥çš„ã€‚é™¤æ­¤ä¹‹å¤–MyBatisä¹Ÿæ”¯æŒä½¿ç”¨æ³¨è§£æ¥é…ç½®æ˜ å°„è¯­å¥ã€‚</p>
<p>å½“æˆ‘ä»¬ä½¿ç”¨åŸºäºæ³¨è§£çš„æ˜ å°„å™¨æ¥å£æ—¶ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦åœ¨XMLé…ç½®æ–‡ä»¶ä¸­é…ç½®äº†ã€‚ä¹Ÿå¯ä»¥åŒæ—¶ä½¿ç”¨åŸºäºXMLå’ŒåŸºäºæ³¨è§£çš„æ˜ å°„è¯­å¥ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡†å¤‡æµ‹è¯•ç¯å¢ƒ</p>
<p>å»ºè¡¨è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> person;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> person(</span><br><span class="line">    id number <span class="keyword">primary</span> key,</span><br><span class="line">    name varchar2(<span class="number">15</span>),</span><br><span class="line">    age number</span><br><span class="line">);	</span><br></pre></td></tr></table></figure>



<p>å®ä½“ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.special;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> Integer age;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-1-æ¥å£"><a href="#3-1-æ¥å£" class="headerlink" title="3.1 æ¥å£"></a>3.1 æ¥å£</h3><p>Mybatisä¸­çš„æ³¨è§£ï¼Œæ˜¯ç›´æ¥å†™åœ¨æ˜ å°„æ¥å£ä¸­çš„ã€‚</p>
<p>MyBatiså¯¹äºå¤§éƒ¨åˆ†çš„åŸºäºXMLçš„æ˜ å°„é…ç½®ï¼ˆåŒ…æ‹¬<code>&lt;select&gt;</code>,<code>&lt;update&gt;</code>ç­‰ï¼‰æä¾›äº†å¯¹åº”çš„åŸºäºæ³¨è§£çš„é…ç½®ã€‚ç„¶è€Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæœ‰äº›xmlçš„é…ç½®åŠŸèƒ½ï¼Œä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ˜¯å®ç°ä¸äº†çš„ã€‚</p>
<h3 id="3-2-ä½¿ç”¨"><a href="#3-2-ä½¿ç”¨" class="headerlink" title="3.2 ä½¿ç”¨"></a>3.2 ä½¿ç”¨</h3><p>MyBatisæä¾›äº†å¤šç§æ³¨è§£æ¥æ”¯æŒä¸åŒç±»å‹çš„è¯­å¥å¦‚:SELECT,INSERT,UPDATE,DELETEã€‚</p>
<h4 id="3-2-1-Insert"><a href="#3-2-1-Insert" class="headerlink" title="3.2.1 @Insert"></a>3.2.1 @Insert</h4><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>@Insert</code>æ³¨è§£æ¥å®šä¹‰ä¸€ä¸ªINSERTæ˜ å°„è¯­å¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.briup.mappers; </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span></span>&#123; </span><br><span class="line"></span><br><span class="line">	<span class="meta">@Insert(&quot;insert into students(stud_id,name,email,addr_id, phone) values(#&#123;studId&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;address.addrId&#125;,#&#123;phone&#125;)&quot;)</span> </span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">insertStudent</span><span class="params">(Student student)</span></span>; </span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œåœ¨mybatis-config.xmlä¸­ï¼Œéœ€è¦é…ç½®ï¼Œé€šçŸ¥mybaitsï¼Œå“ªä¸€ä¸ªæ¥å£æœ‰æ³¨è§£çš„é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.briup.dao.SpecialMapper&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>è‡ªåŠ¨ç”Ÿæˆä¸»é”®</p>
<p>å¯ä»¥ä½¿ç”¨ <code>@Options</code>æ³¨è§£çš„userGeneratedKeyså’ŒkeyPropertyå±æ€§è®©æ•°æ®åº“äº§ç”Ÿ auto_incrementï¼ˆè‡ªå¢é•¿ï¼‰åˆ—çš„å€¼ï¼Œç„¶åå°†ç”Ÿæˆçš„å€¼è®¾ç½®åˆ°è¾“å…¥å‚æ•°å¯¹è±¡çš„å±æ€§ä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Insert(&quot;insert into students(name,email,addr_id, phone) </span></span><br><span class="line"><span class="meta">		values(#&#123;name&#125;,#&#123;email&#125;,#&#123;address.addr Id&#125;,#&#123;phone&#125;)&quot;)</span> </span><br><span class="line"><span class="meta">@Options(useGeneratedKeys = true, keyProperty = &quot;studId&quot;)</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insertStudent</span><span class="params">(Student student)</span></span>; </span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é‡ŒIDåˆ—å€¼å°†ä¼šé€šè¿‡MySQLæ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆã€‚å¹¶ä¸”ç”Ÿæˆçš„å€¼å°†ä¼šè¢«è®¾ç½®åˆ°studentå¯¹è±¡çš„studIdå±æ€§ä¸­ã€‚</p>
</blockquote>
<p>æœ‰ä¸€äº›æ•°æ®åº“å¦‚Oracleï¼Œå¹¶ä¸æ”¯æŒAUTO_INCREMENTåˆ—å±æ€§ï¼Œå®ƒä½¿ç”¨åºåˆ—ï¼ˆSEQUENCEï¼‰æ¥äº§ç”Ÿä¸»é”®çš„å€¼ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>@SelectKey</code>æ³¨è§£æ¥ä¸ºä»»æ„SQLè¯­å¥æ¥æŒ‡å®šä¸»é”®å€¼ï¼Œä½œä¸ºä¸»é”®åˆ—çš„å€¼ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸ºSTUD_ID_SEQçš„åºåˆ—æ¥ç”ŸæˆSTUD_IDä¸»é”®å€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Insert(&quot;insert into students(stud_id,name,email,addr_id,phone) values(#&#123;studId&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;address.addrId&#125;,#&#123;phone&#125;)&quot;)</span> </span><br><span class="line"><span class="meta">@SelectKey(statement=&quot;select my_seq.nextval from dual&quot;,  </span></span><br><span class="line"><span class="meta">           keyProperty=&quot;studId&quot;, resultType=int.class, before=true)</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insertStudent</span><span class="params">(Student student)</span></span>; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä½¿ç”¨äº†<code>@SelectKey</code>æ¥ç”Ÿæˆä¸»é”®å€¼ï¼Œå¹¶ä¸”å­˜å‚¨åˆ°äº†studentå¯¹è±¡çš„studIdå±æ€§ä¸Šã€‚ç”±äºæˆ‘ä»¬è®¾ç½®äº†<code>before=true</code>,è¯¥è¯­å¥å°†ä¼šåœ¨æ‰§è¡ŒINSERTè¯­å¥ä¹‹å‰æ‰§è¡Œ</p>
<h4 id="3-2-2-Update"><a href="#3-2-2-Update" class="headerlink" title="3.2.2 @Update"></a>3.2.2 @Update</h4><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>@Update</code>æ³¨è§£æ¥å®šä¹‰ä¸€ä¸ªUPDATEæ˜ å°„è¯­å¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Update(&quot;update students set name=#&#123;name&#125;, email=#&#123;email&#125;,phone=#&#123;phone&#125; where stud_id=#&#123;studId&#125;&quot;)</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">updateStudent</span><span class="params">(Student student)</span></span>; </span><br></pre></td></tr></table></figure>

<h4 id="3-2-3-Delete"><a href="#3-2-3-Delete" class="headerlink" title="3.2.3 @Delete"></a>3.2.3 @Delete</h4><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>@Delete</code>æ³¨è§£æ¥å®šä¹‰ä¸€ä¸ªDELETEæ˜ å°„è¯­å¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Delete(&quot;delete from students where stud_id=#&#123;studId&#125;&quot;)</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteStudent</span><span class="params">(<span class="keyword">int</span> studId)</span></span>;</span><br></pre></td></tr></table></figure>



<h4 id="3-2-4-Select"><a href="#3-2-4-Select" class="headerlink" title="3.2.4 @Select"></a>3.2.4 @Select</h4><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>@Select</code>æ³¨è§£æ¥å®šä¹‰ä¸€ä¸ªSELECTæ˜ å°„è¯­å¥ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Select(&quot;select id as studid, name, email, phone from students where stud_id=#&#123;studId&#125;&quot;)</span> </span><br><span class="line"><span class="function">Student <span class="title">findStudentById</span><span class="params">(Integer studId)</span></span>; </span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¸ºäº†å°†åˆ—åå’Œå¯¹è±¡ä¸­å±æ€§ååŒ¹é…ï¼Œä¸ºIDèµ·äº†ä¸€ä¸ªstudIdçš„åˆ«åã€‚å¦‚æœæ­¤æŸ¥è¯¢è¿”å›äº†å¤šè¡Œç»“æœï¼Œå°†æŠ›å‡ºTooManyResultsExceptionå¼‚å¸¸</p>
</blockquote>
<h3 id="3-3-ç»“æœæ˜ å°„"><a href="#3-3-ç»“æœæ˜ å°„" class="headerlink" title="3.3 ç»“æœæ˜ å°„"></a>3.3 ç»“æœæ˜ å°„</h3><p>å¯ä»¥å°†æŸ¥è¯¢ç»“æœé€šè¿‡åˆ«åæˆ–è€…æ˜¯<code>@Results</code>æ³¨è§£ä¸å®ä½“ç±»çš„å±æ€§æ˜ å°„èµ·æ¥ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Select(&quot;select * from students&quot;)</span> </span><br><span class="line"><span class="meta">@Results(&#123; </span></span><br><span class="line"><span class="meta">        @Result(id = true, column = &quot;id&quot;, property = &quot;studId&quot;), </span></span><br><span class="line"><span class="meta">        @Result(column = &quot;name&quot;, property = &quot;name&quot;), </span></span><br><span class="line"><span class="meta">        @Result(column = &quot;email&quot;, property = &quot;email&quot;), </span></span><br><span class="line"><span class="meta">        @Result(column = &quot;addr_id&quot;, property = &quot;address.addrId&quot;) </span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="function">List&lt;Student&gt; <span class="title">findAllStudents</span><span class="params">()</span></span>; </span><br><span class="line">	</span><br></pre></td></tr></table></figure>



<p>ä¹Ÿå¯ä»¥åœ¨xmlä¸­å®šä¹‰ç»“æœé›†ï¼Œç„¶ååœ¨æ³¨è§£ä¸­å¼•ç”¨ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Select(&quot;select * from students where stud_id=#&#123;studId&#125;&quot;)</span> </span><br><span class="line"><span class="meta">@Results(&#123; </span></span><br><span class="line"><span class="meta">		@Result(id = true, column = &quot;id&quot;, property = &quot;studId&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;name&quot;, property = &quot;name&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;email&quot;, property = &quot;email&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;addr_id&quot;, property = &quot;address.addrId&quot;) </span></span><br><span class="line"><span class="meta">&#125;)</span> </span><br><span class="line"><span class="function">Student <span class="title">findStudentById</span><span class="params">(<span class="keyword">int</span> studId)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Select(&quot;select * from students&quot;)</span> </span><br><span class="line"><span class="meta">@Results(&#123; </span></span><br><span class="line"><span class="meta">		@Result(id = true, column = &quot;id&quot;, property = &quot;studId&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;name&quot;, property = &quot;name&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;email&quot;, property = &quot;email&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;addr_id&quot;, property = &quot;address.addrId&quot;) </span></span><br><span class="line"><span class="meta">&#125;)</span> </span><br><span class="line"><span class="function">List&lt;Student&gt; <span class="title">findAllStudents</span><span class="params">()</span></span>; </span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¸¤ä¸ªè¯­å¥çš„ <code>@Results</code>é…ç½®å®Œå…¨ç›¸åŒï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ˜ å°„æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­é…ç½®<code>&lt;resultMap&gt;</code>å…ƒç´ ï¼Œç„¶åä½¿ç”¨ <code>@ResultMap</code>æ³¨è§£å¼•ç”¨æ­¤<code>&lt;resultMap&gt;</code></p>
<p>åœ¨StudentMapper.xmlä¸­å®šä¹‰ä¸€ä¸ªIDä¸ºStudentResultçš„<code>&lt;resultMap&gt;</code>ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.mappers.StudentMapper&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;StudentResult&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;studId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">column</span>=<span class="string">&quot;phone&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>åœ¨StudentMapper.javaä¸­,ä½¿ç”¨ <code>@ResultMap</code>å¼•ç”¨åä¸ºStudentResultçš„resultMap:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span></span>&#123; </span><br><span class="line">    <span class="meta">@Select(&quot;select * from students where stud_id=#&#123;studId&#125;&quot;)</span> </span><br><span class="line">    <span class="meta">@ResultMap(&quot;com.briup.mappers.StudentMapper.StudentResult&quot;)</span> </span><br><span class="line">    <span class="function">Student <span class="title">findStudentById</span><span class="params">(<span class="keyword">int</span> studId)</span></span>; </span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select * from students&quot;)</span> </span><br><span class="line">    <span class="meta">@ResultMap(&quot;com.briup.mappers.StudentMapper.StudentResult&quot;)</span> </span><br><span class="line">    <span class="function">List&lt;Student&gt; <span class="title">findAllStudents</span><span class="params">()</span></span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h3 id="3-4-ä¸€å¯¹ä¸€"><a href="#3-4-ä¸€å¯¹ä¸€" class="headerlink" title="3.4 ä¸€å¯¹ä¸€"></a>3.4 ä¸€å¯¹ä¸€</h3><p>MyBatisæä¾›äº† <code>@One</code>æ³¨è§£æ¥ä½¿ç”¨åµŒå¥—selectè¯­å¥åŠ è½½ä¸€å¯¹ä¸€å…³è”æŸ¥è¯¢æ•°æ®ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä½¿ç”¨<code>@One</code>æ³¨è§£è·å–å­¦ç”ŸåŠå…¶åœ°å€ä¿¡æ¯ <code>@Result</code>æ³¨è§£ä¸­ï¼Œæœ‰oneè¿™ä¸ªå±æ€§ï¼Œä¹Ÿæœ‰manyè¿™ä¸ªå±æ€§ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span></span>&#123; </span><br><span class="line">    <span class="meta">@Select(&quot;select addr_id as addrId, street, city, state, zip, country from addresses where addr_id=#&#123;id&#125;&quot;)</span> </span><br><span class="line">    <span class="function">Address <span class="title">findAddressById</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select * from students where stud_id=#&#123;studId&#125; &quot;)</span> </span><br><span class="line">    <span class="meta">@Results(&#123; </span></span><br><span class="line"><span class="meta">            @Result(id = true, column = &quot;id&quot;, property = &quot;studId&quot;), </span></span><br><span class="line"><span class="meta">            @Result(column = &quot;name&quot;, property = &quot;name&quot;), </span></span><br><span class="line"><span class="meta">            @Result(column = &quot;email&quot;, property = &quot;email&quot;), </span></span><br><span class="line"><span class="meta">            @Result(property = &quot;address&quot;, column = &quot;addr_id&quot;, </span></span><br><span class="line"><span class="meta">                    one = @One(select = &quot;com.briup.mappers.Student Mapper.findAddressById&quot;)) </span></span><br><span class="line"><span class="meta">    &#125;)</span> </span><br><span class="line">    <span class="function">Student <span class="title">selectStudentWithAddress</span><span class="params">(<span class="keyword">int</span> studId)</span></span>; </span><br><span class="line">&#125; </span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä½¿ç”¨äº†<code>@One</code>æ³¨è§£çš„selectå±æ€§æ¥æŒ‡å®šä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªAddresså¯¹è±¡ã€‚</p>
<p>ä½¿ç”¨column=â€addr_idâ€,åˆ™STUEDNTSè¡¨ä¸­åˆ—addr_idçš„å€¼å°†ä¼šä½œä¸ºè¾“å…¥å‚æ•°ä¼ é€’ç»™findAddressById()æ–¹æ³•ã€‚</p>
<p>å¦‚æœ <code>@One</code> SELECTæŸ¥è¯¢è¿”å›äº†å¤šè¡Œç»“æœï¼Œåˆ™ä¼šæŠ›å‡ºTooManyResultsExceptionå¼‚å¸¸ã€‚</p>
<p>æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> studId = <span class="number">1</span>; </span><br><span class="line">StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class); </span><br><span class="line">Student student = studentMapper.selectStudentWithAddress(studId); </span><br><span class="line">System.out.println(<span class="string">&quot;Student :&quot;</span>+student); </span><br><span class="line">System.out.println(<span class="string">&quot;Address :&quot;</span>+student.getAddress()); </span><br></pre></td></tr></table></figure>





<p>ä¹‹å‰å¯ä»¥é€šè¿‡åŸºäºXMLçš„æ˜ å°„é…ç½®ï¼Œä½¿ç”¨åµŒå¥—ç»“æœResultMapæ¥åŠ è½½ä¸€å¯¹ä¸€å…³è”çš„æŸ¥è¯¢ã€‚è€ŒMyBatiså½“å‰ç‰ˆæœ¬ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹åº”çš„æ³¨è§£æ”¯æŒã€‚</p>
<p>ä½†æ˜¯å¯ä»¥åœ¨æ˜ å°„æ–‡ä»¶ä¸­æŠŠ1å¯¹1çš„åµŒå¥—ç»“æœå½¢å¼çš„æ˜ å°„ä¿¡æ¯é…ç½®å¥½ï¼Œç„¶ååœ¨@ResultMapæ³¨è§£ä¸­å»å¼•ç”¨å®ƒã€‚</p>
<p>åœ¨StudentMapper.xmlä¸­é…ç½®<code>&lt;resultMap&gt;</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.mappers.StudentMapper&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Address&quot;</span> <span class="attr">id</span>=<span class="string">&quot;AddressResult&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;addrId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;street&quot;</span> <span class="attr">column</span>=<span class="string">&quot;street&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;city&quot;</span> <span class="attr">column</span>=<span class="string">&quot;city&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;state&quot;</span> <span class="attr">column</span>=<span class="string">&quot;state&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;zip&quot;</span> <span class="attr">column</span>=<span class="string">&quot;zip&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;country&quot;</span> <span class="attr">column</span>=<span class="string">&quot;country&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;StudentWithAddressResult&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;studId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;AddressResult&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span> </span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span></span>&#123; </span><br><span class="line">		<span class="meta">@Select(&quot;select stud_id, name, email, a.addr_id, street, city, state, zip, country&quot; + &quot; FROM students s left outer join addresses a on s.addr_id=a.addr_id&quot; + &quot; where stud_id=#&#123;studId&#125; &quot;)</span> </span><br><span class="line">		<span class="meta">@ResultMap(&quot;com.briup.mappers.StudentMapper.StudentWithAddressResult&quot;)</span> </span><br><span class="line">		<span class="function">Student <span class="title">selectStudentWithAddress</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<h3 id="3-5-ä¸€å¯¹å¤š"><a href="#3-5-ä¸€å¯¹å¤š" class="headerlink" title="3.5 ä¸€å¯¹å¤š"></a>3.5 ä¸€å¯¹å¤š</h3><p>MyBatisæä¾›äº†<code>@Many</code>æ³¨è§£ï¼Œç”¨æ¥ä½¿ç”¨åµŒå¥—Selectè¯­å¥åŠ è½½ä¸€å¯¹å¤šå…³è”æŸ¥è¯¢ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä½¿ç”¨<code>@Many</code>æ³¨è§£è·å–ä¸€ä¸ªè®²å¸ˆåŠå…¶æ•™æˆè¯¾ç¨‹åˆ—è¡¨ä¿¡æ¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TutorMapper</span></span>&#123; </span><br><span class="line">	<span class="meta">@Select(&quot;select addr_id as addrId, street, city, state, zip, </span></span><br><span class="line"><span class="meta">			country from addresses where addr_id=#&#123;id&#125;&quot;)</span> </span><br><span class="line">	<span class="function">Address <span class="title">findAddressById</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line"></span><br><span class="line">	<span class="meta">@Select(&quot;select * from courses where tutor_id=#&#123;tutorId&#125;&quot;)</span> </span><br><span class="line">	<span class="meta">@Results( </span></span><br><span class="line"><span class="meta">	&#123; </span></span><br><span class="line"><span class="meta">		@Result(id = true, column = &quot;course_id&quot;, property = &quot;courseId&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;name&quot;, property = &quot;name&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;description&quot;, property = &quot;description&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;start_date&quot; property = &quot;startDate&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;end_date&quot; property = &quot;endDate&quot;) </span></span><br><span class="line"><span class="meta">	&#125;)</span> </span><br><span class="line">	<span class="function">List&lt;Course&gt; <span class="title">findCoursesByTutorId</span><span class="params">(<span class="keyword">int</span> tutorId)</span></span>; </span><br><span class="line"></span><br><span class="line">	<span class="meta">@Select(&quot;SELECT tutor_id, name as tutor_name, email, addr_id </span></span><br><span class="line"><span class="meta">			FROM tutors where tutor_id=#&#123;tutorId&#125;&quot;)</span> </span><br><span class="line">	<span class="meta">@Results( </span></span><br><span class="line"><span class="meta">	&#123; </span></span><br><span class="line"><span class="meta">		@Result(id = true, column = &quot;tutor_id&quot;, property = &quot;tutorId&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;tutor_name&quot;, property = &quot;name&quot;), </span></span><br><span class="line"><span class="meta">		@Result(column = &quot;email&quot;, property = &quot;email&quot;), </span></span><br><span class="line"><span class="meta">		@Result(property = &quot;address&quot;, column = &quot;addr_id&quot;, </span></span><br><span class="line"><span class="meta">		one = @One(select = &quot;com.briup.mappers.TutorMapper.findAddressById&quot;)), </span></span><br><span class="line"><span class="meta">		@Result(property = &quot;courses&quot;, column = &quot;tutor_id&quot;, </span></span><br><span class="line"><span class="meta">		many = @Many(select = &quot;com.briup.mappers.TutorMapper.findCoursesByTutorId&quot;)) </span></span><br><span class="line"><span class="meta">	&#125;)</span> </span><br><span class="line">	<span class="function">Tutor <span class="title">findTutorById</span><span class="params">(<span class="keyword">int</span> tutorId)</span></span>; </span><br><span class="line">&#125; </span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p> è¿™é‡Œä½¿ç”¨äº†<code>@Many</code>æ³¨è§£çš„selectå±æ€§æ¥æŒ‡å‘ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†è¿”å›ä¸€ä¸ª<code>List&lt;Course&gt;</code>å¯¹è±¡ã€‚</p>
<p>ä½¿ç”¨column=â€tutor_idâ€ï¼ŒTUTORSè¡¨ä¸­çš„tutor_idåˆ—å€¼å°†ä¼šä½œä¸ºè¾“å…¥å‚æ•°ä¼ é€’ç»™findCoursesByTutorId()æ–¹æ³•ã€‚ </p>
<p>ä¹‹å‰å¯ä»¥é€šè¿‡åŸºäºXMLçš„æ˜ å°„é…ç½®ï¼Œä½¿ç”¨åµŒå¥—ç»“æœResultMapæ¥åŠ è½½ä¸€å¯¹Nå…³è”çš„æŸ¥è¯¢ã€‚è€ŒMyBatiså½“å‰ç‰ˆæœ¬ï¼Œå¹¶æ²¡æœ‰å¯¹åº”çš„æ³¨è§£æ”¯æŒã€‚</p>
<p>ä½†æ˜¯å¯ä»¥åœ¨æ˜ å°„æ–‡ä»¶ä¸­æŠŠ1å¯¹Nçš„åµŒå¥—ç»“æœå½¢å¼çš„æ˜ å°„ä¿¡æ¯é…ç½®å¥½ï¼Œç„¶ååœ¨<code>@ResultMap</code>æ³¨è§£ä¸­å»å¼•ç”¨å®ƒã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨TutorMapper.xmlä¸­é…ç½®<code>&lt;resultMap&gt;</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.briup.mappers.Tutor Mapper&quot;</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Address&quot;</span> <span class="attr">id</span>=<span class="string">&quot;AddressResult&quot;</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;addrId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;addr_id&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;street&quot;</span> <span class="attr">column</span>=<span class="string">&quot;street&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;city&quot;</span> <span class="attr">column</span>=<span class="string">&quot;city&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;state&quot;</span> <span class="attr">column</span>=<span class="string">&quot;state&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;zip&quot;</span> <span class="attr">column</span>=<span class="string">&quot;zip&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;country&quot;</span> <span class="attr">column</span>=<span class="string">&quot;country&quot;</span> /&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Course&quot;</span> <span class="attr">id</span>=<span class="string">&quot;CourseResult&quot;</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;course_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;course Id&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;description&quot;</span> <span class="attr">property</span>=<span class="string">&quot;description&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;start_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;startDate&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;end_date&quot;</span> <span class="attr">property</span>=<span class="string">&quot;endDate&quot;</span> /&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;Tutor&quot;</span> <span class="attr">id</span>=<span class="string">&quot;TutorResult&quot;</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;tutor_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;tutorId&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;tutor_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">result</span> <span class="attr">Map</span>=<span class="string">&quot;AddressResult&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;courses&quot;</span> <span class="attr">result</span> <span class="attr">Map</span>=<span class="string">&quot;CourseResult&quot;</span> /&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TutorMapper</span></span>&#123; </span><br><span class="line">	<span class="meta">@Select(&quot;select t.tutor_id, t.name as tutor_name,email,a.addr_id, street, city, state, zip, country, course_id, c.name,description, start_date, end_date  from tutors t left outer join addresses a on t.addr_id=a.addr_id left outer join courses c on t.tutor_id=c.tutor_id where t.tutor_id=#&#123;tutorId&#125;&quot;)</span> </span><br><span class="line">	<span class="meta">@ResultMap(&quot;com.briup.mappers.TutorMapper.TutorResult&quot;)</span> </span><br><span class="line">	<span class="function">Tutor <span class="title">selectTutorById</span><span class="params">(<span class="keyword">int</span> tutorId)</span></span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

















]]></content>
      <tags>
        <tag>briup</tag>
      </tags>
  </entry>
</search>
